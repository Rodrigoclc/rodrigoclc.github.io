import './polyfills.server.mjs';
import{a as SM,b as xM,c as TM,d as IM,e as DM,h as kM,l as AM,n as RM,o as is,p as MM}from"./chunk-AJ5GQZHD.mjs";import{$ as hM,$b as pt,$c as Pi,A as Sc,Aa as Jr,Ab as rn,Ac as wM,B as zt,Ba as Ko,Bb as si,Bc as CM,C as gw,Ca as vn,Cb as ai,Cc as yw,D as aM,Da as rg,Db as _,Ea as le,Eb as b,F as xc,Fa as ae,Fb as $,Fc as He,Ga as es,Gb as $o,H as mi,Hb as ft,Ib as Yo,J as oM,Jb as hh,Jc as EM,K as Sr,Ka as nn,Kb as Z,L as lM,La as qi,Lb as fh,Lc as ya,M as cM,Ma as pM,Mb as j,Mc as ph,Nb as wt,Nc as Kn,Ob as Ke,P as ch,Pb as sg,Q as dM,Qb as mt,Qc as gh,R as Go,Rb as Be,Rc as dg,S as tg,Sb as de,T as Tc,Tb as ue,U as Ic,Ub as ts,V as uM,Vb as F,Vc as $n,W as Kt,Wb as it,Wc as Ni,X as pi,Xb as yn,Xc as ww,Y as _w,Yb as wn,Yc as ht,Z as ot,Za as kc,Zb as Cn,Zc as _i,_ as Xr,_b as En,_c as Cw,a as At,aa as Dc,ab as w,ac as se,ad as Ew,ba as Ui,bb as g,bc as Gn,bd as Sw,c as ni,ca as ee,cb as Ac,cc as mh,da as Q,db as ri,dc as Qo,eb as gM,ec as ag,f as be,fa as K,fb as Rc,fc as og,g as lh,gb as _M,gc as lg,h as Cc,ha as C,hb as uh,i as iM,ia as Ne,ib as bM,j as nM,ja as Zr,jb as re,k as Wo,ka as dh,kb as Wn,kc as vM,l as Ec,lb as bw,lc as yM,m as Yr,ma as G,mb as tt,n as et,na as ne,nb as yt,nc as cg,o as Zp,oa as X,pa as ie,qa as ig,r as Ie,ra as fM,rb as Se,s as rM,sb as xe,sc as Oc,tb as H,tc as lt,u as Jp,ub as xr,v as pw,va as gi,vb as ce,w as eg,wa as ve,wb as An,x as Qr,xa as ye,xb as vw,y as sM,ya as ng,yb as Pe,yc as qe,z as fi,za as mM,zb as Mc,zc as va}from"./chunk-QIEJ2PVV.mjs";import{A as we,B as Sn,C as bi,D as Dw,E as UM,F as vh,G as We,H as Rn,I as gg,J as kw,K as Qn,L as Ca,M as Xo,N as _g,O as yh,P as bg,Q as sn,R as vi,a as B,b as Nc,c as ug,d as OM,e as NM,f as wi,g as hg,h as _h,i as xw,j as PM,k as ns,l as Tw,m as fg,n as FM,o as LM,p as mg,q as oi,r as BM,s as VM,t as Yn,u as wa,v as pg,w as bh,x as Iw,y as jM,z as zM}from"./chunk-62KIU23Z.mjs";import{a as Me,b as tn,c as he,f as x,h as fw,i as mw,j as y}from"./chunk-H6KHSOBK.mjs";var us=x((oE,xP)=>{"use strict";var u_=he("buffer"),ds=u_.Buffer;function SP(t,e){for(var i in t)e[i]=t[i]}ds.from&&ds.alloc&&ds.allocUnsafe&&ds.allocUnsafeSlow?xP.exports=u_:(SP(u_,oE),oE.Buffer=ul);function ul(t,e,i){return ds(t,e,i)}ul.prototype=Object.create(ds.prototype);SP(ds,ul);ul.from=function(t,e,i){if(typeof t=="number")throw new TypeError("Argument must not be a number");return ds(t,e,i)};ul.alloc=function(t,e,i){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=ds(t);return e!==void 0?typeof i=="string"?n.fill(e,i):n.fill(e):n.fill(0),n};ul.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return ds(t)};ul.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return u_.SlowBuffer(t)}});var DP=x(lE=>{"use strict";var TP=he("stream").Stream,IP=he("util"),hl=function(t){this.readable=this.writable=!0,this._paused=!1,this._driver=t};IP.inherits(hl,TP);hl.prototype.pause=function(){this._paused=!0,this._driver.messages._paused=!0};hl.prototype.resume=function(){this._paused=!1,this.emit("drain");var t=this._driver.messages;t._paused=!1,t.emit("drain")};hl.prototype.write=function(t){return this.writable?(this._driver.parse(t),!this._paused):!1};hl.prototype.end=function(t){if(this.writable){t!==void 0&&this.write(t),this.writable=!1;var e=this._driver.messages;e.readable&&(e.readable=e.writable=!1,e.emit("end"))}};hl.prototype.destroy=function(){this.end()};var fl=function(t){this.readable=this.writable=!0,this._paused=!1,this._driver=t};IP.inherits(fl,TP);fl.prototype.pause=function(){this._driver.io._paused=!0};fl.prototype.resume=function(){this._driver.io._paused=!1,this._driver.io.emit("drain")};fl.prototype.write=function(t){return this.writable?(typeof t=="string"?this._driver.text(t):this._driver.binary(t),!this._paused):!1};fl.prototype.end=function(t){t!==void 0&&this.write(t)};fl.prototype.destroy=function(){};lE.IO=hl;lE.Messages=fl});var h_=x((pEe,kP)=>{"use strict";var ed=function(){this.clear()};ed.prototype.ALLOWED_DUPLICATES=["set-cookie","set-cookie2","warning","www-authenticate"];ed.prototype.clear=function(){this._sent={},this._lines=[]};ed.prototype.set=function(t,e){if(e!==void 0){t=this._strip(t),e=this._strip(e);var i=t.toLowerCase();(!this._sent.hasOwnProperty(i)||this.ALLOWED_DUPLICATES.indexOf(i)>=0)&&(this._sent[i]=!0,this._lines.push(t+": "+e+`\r
`))}};ed.prototype.toString=function(){return this._lines.join("")};ed.prototype._strip=function(t){return t.toString().replace(/^ */,"").replace(/ *$/,"")};kP.exports=ed});var RP=x((gEe,AP)=>{"use strict";var f_=us().Buffer,m_=function(){this._queue=[],this._queueSize=0,this._offset=0};m_.prototype.put=function(t){!t||t.length===0||(f_.isBuffer(t)||(t=f_.from(t)),this._queue.push(t),this._queueSize+=t.length)};m_.prototype.read=function(t){if(t>this._queueSize)return null;if(t===0)return f_.alloc(0);this._queueSize-=t;var e=this._queue,i=t,n=e[0],r,s;if(n.length>=t)return n.length===t?e.shift():(s=n.slice(0,t),e[0]=n.slice(t),s);for(var a=0,o=e.length;a<o&&!(i<e[a].length);a++)i-=e[a].length;return r=e.splice(0,a),i>0&&e.length>0&&(r.push(e[0].slice(0,i)),e[0]=e[0].slice(i)),f_.concat(r,t)};m_.prototype.eachByte=function(t,e){for(var i,n,r;this._queue.length>0;){for(i=this._queue[0],n=i.length;this._offset<n;)r=this._offset,this._offset+=1,t.call(e,i[r]);this._offset=0,this._queue.shift()}};AP.exports=m_});var Pa=x((_Ee,LP)=>{"use strict";var MP=us().Buffer,PP=he("events").EventEmitter,D$=he("util"),OP=DP(),FP=h_(),k$=RP(),an=function(t,e,i){PP.call(this),an.validateOptions(i||{},["maxLength","masking","requireMasking","protocols"]),this._request=t,this._reader=new k$,this._options=i||{},this._maxLength=this._options.maxLength||this.MAX_LENGTH,this._headers=new FP,this.__queue=[],this.readyState=0,this.url=e,this.io=new OP.IO(this),this.messages=new OP.Messages(this),this._bindEventListeners()};D$.inherits(an,PP);an.isWebSocket=function(t){var e=t.headers.connection||"",i=t.headers.upgrade||"";return t.method==="GET"&&e.toLowerCase().split(/ *, */).indexOf("upgrade")>=0&&i.toLowerCase()==="websocket"};an.validateOptions=function(t,e){for(var i in t)if(e.indexOf(i)<0)throw new Error("Unrecognized option: "+i)};var NP={MAX_LENGTH:67108863,STATES:["connecting","open","closing","closed"],_bindEventListeners:function(){var t=this;this.messages.on("error",function(){}),this.on("message",function(e){var i=t.messages;i.readable&&i.emit("data",e.data)}),this.on("error",function(e){var i=t.messages;i.readable&&i.emit("error",e)}),this.on("close",function(){var e=t.messages;e.readable&&(e.readable=e.writable=!1,e.emit("end"))})},getState:function(){return this.STATES[this.readyState]||null},addExtension:function(t){return!1},setHeader:function(t,e){return this.readyState>0?!1:(this._headers.set(t,e),!0)},start:function(){if(this.readyState!==0)return!1;if(!an.isWebSocket(this._request))return this._failHandshake(new Error("Not a WebSocket request"));var t;try{t=this._handshakeResponse()}catch(e){return this._failHandshake(e)}return this._write(t),this._stage!==-1&&this._open(),!0},_failHandshake:function(t){var e=new FP;return e.set("Content-Type","text/plain"),e.set("Content-Length",MP.byteLength(t.message,"utf8")),e=["HTTP/1.1 400 Bad Request",e.toString(),t.message],this._write(MP.from(e.join(`\r
`),"utf8")),this._fail("protocol_error",t.message),!1},text:function(t){return this.frame(t)},binary:function(t){return!1},ping:function(){return!1},pong:function(){return!1},close:function(t,e){return this.readyState!==1?!1:(this.readyState=3,this.emit("close",new an.CloseEvent(null,null)),!0)},_open:function(){this.readyState=1,this.__queue.forEach(function(t){this.frame.apply(this,t)},this),this.__queue=[],this.emit("open",new an.OpenEvent)},_queue:function(t){return this.__queue.push(t),!0},_write:function(t){var e=this.io;e.readable&&e.emit("data",t)},_fail:function(t,e){this.readyState=2,this.emit("error",new Error(e)),this.close()}};for(cE in NP)an.prototype[cE]=NP[cE];var cE;an.ConnectEvent=function(){};an.OpenEvent=function(){};an.CloseEvent=function(t,e){this.code=t,this.reason=e};an.MessageEvent=function(t){this.data=t};an.PingEvent=function(t){this.data=t};an.PongEvent=function(t){this.data=t};LP.exports=an});var UP=x(fE=>{"use strict";var uE=he("assert");fE.HTTPParser=_e;function _e(t){uE.ok(t===_e.REQUEST||t===_e.RESPONSE||t===void 0),t===void 0||this.initialize(t),this.maxHeaderSize=_e.maxHeaderSize}_e.prototype.initialize=function(t,e){uE.ok(t===_e.REQUEST||t===_e.RESPONSE),this.type=t,this.state=t+"_LINE",this.info={headers:[],upgrade:!1},this.trailers=[],this.line="",this.isChunked=!1,this.connection="",this.headerSize=0,this.body_bytes=null,this.isUserCall=!1,this.hadError=!1};_e.encoding="ascii";_e.maxHeaderSize=80*1024;_e.REQUEST="REQUEST";_e.RESPONSE="RESPONSE";var BP=_e.kOnHeaders=1,dE=_e.kOnHeadersComplete=2,p_=_e.kOnBody=3,hE=_e.kOnMessageComplete=4;_e.prototype[BP]=_e.prototype[dE]=_e.prototype[p_]=_e.prototype[hE]=function(){};var VP=!0;Object.defineProperty(_e,"kOnExecute",{get:function(){return VP=!1,99}});var jP=fE.methods=_e.methods=["DELETE","GET","HEAD","POST","PUT","CONNECT","OPTIONS","TRACE","COPY","LOCK","MKCOL","MOVE","PROPFIND","PROPPATCH","SEARCH","UNLOCK","BIND","REBIND","UNBIND","ACL","REPORT","MKACTIVITY","CHECKOUT","MERGE","M-SEARCH","NOTIFY","SUBSCRIBE","UNSUBSCRIBE","PATCH","PURGE","MKCALENDAR","LINK","UNLINK","SOURCE"],zP=jP.indexOf("CONNECT");_e.prototype.reinitialize=_e;_e.prototype.close=_e.prototype.pause=_e.prototype.resume=_e.prototype.free=function(){};_e.prototype._compatMode0_11=!1;_e.prototype.getAsyncId=function(){return 0};var A$={REQUEST_LINE:!0,RESPONSE_LINE:!0,HEADER:!0};_e.prototype.execute=function(t,e,i){if(!(this instanceof _e))throw new TypeError("not a HTTPParser");e=e||0,i=typeof i=="number"?i:t.length,this.chunk=t,this.offset=e;var n=this.end=e+i;try{for(;this.offset<n&&!this[this.state](););}catch(r){if(this.isUserCall)throw r;return this.hadError=!0,r}return this.chunk=null,i=this.offset-e,A$[this.state]&&(this.headerSize+=i,this.headerSize>(this.maxHeaderSize||_e.maxHeaderSize))?new Error("max header size exceeded"):i};var R$={REQUEST_LINE:!0,RESPONSE_LINE:!0,BODY_RAW:!0};_e.prototype.finish=function(){if(!this.hadError){if(!R$[this.state])return new Error("invalid state for EOF");this.state==="BODY_RAW"&&this.userCall()(this[hE]())}};_e.prototype.consume=_e.prototype.unconsume=_e.prototype.getCurrentBuffer=function(){};_e.prototype.userCall=function(){this.isUserCall=!0;var t=this;return function(e){return t.isUserCall=!1,e}};_e.prototype.nextRequest=function(){this.userCall()(this[hE]()),this.reinitialize(this.type)};_e.prototype.consumeLine=function(){for(var t=this.end,e=this.chunk,i=this.offset;i<t;i++)if(e[i]===10){var n=this.line+e.toString(_e.encoding,this.offset,i);return n.charAt(n.length-1)==="\r"&&(n=n.substr(0,n.length-1)),this.line="",this.offset=i+1,n}this.line+=e.toString(_e.encoding,this.offset,this.end),this.offset=this.end};var M$=/^([^: \t]+):[ \t]*((?:.*[^ \t])|)/,O$=/^[ \t]+(.*[^ \t])/;_e.prototype.parseHeader=function(t,e){if(t.indexOf("\r")!==-1)throw g_("HPE_LF_EXPECTED");var i=M$.exec(t),n=i&&i[1];if(n)e.push(n),e.push(i[2]);else{var r=O$.exec(t);r&&e.length&&(e[e.length-1]&&(e[e.length-1]+=" "),e[e.length-1]+=r[1])}};var N$=/^([A-Z-]+) ([^ ]+) HTTP\/(\d)\.(\d)$/;_e.prototype.REQUEST_LINE=function(){var t=this.consumeLine();if(t){var e=N$.exec(t);if(e===null)throw g_("HPE_INVALID_CONSTANT");if(this.info.method=this._compatMode0_11?e[1]:jP.indexOf(e[1]),this.info.method===-1)throw new Error("invalid request method");this.info.url=e[2],this.info.versionMajor=+e[3],this.info.versionMinor=+e[4],this.body_bytes=0,this.state="HEADER"}};var P$=/^HTTP\/(\d)\.(\d) (\d{3}) ?(.*)$/;_e.prototype.RESPONSE_LINE=function(){var t=this.consumeLine();if(t){var e=P$.exec(t);if(e===null)throw g_("HPE_INVALID_CONSTANT");this.info.versionMajor=+e[1],this.info.versionMinor=+e[2];var i=this.info.statusCode=+e[3];this.info.statusMessage=e[4],((i/100|0)===1||i===204||i===304)&&(this.body_bytes=0),this.state="HEADER"}};_e.prototype.shouldKeepAlive=function(){if(this.info.versionMajor>0&&this.info.versionMinor>0){if(this.connection.indexOf("close")!==-1)return!1}else if(this.connection.indexOf("keep-alive")===-1)return!1;return!!(this.body_bytes!==null||this.isChunked)};_e.prototype.HEADER=function(){var t=this.consumeLine();if(t!==void 0){var e=this.info;if(t)this.parseHeader(t,e.headers);else{for(var i=e.headers,n=!1,r,s=!1,a=0;a<i.length;a+=2)switch(i[a].toLowerCase()){case"transfer-encoding":this.isChunked=i[a+1].toLowerCase()==="chunked";break;case"content-length":if(r=+i[a+1],n){if(r!==this.body_bytes)throw g_("HPE_UNEXPECTED_CONTENT_LENGTH")}else n=!0,this.body_bytes=r;break;case"connection":this.connection+=i[a+1].toLowerCase();break;case"upgrade":s=!0;break}this.isChunked&&n&&(n=!1,this.body_bytes=null),s&&this.connection.indexOf("upgrade")!=-1?e.upgrade=this.type===_e.REQUEST||e.statusCode===101:e.upgrade=e.method===zP,this.isChunked&&e.upgrade&&(this.isChunked=!1),e.shouldKeepAlive=this.shouldKeepAlive();var o;if(VP?o=this.userCall()(this[dE](e)):o=this.userCall()(this[dE](e.versionMajor,e.versionMinor,e.headers,e.method,e.url,e.statusCode,e.statusMessage,e.upgrade,e.shouldKeepAlive)),o===2)return this.nextRequest(),!0;if(this.isChunked&&!o)this.state="BODY_CHUNKHEAD";else{if(o||this.body_bytes===0)return this.nextRequest(),e.upgrade;this.body_bytes===null?this.state="BODY_RAW":this.state="BODY_SIZED"}}}};_e.prototype.BODY_CHUNKHEAD=function(){var t=this.consumeLine();t!==void 0&&(this.body_bytes=parseInt(t,16),this.body_bytes?this.state="BODY_CHUNK":this.state="BODY_CHUNKTRAILERS")};_e.prototype.BODY_CHUNK=function(){var t=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[p_](this.chunk,this.offset,t)),this.offset+=t,this.body_bytes-=t,this.body_bytes||(this.state="BODY_CHUNKEMPTYLINE")};_e.prototype.BODY_CHUNKEMPTYLINE=function(){var t=this.consumeLine();t!==void 0&&(uE.equal(t,""),this.state="BODY_CHUNKHEAD")};_e.prototype.BODY_CHUNKTRAILERS=function(){var t=this.consumeLine();t!==void 0&&(t?this.parseHeader(t,this.trailers):(this.trailers.length&&this.userCall()(this[BP](this.trailers,"")),this.nextRequest()))};_e.prototype.BODY_RAW=function(){var t=this.end-this.offset;this.userCall()(this[p_](this.chunk,this.offset,t)),this.offset=this.end};_e.prototype.BODY_SIZED=function(){var t=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[p_](this.chunk,this.offset,t)),this.offset+=t,this.body_bytes-=t,this.body_bytes||this.nextRequest()};["Headers","HeadersComplete","Body","MessageComplete"].forEach(function(t){var e=_e["kOn"+t];Object.defineProperty(_e.prototype,"on"+t,{get:function(){return this[e]},set:function(i){return this._compatMode0_11=!0,zP="CONNECT",this[e]=i}})});function g_(t){var e=new Error("Parse Error");return e.code=t,e}});var b_=x((vEe,HP)=>{"use strict";var __=UP().HTTPParser,F$=us().Buffer,L$={request:__.REQUEST||"request",response:__.RESPONSE||"response"},on=function(t){this._type=t,this._parser=new __(L$[t]),this._complete=!1,this.headers={};var e=null,i=this;this._parser.onHeaderField=function(n,r,s){e=n.toString("utf8",r,r+s).toLowerCase()},this._parser.onHeaderValue=function(n,r,s){var a=n.toString("utf8",r,r+s);i.headers.hasOwnProperty(e)?i.headers[e]+=", "+a:i.headers[e]=a},this._parser.onHeadersComplete=this._parser[__.kOnHeadersComplete]=function(n,r,s,a,o,l){var c=arguments[0];if(typeof c=="object"&&(a=c.method,o=c.url,l=c.statusCode,s=c.headers),i.method=typeof a=="number"?on.METHODS[a]:a,i.statusCode=l,i.url=o,!!s){for(var d=0,u=s.length,h,f;d<u;d+=2)h=s[d].toLowerCase(),f=s[d+1],i.headers.hasOwnProperty(h)?i.headers[h]+=", "+f:i.headers[h]=f;i._complete=!0}}};on.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"BIND",17:"REBIND",18:"UNBIND",19:"ACL",20:"REPORT",21:"MKACTIVITY",22:"CHECKOUT",23:"MERGE",24:"M-SEARCH",25:"NOTIFY",26:"SUBSCRIBE",27:"UNSUBSCRIBE",28:"PATCH",29:"PURGE",30:"MKCALENDAR",31:"LINK",32:"UNLINK"};var qP=process.version?process.version.match(/[0-9]+/g).map(function(t){return parseInt(t,10)}):[];qP[0]===0&&qP[1]===12&&(on.METHODS[16]="REPORT",on.METHODS[17]="MKACTIVITY",on.METHODS[18]="CHECKOUT",on.METHODS[19]="MERGE",on.METHODS[20]="M-SEARCH",on.METHODS[21]="NOTIFY",on.METHODS[22]="SUBSCRIBE",on.METHODS[23]="UNSUBSCRIBE",on.METHODS[24]="PATCH",on.METHODS[25]="PURGE");on.prototype.isComplete=function(){return this._complete};on.prototype.parse=function(t){var e=this._parser.execute(t,0,t.length);if(typeof e!="number"){this.error=e,this._complete=!0;return}this._complete&&(this.body=e<t.length?t.slice(e):F$.alloc(0))};HP.exports=on});var KP=x((yEe,GP)=>{"use strict";var mE=/([!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+)/,B$=/([^!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z])/g,V$=/"((?:\\[\x00-\x7f]|[^\x00-\x08\x0a-\x1f\x7f"\\])*)"/,pE=new RegExp(mE.source+"(?:=(?:"+mE.source+"|"+V$.source+"))?"),gE=new RegExp(mE.source+"(?: *; *"+pE.source+")*","g"),j$=new RegExp("^"+gE.source+"(?: *, *"+gE.source+")*$"),z$=/^-?(0|[1-9][0-9]*)(\.[0-9]+)?$/,WP=Object.prototype.hasOwnProperty,U$={parseHeader:function(t){var e=new af;if(t===""||t===void 0)return e;if(!j$.test(t))throw new SyntaxError("Invalid Sec-WebSocket-Extensions header: "+t);var i=t.match(gE);return i.forEach(function(n){var r=n.match(new RegExp(pE.source,"g")),s=r.shift(),a={};r.forEach(function(o){var l=o.match(pE),c=l[1],d;l[2]!==void 0?d=l[2]:l[3]!==void 0?d=l[3].replace(/\\/g,""):d=!0,z$.test(d)&&(d=parseFloat(d)),WP.call(a,c)?(a[c]=[].concat(a[c]),a[c].push(d)):a[c]=d},this),e.push(s,a)},this),e},serializeParams:function(t,e){var i=[],n=function(s,a){a instanceof Array?a.forEach(function(o){n(s,o)}):a===!0?i.push(s):typeof a=="number"?i.push(s+"="+a):B$.test(a)?i.push(s+'="'+a.replace(/"/g,'\\"')+'"'):i.push(s+"="+a)};for(var r in e)n(r,e[r]);return[t].concat(i).join("; ")}},af=function(){this._byName={},this._inOrder=[]};af.prototype.push=function(t,e){WP.call(this._byName,t)||(this._byName[t]=[]),this._byName[t].push(e),this._inOrder.push({name:t,params:e})};af.prototype.eachOffer=function(t,e){for(var i=this._inOrder,n=0,r=i.length;n<r;n++)t.call(e,i[n].name,i[n].params)};af.prototype.byName=function(t){return this._byName[t]||[]};af.prototype.toArray=function(){return this._inOrder.slice()};GP.exports=U$});var _E=x((wEe,$P)=>{"use strict";var of=function(t){this._bufferSize=t,this.clear()};of.prototype.clear=function(){this._buffer=new Array(this._bufferSize),this._ringOffset=0,this._ringSize=this._bufferSize,this._head=0,this._tail=0,this.length=0};of.prototype.push=function(t){var e=!1,i=!1;this._ringSize<this._bufferSize?e=this._tail===0:this._ringOffset===this._ringSize&&(e=!0,i=this._tail===0),e&&(this._tail=this._bufferSize,this._buffer=this._buffer.concat(new Array(this._bufferSize)),this._bufferSize=this._buffer.length,i&&(this._ringSize=this._bufferSize)),this._buffer[this._tail]=t,this.length+=1,this._tail<this._ringSize&&(this._ringOffset+=1),this._tail=(this._tail+1)%this._bufferSize};of.prototype.peek=function(){if(this.length!==0)return this._buffer[this._head]};of.prototype.shift=function(){if(this.length!==0){var t=this._buffer[this._head];return this._buffer[this._head]=void 0,this.length-=1,this._ringOffset-=1,this._ringOffset===0&&this.length>0?(this._head=this._ringSize,this._ringOffset=this.length,this._ringSize=this._bufferSize):this._head=(this._head+1)%this._ringSize,t}};$P.exports=of});var QP=x((CEe,YP)=>{"use strict";var q$=_E(),td=function(t,e){this._session=t,this._method=e,this._queue=new q$(td.QUEUE_SIZE),this._stopped=!1,this.pending=0};td.QUEUE_SIZE=8;td.prototype.call=function(t,e,i,n){if(!this._stopped){var r={error:t,message:e,callback:i,context:n,done:!1},s=!1,a=this;if(this._queue.push(r),r.error)return r.done=!0,this._stop(),this._flushQueue();var o=function(l,c){s^(s=!0)&&(l?(a._stop(),r.error=l,r.message=null):r.message=c,r.done=!0,a._flushQueue())};try{this._session[this._method](e,o)}catch(l){o(l)}}};td.prototype._stop=function(){this.pending=this._queue.length,this._stopped=!0};td.prototype._flushQueue=function(){for(var t=this._queue,e;t.length>0&&t.peek().done;)e=t.shift(),e.error?(this.pending=0,t.clear()):this.pending-=1,e.callback.call(e.context,e.error,e.message)};YP.exports=td});var bE=x((EEe,XP)=>{"use strict";var H$=_E(),ml=function(){this._complete=!1,this._callbacks=new H$(ml.QUEUE_SIZE)};ml.QUEUE_SIZE=4;ml.all=function(t){var e=new ml,i=t.length,n=i;for(i===0&&e.done();n--;)t[n].then(function(){i-=1,i===0&&e.done()});return e};ml.prototype.then=function(t){this._complete?t():this._callbacks.push(t)};ml.prototype.done=function(){this._complete=!0;for(var t=this._callbacks,e;e=t.shift();)e()};XP.exports=ml});var eF=x((SEe,JP)=>{"use strict";var ZP=QP(),W$=bE(),pl=function(t){this._ext=t[0],this._session=t[1],this._functors={incoming:new ZP(this._session,"processIncomingMessage"),outgoing:new ZP(this._session,"processOutgoingMessage")}};pl.prototype.pending=function(t){var e=this._functors[t];e._stopped||(e.pending+=1)};pl.prototype.incoming=function(t,e,i,n){this._exec("incoming",t,e,i,n)};pl.prototype.outgoing=function(t,e,i,n){this._exec("outgoing",t,e,i,n)};pl.prototype.close=function(){return this._closed=this._closed||new W$,this._doClose(),this._closed};pl.prototype._exec=function(t,e,i,n,r){this._functors[t].call(e,i,function(s,a){s&&(s.message=this._ext.name+": "+s.message),n.call(r,s,a),this._doClose()},this)};pl.prototype._doClose=function(){var t=this._functors.incoming,e=this._functors.outgoing;!this._closed||t.pending+e.pending!==0||(this._session&&this._session.close(),this._session=null,this._closed.done())};JP.exports=pl});var iF=x((xEe,tF)=>{"use strict";var G$=eF(),K$=bE(),lf=function(t){this._cells=t.map(function(e){return new G$(e)}),this._stopped={incoming:!1,outgoing:!1}};lf.prototype.processIncomingMessage=function(t,e,i){this._stopped.incoming||this._loop("incoming",this._cells.length-1,-1,-1,t,e,i)};lf.prototype.processOutgoingMessage=function(t,e,i){this._stopped.outgoing||this._loop("outgoing",0,this._cells.length,1,t,e,i)};lf.prototype.close=function(t,e){this._stopped={incoming:!0,outgoing:!0};var i=this._cells.map(function(n){return n.close()});t&&K$.all(i).then(function(){t.call(e)})};lf.prototype._loop=function(t,e,i,n,r,s,a){for(var o=this._cells,l=o.length,c=this;l--;)o[l].pending(t);var d=function(u,h,f){if(u===i)return s.call(a,h,f);o[u][t](h,f,function(p,v){p&&(c._stopped[t]=!0),d(u+n,p,v)})};d(e,null,r)};tF.exports=lf});var aF=x((TEe,sF)=>{"use strict";var cf=KP(),nF=iF(),v_=function(){this._rsv1=this._rsv2=this._rsv3=null,this._byName={},this._inOrder=[],this._sessions=[],this._index={}};v_.MESSAGE_OPCODES=[1,2];var rF={add:function(t){if(typeof t.name!="string")throw new TypeError("extension.name must be a string");if(t.type!=="permessage")throw new TypeError('extension.type must be "permessage"');if(typeof t.rsv1!="boolean")throw new TypeError("extension.rsv1 must be true or false");if(typeof t.rsv2!="boolean")throw new TypeError("extension.rsv2 must be true or false");if(typeof t.rsv3!="boolean")throw new TypeError("extension.rsv3 must be true or false");if(this._byName.hasOwnProperty(t.name))throw new TypeError('An extension with name "'+t.name+'" is already registered');this._byName[t.name]=t,this._inOrder.push(t)},generateOffer:function(){var t=[],e=[],i={};return this._inOrder.forEach(function(n){var r=n.createClientSession();if(r){var s=[n,r];t.push(s),i[n.name]=s;var a=r.generateOffer();a=a?[].concat(a):[],a.forEach(function(o){e.push(cf.serializeParams(n.name,o))},this)}},this),this._sessions=t,this._index=i,e.length>0?e.join(", "):null},activate:function(t){var e=cf.parseHeader(t),i=[];e.eachOffer(function(n,r){var s=this._index[n];if(!s)throw new Error('Server sent an extension response for unknown extension "'+n+'"');var a=s[0],o=s[1],l=this._reserved(a);if(l)throw new Error("Server sent two extension responses that use the RSV"+l[0]+' bit: "'+l[1]+'" and "'+a.name+'"');if(o.activate(r)!==!0)throw new Error("Server sent unacceptable extension parameters: "+cf.serializeParams(n,r));this._reserve(a),i.push(s)},this),this._sessions=i,this._pipeline=new nF(i)},generateResponse:function(t){var e=[],i=[],n=cf.parseHeader(t);return this._inOrder.forEach(function(r){var s=n.byName(r.name);if(!(s.length===0||this._reserved(r))){var a=r.createServerSession(s);a&&(this._reserve(r),e.push([r,a]),i.push(cf.serializeParams(r.name,a.generateResponse())))}},this),this._sessions=e,this._pipeline=new nF(e),i.length>0?i.join(", "):null},validFrameRsv:function(t){var e={rsv1:!1,rsv2:!1,rsv3:!1},i;if(v_.MESSAGE_OPCODES.indexOf(t.opcode)>=0)for(var n=0,r=this._sessions.length;n<r;n++)i=this._sessions[n][0],e.rsv1=e.rsv1||i.rsv1,e.rsv2=e.rsv2||i.rsv2,e.rsv3=e.rsv3||i.rsv3;return(e.rsv1||!t.rsv1)&&(e.rsv2||!t.rsv2)&&(e.rsv3||!t.rsv3)},processIncomingMessage:function(t,e,i){this._pipeline.processIncomingMessage(t,e,i)},processOutgoingMessage:function(t,e,i){this._pipeline.processOutgoingMessage(t,e,i)},close:function(t,e){if(!this._pipeline)return t.call(e);this._pipeline.close(t,e)},_reserve:function(t){this._rsv1=this._rsv1||t.rsv1&&t.name,this._rsv2=this._rsv2||t.rsv2&&t.name,this._rsv3=this._rsv3||t.rsv3&&t.name},_reserved:function(t){return this._rsv1&&t.rsv1?[1,this._rsv1]:this._rsv2&&t.rsv2?[2,this._rsv2]:this._rsv3&&t.rsv3?[3,this._rsv3]:!1}};for(vE in rF)v_.prototype[vE]=rF[vE];var vE;sF.exports=v_});var dF=x((IEe,cF)=>{"use strict";var lF=function(){},oF={final:!1,rsv1:!1,rsv2:!1,rsv3:!1,opcode:null,masked:!1,maskingKey:null,lengthBytes:1,length:0,payload:null};for(yE in oF)lF.prototype[yE]=oF[yE];var yE;cF.exports=lF});var mF=x((DEe,fF)=>{"use strict";var $$=us().Buffer,hF=function(){this.rsv1=!1,this.rsv2=!1,this.rsv3=!1,this.opcode=null,this.length=0,this._chunks=[]},uF={read:function(){return this.data=this.data||$$.concat(this._chunks,this.length)},pushFrame:function(t){this.rsv1=this.rsv1||t.rsv1,this.rsv2=this.rsv2||t.rsv2,this.rsv3=this.rsv3||t.rsv3,this.opcode===null&&(this.opcode=t.opcode),this._chunks.push(t.payload),this.length+=t.length}};for(wE in uF)hF.prototype[wE]=uF[wE];var wE;fF.exports=hF});var EE=x((kEe,vF)=>{"use strict";var df=us().Buffer,bF=he("crypto"),Y$=he("util"),Q$=aF(),gl=Pa(),pF=dF(),gF=mF(),On=function(t,e,i){if(gl.apply(this,arguments),this._extensions=new Q$,this._stage=0,this._masking=this._options.masking,this._protocols=this._options.protocols||[],this._requireMasking=this._options.requireMasking,this._pingCallbacks={},typeof this._protocols=="string"&&(this._protocols=this._protocols.split(/ *, */)),!!this._request){var n=this._request.headers["sec-websocket-protocol"],r=this._protocols;n!==void 0&&(typeof n=="string"&&(n=n.split(/ *, */)),this.protocol=n.filter(function(s){return r.indexOf(s)>=0})[0]),this.version="hybi-"+On.VERSION}};Y$.inherits(On,gl);On.VERSION="13";On.mask=function(t,e,i){if(!e||e.length===0)return t;i=i||0;for(var n=0,r=t.length-i;n<r;n++)t[i+n]=t[i+n]^e[n%4];return t};On.generateAccept=function(t){var e=bF.createHash("sha1");return e.update(t+On.GUID),e.digest("base64")};On.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";var _F={FIN:128,MASK:128,RSV1:64,RSV2:32,RSV3:16,OPCODE:15,LENGTH:127,OPCODES:{continuation:0,text:1,binary:2,close:8,ping:9,pong:10},OPCODE_CODES:[0,1,2,8,9,10],MESSAGE_OPCODES:[0,1,2],OPENING_OPCODES:[1,2],ERRORS:{normal_closure:1e3,going_away:1001,protocol_error:1002,unacceptable:1003,encoding_error:1007,policy_violation:1008,too_large:1009,extension_error:1010,unexpected_condition:1011},ERROR_CODES:[1e3,1001,1002,1003,1007,1008,1009,1010,1011],DEFAULT_ERROR_CODE:1e3,MIN_RESERVED_ERROR:3e3,MAX_RESERVED_ERROR:4999,UTF8_MATCH:/^([\x00-\x7F]|[\xC2-\xDF][\x80-\xBF]|\xE0[\xA0-\xBF][\x80-\xBF]|[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}|\xED[\x80-\x9F][\x80-\xBF]|\xF0[\x90-\xBF][\x80-\xBF]{2}|[\xF1-\xF3][\x80-\xBF]{3}|\xF4[\x80-\x8F][\x80-\xBF]{2})*$/,addExtension:function(t){return this._extensions.add(t),!0},parse:function(t){this._reader.put(t);for(var e=!0;e;)switch(this._stage){case 0:e=this._reader.read(1),e&&this._parseOpcode(e[0]);break;case 1:e=this._reader.read(1),e&&this._parseLength(e[0]);break;case 2:e=this._reader.read(this._frame.lengthBytes),e&&this._parseExtendedLength(e);break;case 3:e=this._reader.read(4),e&&(this._stage=4,this._frame.maskingKey=e);break;case 4:e=this._reader.read(this._frame.length),e&&(this._stage=0,this._emitFrame(e));break;default:e=null}},text:function(t){return this.readyState>1?!1:this.frame(t,"text")},binary:function(t){return this.readyState>1?!1:this.frame(t,"binary")},ping:function(t,e){return this.readyState>1?!1:(t=t||"",e&&(this._pingCallbacks[t]=e),this.frame(t,"ping"))},pong:function(t){return this.readyState>1?!1:(t=t||"",this.frame(t,"pong"))},close:function(t,e){return t=t||"",e=e||this.ERRORS.normal_closure,this.readyState<=0?(this.readyState=3,this.emit("close",new gl.CloseEvent(e,t)),!0):this.readyState===1?(this.readyState=2,this._extensions.close(function(){this.frame(t,"close",e)},this),!0):!1},frame:function(t,e,i){if(this.readyState<=0)return this._queue([t,e,i]);if(this.readyState>2)return!1;t instanceof Array&&(t=df.from(t)),typeof t=="number"&&(t=t.toString());var n=new gF,r=typeof t=="string",s,a;n.rsv1=n.rsv2=n.rsv3=!1,n.opcode=this.OPCODES[e||(r?"text":"binary")],s=r?df.from(t,"utf8"):t,i&&(a=s,s=df.allocUnsafe(2+a.length),s.writeUInt16BE(i,0),a.copy(s,2)),n.data=s;var o=function(l){var c=new pF;c.final=!0,c.rsv1=l.rsv1,c.rsv2=l.rsv2,c.rsv3=l.rsv3,c.opcode=l.opcode,c.masked=!!this._masking,c.length=l.data.length,c.payload=l.data,c.masked&&(c.maskingKey=bF.randomBytes(4)),this._sendFrame(c)};return this.MESSAGE_OPCODES.indexOf(n.opcode)>=0?this._extensions.processOutgoingMessage(n,function(l,c){if(l)return this._fail("extension_error",l.message);o.call(this,c)},this):o.call(this,n),!0},_sendFrame:function(t){var e=t.length,i=e<=125?2:e<=65535?4:10,n=i+(t.masked?4:0),r=df.allocUnsafe(n+e),s=t.masked?this.MASK:0;r[0]=(t.final?this.FIN:0)|(t.rsv1?this.RSV1:0)|(t.rsv2?this.RSV2:0)|(t.rsv3?this.RSV3:0)|t.opcode,e<=125?r[1]=s|e:e<=65535?(r[1]=s|126,r.writeUInt16BE(e,2)):(r[1]=s|127,r.writeUInt32BE(Math.floor(e/4294967296),2),r.writeUInt32BE(e%4294967296,6)),t.payload.copy(r,n),t.masked&&(t.maskingKey.copy(r,i),On.mask(r,t.maskingKey,n)),this._write(r)},_handshakeResponse:function(){var t=this._request.headers["sec-websocket-key"],e=this._request.headers["sec-websocket-version"];if(e!==On.VERSION)throw new Error("Unsupported WebSocket version: "+e);if(typeof t!="string")throw new Error("Missing handshake request header: Sec-WebSocket-Key");this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Accept",On.generateAccept(t)),this.protocol&&this._headers.set("Sec-WebSocket-Protocol",this.protocol);var i=this._extensions.generateResponse(this._request.headers["sec-websocket-extensions"]);i&&this._headers.set("Sec-WebSocket-Extensions",i);var n="HTTP/1.1 101 Switching Protocols",r=[n,this._headers.toString(),""];return df.from(r.join(`\r
`),"utf8")},_shutdown:function(t,e,i){delete this._frame,delete this._message,this._stage=5;var n=this.readyState===1;this.readyState=2,this._extensions.close(function(){n&&this.frame(e,"close",t),this.readyState=3,i&&this.emit("error",new Error(e)),this.emit("close",new gl.CloseEvent(t,e))},this)},_fail:function(t,e){this.readyState>1||this._shutdown(this.ERRORS[t],e,!0)},_parseOpcode:function(t){var e=[this.RSV1,this.RSV2,this.RSV3].map(function(n){return(t&n)===n}),i=this._frame=new pF;if(i.final=(t&this.FIN)===this.FIN,i.rsv1=e[0],i.rsv2=e[1],i.rsv3=e[2],i.opcode=t&this.OPCODE,this._stage=1,!this._extensions.validFrameRsv(i))return this._fail("protocol_error","One or more reserved bits are on: reserved1 = "+(i.rsv1?1:0)+", reserved2 = "+(i.rsv2?1:0)+", reserved3 = "+(i.rsv3?1:0));if(this.OPCODE_CODES.indexOf(i.opcode)<0)return this._fail("protocol_error","Unrecognized frame opcode: "+i.opcode);if(this.MESSAGE_OPCODES.indexOf(i.opcode)<0&&!i.final)return this._fail("protocol_error","Received fragmented control frame: opcode = "+i.opcode);if(this._message&&this.OPENING_OPCODES.indexOf(i.opcode)>=0)return this._fail("protocol_error","Received new data frame but previous continuous frame is unfinished")},_parseLength:function(t){var e=this._frame;if(e.masked=(t&this.MASK)===this.MASK,e.length=t&this.LENGTH,e.length>=0&&e.length<=125){if(this._stage=e.masked?3:4,!this._checkFrameLength())return}else this._stage=2,e.lengthBytes=e.length===126?2:8;if(this._requireMasking&&!e.masked)return this._fail("unacceptable","Received unmasked frame but masking is required")},_parseExtendedLength:function(t){var e=this._frame;if(e.length=this._readUInt(t),this._stage=e.masked?3:4,this.MESSAGE_OPCODES.indexOf(e.opcode)<0&&e.length>125)return this._fail("protocol_error","Received control frame having too long payload: "+e.length);this._checkFrameLength()},_checkFrameLength:function(){var t=this._message?this._message.length:0;return t+this._frame.length>this._maxLength?(this._fail("too_large","WebSocket frame length too large"),!1):!0},_emitFrame:function(t){var e=this._frame,i=e.payload=On.mask(t,e.maskingKey),n=e.opcode,r,s,a,o,l;if(delete this._frame,n===this.OPCODES.continuation){if(!this._message)return this._fail("protocol_error","Received unexpected continuation frame");this._message.pushFrame(e)}if((n===this.OPCODES.text||n===this.OPCODES.binary)&&(this._message=new gF,this._message.pushFrame(e)),e.final&&this.MESSAGE_OPCODES.indexOf(n)>=0)return this._emitMessage(this._message);n===this.OPCODES.close&&(s=i.length>=2?i.readUInt16BE(0):null,a=i.length>2?this._encode(i.slice(2)):null,i.length!==0&&!(s!==null&&s>=this.MIN_RESERVED_ERROR&&s<=this.MAX_RESERVED_ERROR)&&this.ERROR_CODES.indexOf(s)<0&&(s=this.ERRORS.protocol_error),(i.length>125||i.length>2&&!a)&&(s=this.ERRORS.protocol_error),this._shutdown(s||this.DEFAULT_ERROR_CODE,a||"")),n===this.OPCODES.ping&&(this.frame(i,"pong"),this.emit("ping",new gl.PingEvent(i.toString()))),n===this.OPCODES.pong&&(o=this._pingCallbacks,r=this._encode(i),l=o[r],delete o[r],l&&l(),this.emit("pong",new gl.PongEvent(i.toString())))},_emitMessage:function(e){var e=this._message;e.read(),delete this._message,this._extensions.processIncomingMessage(e,function(i,n){if(i)return this._fail("extension_error",i.message);var r=n.data;if(n.opcode===this.OPCODES.text&&(r=this._encode(r)),r===null)return this._fail("encoding_error","Could not decode a text frame as UTF-8");this.emit("message",new gl.MessageEvent(r))},this)},_encode:function(t){try{var e=t.toString("binary",0,t.length);if(!this.UTF8_MATCH.test(e))return null}catch{}return t.toString("utf8",0,t.length)},_readUInt:function(t){return t.length===2?t.readUInt16BE(0):t.readUInt32BE(0)*4294967296+t.readUInt32BE(4)}};for(CE in _F)On.prototype[CE]=_F[CE];var CE;vF.exports=On});var SF=x((AEe,EF)=>{"use strict";var CF=us().Buffer,X$=he("stream").Stream,yF=he("url"),Z$=he("util"),J$=Pa(),e7=h_(),t7=b_(),i7={"ws:":80,"wss:":443},xE=function(t,e,i){this._client=t,this._http=new t7("response"),this._origin=typeof t.url=="object"?t.url:yF.parse(t.url),this._url=typeof e=="object"?e:yF.parse(e),this._options=i||{},this._state=0,this.readable=this.writable=!0,this._paused=!1,this._headers=new e7,this._headers.set("Host",this._origin.host),this._headers.set("Connection","keep-alive"),this._headers.set("Proxy-Connection","keep-alive");var n=this._url.auth&&CF.from(this._url.auth,"utf8").toString("base64");n&&this._headers.set("Proxy-Authorization","Basic "+n)};Z$.inherits(xE,X$);var wF={setHeader:function(t,e){return this._state!==0?!1:(this._headers.set(t,e),!0)},start:function(){if(this._state!==0)return!1;this._state=1;var t=this._origin,e=t.port||i7[t.protocol],i="CONNECT "+t.hostname+":"+e+" HTTP/1.1",n=[i,this._headers.toString(),""];return this.emit("data",CF.from(n.join(`\r
`),"utf8")),!0},pause:function(){this._paused=!0},resume:function(){this._paused=!1,this.emit("drain")},write:function(t){if(!this.writable)return!1;if(this._http.parse(t),!this._http.isComplete())return!this._paused;if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this.statusCode===200)this.emit("connect",new J$.ConnectEvent);else{var e="Can't establish a connection to the server at "+this._origin.href;this.emit("error",new Error(e))}return this.end(),!this._paused},end:function(t){this.writable&&(t!==void 0&&this.write(t),this.readable=this.writable=!1,this.emit("close"),this.emit("end"))},destroy:function(){this.end()}};for(SE in wF)xE.prototype[SE]=wF[SE];var SE;EF.exports=xE});var DF=x((REe,IF)=>{"use strict";var TF=us().Buffer,n7=he("crypto"),r7=he("url"),s7=he("util"),a7=b_(),o7=Pa(),id=EE(),l7=SF(),uf=function(t,e){this.version="hybi-"+id.VERSION,id.call(this,null,t,e),this.readyState=-1,this._key=uf.generateKey(),this._accept=id.generateAccept(this._key),this._http=new a7("response");var i=r7.parse(this.url),n=i.auth&&TF.from(i.auth,"utf8").toString("base64");if(this.VALID_PROTOCOLS.indexOf(i.protocol)<0)throw new Error(this.url+" is not a valid WebSocket URL");this._pathname=(i.pathname||"/")+(i.search||""),this._headers.set("Host",i.host),this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Key",this._key),this._headers.set("Sec-WebSocket-Version",id.VERSION),this._protocols.length>0&&this._headers.set("Sec-WebSocket-Protocol",this._protocols.join(", ")),n&&this._headers.set("Authorization","Basic "+n)};s7.inherits(uf,id);uf.generateKey=function(){return n7.randomBytes(16).toString("base64")};var xF={VALID_PROTOCOLS:["ws:","wss:"],proxy:function(t,e){return new l7(this,t,e)},start:function(){return this.readyState!==-1?!1:(this._write(this._handshakeRequest()),this.readyState=0,!0)},parse:function(t){if(this.readyState!==3){if(this.readyState>0)return id.prototype.parse.call(this,t);this._http.parse(t),this._http.isComplete()&&(this._validateHandshake(),this.readyState!==3&&(this._open(),this.parse(this._http.body)))}},_handshakeRequest:function(){var t=this._extensions.generateOffer();t&&this._headers.set("Sec-WebSocket-Extensions",t);var e="GET "+this._pathname+" HTTP/1.1",i=[e,this._headers.toString(),""];return TF.from(i.join(`\r
`),"utf8")},_failHandshake:function(t){t="Error during WebSocket handshake: "+t,this.readyState=3,this.emit("error",new Error(t)),this.emit("close",new o7.CloseEvent(this.ERRORS.protocol_error,t))},_validateHandshake:function(){if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this._http.error)return this._failHandshake(this._http.error.message);if(this._http.statusCode!==101)return this._failHandshake("Unexpected response code: "+this._http.statusCode);var t=this._http.headers,e=t.upgrade||"",i=t.connection||"",n=t["sec-websocket-accept"]||"",r=t["sec-websocket-protocol"]||"";if(e==="")return this._failHandshake("'Upgrade' header is missing");if(e.toLowerCase()!=="websocket")return this._failHandshake("'Upgrade' header value is not 'WebSocket'");if(i==="")return this._failHandshake("'Connection' header is missing");if(i.toLowerCase()!=="upgrade")return this._failHandshake("'Connection' header value is not 'Upgrade'");if(n!==this._accept)return this._failHandshake("Sec-WebSocket-Accept mismatch");if(this.protocol=null,r!==""){if(this._protocols.indexOf(r)<0)return this._failHandshake("Sec-WebSocket-Protocol mismatch");this.protocol=r}try{this._extensions.activate(this.headers["sec-websocket-extensions"])}catch(s){return this._failHandshake(s.message)}}};for(TE in xF)uf.prototype[TE]=xF[TE];var TE;IF.exports=uf});var kE=x((MEe,AF)=>{"use strict";var y_=us().Buffer,w_=Pa(),c7=he("util"),DE=function(t,e,i){w_.apply(this,arguments),this._stage=0,this.version="hixie-75",this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("WebSocket-Origin",this._request.headers.origin),this._headers.set("WebSocket-Location",this.url)};c7.inherits(DE,w_);var kF={close:function(){return this.readyState===3?!1:(this.readyState=3,this.emit("close",new w_.CloseEvent(null,null)),!0)},parse:function(t){this.readyState>1||(this._reader.put(t),this._reader.eachByte(function(e){var i;switch(this._stage){case-1:this._body.push(e),this._sendHandshakeBody();break;case 0:this._parseLeadingByte(e);break;case 1:if(this._length=(e&127)+128*this._length,this._closing&&this._length===0)return this.close();(e&128)!==128&&(this._length===0?this._stage=0:(this._skipped=0,this._stage=2));break;case 2:if(e===255)this._stage=0,i=y_.from(this._buffer).toString("utf8",0,this._buffer.length),this.emit("message",new w_.MessageEvent(i));else if(this._length)this._skipped+=1,this._skipped===this._length&&(this._stage=0);else if(this._buffer.push(e),this._buffer.length>this._maxLength)return this.close();break}},this))},frame:function(t){if(this.readyState===0)return this._queue([t]);if(this.readyState>1)return!1;typeof t!="string"&&(t=t.toString());var e=y_.byteLength(t),i=y_.allocUnsafe(e+2);return i[0]=0,i.write(t,1),i[i.length-1]=255,this._write(i),!0},_handshakeResponse:function(){var t="HTTP/1.1 101 Web Socket Protocol Handshake",e=[t,this._headers.toString(),""];return y_.from(e.join(`\r
`),"utf8")},_parseLeadingByte:function(t){(t&128)===128?(this._length=0,this._stage=1):(delete this._length,delete this._skipped,this._buffer=[],this._stage=2)}};for(IE in kF)DE.prototype[IE]=kF[IE];var IE;AF.exports=DE});var PF=x((OEe,NF)=>{"use strict";var hf=us().Buffer,d7=Pa(),C_=kE(),u7=he("crypto"),h7=he("util"),RF=function(t){return parseInt((t.match(/[0-9]/g)||[]).join(""),10)},MF=function(t){return(t.match(/ /g)||[]).length},RE=function(t,e,i){C_.apply(this,arguments),this._stage=-1,this._body=[],this.version="hixie-76",this._headers.clear(),this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Origin",this._request.headers.origin),this._headers.set("Sec-WebSocket-Location",this.url)};h7.inherits(RE,C_);var OF={BODY_SIZE:8,start:function(){return C_.prototype.start.call(this)?(this._started=!0,this._sendHandshakeBody(),!0):!1},close:function(){return this.readyState===3?!1:(this.readyState===1&&this._write(hf.from([255,0])),this.readyState=3,this.emit("close",new d7.CloseEvent(null,null)),!0)},_handshakeResponse:function(){var o=this._request.headers,t=o["sec-websocket-key1"],e=o["sec-websocket-key2"];if(!t)throw new Error("Missing required header: Sec-WebSocket-Key1");if(!e)throw new Error("Missing required header: Sec-WebSocket-Key2");var i=RF(t),n=MF(t),r=RF(e),s=MF(e);if(i%n!==0||r%s!==0)throw new Error("Client sent invalid Sec-WebSocket-Key headers");this._keyValues=[i/n,r/s];var a="HTTP/1.1 101 WebSocket Protocol Handshake",o=[a,this._headers.toString(),""];return hf.from(o.join(`\r
`),"binary")},_handshakeSignature:function(){if(this._body.length<this.BODY_SIZE)return null;var t=u7.createHash("md5"),e=hf.allocUnsafe(8+this.BODY_SIZE);return e.writeUInt32BE(this._keyValues[0],0),e.writeUInt32BE(this._keyValues[1],4),hf.from(this._body).copy(e,8,0,this.BODY_SIZE),t.update(e),hf.from(t.digest("binary"),"binary")},_sendHandshakeBody:function(){if(this._started){var t=this._handshakeSignature();t&&(this._write(t),this._stage=0,this._open(),this._body.length>this.BODY_SIZE&&this.parse(this._body.slice(this.BODY_SIZE)))}},_parseLeadingByte:function(t){if(t!==255)return C_.prototype._parseLeadingByte.call(this,t);this._closing=!0,this._length=0,this._stage=1}};for(AE in OF)RE.prototype[AE]=OF[AE];var AE;NF.exports=RE});var LF=x((NEe,FF)=>{"use strict";var f7=he("util"),m7=b_(),NE=Pa(),p7=kE(),g7=PF(),_7=EE(),_l=function(t){NE.call(this,null,null,t),this._http=new m7("request")};f7.inherits(_l,NE);var OE={EVENTS:["open","message","error","close","ping","pong"],_bindEventListeners:function(){this.messages.on("error",function(){}),this.on("error",function(){})},parse:function(t){if(this._delegate)return this._delegate.parse(t);if(this._http.parse(t),!!this._http.isComplete()){this.method=this._http.method,this.url=this._http.url,this.headers=this._http.headers,this.body=this._http.body;var e=this;this._delegate=_l.http(this,this._options),this._delegate.messages=this.messages,this._delegate.io=this.io,this._open(),this.EVENTS.forEach(function(i){this._delegate.on(i,function(n){e.emit(i,n)})},this),this.protocol=this._delegate.protocol,this.version=this._delegate.version,this.parse(this._http.body),this.emit("connect",new NE.ConnectEvent)}},_open:function(){this.__queue.forEach(function(t){this._delegate[t[0]].apply(this._delegate,t[1])},this),this.__queue=[]}};["addExtension","setHeader","start","frame","text","binary","ping","close"].forEach(function(t){OE[t]=function(){return this._delegate?this._delegate[t].apply(this._delegate,arguments):(this.__queue.push([t,arguments]),!0)}});for(ME in OE)_l.prototype[ME]=OE[ME];var ME;_l.isSecureRequest=function(t){if(t.connection&&t.connection.authorized!==void 0||t.socket&&t.socket.secure)return!0;var e=t.headers;return e?e.https==="on"||e["x-forwarded-ssl"]==="on"||e["x-forwarded-scheme"]==="https"||e["x-forwarded-proto"]==="https":!1};_l.determineUrl=function(t){var e=this.isSecureRequest(t)?"wss:":"ws:";return e+"//"+t.headers.host+t.url};_l.http=function(t,e){e=e||{},e.requireMasking===void 0&&(e.requireMasking=!0);var i=t.headers,n=i["sec-websocket-version"],r=i["sec-websocket-key"],s=i["sec-websocket-key1"],a=i["sec-websocket-key2"],o=this.determineUrl(t);return n||r?new _7(t,o,e):s||a?new g7(t,o,e):new p7(t,o,e)};FF.exports=_l});var ff=x((PEe,VF)=>{"use strict";var BF=Pa(),b7=DF(),E_=LF(),v7={client:function(t,e){return e=e||{},e.masking===void 0&&(e.masking=!0),new b7(t,e)},server:function(t){return t=t||{},t.requireMasking===void 0&&(t.requireMasking=!0),new E_(t)},http:function(){return E_.http.apply(E_,arguments)},isSecureRequest:function(t){return E_.isSecureRequest(t)},isWebSocket:function(t){return BF.isWebSocket(t)},validateOptions:function(t,e){BF.validateOptions(t,e)}};VF.exports=v7});var mf=x((FEe,jF)=>{"use strict";var bl=function(t,e){this.type=t;for(var i in e)this[i]=e[i]};bl.prototype.initEvent=function(t,e,i){this.type=t,this.bubbles=e,this.cancelable=i};bl.prototype.stopPropagation=function(){};bl.prototype.preventDefault=function(){};bl.CAPTURING_PHASE=1;bl.AT_TARGET=2;bl.BUBBLING_PHASE=3;jF.exports=bl});var PE=x((LEe,zF)=>{"use strict";var y7=mf(),w7={onopen:null,onmessage:null,onerror:null,onclose:null,addEventListener:function(t,e,i){this.on(t,e)},removeEventListener:function(t,e,i){this.removeListener(t,e)},dispatchEvent:function(t){t.target=t.currentTarget=this,t.eventPhase=y7.AT_TARGET,this["on"+t.type]&&this["on"+t.type](t),this.emit(t.type,t)}};zF.exports=w7});var x_=x((BEe,HF)=>{"use strict";var C7=he("stream").Stream,E7=he("util"),S7=ff(),UF=PE(),S_=mf(),Rt=function(t){t=t||{},S7.validateOptions(t,["headers","extensions","maxLength","ping","proxy","tls","ca"]),this.readable=this.writable=!0;var e=t.headers;if(e)for(var i in e)this._driver.setHeader(i,e[i]);var n=t.extensions;n&&[].concat(n).forEach(this._driver.addExtension,this._driver),this._ping=t.ping,this._pingId=0,this.readyState=Rt.CONNECTING,this.bufferedAmount=0,this.protocol="",this.url=this._driver.url,this.version=this._driver.version;var r=this;this._driver.on("open",function(s){r._open()}),this._driver.on("message",function(s){r._receiveMessage(s.data)}),this._driver.on("close",function(s){r._beginClose(s.reason,s.code)}),this._driver.on("error",function(s){r._emitError(s.message)}),this.on("error",function(){}),this._driver.messages.on("drain",function(){r.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){r._pingId+=1,r.ping(r._pingId.toString())},this._ping*1e3)),this._configureStream(),this._proxy||(this._stream.pipe(this._driver.io),this._driver.io.pipe(this._stream))};E7.inherits(Rt,C7);Rt.CONNECTING=0;Rt.OPEN=1;Rt.CLOSING=2;Rt.CLOSED=3;Rt.CLOSE_TIMEOUT=3e4;var qF={write:function(t){return this.send(t)},end:function(t){t!==void 0&&this.send(t),this.close()},pause:function(){return this._driver.messages.pause()},resume:function(){return this._driver.messages.resume()},send:function(t){return this.readyState>Rt.OPEN?!1:(t instanceof Buffer||(t=String(t)),this._driver.messages.write(t))},ping:function(t,e){return this.readyState>Rt.OPEN?!1:this._driver.ping(t,e)},close:function(t,e){if(t===void 0&&(t=1e3),e===void 0&&(e=""),t!==1e3&&(t<3e3||t>4999))throw new Error("Failed to execute 'close' on WebSocket: The code must be either 1000, or between 3000 and 4999. "+t+" is neither.");if(this.readyState<Rt.CLOSING){var i=this;this._closeTimer=setTimeout(function(){i._beginClose("",1006)},Rt.CLOSE_TIMEOUT)}this.readyState!==Rt.CLOSED&&(this.readyState=Rt.CLOSING),this._driver.close(e,t)},_configureStream:function(){var t=this;this._stream.setTimeout(0),this._stream.setNoDelay(!0),["close","end"].forEach(function(e){this._stream.on(e,function(){t._finalizeClose()})},this),this._stream.on("error",function(e){t._emitError("Network error: "+t.url+": "+e.message),t._finalizeClose()})},_open:function(){if(this.readyState===Rt.CONNECTING){this.readyState=Rt.OPEN,this.protocol=this._driver.protocol||"";var t=new S_("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},_receiveMessage:function(t){if(this.readyState>Rt.OPEN)return!1;this.readable&&this.emit("data",t);var e=new S_("message",{data:t});e.initEvent("message",!1,!1),this.dispatchEvent(e)},_emitError:function(t){if(!(this.readyState>=Rt.CLOSING)){var e=new S_("error",{message:t});e.initEvent("error",!1,!1),this.dispatchEvent(e)}},_beginClose:function(t,e){this.readyState!==Rt.CLOSED&&(this.readyState=Rt.CLOSING,this._closeParams=[t,e],this._stream&&(this._stream.destroy(),this._stream.readable||this._finalizeClose()))},_finalizeClose:function(){if(this.readyState!==Rt.CLOSED){this.readyState=Rt.CLOSED,this._closeTimer&&clearTimeout(this._closeTimer),this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end(),this.readable&&this.emit("end"),this.readable=this.writable=!1;var t=this._closeParams?this._closeParams[0]:"",e=this._closeParams?this._closeParams[1]:1006,i=new S_("close",{code:e,reason:t});i.initEvent("close",!1,!1),this.dispatchEvent(i)}}};for(FE in qF)Rt.prototype[FE]=qF[FE];var FE;for(LE in UF)Rt.prototype[LE]=UF[LE];var LE;HF.exports=Rt});var QF=x((jEe,YF)=>{"use strict";var x7=he("util"),T7=he("net"),WF=he("tls"),GF=he("url"),I7=ff(),KF=x_(),VEe=mf(),D7={"http:":80,"https:":443,"ws:":80,"wss:":443},$F=["https:","wss:"],T_=function(t,e,i){i=i||{},this.url=t,this._driver=I7.client(this.url,{maxLength:i.maxLength,protocols:e}),["open","error"].forEach(function(h){this._driver.on(h,function(){u.headers=u._driver.headers,u.statusCode=u._driver.statusCode})},this);var n=i.proxy||{},r=GF.parse(n.origin||this.url),s=r.port||D7[r.protocol],a=$F.indexOf(r.protocol)>=0,o=function(){u._onConnect()},l=i.net||{},c=i.tls||{},d=n.origin?n.tls||{}:c,u=this;l.host=d.host=r.hostname,l.port=d.port=s,c.ca=c.ca||i.ca,d.servername=d.servername||r.hostname,this._stream=a?WF.connect(d,o):T7.connect(l,o),n.origin&&this._configureProxy(n,c),KF.call(this,i)};x7.inherits(T_,KF);T_.prototype._onConnect=function(){var t=this._proxy||this._driver;t.start()};T_.prototype._configureProxy=function(t,e){var i=GF.parse(this.url),n=$F.indexOf(i.protocol)>=0,r=this,s;if(this._proxy=this._driver.proxy(t.origin),t.headers)for(s in t.headers)this._proxy.setHeader(s,t.headers[s]);this._proxy.pipe(this._stream,{end:!1}),this._stream.pipe(this._proxy),this._proxy.on("connect",function(){if(n){var a={socket:r._stream,servername:i.hostname};for(s in e)a[s]=e[s];r._stream=WF.connect(a),r._configureStream()}r._driver.io.pipe(r._stream),r._stream.pipe(r._driver.io),r._driver.start()}),this._proxy.on("error",function(a){r._driver.emit("error",a)})};YF.exports=T_});var tL=x((zEe,eL)=>{"use strict";var k7=he("stream").Stream,A7=he("util"),R7=ff(),M7=h_(),nd=x_(),XF=PE(),ZF=mf(),pf=function(t,e,i){this.writable=!0,i=i||{},this._stream=e.socket,this._ping=i.ping||this.DEFAULT_PING,this._retry=i.retry||this.DEFAULT_RETRY;var n=R7.isSecureRequest(t)?"https:":"http:";this.url=n+"//"+t.headers.host+t.url,this.lastEventId=t.headers["last-event-id"]||"",this.readyState=nd.CONNECTING;var r=new M7,s=this;if(i.headers)for(var a in i.headers)r.set(a,i.headers[a]);if(!(!this._stream||!this._stream.writable)){process.nextTick(function(){s._open()}),this._stream.setTimeout(0),this._stream.setNoDelay(!0);var o=`HTTP/1.1 200 OK\r
Content-Type: text/event-stream\r
Cache-Control: no-cache, no-store\r
Connection: close\r
`+r.toString()+`\r
retry: `+Math.floor(this._retry*1e3)+`\r
\r
`;this._write(o),this._stream.on("drain",function(){s.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){s.ping()},this._ping*1e3)),["error","end"].forEach(function(l){s._stream.on(l,function(){s.close()})})}};A7.inherits(pf,k7);pf.isEventSource=function(t){if(t.method!=="GET")return!1;var e=(t.headers.accept||"").split(/\s*,\s*/);return e.indexOf("text/event-stream")>=0};var JF={DEFAULT_PING:10,DEFAULT_RETRY:5,_write:function(t){if(!this.writable)return!1;try{return this._stream.write(t,"utf8")}catch{return!1}},_open:function(){if(this.readyState===nd.CONNECTING){this.readyState=nd.OPEN;var t=new ZF("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},write:function(t){return this.send(t)},end:function(t){t!==void 0&&this.write(t),this.close()},send:function(t,e){if(this.readyState>nd.OPEN)return!1;t=String(t).replace(/(\r\n|\r|\n)/g,"$1data: "),e=e||{};var i="";return e.event&&(i+="event: "+e.event+`\r
`),e.id&&(i+="id: "+e.id+`\r
`),i+="data: "+t+`\r
\r
`,this._write(i)},ping:function(){return this._write(`:\r
\r
`)},close:function(){if(this.readyState>nd.OPEN)return!1;this.readyState=nd.CLOSED,this.writable=!1,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end();var t=new ZF("close");return t.initEvent("close",!1,!1),this.dispatchEvent(t),!0}};for(BE in JF)pf.prototype[BE]=JF[BE];var BE;for(VE in XF)pf.prototype[VE]=XF[VE];var VE;eL.exports=pf});var rL=x((UEe,nL)=>{"use strict";var O7=he("util"),jE=ff(),iL=x_(),Fa=function(t,e,i,n,r){r=r||{},this._stream=e,this._driver=jE.http(t,{maxLength:r.maxLength,protocols:n});var s=this;if(!(!this._stream||!this._stream.writable)){if(!this._stream.readable)return this._stream.end();var a=function(){s._stream.removeListener("data",a)};this._stream.on("data",a),iL.call(this,r),process.nextTick(function(){s._driver.start(),s._driver.io.write(i)})}};O7.inherits(Fa,iL);Fa.isWebSocket=function(t){return jE.isWebSocket(t)};Fa.validateOptions=function(t,e){jE.validateOptions(t,e)};Fa.WebSocket=Fa;Fa.Client=QF();Fa.EventSource=tL();nL.exports=Fa});var st=x(cr=>{"use strict";Object.defineProperty(cr,"__esModule",{value:!0});cr.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=cr.DEFAULT_MAX_SEND_MESSAGE_LENGTH=cr.Propagate=cr.LogVerbosity=cr.Status=void 0;var WV=function(t){return t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t}(WV||(cr.Status=WV={})),GV=function(t){return t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.ERROR=2]="ERROR",t[t.NONE=3]="NONE",t}(GV||(cr.LogVerbosity=GV={})),KV=function(t){return t[t.DEADLINE=1]="DEADLINE",t[t.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",t[t.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",t[t.CANCELLATION=8]="CANCELLATION",t[t.DEFAULTS=65535]="DEFAULTS",t}(KV||(cr.Propagate=KV={}));cr.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;cr.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var ST=x((kSe,NZ)=>{NZ.exports={name:"@grpc/grpc-js",version:"1.9.14",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.186","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","@typescript-eslint/eslint-plugin":"^5.59.11","@typescript-eslint/parser":"^5.59.11","@typescript-eslint/typescript-estree":"^5.59.11","clang-format":"^1.0.55",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^10.9.1",typescript:"^5.1.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.8","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var qt=x(hn=>{"use strict";var xT,TT,IT,DT;Object.defineProperty(hn,"__esModule",{value:!0});hn.isTracerEnabled=hn.trace=hn.log=hn.setLoggerVerbosity=hn.setLogger=hn.getLogger=void 0;var $a=st(),PZ=he("process"),FZ=ST().version,LZ={error:(t,...e)=>{console.error("E "+t,...e)},info:(t,...e)=>{console.error("I "+t,...e)},debug:(t,...e)=>{console.error("D "+t,...e)}},Ol=LZ,Id=$a.LogVerbosity.ERROR,BZ=(TT=(xT=process.env.GRPC_NODE_VERBOSITY)!==null&&xT!==void 0?xT:process.env.GRPC_VERBOSITY)!==null&&TT!==void 0?TT:"";switch(BZ.toUpperCase()){case"DEBUG":Id=$a.LogVerbosity.DEBUG;break;case"INFO":Id=$a.LogVerbosity.INFO;break;case"ERROR":Id=$a.LogVerbosity.ERROR;break;case"NONE":Id=$a.LogVerbosity.NONE;break;default:}var VZ=()=>Ol;hn.getLogger=VZ;var jZ=t=>{Ol=t};hn.setLogger=jZ;var zZ=t=>{Id=t};hn.setLoggerVerbosity=zZ;var UZ=(t,...e)=>{let i;if(t>=Id){switch(t){case $a.LogVerbosity.DEBUG:i=Ol.debug;break;case $a.LogVerbosity.INFO:i=Ol.info;break;case $a.LogVerbosity.ERROR:i=Ol.error;break}i||(i=Ol.error),i&&i.bind(Ol)(...e)}};hn.log=UZ;var qZ=(DT=(IT=process.env.GRPC_NODE_TRACE)!==null&&IT!==void 0?IT:process.env.GRPC_TRACE)!==null&&DT!==void 0?DT:"",kT=new Set,$V=new Set;for(let t of qZ.split(","))t.startsWith("-")?$V.add(t.substring(1)):kT.add(t);var HZ=kT.has("all");function WZ(t,e,i){YV(e)&&(0,hn.log)(t,new Date().toISOString()+" | v"+FZ+" "+PZ.pid+" | "+e+" | "+i)}hn.trace=WZ;function YV(t){return!$V.has(t)&&(HZ||kT.has(t))}hn.isTracerEnabled=YV});var Gb=x(Dd=>{"use strict";Object.defineProperty(Dd,"__esModule",{value:!0});Dd.getErrorCode=Dd.getErrorMessage=void 0;function GZ(t){return t instanceof Error?t.message:String(t)}Dd.getErrorMessage=GZ;function KZ(t){return typeof t=="object"&&t!==null&&"code"in t&&typeof t.code=="number"?t.code:null}Dd.getErrorCode=KZ});var fn=x($b=>{"use strict";Object.defineProperty($b,"__esModule",{value:!0});$b.Metadata=void 0;var $Z=qt(),YZ=st(),QZ=Gb(),XZ=/^[0-9a-z_.-]+$/,ZZ=/^[ -~]*$/;function JZ(t){return XZ.test(t)}function eJ(t){return ZZ.test(t)}function XV(t){return t.endsWith("-bin")}function tJ(t){return!t.startsWith("grpc-")}function Kb(t){return t.toLowerCase()}function QV(t,e){if(!JZ(t))throw new Error('Metadata key "'+t+'" contains illegal characters');if(e!=null)if(XV(t)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!eJ(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var AT=class t{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,i){e=Kb(e),QV(e,i),this.internalRepr.set(e,[i])}add(e,i){e=Kb(e),QV(e,i);let n=this.internalRepr.get(e);n===void 0?this.internalRepr.set(e,[i]):n.push(i)}remove(e){e=Kb(e),this.internalRepr.delete(e)}get(e){return e=Kb(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[i,n]of this.internalRepr)if(n.length>0){let r=n[0];e[i]=Buffer.isBuffer(r)?Buffer.from(r):r}return e}clone(){let e=new t(this.options),i=e.internalRepr;for(let[n,r]of this.internalRepr){let s=r.map(a=>Buffer.isBuffer(a)?Buffer.from(a):a);i.set(n,s)}return e}merge(e){for(let[i,n]of e.internalRepr){let r=(this.internalRepr.get(i)||[]).concat(n);this.internalRepr.set(i,r)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[i,n]of this.internalRepr)e[i]=n.map(iJ);return e}toJSON(){let e={};for(let[i,n]of this.internalRepr)e[i]=n;return e}static fromHttp2Headers(e){let i=new t;for(let n of Object.keys(e)){if(n.charAt(0)===":")continue;let r=e[n];try{XV(n)?Array.isArray(r)?r.forEach(s=>{i.add(n,Buffer.from(s,"base64"))}):r!==void 0&&(tJ(n)?r.split(",").forEach(s=>{i.add(n,Buffer.from(s.trim(),"base64"))}):i.add(n,Buffer.from(r,"base64"))):Array.isArray(r)?r.forEach(s=>{i.add(n,s)}):r!==void 0&&i.add(n,r)}catch(s){let a=`Failed to add metadata entry ${n}: ${r}. ${(0,QZ.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,$Z.log)(YZ.LogVerbosity.ERROR,a)}}return i}};$b.Metadata=AT;var iJ=t=>Buffer.isBuffer(t)?t.toString("base64"):t});var PT=x(Yb=>{"use strict";Object.defineProperty(Yb,"__esModule",{value:!0});Yb.CallCredentials=void 0;var NT=fn();function nJ(t){return"getRequestHeaders"in t&&typeof t.getRequestHeaders=="function"}var kd=class t{static createFromMetadataGenerator(e){return new MT(e)}static createFromGoogleCredential(e){return t.createFromMetadataGenerator((i,n)=>{let r;nJ(e)?r=e.getRequestHeaders(i.service_url):r=new Promise((s,a)=>{e.getRequestMetadata(i.service_url,(o,l)=>{if(o){a(o);return}if(!l){a(new Error("Headers not set by metadata plugin"));return}s(l)})}),r.then(s=>{let a=new NT.Metadata;for(let o of Object.keys(s))a.add(o,s[o]);n(null,a)},s=>{n(s)})})}static createEmpty(){return new OT}};Yb.CallCredentials=kd;var RT=class t extends kd{constructor(e){super(),this.creds=e}generateMetadata(e){return y(this,null,function*(){let i=new NT.Metadata,n=yield Promise.all(this.creds.map(r=>r.generateMetadata(e)));for(let r of n)i.merge(r);return i})}compose(e){return new t(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof t?this.creds.every((i,n)=>i._equals(e.creds[n])):!1}},MT=class t extends kd{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((i,n)=>{this.metadataGenerator(e,(r,s)=>{s!==void 0?i(s):n(r)})})}compose(e){return new RT([this,e])}_equals(e){return this===e?!0:e instanceof t?this.metadataGenerator===e.metadataGenerator:!1}},OT=class t extends kd{generateMetadata(e){return Promise.resolve(new NT.Metadata)}compose(e){return e}_equals(e){return e instanceof t}}});var LT=x(Ad=>{"use strict";Object.defineProperty(Ad,"__esModule",{value:!0});Ad.getDefaultRootsData=Ad.CIPHER_SUITES=void 0;var rJ=he("fs");Ad.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var ZV=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,FT=null;function sJ(){return ZV?(FT===null&&(FT=rJ.readFileSync(ZV)),FT):null}Ad.getDefaultRootsData=sJ});var Zb=x(Xb=>{"use strict";Object.defineProperty(Xb,"__esModule",{value:!0});Xb.ChannelCredentials=void 0;var aJ=he("tls"),oJ=PT(),JV=LT();function BT(t,e){if(t&&!(t instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var Rd=class{constructor(e){this.callCredentials=e||oJ.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,i,n,r){var s;if(BT(e,"Root certificate"),BT(i,"Private key"),BT(n,"Certificate chain"),i&&!n)throw new Error("Private key must be given with accompanying certificate chain");if(!i&&n)throw new Error("Certificate chain must be given with accompanying private key");let a=(0,aJ.createSecureContext)({ca:(s=e??(0,JV.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:i??void 0,cert:n??void 0,ciphers:JV.CIPHER_SUITES});return new Qb(a,r??{})}static createFromSecureContext(e,i){return new Qb(e,i??{})}static createInsecure(){return new VT}};Xb.ChannelCredentials=Rd;var VT=class t extends Rd{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof t}},Qb=class t extends Rd{constructor(e,i){super(),this.secureContext=e,this.verifyOptions=i,this.connectionOptions={secureContext:e},i?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=i.checkServerIdentity)}compose(e){let i=this.callCredentials.compose(e);return new jT(this,i)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof t?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},jT=class t extends Rd{constructor(e,i){super(i),this.channelCredentials=e}compose(e){let i=this.callCredentials.compose(e);return new t(this.channelCredentials,i)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof t?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var Qa=x(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.validateLoadBalancingConfig=Ki.getFirstUsableConfig=Ki.isLoadBalancerNameRegistered=Ki.createLoadBalancer=Ki.registerDefaultLoadBalancerType=Ki.registerLoadBalancerType=Ki.createChildChannelControlHelper=void 0;function lJ(t,e){var i,n,r,s,a,o,l,c,d,u;return{createSubchannel:(n=(i=e.createSubchannel)===null||i===void 0?void 0:i.bind(e))!==null&&n!==void 0?n:t.createSubchannel.bind(t),updateState:(s=(r=e.updateState)===null||r===void 0?void 0:r.bind(e))!==null&&s!==void 0?s:t.updateState.bind(t),requestReresolution:(o=(a=e.requestReresolution)===null||a===void 0?void 0:a.bind(e))!==null&&o!==void 0?o:t.requestReresolution.bind(t),addChannelzChild:(c=(l=e.addChannelzChild)===null||l===void 0?void 0:l.bind(e))!==null&&c!==void 0?c:t.addChannelzChild.bind(t),removeChannelzChild:(u=(d=e.removeChannelzChild)===null||d===void 0?void 0:d.bind(e))!==null&&u!==void 0?u:t.removeChannelzChild.bind(t)}}Ki.createChildChannelControlHelper=lJ;var Ya={},zT=null;function cJ(t,e,i){Ya[t]={LoadBalancer:e,LoadBalancingConfig:i}}Ki.registerLoadBalancerType=cJ;function dJ(t){zT=t}Ki.registerDefaultLoadBalancerType=dJ;function uJ(t,e){let i=t.getLoadBalancerName();return i in Ya?new Ya[i].LoadBalancer(e):null}Ki.createLoadBalancer=uJ;function hJ(t){return t in Ya}Ki.isLoadBalancerNameRegistered=hJ;function fJ(t,e=!1){for(let i of t)if(i.getLoadBalancerName()in Ya)return i;return e&&zT?new Ya[zT].LoadBalancingConfig:null}Ki.getFirstUsableConfig=fJ;function mJ(t){if(!(t!==null&&typeof t=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(t);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let i=e[0];if(i in Ya)return Ya[i].LoadBalancingConfig.createFromJson(t[i]);throw new Error(`Unrecognized load balancing config name ${i}`)}Ki.validateLoadBalancingConfig=mJ});var UT=x(Xa=>{"use strict";Object.defineProperty(Xa,"__esModule",{value:!0});Xa.extractAndSelectServiceConfig=Xa.validateServiceConfig=Xa.validateRetryThrottling=void 0;var pJ=he("os"),Jb=st(),gJ=Qa(),ev=/^\d+(\.\d{1,9})?s$/,_J="node";function bJ(t){if("service"in t&&t.service!==""){if(typeof t.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof t.service}`);if("method"in t&&t.method!==""){if(typeof t.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof t.service}`);return{service:t.service,method:t.method}}else return{service:t.service}}else{if("method"in t&&t.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function vJ(t){if(!("maxAttempts"in t)||!Number.isInteger(t.maxAttempts)||t.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in t)||typeof t.initialBackoff!="string"||!ev.test(t.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in t)||typeof t.maxBackoff!="string"||!ev.test(t.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in t)||typeof t.backoffMultiplier!="number"||t.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in t&&Array.isArray(t.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(t.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of t.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(Jb.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(Jb.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:t.maxAttempts,initialBackoff:t.initialBackoff,maxBackoff:t.maxBackoff,backoffMultiplier:t.backoffMultiplier,retryableStatusCodes:t.retryableStatusCodes}}function yJ(t){if(!("maxAttempts"in t)||!Number.isInteger(t.maxAttempts)||t.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in t&&(typeof t.hedgingDelay!="string"||!ev.test(t.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in t&&Array.isArray(t.nonFatalStatusCodes))for(let i of t.nonFatalStatusCodes)if(typeof i=="number"){if(!Object.values(Jb.Status).includes(i))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof i=="string"){if(!Object.values(Jb.Status).includes(i.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:t.maxAttempts};return t.hedgingDelay&&(e.hedgingDelay=t.hedgingDelay),t.nonFatalStatusCodes&&(e.nonFatalStatusCodes=t.nonFatalStatusCodes),e}function wJ(t){var e;let i={name:[]};if(!("name"in t)||!Array.isArray(t.name))throw new Error("Invalid method config: invalid name array");for(let n of t.name)i.name.push(bJ(n));if("waitForReady"in t){if(typeof t.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");i.waitForReady=t.waitForReady}if("timeout"in t)if(typeof t.timeout=="object"){if(!("seconds"in t.timeout)||typeof t.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in t.timeout)||typeof t.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");i.timeout=t.timeout}else if(typeof t.timeout=="string"&&ev.test(t.timeout)){let n=t.timeout.substring(0,t.timeout.length-1).split(".");i.timeout={seconds:n[0]|0,nanos:((e=n[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in t){if(typeof t.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");i.maxRequestBytes=t.maxRequestBytes}if("maxResponseBytes"in t){if(typeof t.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");i.maxResponseBytes=t.maxResponseBytes}if("retryPolicy"in t){if("hedgingPolicy"in t)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");i.retryPolicy=vJ(t.retryPolicy)}else"hedgingPolicy"in t&&(i.hedgingPolicy=yJ(t.hedgingPolicy));return i}function ej(t){if(!("maxTokens"in t)||typeof t.maxTokens!="number"||t.maxTokens<=0||t.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in t)||typeof t.tokenRatio!="number"||t.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+t.maxTokens.toFixed(3),tokenRatio:+t.tokenRatio.toFixed(3)}}Xa.validateRetryThrottling=ej;function tj(t){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in t)if(typeof t.loadBalancingPolicy=="string")e.loadBalancingPolicy=t.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in t)if(Array.isArray(t.loadBalancingConfig))for(let n of t.loadBalancingConfig)e.loadBalancingConfig.push((0,gJ.validateLoadBalancingConfig)(n));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in t&&Array.isArray(t.methodConfig))for(let n of t.methodConfig)e.methodConfig.push(wJ(n));"retryThrottling"in t&&(e.retryThrottling=ej(t.retryThrottling));let i=[];for(let n of e.methodConfig)for(let r of n.name){for(let s of i)if(r.service===s.service&&r.method===s.method)throw new Error(`Invalid service config: duplicate name ${r.service}/${r.method}`);i.push(r)}return e}Xa.validateServiceConfig=tj;function CJ(t){if(!("serviceConfig"in t))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:tj(t.serviceConfig)};if("clientLanguage"in t)if(Array.isArray(t.clientLanguage)){e.clientLanguage=[];for(let n of t.clientLanguage)if(typeof n=="string")e.clientLanguage.push(n);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in t)if(Array.isArray(t.clientHostname)){e.clientHostname=[];for(let n of t.clientHostname)if(typeof n=="string")e.clientHostname.push(n);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in t)if(typeof t.percentage=="number"&&0<=t.percentage&&t.percentage<=100)e.percentage=t.percentage;else throw new Error("Invalid service config choice: invalid percentage");let i=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let n in t)if(!i.includes(n))throw new Error(`Invalid service config choice: unexpected field ${n}`);return e}function EJ(t,e){if(!Array.isArray(t))throw new Error("Invalid service config list");for(let i of t){let n=CJ(i);if(!(typeof n.percentage=="number"&&e>n.percentage)){if(Array.isArray(n.clientHostname)){let r=!1;for(let s of n.clientHostname)s===pJ.hostname()&&(r=!0);if(!r)continue}if(Array.isArray(n.clientLanguage)){let r=!1;for(let s of n.clientLanguage)s===_J&&(r=!0);if(!r)continue}return n.serviceConfig}}throw new Error("No matching service config found")}function SJ(t,e){for(let i of t)if(i.length>0&&i[0].startsWith("grpc_config=")){let n=i.join("").substring(12),r=JSON.parse(n);return EJ(r,e)}return null}Xa.extractAndSelectServiceConfig=SJ});var dr=x(tv=>{"use strict";Object.defineProperty(tv,"__esModule",{value:!0});tv.ConnectivityState=void 0;var ij=function(t){return t[t.IDLE=0]="IDLE",t[t.CONNECTING=1]="CONNECTING",t[t.READY=2]="READY",t[t.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",t[t.SHUTDOWN=4]="SHUTDOWN",t}(ij||(tv.ConnectivityState=ij={}))});var Vn=x(Za=>{"use strict";Object.defineProperty(Za,"__esModule",{value:!0});Za.uriToString=Za.splitHostPort=Za.parseUri=void 0;var xJ=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function TJ(t){let e=xJ.exec(t);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}Za.parseUri=TJ;var nj=/^\d+$/;function IJ(t){if(t.startsWith("[")){let e=t.indexOf("]");if(e===-1)return null;let i=t.substring(1,e);if(i.indexOf(":")===-1)return null;if(t.length>e+1)if(t[e+1]===":"){let n=t.substring(e+2);return nj.test(n)?{host:i,port:+n}:null}else return null;else return{host:i}}else{let e=t.split(":");return e.length===2?nj.test(e[1])?{host:e[0],port:+e[1]}:null:{host:t}}}Za.splitHostPort=IJ;function DJ(t){let e="";return t.scheme!==void 0&&(e+=t.scheme+":"),t.authority!==void 0&&(e+="//"+t.authority+"/"),e+=t.path,e}Za.uriToString=DJ});var ys=x(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.mapUriDefaultScheme=ur.getDefaultAuthority=ur.createResolver=ur.registerDefaultScheme=ur.registerResolver=void 0;var HT=Vn(),Md={},qT=null;function kJ(t,e){Md[t]=e}ur.registerResolver=kJ;function AJ(t){qT=t}ur.registerDefaultScheme=AJ;function RJ(t,e,i){if(t.scheme!==void 0&&t.scheme in Md)return new Md[t.scheme](t,e,i);throw new Error(`No resolver could be created for target ${(0,HT.uriToString)(t)}`)}ur.createResolver=RJ;function MJ(t){if(t.scheme!==void 0&&t.scheme in Md)return Md[t.scheme].getDefaultAuthority(t);throw new Error(`Invalid target ${(0,HT.uriToString)(t)}`)}ur.getDefaultAuthority=MJ;function OJ(t){return t.scheme===void 0||!(t.scheme in Md)?qT!==null?{scheme:qT,authority:void 0,path:(0,HT.uriToString)(t)}:null:t}ur.mapUriDefaultScheme=OJ});var eo=x(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.QueuePicker=Ja.UnavailablePicker=Ja.PickResultType=void 0;var NJ=fn(),PJ=st(),iv=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.QUEUE=1]="QUEUE",t[t.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",t[t.DROP=3]="DROP",t}(iv||(Ja.PickResultType=iv={})),WT=class{constructor(e){this.status=Object.assign({code:PJ.Status.UNAVAILABLE,details:"No connection established",metadata:new NJ.Metadata},e)}pick(e){return{pickResultType:iv.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};Ja.UnavailablePicker=WT;var GT=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:iv.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};Ja.QueuePicker=GT});var bm=x(nv=>{"use strict";Object.defineProperty(nv,"__esModule",{value:!0});nv.BackoffTimeout=void 0;var FJ=1e3,LJ=1.6,BJ=12e4,VJ=.2;function jJ(t,e){return Math.random()*(e-t)+t}var KT=class{constructor(e,i){this.callback=e,this.initialDelay=FJ,this.multiplier=LJ,this.maxDelay=BJ,this.jitter=VJ,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,i&&(i.initialDelay&&(this.initialDelay=i.initialDelay),i.multiplier&&(this.multiplier=i.multiplier),i.jitter&&(this.jitter=i.jitter),i.maxDelay&&(this.maxDelay=i.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var i,n;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(n=(i=this.timerId).unref)===null||n===void 0||n.call(i)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),i=e*this.jitter;this.nextDelay=e+jJ(-i,i)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,i=this.startTime;i.setMilliseconds(i.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<i?this.runTimer(i.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,i;this.hasRef=!0,(i=(e=this.timerId).ref)===null||i===void 0||i.call(e)}unref(){var e,i;this.hasRef=!1,(i=(e=this.timerId).unref)===null||i===void 0||i.call(e)}getEndTime(){return this.endTime}};nv.BackoffTimeout=KT});var sv=x(rv=>{"use strict";Object.defineProperty(rv,"__esModule",{value:!0});rv.ChildLoadBalancerHandler=void 0;var zJ=Qa(),UJ=dr(),qJ="child_load_balancer_helper",$T=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(i){this.parent=i,this.child=null}createSubchannel(i,n){return this.parent.channelControlHelper.createSubchannel(i,n)}updateState(i,n){var r;if(this.calledByPendingChild()){if(i===UJ.ConnectivityState.CONNECTING)return;(r=this.parent.currentChild)===null||r===void 0||r.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(i,n)}requestReresolution(){var i;let n=(i=this.parent.pendingChild)!==null&&i!==void 0?i:this.parent.currentChild;this.child===n&&this.parent.channelControlHelper.requestReresolution()}setChild(i){this.child=i}addChannelzChild(i){this.parent.channelControlHelper.addChannelzChild(i)}removeChannelzChild(i){this.parent.channelControlHelper.removeChannelzChild(i)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,i){return e.getLoadBalancerName()!==i.getLoadBalancerName()}updateAddressList(e,i,n){let r;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,i)){let s=new this.ChildPolicyHelper(this),a=(0,zJ.createLoadBalancer)(i,s);s.setChild(a),this.currentChild===null?(this.currentChild=a,r=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=a,r=this.pendingChild)}else this.pendingChild===null?r=this.currentChild:r=this.pendingChild;this.latestConfig=i,r.updateAddressList(e,i,n)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return qJ}};rv.ChildLoadBalancerHandler=$T});var sj=x(av=>{"use strict";Object.defineProperty(av,"__esModule",{value:!0});av.ResolvingLoadBalancer=void 0;var HJ=Qa(),WJ=UT(),xn=dr(),GJ=ys(),Od=eo(),KJ=bm(),YT=st(),$J=fn(),YJ=qt(),QJ=st(),XJ=Vn(),ZJ=sv(),JJ="resolving_load_balancer";function rj(t){YJ.trace(QJ.LogVerbosity.DEBUG,JJ,t)}var eee=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function tee(t,e,i,n){for(let r of i.name)switch(n){case"EMPTY":if(!r.service&&!r.method)return!0;break;case"SERVICE":if(r.service===t&&!r.method)return!0;break;case"SERVICE_AND_METHOD":if(r.service===t&&r.method===e)return!0}return!1}function iee(t,e,i,n){for(let r of i)if(tee(t,e,r,n))return r;return null}function nee(t){return function(i,n){var r,s;let a=i.split("/").filter(c=>c.length>0),o=(r=a[0])!==null&&r!==void 0?r:"",l=(s=a[1])!==null&&s!==void 0?s:"";if(t&&t.methodConfig)for(let c of eee){let d=iee(o,l,t.methodConfig,c);if(d)return{methodConfig:d,pickInformation:{},status:YT.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:YT.Status.OK,dynamicFilterFactories:[]}}}var QT=class{constructor(e,i,n,r,s){this.target=e,this.channelControlHelper=i,this.onSuccessfulResolution=r,this.onFailedResolution=s,this.latestChildState=xn.ConnectivityState.IDLE,this.latestChildPicker=new Od.QueuePicker(this),this.currentState=xn.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,n["grpc.service_config"]?this.defaultServiceConfig=(0,WJ.validateServiceConfig)(JSON.parse(n["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(xn.ConnectivityState.IDLE,new Od.QueuePicker(this)),this.childLoadBalancer=new ZJ.ChildLoadBalancerHandler({createSubchannel:i.createSubchannel.bind(i),requestReresolution:()=>{this.backoffTimeout.isRunning()?(rj("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(o,l)=>{this.latestChildState=o,this.latestChildPicker=l,this.updateState(o,l)},addChannelzChild:i.addChannelzChild.bind(i),removeChannelzChild:i.removeChannelzChild.bind(i)}),this.innerResolver=(0,GJ.createResolver)(e,{onSuccessfulResolution:(o,l,c,d,u)=>{var h;this.backoffTimeout.stop(),this.backoffTimeout.reset();let f=null;l===null?c===null?(this.previousServiceConfig=null,f=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(c):f=this.previousServiceConfig:(f=l,this.previousServiceConfig=l);let p=(h=f?.loadBalancingConfig)!==null&&h!==void 0?h:[],v=(0,HJ.getFirstUsableConfig)(p,!0);if(v===null){this.handleResolutionFailure({code:YT.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new $J.Metadata});return}this.childLoadBalancer.updateAddressList(o,v,u);let E=f??this.defaultServiceConfig;this.onSuccessfulResolution(E,d??nee(E))},onError:o=>{this.handleResolutionFailure(o)}},n);let a={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new KJ.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},a),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===xn.ConnectivityState.IDLE&&this.updateState(xn.ConnectivityState.CONNECTING,new Od.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,i){rj((0,XJ.uriToString)(this.target)+" "+xn.ConnectivityState[this.currentState]+" -> "+xn.ConnectivityState[e]),e===xn.ConnectivityState.IDLE&&(i=new Od.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,i)}handleResolutionFailure(e){this.latestChildState===xn.ConnectivityState.IDLE&&(this.updateState(xn.ConnectivityState.TRANSIENT_FAILURE,new Od.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===xn.ConnectivityState.IDLE||this.currentState===xn.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,i){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=xn.ConnectivityState.IDLE,this.latestChildPicker=new Od.QueuePicker(this),this.currentState=xn.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};av.ResolvingLoadBalancer=QT});var aj=x(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0});Nd.channelOptionsEqual=Nd.recognizedOptions=void 0;Nd.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0};function ree(t,e){let i=Object.keys(t).sort(),n=Object.keys(e).sort();if(i.length!==n.length)return!1;for(let r=0;r<i.length;r+=1)if(i[r]!==n[r]||t[i[r]]!==e[n[r]])return!1;return!0}Nd.channelOptionsEqual=ree});var Cs=x(ws=>{"use strict";Object.defineProperty(ws,"__esModule",{value:!0});ws.stringToSubchannelAddress=ws.subchannelAddressToString=ws.subchannelAddressEqual=ws.isTcpSubchannelAddress=void 0;var see=he("net");function vm(t){return"port"in t}ws.isTcpSubchannelAddress=vm;function aee(t,e){return!t&&!e?!0:!t||!e?!1:vm(t)?vm(e)&&t.host===e.host&&t.port===e.port:!vm(e)&&t.path===e.path}ws.subchannelAddressEqual=aee;function oee(t){return vm(t)?t.host+":"+t.port:t.path}ws.subchannelAddressToString=oee;var lee=443;function cee(t,e){return(0,see.isIP)(t)?{host:t,port:e??lee}:{path:t}}ws.stringToSubchannelAddress=cee});var ov=x(Pd=>{"use strict";Object.defineProperty(Pd,"__esModule",{value:!0});Pd.addAdminServicesToServer=Pd.registerAdminService=void 0;var oj=[];function dee(t,e){oj.push({getServiceDefinition:t,getHandlers:e})}Pd.registerAdminService=dee;function uee(t){for(let{getServiceDefinition:e,getHandlers:i}of oj)t.addService(e(),i())}Pd.addAdminServicesToServer=uee});var lj=x(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.ClientDuplexStreamImpl=hr.ClientWritableStreamImpl=hr.ClientReadableStreamImpl=hr.ClientUnaryCallImpl=hr.callErrorFromStatus=void 0;var hee=he("events"),tI=he("stream"),ym=st();function fee(t,e){let i=`${t.code} ${ym.Status[t.code]}: ${t.details}`,r=`${new Error(i).stack}
for call at
${e}`;return Object.assign(new Error(i),t,{stack:r})}hr.callErrorFromStatus=fee;var XT=class extends hee.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ym.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,i;return(i=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&i!==void 0?i:"unknown"}};hr.ClientUnaryCallImpl=XT;var ZT=class extends tI.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ym.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,i;return(i=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&i!==void 0?i:"unknown"}_read(e){var i;(i=this.call)===null||i===void 0||i.startRead()}};hr.ClientReadableStreamImpl=ZT;var JT=class extends tI.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ym.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,i;return(i=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&i!==void 0?i:"unknown"}_write(e,i,n){var r;let s={callback:n},a=Number(i);Number.isNaN(a)||(s.flags=a),(r=this.call)===null||r===void 0||r.sendMessageWithContext(s,e)}_final(e){var i;(i=this.call)===null||i===void 0||i.halfClose(),e()}};hr.ClientWritableStreamImpl=JT;var eI=class extends tI.Duplex{constructor(e,i){super({objectMode:!0}),this.serialize=e,this.deserialize=i}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ym.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,i;return(i=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&i!==void 0?i:"unknown"}_read(e){var i;(i=this.call)===null||i===void 0||i.startRead()}_write(e,i,n){var r;let s={callback:n},a=Number(i);Number.isNaN(a)||(s.flags=a),(r=this.call)===null||r===void 0||r.sendMessageWithContext(s,e)}_final(e){var i;(i=this.call)===null||i===void 0||i.halfClose(),e()}};hr.ClientDuplexStreamImpl=eI});var cj=x(Fd=>{"use strict";Object.defineProperty(Fd,"__esModule",{value:!0});Fd.InterceptingListenerImpl=Fd.isInterceptingListener=void 0;function mee(t){return t.onReceiveMetadata!==void 0&&t.onReceiveMetadata.length===1}Fd.isInterceptingListener=mee;var iI=class{constructor(e,i){this.listener=e,this.nextListener=i,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,i=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(i),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,i=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=i,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(i),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,i=>{this.processingMetadata||this.processingMessage?this.pendingStatus=i:this.nextListener.onReceiveStatus(i)})}};Fd.InterceptingListenerImpl=iI});var cI=x(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.getInterceptingCall=fr.InterceptingCall=fr.RequesterBuilder=fr.ListenerBuilder=fr.InterceptorConfigurationError=void 0;var pee=fn(),dj=cj(),uj=st(),hj=Gb(),Cm=class t extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,t)}};fr.InterceptorConfigurationError=Cm;var rI=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};fr.ListenerBuilder=rI;var sI=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};fr.RequesterBuilder=sI;var nI={onReceiveMetadata:(t,e)=>{e(t)},onReceiveMessage:(t,e)=>{e(t)},onReceiveStatus:(t,e)=>{e(t)}},wm={start:(t,e,i)=>{i(t,e)},sendMessage:(t,e)=>{e(t)},halfClose:t=>{t()},cancel:t=>{t()}},aI=class{constructor(e,i){var n,r,s,a;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,i?this.requester={start:(n=i.start)!==null&&n!==void 0?n:wm.start,sendMessage:(r=i.sendMessage)!==null&&r!==void 0?r:wm.sendMessage,halfClose:(s=i.halfClose)!==null&&s!==void 0?s:wm.halfClose,cancel:(a=i.cancel)!==null&&a!==void 0?a:wm.cancel}:this.requester=wm}cancelWithStatus(e,i){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,i)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,i){var n,r,s,a,o,l;let c={onReceiveMetadata:(r=(n=i?.onReceiveMetadata)===null||n===void 0?void 0:n.bind(i))!==null&&r!==void 0?r:d=>{},onReceiveMessage:(a=(s=i?.onReceiveMessage)===null||s===void 0?void 0:s.bind(i))!==null&&a!==void 0?a:d=>{},onReceiveStatus:(l=(o=i?.onReceiveStatus)===null||o===void 0?void 0:o.bind(i))!==null&&l!==void 0?l:d=>{}};this.processingMetadata=!0,this.requester.start(e,c,(d,u)=>{var h,f,p;this.processingMetadata=!1;let v;if((0,dj.isInterceptingListener)(u))v=u;else{let E={onReceiveMetadata:(h=u.onReceiveMetadata)!==null&&h!==void 0?h:nI.onReceiveMetadata,onReceiveMessage:(f=u.onReceiveMessage)!==null&&f!==void 0?f:nI.onReceiveMessage,onReceiveStatus:(p=u.onReceiveStatus)!==null&&p!==void 0?p:nI.onReceiveStatus};v=new dj.InterceptingListenerImpl(E,c)}this.nextCall.start(d,v),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,i){this.processingMessage=!0,this.requester.sendMessage(i,n=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=i):(this.nextCall.sendMessageWithContext(e,n),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};fr.InterceptingCall=aI;function gee(t,e,i){var n,r;let s=(n=i.deadline)!==null&&n!==void 0?n:1/0,a=i.host,o=(r=i.parent)!==null&&r!==void 0?r:null,l=i.propagate_flags,c=i.credentials,d=t.createCall(e,s,a,o,l);return c&&d.setCredentials(c),d}var lv=class{constructor(e,i){this.call=e,this.methodDefinition=i}cancelWithStatus(e,i){this.call.cancelWithStatus(e,i)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,i){let n;try{n=this.methodDefinition.requestSerialize(i)}catch(r){this.call.cancelWithStatus(uj.Status.INTERNAL,`Request message serialization failure: ${(0,hj.getErrorMessage)(r)}`);return}this.call.sendMessageWithContext(e,n)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,i){let n=null;this.call.start(e,{onReceiveMetadata:r=>{var s;(s=i?.onReceiveMetadata)===null||s===void 0||s.call(i,r)},onReceiveMessage:r=>{var s;let a;try{a=this.methodDefinition.responseDeserialize(r)}catch(o){n={code:uj.Status.INTERNAL,details:`Response message parsing error: ${(0,hj.getErrorMessage)(o)}`,metadata:new pee.Metadata},this.call.cancelWithStatus(n.code,n.details);return}(s=i?.onReceiveMessage)===null||s===void 0||s.call(i,a)},onReceiveStatus:r=>{var s,a;n?(s=i?.onReceiveStatus)===null||s===void 0||s.call(i,n):(a=i?.onReceiveStatus)===null||a===void 0||a.call(i,r)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},oI=class extends lv{constructor(e,i){super(e,i)}start(e,i){var n,r;let s=!1,a={onReceiveMetadata:(r=(n=i?.onReceiveMetadata)===null||n===void 0?void 0:n.bind(i))!==null&&r!==void 0?r:o=>{},onReceiveMessage:o=>{var l;s=!0,(l=i?.onReceiveMessage)===null||l===void 0||l.call(i,o)},onReceiveStatus:o=>{var l,c;s||(l=i?.onReceiveMessage)===null||l===void 0||l.call(i,null),(c=i?.onReceiveStatus)===null||c===void 0||c.call(i,o)}};super.start(e,a),this.call.startRead()}},lI=class extends lv{};function _ee(t,e,i){let n=gee(t,i.path,e);return i.responseStream?new lI(n,i):new oI(n,i)}function bee(t,e,i,n){if(t.clientInterceptors.length>0&&t.clientInterceptorProviders.length>0)throw new Cm("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(t.callInterceptors.length>0&&t.callInterceptorProviders.length>0)throw new Cm("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let r=[];t.callInterceptors.length>0||t.callInterceptorProviders.length>0?r=[].concat(t.callInterceptors,t.callInterceptorProviders.map(o=>o(e))).filter(o=>o):r=[].concat(t.clientInterceptors,t.clientInterceptorProviders.map(o=>o(e))).filter(o=>o);let s=Object.assign({},i,{method_definition:e});return r.reduceRight((o,l)=>c=>l(c,o),o=>_ee(n,o,e))(s)}fr.getInterceptingCall=bee});var hI=x(dv=>{"use strict";Object.defineProperty(dv,"__esModule",{value:!0});dv.Client=void 0;var Es=lj(),vee=fI(),yee=dr(),to=st(),Ld=fn(),cv=cI(),Pr=Symbol(),Bd=Symbol(),Vd=Symbol(),ea=Symbol();function dI(t){return typeof t=="function"}function jd(t){return t.stack.split(`
`).slice(1).join(`
`)}var uI=class{constructor(e,i,n={}){var r,s;if(n=Object.assign({},n),this[Bd]=(r=n.interceptors)!==null&&r!==void 0?r:[],delete n.interceptors,this[Vd]=(s=n.interceptor_providers)!==null&&s!==void 0?s:[],delete n.interceptor_providers,this[Bd].length>0&&this[Vd].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[ea]=n.callInvocationTransformer,delete n.callInvocationTransformer,n.channelOverride)this[Pr]=n.channelOverride;else if(n.channelFactoryOverride){let a=n.channelFactoryOverride;delete n.channelFactoryOverride,this[Pr]=a(e,i,n)}else this[Pr]=new vee.ChannelImplementation(e,i,n)}close(){this[Pr].close()}getChannel(){return this[Pr]}waitForReady(e,i){let n=r=>{if(r){i(new Error("Failed to connect before the deadline"));return}let s;try{s=this[Pr].getConnectivityState(!0)}catch{i(new Error("The channel has been closed"));return}if(s===yee.ConnectivityState.READY)i();else try{this[Pr].watchConnectivityState(s,e,n)}catch{i(new Error("The channel has been closed"))}};setImmediate(n)}checkOptionalUnaryResponseArguments(e,i,n){if(dI(e))return{metadata:new Ld.Metadata,options:{},callback:e};if(dI(i))return e instanceof Ld.Metadata?{metadata:e,options:{},callback:i}:{metadata:new Ld.Metadata,options:e,callback:i};if(!(e instanceof Ld.Metadata&&i instanceof Object&&dI(n)))throw new Error("Incorrect arguments passed");return{metadata:e,options:i,callback:n}}makeUnaryRequest(e,i,n,r,s,a,o){var l,c;let d=this.checkOptionalUnaryResponseArguments(s,a,o),u={path:e,requestStream:!1,responseStream:!1,requestSerialize:i,responseDeserialize:n},h={argument:r,metadata:d.metadata,call:new Es.ClientUnaryCallImpl,channel:this[Pr],methodDefinition:u,callOptions:d.options,callback:d.callback};this[ea]&&(h=this[ea](h));let f=h.call,p={clientInterceptors:this[Bd],clientInterceptorProviders:this[Vd],callInterceptors:(l=h.callOptions.interceptors)!==null&&l!==void 0?l:[],callInterceptorProviders:(c=h.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},v=(0,cv.getInterceptingCall)(p,h.methodDefinition,h.callOptions,h.channel);f.call=v;let E=null,k=!1,I=new Error;return v.start(h.metadata,{onReceiveMetadata:P=>{f.emit("metadata",P)},onReceiveMessage(P){E!==null&&v.cancelWithStatus(to.Status.INTERNAL,"Too many responses received"),E=P},onReceiveStatus(P){if(!k){if(k=!0,P.code===to.Status.OK)if(E===null){let L=jd(I);h.callback((0,Es.callErrorFromStatus)({code:to.Status.INTERNAL,details:"No message received",metadata:P.metadata},L))}else h.callback(null,E);else{let L=jd(I);h.callback((0,Es.callErrorFromStatus)(P,L))}I=null,f.emit("status",P)}}}),v.sendMessage(r),v.halfClose(),f}makeClientStreamRequest(e,i,n,r,s,a){var o,l;let c=this.checkOptionalUnaryResponseArguments(r,s,a),d={path:e,requestStream:!0,responseStream:!1,requestSerialize:i,responseDeserialize:n},u={metadata:c.metadata,call:new Es.ClientWritableStreamImpl(i),channel:this[Pr],methodDefinition:d,callOptions:c.options,callback:c.callback};this[ea]&&(u=this[ea](u));let h=u.call,f={clientInterceptors:this[Bd],clientInterceptorProviders:this[Vd],callInterceptors:(o=u.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(l=u.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},p=(0,cv.getInterceptingCall)(f,u.methodDefinition,u.callOptions,u.channel);h.call=p;let v=null,E=!1,k=new Error;return p.start(u.metadata,{onReceiveMetadata:I=>{h.emit("metadata",I)},onReceiveMessage(I){v!==null&&p.cancelWithStatus(to.Status.INTERNAL,"Too many responses received"),v=I},onReceiveStatus(I){if(!E){if(E=!0,I.code===to.Status.OK)if(v===null){let P=jd(k);u.callback((0,Es.callErrorFromStatus)({code:to.Status.INTERNAL,details:"No message received",metadata:I.metadata},P))}else u.callback(null,v);else{let P=jd(k);u.callback((0,Es.callErrorFromStatus)(I,P))}k=null,h.emit("status",I)}}}),h}checkMetadataAndOptions(e,i){let n,r;return e instanceof Ld.Metadata?(n=e,i?r=i:r={}):(e?r=e:r={},n=new Ld.Metadata),{metadata:n,options:r}}makeServerStreamRequest(e,i,n,r,s,a){var o,l;let c=this.checkMetadataAndOptions(s,a),d={path:e,requestStream:!1,responseStream:!0,requestSerialize:i,responseDeserialize:n},u={argument:r,metadata:c.metadata,call:new Es.ClientReadableStreamImpl(n),channel:this[Pr],methodDefinition:d,callOptions:c.options};this[ea]&&(u=this[ea](u));let h=u.call,f={clientInterceptors:this[Bd],clientInterceptorProviders:this[Vd],callInterceptors:(o=u.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(l=u.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},p=(0,cv.getInterceptingCall)(f,u.methodDefinition,u.callOptions,u.channel);h.call=p;let v=!1,E=new Error;return p.start(u.metadata,{onReceiveMetadata(k){h.emit("metadata",k)},onReceiveMessage(k){h.push(k)},onReceiveStatus(k){if(!v){if(v=!0,h.push(null),k.code!==to.Status.OK){let I=jd(E);h.emit("error",(0,Es.callErrorFromStatus)(k,I))}E=null,h.emit("status",k)}}}),p.sendMessage(r),p.halfClose(),h}makeBidiStreamRequest(e,i,n,r,s){var a,o;let l=this.checkMetadataAndOptions(r,s),c={path:e,requestStream:!0,responseStream:!0,requestSerialize:i,responseDeserialize:n},d={metadata:l.metadata,call:new Es.ClientDuplexStreamImpl(i,n),channel:this[Pr],methodDefinition:c,callOptions:l.options};this[ea]&&(d=this[ea](d));let u=d.call,h={clientInterceptors:this[Bd],clientInterceptorProviders:this[Vd],callInterceptors:(a=d.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(o=d.callOptions.interceptor_providers)!==null&&o!==void 0?o:[]},f=(0,cv.getInterceptingCall)(h,d.methodDefinition,d.callOptions,d.channel);u.call=f;let p=!1,v=new Error;return f.start(d.metadata,{onReceiveMetadata(E){u.emit("metadata",E)},onReceiveMessage(E){u.push(E)},onReceiveStatus(E){if(!p){if(p=!0,u.push(null),E.code!==to.Status.OK){let k=jd(v);u.emit("error",(0,Es.callErrorFromStatus)(E,k))}v=null,u.emit("status",E)}}}),u}};dv.Client=uI});var pI=x(zd=>{"use strict";Object.defineProperty(zd,"__esModule",{value:!0});zd.loadPackageDefinition=zd.makeClientConstructor=void 0;var Em=hI(),wee={unary:Em.Client.prototype.makeUnaryRequest,server_stream:Em.Client.prototype.makeServerStreamRequest,client_stream:Em.Client.prototype.makeClientStreamRequest,bidi:Em.Client.prototype.makeBidiStreamRequest};function mI(t){return["__proto__","prototype","constructor"].includes(t)}function fj(t,e,i){i||(i={});class n extends Em.Client{}return Object.keys(t).forEach(r=>{if(mI(r))return;let s=t[r],a;if(typeof r=="string"&&r.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?a="bidi":a="client_stream":s.responseStream?a="server_stream":a="unary";let o=s.requestSerialize,l=s.responseDeserialize,c=Cee(wee[a],s.path,o,l);n.prototype[r]=c,Object.assign(n.prototype[r],s),s.originalName&&!mI(s.originalName)&&(n.prototype[s.originalName]=n.prototype[r])}),n.service=t,n.serviceName=e,n}zd.makeClientConstructor=fj;function Cee(t,e,i,n){return function(...r){return t.call(this,e,i,n,...r)}}function Eee(t){return"format"in t}function See(t){let e={};for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i)){let n=t[i],r=i.split(".");if(r.some(o=>mI(o)))continue;let s=r[r.length-1],a=e;for(let o of r.slice(0,-1))a[o]||(a[o]={}),a=a[o];Eee(n)?a[s]=n:a[s]=fj(n,s,{})}return e}zd.loadPackageDefinition=See});var Bj=x((txe,Lj)=>{"use strict";var xee=1/0,Tee="[object Symbol]",Iee=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Dee=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,hv="\\ud800-\\udfff",wj="\\u0300-\\u036f\\ufe20-\\ufe23",Cj="\\u20d0-\\u20f0",Ej="\\u2700-\\u27bf",Sj="a-z\\xdf-\\xf6\\xf8-\\xff",kee="\\xac\\xb1\\xd7\\xf7",Aee="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ree="\\u2000-\\u206f",Mee=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",xj="A-Z\\xc0-\\xd6\\xd8-\\xde",Tj="\\ufe0e\\ufe0f",Ij=kee+Aee+Ree+Mee,_I="['\u2019]",Oee="["+hv+"]",mj="["+Ij+"]",uv="["+wj+Cj+"]",Dj="\\d+",Nee="["+Ej+"]",kj="["+Sj+"]",Aj="[^"+hv+Ij+Dj+Ej+Sj+xj+"]",gI="\\ud83c[\\udffb-\\udfff]",Pee="(?:"+uv+"|"+gI+")",Rj="[^"+hv+"]",bI="(?:\\ud83c[\\udde6-\\uddff]){2}",vI="[\\ud800-\\udbff][\\udc00-\\udfff]",Ud="["+xj+"]",Mj="\\u200d",pj="(?:"+kj+"|"+Aj+")",Fee="(?:"+Ud+"|"+Aj+")",gj="(?:"+_I+"(?:d|ll|m|re|s|t|ve))?",_j="(?:"+_I+"(?:D|LL|M|RE|S|T|VE))?",Oj=Pee+"?",Nj="["+Tj+"]?",Lee="(?:"+Mj+"(?:"+[Rj,bI,vI].join("|")+")"+Nj+Oj+")*",Pj=Nj+Oj+Lee,Bee="(?:"+[Nee,bI,vI].join("|")+")"+Pj,Vee="(?:"+[Rj+uv+"?",uv,bI,vI,Oee].join("|")+")",jee=RegExp(_I,"g"),zee=RegExp(uv,"g"),Uee=RegExp(gI+"(?="+gI+")|"+Vee+Pj,"g"),qee=RegExp([Ud+"?"+kj+"+"+gj+"(?="+[mj,Ud,"$"].join("|")+")",Fee+"+"+_j+"(?="+[mj,Ud+pj,"$"].join("|")+")",Ud+"?"+pj+"+"+gj,Ud+"+"+_j,Dj,Bee].join("|"),"g"),Hee=RegExp("["+Mj+hv+wj+Cj+Tj+"]"),Wee=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gee={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},Kee=typeof global=="object"&&global&&global.Object===Object&&global,$ee=typeof self=="object"&&self&&self.Object===Object&&self,Yee=Kee||$ee||Function("return this")();function Qee(t,e,i,n){var r=-1,s=t?t.length:0;for(n&&s&&(i=t[++r]);++r<s;)i=e(i,t[r],r,t);return i}function Xee(t){return t.split("")}function Zee(t){return t.match(Iee)||[]}function Jee(t){return function(e){return t?.[e]}}var ete=Jee(Gee);function Fj(t){return Hee.test(t)}function tte(t){return Wee.test(t)}function ite(t){return Fj(t)?nte(t):Xee(t)}function nte(t){return t.match(Uee)||[]}function rte(t){return t.match(qee)||[]}var ste=Object.prototype,ate=ste.toString,bj=Yee.Symbol,vj=bj?bj.prototype:void 0,yj=vj?vj.toString:void 0;function ote(t,e,i){var n=-1,r=t.length;e<0&&(e=-e>r?0:r+e),i=i>r?r:i,i<0&&(i+=r),r=e>i?0:i-e>>>0,e>>>=0;for(var s=Array(r);++n<r;)s[n]=t[n+e];return s}function lte(t){if(typeof t=="string")return t;if(fte(t))return yj?yj.call(t):"";var e=t+"";return e=="0"&&1/t==-xee?"-0":e}function cte(t,e,i){var n=t.length;return i=i===void 0?n:i,!e&&i>=n?t:ote(t,e,i)}function dte(t){return function(e){e=fv(e);var i=Fj(e)?ite(e):void 0,n=i?i[0]:e.charAt(0),r=i?cte(i,1).join(""):e.slice(1);return n[t]()+r}}function ute(t){return function(e){return Qee(bte(gte(e).replace(jee,"")),t,"")}}function hte(t){return!!t&&typeof t=="object"}function fte(t){return typeof t=="symbol"||hte(t)&&ate.call(t)==Tee}function fv(t){return t==null?"":lte(t)}var mte=ute(function(t,e,i){return e=e.toLowerCase(),t+(i?pte(e):e)});function pte(t){return _te(fv(t).toLowerCase())}function gte(t){return t=fv(t),t&&t.replace(Dee,ete).replace(zee,"")}var _te=dte("toUpperCase");function bte(t,e,i){return t=fv(t),e=i?void 0:e,e===void 0?tte(t)?rte(t):Zee(t):t.match(e)||[]}Lj.exports=mte});var yI=x((ixe,Vj)=>{"use strict";Vj.exports=vte;function vte(t,e){for(var i=new Array(arguments.length-1),n=0,r=2,s=!0;r<arguments.length;)i[n++]=arguments[r++];return new Promise(function(o,l){i[n]=function(d){if(s)if(s=!1,d)l(d);else{for(var u=new Array(arguments.length-1),h=0;h<u.length;)u[h++]=arguments[h];o.apply(null,u)}};try{t.apply(e||null,i)}catch(c){s&&(s=!1,l(c))}})}});var qj=x(Uj=>{"use strict";var mv=Uj;mv.length=function(e){var i=e.length;if(!i)return 0;for(var n=0;--i%4>1&&e.charAt(i)==="=";)++n;return Math.ceil(e.length*3)/4-n};var qd=new Array(64),zj=new Array(123);for(Fr=0;Fr<64;)zj[qd[Fr]=Fr<26?Fr+65:Fr<52?Fr+71:Fr<62?Fr-4:Fr-59|43]=Fr++;var Fr;mv.encode=function(e,i,n){for(var r=null,s=[],a=0,o=0,l;i<n;){var c=e[i++];switch(o){case 0:s[a++]=qd[c>>2],l=(c&3)<<4,o=1;break;case 1:s[a++]=qd[l|c>>4],l=(c&15)<<2,o=2;break;case 2:s[a++]=qd[l|c>>6],s[a++]=qd[c&63],o=0;break}a>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),a=0)}return o&&(s[a++]=qd[l],s[a++]=61,o===1&&(s[a++]=61)),r?(a&&r.push(String.fromCharCode.apply(String,s.slice(0,a))),r.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var jj="invalid encoding";mv.decode=function(e,i,n){for(var r=n,s=0,a,o=0;o<e.length;){var l=e.charCodeAt(o++);if(l===61&&s>1)break;if((l=zj[l])===void 0)throw Error(jj);switch(s){case 0:a=l,s=1;break;case 1:i[n++]=a<<2|(l&48)>>4,a=l,s=2;break;case 2:i[n++]=(a&15)<<4|(l&60)>>2,a=l,s=3;break;case 3:i[n++]=(a&3)<<6|l,s=0;break}}if(s===1)throw Error(jj);return n-r};mv.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Wj=x((rxe,Hj)=>{"use strict";Hj.exports=pv;function pv(){this._listeners={}}pv.prototype.on=function(e,i,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:i,ctx:n||this}),this};pv.prototype.off=function(e,i){if(e===void 0)this._listeners={};else if(i===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===i?n.splice(r,1):++r;return this};pv.prototype.emit=function(e){var i=this._listeners[e];if(i){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<i.length;)i[r].fn.apply(i[r++].ctx,n)}return this}});var Zj=x((sxe,Xj)=>{"use strict";Xj.exports=Gj(Gj);function Gj(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),i=new Uint8Array(e.buffer),n=i[3]===128;function r(l,c,d){e[0]=l,c[d]=i[0],c[d+1]=i[1],c[d+2]=i[2],c[d+3]=i[3]}function s(l,c,d){e[0]=l,c[d]=i[3],c[d+1]=i[2],c[d+2]=i[1],c[d+3]=i[0]}t.writeFloatLE=n?r:s,t.writeFloatBE=n?s:r;function a(l,c){return i[0]=l[c],i[1]=l[c+1],i[2]=l[c+2],i[3]=l[c+3],e[0]}function o(l,c){return i[3]=l[c],i[2]=l[c+1],i[1]=l[c+2],i[0]=l[c+3],e[0]}t.readFloatLE=n?a:o,t.readFloatBE=n?o:a}():function(){function e(n,r,s,a){var o=r<0?1:0;if(o&&(r=-r),r===0)n(1/r>0?0:2147483648,s,a);else if(isNaN(r))n(2143289344,s,a);else if(r>34028234663852886e22)n((o<<31|2139095040)>>>0,s,a);else if(r<11754943508222875e-54)n((o<<31|Math.round(r/1401298464324817e-60))>>>0,s,a);else{var l=Math.floor(Math.log(r)/Math.LN2),c=Math.round(r*Math.pow(2,-l)*8388608)&8388607;n((o<<31|l+127<<23|c)>>>0,s,a)}}t.writeFloatLE=e.bind(null,Kj),t.writeFloatBE=e.bind(null,$j);function i(n,r,s){var a=n(r,s),o=(a>>31)*2+1,l=a>>>23&255,c=a&8388607;return l===255?c?NaN:o*(1/0):l===0?o*1401298464324817e-60*c:o*Math.pow(2,l-150)*(c+8388608)}t.readFloatLE=i.bind(null,Yj),t.readFloatBE=i.bind(null,Qj)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),i=new Uint8Array(e.buffer),n=i[7]===128;function r(l,c,d){e[0]=l,c[d]=i[0],c[d+1]=i[1],c[d+2]=i[2],c[d+3]=i[3],c[d+4]=i[4],c[d+5]=i[5],c[d+6]=i[6],c[d+7]=i[7]}function s(l,c,d){e[0]=l,c[d]=i[7],c[d+1]=i[6],c[d+2]=i[5],c[d+3]=i[4],c[d+4]=i[3],c[d+5]=i[2],c[d+6]=i[1],c[d+7]=i[0]}t.writeDoubleLE=n?r:s,t.writeDoubleBE=n?s:r;function a(l,c){return i[0]=l[c],i[1]=l[c+1],i[2]=l[c+2],i[3]=l[c+3],i[4]=l[c+4],i[5]=l[c+5],i[6]=l[c+6],i[7]=l[c+7],e[0]}function o(l,c){return i[7]=l[c],i[6]=l[c+1],i[5]=l[c+2],i[4]=l[c+3],i[3]=l[c+4],i[2]=l[c+5],i[1]=l[c+6],i[0]=l[c+7],e[0]}t.readDoubleLE=n?a:o,t.readDoubleBE=n?o:a}():function(){function e(n,r,s,a,o,l){var c=a<0?1:0;if(c&&(a=-a),a===0)n(0,o,l+r),n(1/a>0?0:2147483648,o,l+s);else if(isNaN(a))n(0,o,l+r),n(2146959360,o,l+s);else if(a>17976931348623157e292)n(0,o,l+r),n((c<<31|2146435072)>>>0,o,l+s);else{var d;if(a<22250738585072014e-324)d=a/5e-324,n(d>>>0,o,l+r),n((c<<31|d/4294967296)>>>0,o,l+s);else{var u=Math.floor(Math.log(a)/Math.LN2);u===1024&&(u=1023),d=a*Math.pow(2,-u),n(d*4503599627370496>>>0,o,l+r),n((c<<31|u+1023<<20|d*1048576&1048575)>>>0,o,l+s)}}}t.writeDoubleLE=e.bind(null,Kj,0,4),t.writeDoubleBE=e.bind(null,$j,4,0);function i(n,r,s,a,o){var l=n(a,o+r),c=n(a,o+s),d=(c>>31)*2+1,u=c>>>20&2047,h=4294967296*(c&1048575)+l;return u===2047?h?NaN:d*(1/0):u===0?d*5e-324*h:d*Math.pow(2,u-1075)*(h+4503599627370496)}t.readDoubleLE=i.bind(null,Yj,0,4),t.readDoubleBE=i.bind(null,Qj,4,0)}(),t}function Kj(t,e,i){e[i]=t&255,e[i+1]=t>>>8&255,e[i+2]=t>>>16&255,e[i+3]=t>>>24}function $j(t,e,i){e[i]=t>>>24,e[i+1]=t>>>16&255,e[i+2]=t>>>8&255,e[i+3]=t&255}function Yj(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Qj(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var wI=x((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var e3=x(Jj=>{"use strict";var CI=Jj;CI.length=function(e){for(var i=0,n=0,r=0;r<e.length;++r)n=e.charCodeAt(r),n<128?i+=1:n<2048?i+=2:(n&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320?(++r,i+=4):i+=3;return i};CI.read=function(e,i,n){var r=n-i;if(r<1)return"";for(var s=null,a=[],o=0,l;i<n;)l=e[i++],l<128?a[o++]=l:l>191&&l<224?a[o++]=(l&31)<<6|e[i++]&63:l>239&&l<365?(l=((l&7)<<18|(e[i++]&63)<<12|(e[i++]&63)<<6|e[i++]&63)-65536,a[o++]=55296+(l>>10),a[o++]=56320+(l&1023)):a[o++]=(l&15)<<12|(e[i++]&63)<<6|e[i++]&63,o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};CI.write=function(e,i,n){for(var r=n,s,a,o=0;o<e.length;++o)s=e.charCodeAt(o),s<128?i[n++]=s:s<2048?(i[n++]=s>>6|192,i[n++]=s&63|128):(s&64512)===55296&&((a=e.charCodeAt(o+1))&64512)===56320?(s=65536+((s&1023)<<10)+(a&1023),++o,i[n++]=s>>18|240,i[n++]=s>>12&63|128,i[n++]=s>>6&63|128,i[n++]=s&63|128):(i[n++]=s>>12|224,i[n++]=s>>6&63|128,i[n++]=s&63|128);return n-r}});var i3=x((oxe,t3)=>{"use strict";t3.exports=yte;function yte(t,e,i){var n=i||8192,r=n>>>1,s=null,a=n;return function(l){if(l<1||l>r)return t(l);a+l>n&&(s=t(n),a=0);var c=e.call(s,a,a+=l);return a&7&&(a=(a|7)+1),c}}});var r3=x((lxe,n3)=>{"use strict";n3.exports=Ii;var Sm=Ss();function Ii(t,e){this.lo=t>>>0,this.hi=e>>>0}var Nl=Ii.zero=new Ii(0,0);Nl.toNumber=function(){return 0};Nl.zzEncode=Nl.zzDecode=function(){return this};Nl.length=function(){return 1};var wte=Ii.zeroHash="\0\0\0\0\0\0\0\0";Ii.fromNumber=function(e){if(e===0)return Nl;var i=e<0;i&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return i&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new Ii(n,r)};Ii.from=function(e){if(typeof e=="number")return Ii.fromNumber(e);if(Sm.isString(e))if(Sm.Long)e=Sm.Long.fromString(e);else return Ii.fromNumber(parseInt(e,10));return e.low||e.high?new Ii(e.low>>>0,e.high>>>0):Nl};Ii.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var i=~this.lo+1>>>0,n=~this.hi>>>0;return i||(n=n+1>>>0),-(i+n*4294967296)}return this.lo+this.hi*4294967296};Ii.prototype.toLong=function(e){return Sm.Long?new Sm.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var io=String.prototype.charCodeAt;Ii.fromHash=function(e){return e===wte?Nl:new Ii((io.call(e,0)|io.call(e,1)<<8|io.call(e,2)<<16|io.call(e,3)<<24)>>>0,(io.call(e,4)|io.call(e,5)<<8|io.call(e,6)<<16|io.call(e,7)<<24)>>>0)};Ii.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Ii.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Ii.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Ii.prototype.length=function(){var e=this.lo,i=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?i===0?e<16384?e<128?1:2:e<2097152?3:4:i<16384?i<128?5:6:i<2097152?7:8:n<128?9:10}});var Ss=x(EI=>{"use strict";var fe=EI;fe.asPromise=yI();fe.base64=qj();fe.EventEmitter=Wj();fe.float=Zj();fe.inquire=wI();fe.utf8=e3();fe.pool=i3();fe.LongBits=r3();fe.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);fe.global=fe.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||EI;fe.emptyArray=Object.freeze?Object.freeze([]):[];fe.emptyObject=Object.freeze?Object.freeze({}):{};fe.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};fe.isString=function(e){return typeof e=="string"||e instanceof String};fe.isObject=function(e){return e&&typeof e=="object"};fe.isset=fe.isSet=function(e,i){var n=e[i];return n!=null&&e.hasOwnProperty(i)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};fe.Buffer=function(){try{var t=fe.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();fe._Buffer_from=null;fe._Buffer_allocUnsafe=null;fe.newBuffer=function(e){return typeof e=="number"?fe.Buffer?fe._Buffer_allocUnsafe(e):new fe.Array(e):fe.Buffer?fe._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};fe.Array=typeof Uint8Array<"u"?Uint8Array:Array;fe.Long=fe.global.dcodeIO&&fe.global.dcodeIO.Long||fe.global.Long||fe.inquire("long");fe.key2Re=/^true|false|0|1$/;fe.key32Re=/^-?(?:0|[1-9][0-9]*)$/;fe.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;fe.longToHash=function(e){return e?fe.LongBits.from(e).toHash():fe.LongBits.zeroHash};fe.longFromHash=function(e,i){var n=fe.LongBits.fromHash(e);return fe.Long?fe.Long.fromBits(n.lo,n.hi,i):n.toNumber(!!i)};function s3(t,e,i){for(var n=Object.keys(e),r=0;r<n.length;++r)(t[n[r]]===void 0||!i)&&(t[n[r]]=e[n[r]]);return t}fe.merge=s3;fe.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function a3(t){function e(i,n){if(!(this instanceof e))return new e(i,n);Object.defineProperty(this,"message",{get:function(){return i}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&s3(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}fe.newError=a3;fe.ProtocolError=a3("ProtocolError");fe.oneOfGetter=function(e){for(var i={},n=0;n<e.length;++n)i[e[n]]=1;return function(){for(var r=Object.keys(this),s=r.length-1;s>-1;--s)if(i[r[s]]===1&&this[r[s]]!==void 0&&this[r[s]]!==null)return r[s]}};fe.oneOfSetter=function(e){return function(i){for(var n=0;n<e.length;++n)e[n]!==i&&delete this[e[n]]}};fe.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};fe._configure=function(){var t=fe.Buffer;if(!t){fe._Buffer_from=fe._Buffer_allocUnsafe=null;return}fe._Buffer_from=t.from!==Uint8Array.from&&t.from||function(i,n){return new t(i,n)},fe._Buffer_allocUnsafe=t.allocUnsafe||function(i){return new t(i)}}});var _v=x((dxe,d3)=>{"use strict";d3.exports=Je;var mr=Ss(),SI,gv=mr.LongBits,o3=mr.base64,l3=mr.utf8;function xm(t,e,i){this.fn=t,this.len=e,this.next=void 0,this.val=i}function TI(){}function Cte(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Je(){this.len=0,this.head=new xm(TI,0,0),this.tail=this.head,this.states=null}var c3=function(){return mr.Buffer?function(){return(Je.create=function(){return new SI})()}:function(){return new Je}};Je.create=c3();Je.alloc=function(e){return new mr.Array(e)};mr.Array!==Array&&(Je.alloc=mr.pool(Je.alloc,mr.Array.prototype.subarray));Je.prototype._push=function(e,i,n){return this.tail=this.tail.next=new xm(e,i,n),this.len+=i,this};function II(t,e,i){e[i]=t&255}function Ete(t,e,i){for(;t>127;)e[i++]=t&127|128,t>>>=7;e[i]=t}function DI(t,e){this.len=t,this.next=void 0,this.val=e}DI.prototype=Object.create(xm.prototype);DI.prototype.fn=Ete;Je.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new DI((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Je.prototype.int32=function(e){return e<0?this._push(kI,10,gv.fromNumber(e)):this.uint32(e)};Je.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function kI(t,e,i){for(;t.hi;)e[i++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[i++]=t.lo&127|128,t.lo=t.lo>>>7;e[i++]=t.lo}Je.prototype.uint64=function(e){var i=gv.from(e);return this._push(kI,i.length(),i)};Je.prototype.int64=Je.prototype.uint64;Je.prototype.sint64=function(e){var i=gv.from(e).zzEncode();return this._push(kI,i.length(),i)};Je.prototype.bool=function(e){return this._push(II,1,e?1:0)};function xI(t,e,i){e[i]=t&255,e[i+1]=t>>>8&255,e[i+2]=t>>>16&255,e[i+3]=t>>>24}Je.prototype.fixed32=function(e){return this._push(xI,4,e>>>0)};Je.prototype.sfixed32=Je.prototype.fixed32;Je.prototype.fixed64=function(e){var i=gv.from(e);return this._push(xI,4,i.lo)._push(xI,4,i.hi)};Je.prototype.sfixed64=Je.prototype.fixed64;Je.prototype.float=function(e){return this._push(mr.float.writeFloatLE,4,e)};Je.prototype.double=function(e){return this._push(mr.float.writeDoubleLE,8,e)};var Ste=mr.Array.prototype.set?function(e,i,n){i.set(e,n)}:function(e,i,n){for(var r=0;r<e.length;++r)i[n+r]=e[r]};Je.prototype.bytes=function(e){var i=e.length>>>0;if(!i)return this._push(II,1,0);if(mr.isString(e)){var n=Je.alloc(i=o3.length(e));o3.decode(e,n,0),e=n}return this.uint32(i)._push(Ste,i,e)};Je.prototype.string=function(e){var i=l3.length(e);return i?this.uint32(i)._push(l3.write,i,e):this._push(II,1,0)};Je.prototype.fork=function(){return this.states=new Cte(this),this.head=this.tail=new xm(TI,0,0),this.len=0,this};Je.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new xm(TI,0,0),this.len=0),this};Je.prototype.ldelim=function(){var e=this.head,i=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=i,this.len+=n),this};Je.prototype.finish=function(){for(var e=this.head.next,i=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,i,n),n+=e.len,e=e.next;return i};Je._configure=function(t){SI=t,Je.create=c3(),SI._configure()}});var f3=x((uxe,h3)=>{"use strict";h3.exports=xs;var u3=_v();(xs.prototype=Object.create(u3.prototype)).constructor=xs;var no=Ss();function xs(){u3.call(this)}xs._configure=function(){xs.alloc=no._Buffer_allocUnsafe,xs.writeBytesBuffer=no.Buffer&&no.Buffer.prototype instanceof Uint8Array&&no.Buffer.prototype.set.name==="set"?function(e,i,n){i.set(e,n)}:function(e,i,n){if(e.copy)e.copy(i,n,0,e.length);else for(var r=0;r<e.length;)i[n++]=e[r++]}};xs.prototype.bytes=function(e){no.isString(e)&&(e=no._Buffer_from(e,"base64"));var i=e.length>>>0;return this.uint32(i),i&&this._push(xs.writeBytesBuffer,i,e),this};function xte(t,e,i){t.length<40?no.utf8.write(t,e,i):e.utf8Write?e.utf8Write(t,i):e.write(t,i)}xs.prototype.string=function(e){var i=no.Buffer.byteLength(e);return this.uint32(i),i&&this._push(xte,i,e),this};xs._configure()});var vv=x((hxe,b3)=>{"use strict";b3.exports=Qt;var Lr=Ss(),RI,g3=Lr.LongBits,Tte=Lr.utf8;function Br(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Qt(t){this.buf=t,this.pos=0,this.len=t.length}var m3=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Qt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Qt(e);throw Error("illegal buffer")},_3=function(){return Lr.Buffer?function(i){return(Qt.create=function(r){return Lr.Buffer.isBuffer(r)?new RI(r):m3(r)})(i)}:m3};Qt.create=_3();Qt.prototype._slice=Lr.Array.prototype.subarray||Lr.Array.prototype.slice;Qt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Br(this,10);return e}}();Qt.prototype.int32=function(){return this.uint32()|0};Qt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function AI(){var t=new g3(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Br(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Br(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Qt.prototype.bool=function(){return this.uint32()!==0};function bv(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Qt.prototype.fixed32=function(){if(this.pos+4>this.len)throw Br(this,4);return bv(this.buf,this.pos+=4)};Qt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Br(this,4);return bv(this.buf,this.pos+=4)|0};function p3(){if(this.pos+8>this.len)throw Br(this,8);return new g3(bv(this.buf,this.pos+=4),bv(this.buf,this.pos+=4))}Qt.prototype.float=function(){if(this.pos+4>this.len)throw Br(this,4);var e=Lr.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Qt.prototype.double=function(){if(this.pos+8>this.len)throw Br(this,4);var e=Lr.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Qt.prototype.bytes=function(){var e=this.uint32(),i=this.pos,n=this.pos+e;if(n>this.len)throw Br(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(i,n);if(i===n){var r=Lr.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,i,n)};Qt.prototype.string=function(){var e=this.bytes();return Tte.read(e,0,e.length)};Qt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Br(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Br(this);while(this.buf[this.pos++]&128);return this};Qt.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Qt._configure=function(t){RI=t,Qt.create=_3(),RI._configure();var e=Lr.Long?"toLong":"toNumber";Lr.merge(Qt.prototype,{int64:function(){return AI.call(this)[e](!1)},uint64:function(){return AI.call(this)[e](!0)},sint64:function(){return AI.call(this).zzDecode()[e](!1)},fixed64:function(){return p3.call(this)[e](!0)},sfixed64:function(){return p3.call(this)[e](!1)}})}});var C3=x((fxe,w3)=>{"use strict";w3.exports=Pl;var y3=vv();(Pl.prototype=Object.create(y3.prototype)).constructor=Pl;var v3=Ss();function Pl(t){y3.call(this,t)}Pl._configure=function(){v3.Buffer&&(Pl.prototype._slice=v3.Buffer.prototype.slice)};Pl.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Pl._configure()});var S3=x((mxe,E3)=>{"use strict";E3.exports=Tm;var MI=Ss();(Tm.prototype=Object.create(MI.EventEmitter.prototype)).constructor=Tm;function Tm(t,e,i){if(typeof t!="function")throw TypeError("rpcImpl must be a function");MI.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!e,this.responseDelimited=!!i}Tm.prototype.rpcCall=function t(e,i,n,r,s){if(!r)throw TypeError("request must be specified");var a=this;if(!s)return MI.asPromise(t,a,e,i,n,r);if(!a.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return a.rpcImpl(e,i[a.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(l,c){if(l)return a.emit("error",l,e),s(l);if(c===null){a.end(!0);return}if(!(c instanceof n))try{c=n[a.responseDelimited?"decodeDelimited":"decode"](c)}catch(d){return a.emit("error",d,e),s(d)}return a.emit("data",c,e),s(null,c)})}catch(o){a.emit("error",o,e),setTimeout(function(){s(o)},0);return}};Tm.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var OI=x(x3=>{"use strict";var Ite=x3;Ite.Service=S3()});var NI=x((gxe,T3)=>{"use strict";T3.exports={}});var k3=x(D3=>{"use strict";var Tn=D3;Tn.build="minimal";Tn.Writer=_v();Tn.BufferWriter=f3();Tn.Reader=vv();Tn.BufferReader=C3();Tn.util=Ss();Tn.rpc=OI();Tn.roots=NI();Tn.configure=I3;function I3(){Tn.util._configure(),Tn.Writer._configure(Tn.BufferWriter),Tn.Reader._configure(Tn.BufferReader)}I3()});var R3=x((bxe,A3)=>{"use strict";A3.exports=PI;function PI(t,e){typeof t=="string"&&(e=t,t=void 0);var i=[];function n(s){if(typeof s!="string"){var a=r();if(PI.verbose&&console.log("codegen: "+a),a="return "+a,s){for(var o=Object.keys(s),l=new Array(o.length+1),c=new Array(o.length),d=0;d<o.length;)l[d]=o[d],c[d]=s[o[d++]];return l[d]=a,Function.apply(null,l).apply(null,c)}return Function(a)()}for(var u=new Array(arguments.length-1),h=0;h<u.length;)u[h]=arguments[++h];if(h=0,s=s.replace(/%([%dfijs])/g,function(p,v){var E=u[h++];switch(v){case"d":case"f":return String(Number(E));case"i":return String(Math.floor(E));case"j":return JSON.stringify(E);case"s":return String(E)}return"%"}),h!==u.length)throw Error("parameter count mismatch");return i.push(s),n}function r(s){return"function "+(s||e||"")+"("+(t&&t.join(",")||"")+`){
  `+i.join(`
  `)+`
}`}return n.toString=r,n}PI.verbose=!1});var O3=x((vxe,M3)=>{"use strict";M3.exports=Im;var Dte=yI(),kte=wI(),FI=kte("fs");function Im(t,e,i){return typeof e=="function"?(i=e,e={}):e||(e={}),i?!e.xhr&&FI&&FI.readFile?FI.readFile(t,function(r,s){return r&&typeof XMLHttpRequest<"u"?Im.xhr(t,e,i):r?i(r):i(null,e.binary?s:s.toString("utf8"))}):Im.xhr(t,e,i):Dte(Im,this,t,e)}Im.xhr=function(e,i,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4){if(r.status!==0&&r.status!==200)return n(Error("status "+r.status));if(i.binary){var a=r.response;if(!a){a=[];for(var o=0;o<r.responseText.length;++o)a.push(r.responseText.charCodeAt(o)&255)}return n(null,typeof Uint8Array<"u"?new Uint8Array(a):a)}return n(null,r.responseText)}},i.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}});var F3=x(P3=>{"use strict";var BI=P3,N3=BI.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},LI=BI.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var i=e.split("/"),n=N3(e),r="";n&&(r=i.shift()+"/");for(var s=0;s<i.length;)i[s]===".."?s>0&&i[s-1]!==".."?i.splice(--s,2):n?i.splice(s,1):++s:i[s]==="."?i.splice(s,1):++s;return r+i.join("/")};BI.resolve=function(e,i,n){return n||(i=LI(i)),N3(i)?i:(n||(e=LI(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?LI(e+"/"+i):i)}});var Fl=x(L3=>{"use strict";var Dm=L3,Ate=Di(),Rte=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function km(t,e){var i=0,n={};for(e|=0;i<t.length;)n[Rte[i+e]]=t[i++];return n}Dm.basic=km([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Dm.defaults=km([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",Ate.emptyArray,null]);Dm.long=km([0,0,0,1,1],7);Dm.mapKey=km([0,0,0,5,5,0,0,0,1,1,0,2],2);Dm.packed=km([1,5,0,0,0,5,5,0,0,0,1,1,0])});var ro=x((Cxe,j3)=>{"use strict";j3.exports=pr;var yv=Ll();((pr.prototype=Object.create(yv.prototype)).constructor=pr).className="Field";var B3=Vr(),V3=Fl(),li=Di(),VI,Mte=/^required|optional|repeated$/;pr.fromJSON=function(e,i){return new pr(e,i.id,i.type,i.rule,i.extend,i.options,i.comment)};function pr(t,e,i,n,r,s,a){if(li.isObject(n)?(a=r,s=n,n=r=void 0):li.isObject(r)&&(a=s,s=r,r=void 0),yv.call(this,t,s),!li.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!li.isString(i))throw TypeError("type must be a string");if(n!==void 0&&!Mte.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(r!==void 0&&!li.isString(r))throw TypeError("extend must be a string");n==="proto3_optional"&&(n="optional"),this.rule=n&&n!=="optional"?n:void 0,this.type=i,this.id=e,this.extend=r||void 0,this.required=n==="required",this.optional=!this.required,this.repeated=n==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=li.Long?V3.long[i]!==void 0:!1,this.bytes=i==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=a}Object.defineProperty(pr.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});pr.prototype.setOption=function(e,i,n){return e==="packed"&&(this._packed=null),yv.prototype.setOption.call(this,e,i,n)};pr.prototype.toJSON=function(e){var i=e?!!e.keepComments:!1;return li.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",i?this.comment:void 0])};pr.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=V3.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof VI?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof B3&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof B3))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=li.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;li.base64.test(this.typeDefault)?li.base64.decode(this.typeDefault,e=li.newBuffer(li.base64.length(this.typeDefault)),0):li.utf8.write(this.typeDefault,e=li.newBuffer(li.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=li.emptyObject:this.repeated?this.defaultValue=li.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof VI&&(this.parent.ctor.prototype[this.name]=this.defaultValue),yv.prototype.resolve.call(this)};pr.d=function(e,i,n,r){return typeof i=="function"?i=li.decorateType(i).name:i&&typeof i=="object"&&(i=li.decorateEnum(i).name),function(a,o){li.decorateType(a.constructor).add(new pr(o,e,i,n,{default:r}))}};pr._configure=function(e){VI=e}});var Hd=x((Exe,q3)=>{"use strict";q3.exports=gr;var Cv=Ll();((gr.prototype=Object.create(Cv.prototype)).constructor=gr).className="OneOf";var z3=ro(),wv=Di();function gr(t,e,i,n){if(Array.isArray(e)||(i=e,e=void 0),Cv.call(this,t,i),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=n}gr.fromJSON=function(e,i){return new gr(e,i.oneof,i.options,i.comment)};gr.prototype.toJSON=function(e){var i=e?!!e.keepComments:!1;return wv.toObject(["options",this.options,"oneof",this.oneof,"comment",i?this.comment:void 0])};function U3(t){if(t.parent)for(var e=0;e<t.fieldsArray.length;++e)t.fieldsArray[e].parent||t.parent.add(t.fieldsArray[e])}gr.prototype.add=function(e){if(!(e instanceof z3))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,U3(this),this};gr.prototype.remove=function(e){if(!(e instanceof z3))throw TypeError("field must be a Field");var i=this.fieldsArray.indexOf(e);if(i<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(i,1),i=this.oneof.indexOf(e.name),i>-1&&this.oneof.splice(i,1),e.partOf=null,this};gr.prototype.onAdd=function(e){Cv.prototype.onAdd.call(this,e);for(var i=this,n=0;n<this.oneof.length;++n){var r=e.get(this.oneof[n]);r&&!r.partOf&&(r.partOf=i,i.fieldsArray.push(r))}U3(this)};gr.prototype.onRemove=function(e){for(var i=0,n;i<this.fieldsArray.length;++i)(n=this.fieldsArray[i]).parent&&n.parent.remove(n);Cv.prototype.onRemove.call(this,e)};gr.d=function(){for(var e=new Array(arguments.length),i=0;i<arguments.length;)e[i]=arguments[i++];return function(r,s){wv.decorateType(r.constructor).add(new gr(s,e)),Object.defineProperty(r,s,{get:wv.oneOfGetter(e),set:wv.oneOfSetter(e)})}}});var Kd=x((Sxe,K3)=>{"use strict";K3.exports=at;var jI=Ll();((at.prototype=Object.create(jI.prototype)).constructor=at).className="Namespace";var H3=ro(),Ev=Di(),Ote=Hd(),Wd,Am,Gd;at.fromJSON=function(e,i){return new at(e,i.options).addJSON(i.nested)};function W3(t,e){if(t&&t.length){for(var i={},n=0;n<t.length;++n)i[t[n].name]=t[n].toJSON(e);return i}}at.arrayToJSON=W3;at.isReservedId=function(e,i){if(e){for(var n=0;n<e.length;++n)if(typeof e[n]!="string"&&e[n][0]<=i&&e[n][1]>i)return!0}return!1};at.isReservedName=function(e,i){if(e){for(var n=0;n<e.length;++n)if(e[n]===i)return!0}return!1};function at(t,e){jI.call(this,t,e),this.nested=void 0,this._nestedArray=null}function G3(t){return t._nestedArray=null,t}Object.defineProperty(at.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=Ev.toArray(this.nested))}});at.prototype.toJSON=function(e){return Ev.toObject(["options",this.options,"nested",W3(this.nestedArray,e)])};at.prototype.addJSON=function(e){var i=this;if(e)for(var n=Object.keys(e),r=0,s;r<n.length;++r)s=e[n[r]],i.add((s.fields!==void 0?Wd.fromJSON:s.values!==void 0?Gd.fromJSON:s.methods!==void 0?Am.fromJSON:s.id!==void 0?H3.fromJSON:at.fromJSON)(n[r],s));return this};at.prototype.get=function(e){return this.nested&&this.nested[e]||null};at.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof Gd)return this.nested[e].values;throw Error("no such enum: "+e)};at.prototype.add=function(e){if(!(e instanceof H3&&e.extend!==void 0||e instanceof Wd||e instanceof Ote||e instanceof Gd||e instanceof Am||e instanceof at))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var i=this.get(e.name);if(i)if(i instanceof at&&e instanceof at&&!(i instanceof Wd||i instanceof Am)){for(var n=i.nestedArray,r=0;r<n.length;++r)e.add(n[r]);this.remove(i),this.nested||(this.nested={}),e.setOptions(i.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),G3(this)};at.prototype.remove=function(e){if(!(e instanceof jI))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),G3(this)};at.prototype.define=function(e,i){if(Ev.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var n=this;e.length>0;){var r=e.shift();if(n.nested&&n.nested[r]){if(n=n.nested[r],!(n instanceof at))throw Error("path conflicts with non-namespace objects")}else n.add(n=new at(r))}return i&&n.addJSON(i),n};at.prototype.resolveAll=function(){for(var e=this.nestedArray,i=0;i<e.length;)e[i]instanceof at?e[i++].resolveAll():e[i++].resolve();return this.resolve()};at.prototype.lookup=function(e,i,n){if(typeof i=="boolean"?(n=i,i=void 0):i&&!Array.isArray(i)&&(i=[i]),Ev.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),i);var r=this.get(e[0]);if(r){if(e.length===1){if(!i||i.indexOf(r.constructor)>-1)return r}else if(r instanceof at&&(r=r.lookup(e.slice(1),i,!0)))return r}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof at&&(r=this._nestedArray[s].lookup(e,i,!0)))return r;return this.parent===null||n?null:this.parent.lookup(e,i)};at.prototype.lookupType=function(e){var i=this.lookup(e,[Wd]);if(!i)throw Error("no such type: "+e);return i};at.prototype.lookupEnum=function(e){var i=this.lookup(e,[Gd]);if(!i)throw Error("no such Enum '"+e+"' in "+this);return i};at.prototype.lookupTypeOrEnum=function(e){var i=this.lookup(e,[Wd,Gd]);if(!i)throw Error("no such Type or Enum '"+e+"' in "+this);return i};at.prototype.lookupService=function(e){var i=this.lookup(e,[Am]);if(!i)throw Error("no such Service '"+e+"' in "+this);return i};at._configure=function(t,e,i){Wd=t,Am=e,Gd=i}});var Sv=x((xxe,$3)=>{"use strict";$3.exports=ta;var zI=ro();((ta.prototype=Object.create(zI.prototype)).constructor=ta).className="MapField";var Nte=Fl(),Rm=Di();function ta(t,e,i,n,r,s){if(zI.call(this,t,e,n,void 0,void 0,r,s),!Rm.isString(i))throw TypeError("keyType must be a string");this.keyType=i,this.resolvedKeyType=null,this.map=!0}ta.fromJSON=function(e,i){return new ta(e,i.id,i.keyType,i.type,i.options,i.comment)};ta.prototype.toJSON=function(e){var i=e?!!e.keepComments:!1;return Rm.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",i?this.comment:void 0])};ta.prototype.resolve=function(){if(this.resolved)return this;if(Nte.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return zI.prototype.resolve.call(this)};ta.d=function(e,i,n){return typeof n=="function"?n=Rm.decorateType(n).name:n&&typeof n=="object"&&(n=Rm.decorateEnum(n).name),function(s,a){Rm.decorateType(s.constructor).add(new ta(a,e,i,n))}}});var xv=x((Txe,Y3)=>{"use strict";Y3.exports=Bl;var UI=Ll();((Bl.prototype=Object.create(UI.prototype)).constructor=Bl).className="Method";var $d=Di();function Bl(t,e,i,n,r,s,a,o,l){if($d.isObject(r)?(a=r,r=s=void 0):$d.isObject(s)&&(a=s,s=void 0),!(e===void 0||$d.isString(e)))throw TypeError("type must be a string");if(!$d.isString(i))throw TypeError("requestType must be a string");if(!$d.isString(n))throw TypeError("responseType must be a string");UI.call(this,t,a),this.type=e||"rpc",this.requestType=i,this.requestStream=r?!0:void 0,this.responseType=n,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=o,this.parsedOptions=l}Bl.fromJSON=function(e,i){return new Bl(e,i.type,i.requestType,i.responseType,i.requestStream,i.responseStream,i.options,i.comment,i.parsedOptions)};Bl.prototype.toJSON=function(e){var i=e?!!e.keepComments:!1;return $d.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",i?this.comment:void 0,"parsedOptions",this.parsedOptions])};Bl.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),UI.prototype.resolve.call(this))}});var Tv=x((Ixe,X3)=>{"use strict";X3.exports=_r;var so=Kd();((_r.prototype=Object.create(so.prototype)).constructor=_r).className="Service";var qI=xv(),Mm=Di(),Pte=OI();function _r(t,e){so.call(this,t,e),this.methods={},this._methodsArray=null}_r.fromJSON=function(e,i){var n=new _r(e,i.options);if(i.methods)for(var r=Object.keys(i.methods),s=0;s<r.length;++s)n.add(qI.fromJSON(r[s],i.methods[r[s]]));return i.nested&&n.addJSON(i.nested),n.comment=i.comment,n};_r.prototype.toJSON=function(e){var i=so.prototype.toJSON.call(this,e),n=e?!!e.keepComments:!1;return Mm.toObject(["options",i&&i.options||void 0,"methods",so.arrayToJSON(this.methodsArray,e)||{},"nested",i&&i.nested||void 0,"comment",n?this.comment:void 0])};Object.defineProperty(_r.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Mm.toArray(this.methods))}});function Q3(t){return t._methodsArray=null,t}_r.prototype.get=function(e){return this.methods[e]||so.prototype.get.call(this,e)};_r.prototype.resolveAll=function(){for(var e=this.methodsArray,i=0;i<e.length;++i)e[i].resolve();return so.prototype.resolve.call(this)};_r.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof qI?(this.methods[e.name]=e,e.parent=this,Q3(this)):so.prototype.add.call(this,e)};_r.prototype.remove=function(e){if(e instanceof qI){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,Q3(this)}return so.prototype.remove.call(this,e)};_r.prototype.create=function(e,i,n){for(var r=new Pte.Service(e,i,n),s=0,a;s<this.methodsArray.length;++s){var o=Mm.lcFirst((a=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");r[o]=Mm.codegen(["r","c"],Mm.isReserved(o)?o+"_":o)("return this.rpcCall(m,q,s,r,c)")({m:a,q:a.resolvedRequestType.ctor,s:a.resolvedResponseType.ctor})}return r}});var Iv=x((Dxe,Z3)=>{"use strict";Z3.exports=Ts;var Fte=Ss();function Ts(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)this[e[i]]=t[e[i]]}Ts.create=function(e){return this.$type.create(e)};Ts.encode=function(e,i){return this.$type.encode(e,i)};Ts.encodeDelimited=function(e,i){return this.$type.encodeDelimited(e,i)};Ts.decode=function(e){return this.$type.decode(e)};Ts.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};Ts.verify=function(e){return this.$type.verify(e)};Ts.fromObject=function(e){return this.$type.fromObject(e)};Ts.toObject=function(e,i){return this.$type.toObject(e,i)};Ts.prototype.toJSON=function(){return this.$type.toObject(this,Fte.toJSONOptions)}});var HI=x((kxe,ez)=>{"use strict";ez.exports=Vte;var Lte=Vr(),ia=Fl(),J3=Di();function Bte(t){return"missing required '"+t.name+"'"}function Vte(t){var e=J3.codegen(["r","l"],t.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(t.fieldsArray.filter(function(o){return o.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");t.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var i=0;i<t.fieldsArray.length;++i){var n=t._fieldsArray[i].resolve(),r=n.resolvedType instanceof Lte?"int32":n.type,s="m"+J3.safeProp(n.name);e("case %i: {",n.id),n.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),ia.defaults[n.keyType]!==void 0?e("k=%j",ia.defaults[n.keyType]):e("k=null"),ia.defaults[r]!==void 0?e("value=%j",ia.defaults[r]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",n.keyType)("case 2:"),ia.basic[r]===void 0?e("value=types[%i].decode(r,r.uint32())",i):e("value=r.%s()",r),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),ia.long[n.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):n.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),ia.packed[r]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,r)("}else"),ia.basic[r]===void 0?e(n.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,i):e("%s.push(r.%s())",s,r)):ia.basic[r]===void 0?e(n.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,i):e("%s=r.%s()",s,r),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),i=0;i<t._fieldsArray.length;++i){var a=t._fieldsArray[i];a.required&&e("if(!m.hasOwnProperty(%j))",a.name)("throw util.ProtocolError(%j,{instance:m})",Bte(a))}return e("return m")}});var KI=x((Axe,tz)=>{"use strict";tz.exports=Ute;var jte=Vr(),WI=Di();function br(t,e){return t.name+": "+e+(t.repeated&&e!=="array"?"[]":t.map&&e!=="object"?"{k:"+t.keyType+"}":"")+" expected"}function GI(t,e,i,n){if(e.resolvedType)if(e.resolvedType instanceof jte){t("switch(%s){",n)("default:")("return%j",br(e,"enum value"));for(var r=Object.keys(e.resolvedType.values),s=0;s<r.length;++s)t("case %i:",e.resolvedType.values[r[s]]);t("break")("}")}else t("{")("var e=types[%i].verify(%s);",i,n)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.isInteger(%s))",n)("return%j",br(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",br(e,"integer|Long"));break;case"float":case"double":t('if(typeof %s!=="number")',n)("return%j",br(e,"number"));break;case"bool":t('if(typeof %s!=="boolean")',n)("return%j",br(e,"boolean"));break;case"string":t("if(!util.isString(%s))",n)("return%j",br(e,"string"));break;case"bytes":t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",br(e,"buffer"));break}return t}function zte(t,e,i){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.key32Re.test(%s))",i)("return%j",br(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.key64Re.test(%s))",i)("return%j",br(e,"integer|Long key"));break;case"bool":t("if(!util.key2Re.test(%s))",i)("return%j",br(e,"boolean key"));break}return t}function Ute(t){var e=WI.codegen(["m"],t.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),i=t.oneofsArray,n={};i.length&&e("var p={}");for(var r=0;r<t.fieldsArray.length;++r){var s=t._fieldsArray[r].resolve(),a="m"+WI.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",a,s.name),s.map)e("if(!util.isObject(%s))",a)("return%j",br(s,"object"))("var k=Object.keys(%s)",a)("for(var i=0;i<k.length;++i){"),zte(e,s,"k[i]"),GI(e,s,r,a+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",a)("return%j",br(s,"array"))("for(var i=0;i<%s.length;++i){",a),GI(e,s,r,a+"[i]")("}");else{if(s.partOf){var o=WI.safeProp(s.partOf.name);n[s.partOf.name]===1&&e("if(p%s===1)",o)("return%j",s.partOf.name+": multiple values"),n[s.partOf.name]=1,e("p%s=1",o)}GI(e,s,r,a)}s.optional&&e("}")}return e("return null")}});var QI=x(nz=>{"use strict";var iz=nz,Om=Vr(),Is=Di();function $I(t,e,i,n){var r=!1;if(e.resolvedType)if(e.resolvedType instanceof Om){t("switch(d%s){",n);for(var s=e.resolvedType.values,a=Object.keys(s),o=0;o<a.length;++o)s[a[o]]===e.typeDefault&&!r&&(t("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',n,n,n),e.repeated||t("break"),r=!0),t("case%j:",a[o])("case %i:",s[a[o]])("m%s=%j",n,s[a[o]])("break");t("}")}else t('if(typeof d%s!=="object")',n)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,i,n);else{var l=!1;switch(e.type){case"double":case"float":t("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":t("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":t("m%s=d%s|0",n,n);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,l)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,l?"true":"");break;case"bytes":t('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":t("m%s=String(d%s)",n,n);break;case"bool":t("m%s=Boolean(d%s)",n,n);break}}return t}iz.fromObject=function(e){var i=e.fieldsArray,n=Is.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!i.length)return n("return new this.ctor");n("var m=new this.ctor");for(var r=0;r<i.length;++r){var s=i[r].resolve(),a=Is.safeProp(s.name);s.map?(n("if(d%s){",a)('if(typeof d%s!=="object")',a)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",a)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",a),$I(n,s,r,a+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",a)("if(!Array.isArray(d%s))",a)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",a)("for(var i=0;i<d%s.length;++i){",a),$I(n,s,r,a+"[i]")("}")("}")):(s.resolvedType instanceof Om||n("if(d%s!=null){",a),$I(n,s,r,a),s.resolvedType instanceof Om||n("}"))}return n("return m")};function YI(t,e,i,n){if(e.resolvedType)e.resolvedType instanceof Om?t("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",n,i,n,n,i,n,n):t("d%s=types[%i].toObject(m%s,o)",n,i,n);else{var r=!1;switch(e.type){case"double":case"float":t("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":r=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,r?"true":"",n);break;case"bytes":t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:t("d%s=m%s",n,n);break}}return t}iz.toObject=function(e){var i=e.fieldsArray.slice().sort(Is.compareFieldsById);if(!i.length)return Is.codegen()("return {}");for(var n=Is.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],s=[],a=[],o=0;o<i.length;++o)i[o].partOf||(i[o].resolve().repeated?r:i[o].map?s:a).push(i[o]);if(r.length){for(n("if(o.arrays||o.defaults){"),o=0;o<r.length;++o)n("d%s=[]",Is.safeProp(r[o].name));n("}")}if(s.length){for(n("if(o.objects||o.defaults){"),o=0;o<s.length;++o)n("d%s={}",Is.safeProp(s[o].name));n("}")}if(a.length){for(n("if(o.defaults){"),o=0;o<a.length;++o){var l=a[o],c=Is.safeProp(l.name);if(l.resolvedType instanceof Om)n("d%s=o.enums===String?%j:%j",c,l.resolvedType.valuesById[l.typeDefault],l.typeDefault);else if(l.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,l.typeDefault.toString(),l.typeDefault.toNumber());else if(l.bytes){var d="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",c,d)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else n("d%s=%j",c,l.typeDefault)}n("}")}var u=!1;for(o=0;o<i.length;++o){var l=i[o],h=e._fieldsArray.indexOf(l),c=Is.safeProp(l.name);l.map?(u||(u=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),YI(n,l,h,c+"[ks2[j]]")("}")):l.repeated?(n("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),YI(n,l,h,c+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",c,l.name),YI(n,l,h,c),l.partOf&&n("if(o.oneofs)")("d%s=%j",Is.safeProp(l.partOf.name),l.name)),n("}")}return n("return d")}});var XI=x(rz=>{"use strict";var qte=rz,Hte=Iv();qte[".google.protobuf.Any"]={fromObject:function(t){if(t&&t["@type"]){var e=t["@type"].substring(t["@type"].lastIndexOf("/")+1),i=this.lookup(e);if(i){var n=t["@type"].charAt(0)==="."?t["@type"].slice(1):t["@type"];return n.indexOf("/")===-1&&(n="/"+n),this.create({type_url:n,value:i.encode(i.fromObject(t)).finish()})}}return this.fromObject(t)},toObject:function(t,e){var i="type.googleapis.com/",n="",r="";if(e&&e.json&&t.type_url&&t.value){r=t.type_url.substring(t.type_url.lastIndexOf("/")+1),n=t.type_url.substring(0,t.type_url.lastIndexOf("/")+1);var s=this.lookup(r);s&&(t=s.decode(t.value))}if(!(t instanceof this.ctor)&&t instanceof Hte){var a=t.$type.toObject(t,e),o=t.$type.fullName[0]==="."?t.$type.fullName.slice(1):t.$type.fullName;return n===""&&(n=i),r=n+o,a["@type"]=r,a}return this.toObject(t,e)}}});var Av=x((Oxe,az)=>{"use strict";az.exports=Et;var jr=Kd();((Et.prototype=Object.create(jr.prototype)).constructor=Et).className="Type";var Wte=Vr(),eD=Hd(),Dv=ro(),Gte=Sv(),Kte=Tv(),ZI=Iv(),JI=vv(),$te=_v(),$i=Di(),Yte=tD(),Qte=HI(),Xte=KI(),sz=QI(),Zte=XI();function Et(t,e){jr.call(this,t,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(Et.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var t=Object.keys(this.fields),e=0;e<t.length;++e){var i=this.fields[t[e]],n=i.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=i}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=$i.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=$i.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=Et.generateConstructor(this)())},set:function(t){var e=t.prototype;e instanceof ZI||((t.prototype=new ZI).constructor=t,$i.merge(t.prototype,e)),t.$type=t.prototype.$type=this,$i.merge(t,ZI,!0),this._ctor=t;for(var i=0;i<this.fieldsArray.length;++i)this._fieldsArray[i].resolve();var n={};for(i=0;i<this.oneofsArray.length;++i)n[this._oneofsArray[i].resolve().name]={get:$i.oneOfGetter(this._oneofsArray[i].oneof),set:$i.oneOfSetter(this._oneofsArray[i].oneof)};i&&Object.defineProperties(t.prototype,n)}}});Et.generateConstructor=function(e){for(var i=$i.codegen(["p"],e.name),n=0,r;n<e.fieldsArray.length;++n)(r=e._fieldsArray[n]).map?i("this%s={}",$i.safeProp(r.name)):r.repeated&&i("this%s=[]",$i.safeProp(r.name));return i("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function kv(t){return t._fieldsById=t._fieldsArray=t._oneofsArray=null,delete t.encode,delete t.decode,delete t.verify,t}Et.fromJSON=function(e,i){var n=new Et(e,i.options);n.extensions=i.extensions,n.reserved=i.reserved;for(var r=Object.keys(i.fields),s=0;s<r.length;++s)n.add((typeof i.fields[r[s]].keyType<"u"?Gte.fromJSON:Dv.fromJSON)(r[s],i.fields[r[s]]));if(i.oneofs)for(r=Object.keys(i.oneofs),s=0;s<r.length;++s)n.add(eD.fromJSON(r[s],i.oneofs[r[s]]));if(i.nested)for(r=Object.keys(i.nested),s=0;s<r.length;++s){var a=i.nested[r[s]];n.add((a.id!==void 0?Dv.fromJSON:a.fields!==void 0?Et.fromJSON:a.values!==void 0?Wte.fromJSON:a.methods!==void 0?Kte.fromJSON:jr.fromJSON)(r[s],a))}return i.extensions&&i.extensions.length&&(n.extensions=i.extensions),i.reserved&&i.reserved.length&&(n.reserved=i.reserved),i.group&&(n.group=!0),i.comment&&(n.comment=i.comment),n};Et.prototype.toJSON=function(e){var i=jr.prototype.toJSON.call(this,e),n=e?!!e.keepComments:!1;return $i.toObject(["options",i&&i.options||void 0,"oneofs",jr.arrayToJSON(this.oneofsArray,e),"fields",jr.arrayToJSON(this.fieldsArray.filter(function(r){return!r.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",i&&i.nested||void 0,"comment",n?this.comment:void 0])};Et.prototype.resolveAll=function(){for(var e=this.fieldsArray,i=0;i<e.length;)e[i++].resolve();var n=this.oneofsArray;for(i=0;i<n.length;)n[i++].resolve();return jr.prototype.resolveAll.call(this)};Et.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};Et.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof Dv&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),kv(this)}return e instanceof eD?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),kv(this)):jr.prototype.add.call(this,e)};Et.prototype.remove=function(e){if(e instanceof Dv&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),kv(this)}if(e instanceof eD){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),kv(this)}return jr.prototype.remove.call(this,e)};Et.prototype.isReservedId=function(e){return jr.isReservedId(this.reserved,e)};Et.prototype.isReservedName=function(e){return jr.isReservedName(this.reserved,e)};Et.prototype.create=function(e){return new this.ctor(e)};Et.prototype.setup=function(){for(var e=this.fullName,i=[],n=0;n<this.fieldsArray.length;++n)i.push(this._fieldsArray[n].resolve().resolvedType);this.encode=Yte(this)({Writer:$te,types:i,util:$i}),this.decode=Qte(this)({Reader:JI,types:i,util:$i}),this.verify=Xte(this)({types:i,util:$i}),this.fromObject=sz.fromObject(this)({types:i,util:$i}),this.toObject=sz.toObject(this)({types:i,util:$i});var r=Zte[e];if(r){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(s),s.toObject=this.toObject,this.toObject=r.toObject.bind(s)}return this};Et.prototype.encode=function(e,i){return this.setup().encode(e,i)};Et.prototype.encodeDelimited=function(e,i){return this.encode(e,i&&i.len?i.fork():i).ldelim()};Et.prototype.decode=function(e,i){return this.setup().decode(e,i)};Et.prototype.decodeDelimited=function(e){return e instanceof JI||(e=JI.create(e)),this.decode(e,e.uint32())};Et.prototype.verify=function(e){return this.setup().verify(e)};Et.prototype.fromObject=function(e){return this.setup().fromObject(e)};Et.prototype.toObject=function(e,i){return this.setup().toObject(e,i)};Et.d=function(e){return function(n){$i.decorateType(n,e)}}});var Ov=x((Nxe,uz)=>{"use strict";uz.exports=jn;var Mv=Kd();((jn.prototype=Object.create(Mv.prototype)).constructor=jn).className="Root";var nD=ro(),lz=Vr(),Jte=Hd(),ao=Di(),cz,iD,Nm;function jn(t){Mv.call(this,"",t),this.deferred=[],this.files=[]}jn.fromJSON=function(e,i){return i||(i=new jn),e.options&&i.setOptions(e.options),i.addJSON(e.nested)};jn.prototype.resolvePath=ao.path.resolve;jn.prototype.fetch=ao.fetch;function dz(){}jn.prototype.load=function t(e,i,n){typeof i=="function"&&(n=i,i=void 0);var r=this;if(!n)return ao.asPromise(t,r,e,i);var s=n===dz;function a(f,p){if(n){if(s)throw f;var v=n;n=null,v(f,p)}}function o(f){var p=f.lastIndexOf("google/protobuf/");if(p>-1){var v=f.substring(p);if(v in Nm)return v}return null}function l(f,p){try{if(ao.isString(p)&&p.charAt(0)==="{"&&(p=JSON.parse(p)),!ao.isString(p))r.setOptions(p.options).addJSON(p.nested);else{iD.filename=f;var v=iD(p,r,i),E,k=0;if(v.imports)for(;k<v.imports.length;++k)(E=o(v.imports[k])||r.resolvePath(f,v.imports[k]))&&c(E);if(v.weakImports)for(k=0;k<v.weakImports.length;++k)(E=o(v.weakImports[k])||r.resolvePath(f,v.weakImports[k]))&&c(E,!0)}}catch(I){a(I)}!s&&!d&&a(null,r)}function c(f,p){if(f=o(f)||f,!(r.files.indexOf(f)>-1)){if(r.files.push(f),f in Nm){s?l(f,Nm[f]):(++d,setTimeout(function(){--d,l(f,Nm[f])}));return}if(s){var v;try{v=ao.fs.readFileSync(f).toString("utf8")}catch(E){p||a(E);return}l(f,v)}else++d,r.fetch(f,function(E,k){if(--d,!!n){if(E){p?d||a(null,r):a(E);return}l(f,k)}})}}var d=0;ao.isString(e)&&(e=[e]);for(var u=0,h;u<e.length;++u)(h=r.resolvePath("",e[u]))&&c(h);if(s)return r;d||a(null,r)};jn.prototype.loadSync=function(e,i){if(!ao.isNode)throw Error("not supported");return this.load(e,i,dz)};jn.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return Mv.prototype.resolveAll.call(this)};var Rv=/^[A-Z]/;function oz(t,e){var i=e.parent.lookup(e.extend);if(i){var n=new nD(e.fullName,e.id,e.type,e.rule,void 0,e.options);return i.get(n.name)||(n.declaringField=e,e.extensionField=n,i.add(n)),!0}return!1}jn.prototype._handleAdd=function(e){if(e instanceof nD)e.extend!==void 0&&!e.extensionField&&(oz(this,e)||this.deferred.push(e));else if(e instanceof lz)Rv.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof Jte)){if(e instanceof cz)for(var i=0;i<this.deferred.length;)oz(this,this.deferred[i])?this.deferred.splice(i,1):++i;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);Rv.test(e.name)&&(e.parent[e.name]=e)}};jn.prototype._handleRemove=function(e){if(e instanceof nD){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var i=this.deferred.indexOf(e);i>-1&&this.deferred.splice(i,1)}}else if(e instanceof lz)Rv.test(e.name)&&delete e.parent[e.name];else if(e instanceof Mv){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);Rv.test(e.name)&&delete e.parent[e.name]}};jn._configure=function(t,e,i){cz=t,iD=e,Nm=i}});var Di=x((Pxe,fz)=>{"use strict";var Xt=fz.exports=Ss(),hz=NI(),rD,sD;Xt.codegen=R3();Xt.fetch=O3();Xt.path=F3();Xt.fs=Xt.inquire("fs");Xt.toArray=function(e){if(e){for(var i=Object.keys(e),n=new Array(i.length),r=0;r<i.length;)n[r]=e[i[r++]];return n}return[]};Xt.toObject=function(e){for(var i={},n=0;n<e.length;){var r=e[n++],s=e[n++];s!==void 0&&(i[r]=s)}return i};var eie=/\\/g,tie=/"/g;Xt.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};Xt.safeProp=function(e){return!/^[$\w_]+$/.test(e)||Xt.isReserved(e)?'["'+e.replace(eie,"\\\\").replace(tie,'\\"')+'"]':"."+e};Xt.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var iie=/_([a-z])/g;Xt.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(iie,function(i,n){return n.toUpperCase()})};Xt.compareFieldsById=function(e,i){return e.id-i.id};Xt.decorateType=function(e,i){if(e.$type)return i&&e.$type.name!==i&&(Xt.decorateRoot.remove(e.$type),e.$type.name=i,Xt.decorateRoot.add(e.$type)),e.$type;rD||(rD=Av());var n=new rD(i||e.name);return Xt.decorateRoot.add(n),n.ctor=e,Object.defineProperty(e,"$type",{value:n,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:n,enumerable:!1}),n};var nie=0;Xt.decorateEnum=function(e){if(e.$type)return e.$type;sD||(sD=Vr());var i=new sD("Enum"+nie++,e);return Xt.decorateRoot.add(i),Object.defineProperty(e,"$type",{value:i,enumerable:!1}),i};Xt.setProperty=function(e,i,n){function r(s,a,o){var l=a.shift();if(l==="__proto__"||l==="prototype")return s;if(a.length>0)s[l]=r(s[l]||{},a,o);else{var c=s[l];c&&(o=[].concat(c).concat(o)),s[l]=o}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!i)throw TypeError("path must be specified");return i=i.split("."),r(e,i,n)};Object.defineProperty(Xt,"decorateRoot",{get:function(){return hz.decorated||(hz.decorated=new(Ov()))}})});var Ll=x((Fxe,mz)=>{"use strict";mz.exports=zn;zn.className="ReflectionObject";var Nv=Di(),Pv;function zn(t,e){if(!Nv.isString(t))throw TypeError("name must be a string");if(e&&!Nv.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=t,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(zn.prototype,{root:{get:function(){for(var t=this;t.parent!==null;)t=t.parent;return t}},fullName:{get:function(){for(var t=[this.name],e=this.parent;e;)t.unshift(e.name),e=e.parent;return t.join(".")}}});zn.prototype.toJSON=function(){throw Error()};zn.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var i=e.root;i instanceof Pv&&i._handleAdd(this)};zn.prototype.onRemove=function(e){var i=e.root;i instanceof Pv&&i._handleRemove(this),this.parent=null,this.resolved=!1};zn.prototype.resolve=function(){return this.resolved?this:(this.root instanceof Pv&&(this.resolved=!0),this)};zn.prototype.getOption=function(e){if(this.options)return this.options[e]};zn.prototype.setOption=function(e,i,n){return(!n||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=i),this};zn.prototype.setParsedOption=function(e,i,n){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(n){var s=r.find(function(l){return Object.prototype.hasOwnProperty.call(l,e)});if(s){var a=s[e];Nv.setProperty(a,n,i)}else s={},s[e]=Nv.setProperty({},n,i),r.push(s)}else{var o={};o[e]=i,r.push(o)}return this};zn.prototype.setOptions=function(e,i){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],i);return this};zn.prototype.toString=function(){var e=this.constructor.className,i=this.fullName;return i.length?e+" "+i:e};zn._configure=function(t){Pv=t}});var Vr=x((Lxe,_z)=>{"use strict";_z.exports=Ds;var pz=Ll();((Ds.prototype=Object.create(pz.prototype)).constructor=Ds).className="Enum";var gz=Kd(),Fv=Di();function Ds(t,e,i,n,r,s){if(pz.call(this,t,i),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=n,this.comments=r||{},this.valuesOptions=s,this.reserved=void 0,e)for(var a=Object.keys(e),o=0;o<a.length;++o)typeof e[a[o]]=="number"&&(this.valuesById[this.values[a[o]]=e[a[o]]]=a[o])}Ds.fromJSON=function(e,i){var n=new Ds(e,i.values,i.options,i.comment,i.comments);return n.reserved=i.reserved,n};Ds.prototype.toJSON=function(e){var i=e?!!e.keepComments:!1;return Fv.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",i?this.comment:void 0,"comments",i?this.comments:void 0])};Ds.prototype.add=function(e,i,n,r){if(!Fv.isString(e))throw TypeError("name must be a string");if(!Fv.isInteger(i))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(i))throw Error("id "+i+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[i]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+i+" in "+this);this.values[e]=i}else this.valuesById[this.values[e]=i]=e;return r&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=r||null),this.comments[e]=n||null,this};Ds.prototype.remove=function(e){if(!Fv.isString(e))throw TypeError("name must be a string");var i=this.values[e];if(i==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[i],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};Ds.prototype.isReservedId=function(e){return gz.isReservedId(this.reserved,e)};Ds.prototype.isReservedName=function(e){return gz.isReservedName(this.reserved,e)}});var tD=x((Bxe,vz)=>{"use strict";vz.exports=sie;var rie=Vr(),aD=Fl(),oD=Di();function bz(t,e,i,n){return e.resolvedType.group?t("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",i,n,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):t("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",i,n,(e.id<<3|2)>>>0)}function sie(t){for(var e=oD.codegen(["m","w"],t.name+"$encode")("if(!w)")("w=Writer.create()"),i,n,r=t.fieldsArray.slice().sort(oD.compareFieldsById),i=0;i<r.length;++i){var s=r[i].resolve(),a=t._fieldsArray.indexOf(s),o=s.resolvedType instanceof rie?"int32":s.type,l=aD.basic[o];n="m"+oD.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",n,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",n)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|aD.mapKey[s.keyType],s.keyType),l===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",a,n):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|l,o,n),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",n,n),s.packed&&aD.packed[o]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",n)("w.%s(%s[i])",o,n)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",n),l===void 0?bz(e,s,a,n+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|l)>>>0,o,n)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",n,s.name),l===void 0?bz(e,s,a,n):e("w.uint32(%i).%s(%s)",(s.id<<3|l)>>>0,o,n))}return e("return w")}});var wz=x((Vxe,yz)=>{"use strict";var Ye=yz.exports=k3();Ye.build="light";function aie(t,e,i){return typeof e=="function"?(i=e,e=new Ye.Root):e||(e=new Ye.Root),e.load(t,i)}Ye.load=aie;function oie(t,e){return e||(e=new Ye.Root),e.loadSync(t)}Ye.loadSync=oie;Ye.encoder=tD();Ye.decoder=HI();Ye.verifier=KI();Ye.converter=QI();Ye.ReflectionObject=Ll();Ye.Namespace=Kd();Ye.Root=Ov();Ye.Enum=Vr();Ye.Type=Av();Ye.Field=ro();Ye.OneOf=Hd();Ye.MapField=Sv();Ye.Service=Tv();Ye.Method=xv();Ye.Message=Iv();Ye.wrappers=XI();Ye.types=Fl();Ye.util=Di();Ye.ReflectionObject._configure(Ye.Root);Ye.Namespace._configure(Ye.Type,Ye.Service,Ye.Enum);Ye.Root._configure(Ye.Type);Ye.Field._configure(Ye.Type)});var cD=x((jxe,Sz)=>{"use strict";Sz.exports=Ez;var lD=/[\s{}=;:[\],'"()<>]/g,lie=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,cie=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,die=/^ *[*/]+ */,uie=/^\s*\*?\/*/,hie=/\n/g,fie=/\s/,mie=/\\(.?)/g,pie={0:"\0",r:"\r",n:`
`,t:"	"};function Cz(t){return t.replace(mie,function(e,i){switch(i){case"\\":case"":return i;default:return pie[i]||""}})}Ez.unescape=Cz;function Ez(t,e){t=t.toString();var i=0,n=t.length,r=1,s=0,a={},o=[],l=null;function c(L){return Error("illegal "+L+" (line "+r+")")}function d(){var L=l==="'"?cie:lie;L.lastIndex=i-1;var te=L.exec(t);if(!te)throw c("string");return i=L.lastIndex,E(l),l=null,Cz(te[1])}function u(L){return t.charAt(L)}function h(L,te,Ee){var ze={type:t.charAt(L++),lineEmpty:!1,leading:Ee},hi;e?hi=2:hi=3;var Vi=L-hi,vt;do if(--Vi<0||(vt=t.charAt(Vi))===`
`){ze.lineEmpty=!0;break}while(vt===" "||vt==="	");for(var A=t.substring(L,te).split(hie),Vt=0;Vt<A.length;++Vt)A[Vt]=A[Vt].replace(e?uie:die,"").trim();ze.text=A.join(`
`).trim(),a[r]=ze,s=r}function f(L){var te=p(L),Ee=t.substring(L,te),ze=/^\s*\/\//.test(Ee);return ze}function p(L){for(var te=L;te<n&&u(te)!==`
`;)te++;return te}function v(){if(o.length>0)return o.shift();if(l)return d();var L,te,Ee,ze,hi,Vi=i===0;do{if(i===n)return null;for(L=!1;fie.test(Ee=u(i));)if(Ee===`
`&&(Vi=!0,++r),++i===n)return null;if(u(i)==="/"){if(++i===n)throw c("comment");if(u(i)==="/")if(e){if(ze=i,hi=!1,f(i-1)){hi=!0;do if(i=p(i),i===n||(i++,!Vi))break;while(f(i))}else i=Math.min(n,p(i)+1);hi&&(h(ze,i,Vi),Vi=!0),r++,L=!0}else{for(hi=u(ze=i+1)==="/";u(++i)!==`
`;)if(i===n)return null;++i,hi&&(h(ze,i-1,Vi),Vi=!0),++r,L=!0}else if((Ee=u(i))==="*"){ze=i+1,hi=e||u(ze)==="*";do{if(Ee===`
`&&++r,++i===n)throw c("comment");te=Ee,Ee=u(i)}while(te!=="*"||Ee!=="/");++i,hi&&(h(ze,i-2,Vi),Vi=!0),L=!0}else return"/"}}while(L);var vt=i;lD.lastIndex=0;var A=lD.test(u(vt++));if(!A)for(;vt<n&&!lD.test(u(vt));)++vt;var Vt=t.substring(i,i=vt);return(Vt==='"'||Vt==="'")&&(l=Vt),Vt}function E(L){o.push(L)}function k(){if(!o.length){var L=v();if(L===null)return null;E(L)}return o[0]}function I(L,te){var Ee=k(),ze=Ee===L;if(ze)return v(),!0;if(!te)throw c("token '"+Ee+"', '"+L+"' expected");return!1}function P(L){var te=null,Ee;return L===void 0?(Ee=a[r-1],delete a[r-1],Ee&&(e||Ee.type==="*"||Ee.lineEmpty)&&(te=Ee.leading?Ee.text:null)):(s<L&&k(),Ee=a[L],delete a[L],Ee&&!Ee.lineEmpty&&(e||Ee.type==="/")&&(te=Ee.leading?null:Ee.text)),te}return Object.defineProperty({next:v,peek:k,push:E,skip:I,cmnt:P},"line",{get:function(){return r}})}});var Az=x((zxe,kz)=>{"use strict";kz.exports=na;na.filename=null;na.defaults={keepCase:!1};var gie=cD(),xz=Ov(),Tz=Av(),Iz=ro(),_ie=Sv(),Dz=Hd(),bie=Vr(),vie=Tv(),yie=xv(),dD=Fl(),uD=Di(),wie=/^[1-9][0-9]*$/,Cie=/^-?[1-9][0-9]*$/,Eie=/^0[x][0-9a-fA-F]+$/,Sie=/^-?0[x][0-9a-fA-F]+$/,xie=/^0[0-7]+$/,Tie=/^-?0[0-7]+$/,Iie=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,ks=/^[a-zA-Z_][a-zA-Z_0-9]*$/,As=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,Die=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function na(t,e,i){e instanceof xz||(i=e,e=new xz),i||(i=na.defaults);var n=i.preferTrailingComment||!1,r=gie(t,i.alternateCommentMode||!1),s=r.next,a=r.push,o=r.peek,l=r.skip,c=r.cmnt,d=!0,u,h,f,p,v=!1,E=e,k=i.keepCase?function(M){return M}:uD.camelCase;function I(M,O,V){var ge=na.filename;return V||(na.filename=null),Error("illegal "+(O||"token")+" '"+M+"' ("+(ge?ge+", ":"")+"line "+r.line+")")}function P(){var M=[],O;do{if((O=s())!=='"'&&O!=="'")throw I(O);M.push(s()),l(O),O=o()}while(O==='"'||O==="'");return M.join("")}function L(M){var O=s();switch(O){case"'":case'"':return a(O),P();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return Ee(O,!0)}catch{if(M&&As.test(O))return O;throw I(O,"value")}}function te(M,O){var V,ge;do O&&((V=o())==='"'||V==="'")?M.push(P()):M.push([ge=ze(s()),l("to",!0)?ze(s()):ge]);while(l(",",!0));l(";")}function Ee(M,O){var V=1;switch(M.charAt(0)==="-"&&(V=-1,M=M.substring(1)),M){case"inf":case"INF":case"Inf":return V*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(wie.test(M))return V*parseInt(M,10);if(Eie.test(M))return V*parseInt(M,16);if(xie.test(M))return V*parseInt(M,8);if(Iie.test(M))return V*parseFloat(M);throw I(M,"number",O)}function ze(M,O){switch(M){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!O&&M.charAt(0)==="-")throw I(M,"id");if(Cie.test(M))return parseInt(M,10);if(Sie.test(M))return parseInt(M,16);if(Tie.test(M))return parseInt(M,8);throw I(M,"id")}function hi(){if(u!==void 0)throw I("package");if(u=s(),!As.test(u))throw I(u,"name");E=E.define(u),l(";")}function Vi(){var M=o(),O;switch(M){case"weak":O=f||(f=[]),s();break;case"public":s();default:O=h||(h=[]);break}M=P(),l(";"),O.push(M)}function vt(){if(l("="),p=P(),v=p==="proto3",!v&&p!=="proto2")throw I(p,"syntax");l(";")}function A(M,O){switch(O){case"option":return Tt(M,O),l(";"),!0;case"message":return R(M,O),!0;case"enum":return ut(M,O),!0;case"service":return ii(M,O),!0;case"extend":return wc(M,O),!0}return!1}function Vt(M,O,V){var ge=r.line;if(M&&(typeof M.comment!="string"&&(M.comment=c()),M.filename=na.filename),l("{",!0)){for(var me;(me=s())!=="}";)O(me);l(";",!0)}else V&&V(),l(";"),M&&(typeof M.comment!="string"||n)&&(M.comment=c(ge)||M.comment)}function R(M,O){if(!ks.test(O=s()))throw I(O,"type name");var V=new Tz(O);Vt(V,function(me){if(!A(V,me))switch(me){case"map":Ze(V,me);break;case"required":case"repeated":m(V,me);break;case"optional":v?m(V,"proto3_optional"):m(V,"optional");break;case"oneof":kt(V,me);break;case"extensions":te(V.extensions||(V.extensions=[]));break;case"reserved":te(V.reserved||(V.reserved=[]),!0);break;default:if(!v||!As.test(me))throw I(me);a(me),m(V,"optional");break}}),M.add(V)}function m(M,O,V){var ge=s();if(ge==="group"){W(M,O);return}for(;ge.endsWith(".")||o().startsWith(".");)ge+=s();if(!As.test(ge))throw I(ge,"type");var me=s();if(!ks.test(me))throw I(me,"name");me=k(me),l("=");var Ue=new Iz(me,ze(s()),ge,O,V);if(Vt(Ue,function(kn){if(kn==="option")Tt(Ue,kn),l(";");else throw I(kn)},function(){ji(Ue)}),O==="proto3_optional"){var Oi=new Dz("_"+me);Ue.setOption("proto3_optional",!0),Oi.add(Ue),M.add(Oi)}else M.add(Ue);!v&&Ue.repeated&&(dD.packed[ge]!==void 0||dD.basic[ge]===void 0)&&Ue.setOption("packed",!1,!0)}function W(M,O){var V=s();if(!ks.test(V))throw I(V,"name");var ge=uD.lcFirst(V);V===ge&&(V=uD.ucFirst(V)),l("=");var me=ze(s()),Ue=new Tz(V);Ue.group=!0;var Oi=new Iz(ge,me,V,O);Oi.filename=na.filename,Vt(Ue,function(kn){switch(kn){case"option":Tt(Ue,kn),l(";");break;case"required":case"repeated":m(Ue,kn);break;case"optional":v?m(Ue,"proto3_optional"):m(Ue,"optional");break;case"message":R(Ue,kn);break;case"enum":ut(Ue,kn);break;default:throw I(kn)}}),M.add(Ue).add(Oi)}function Ze(M){l("<");var O=s();if(dD.mapKey[O]===void 0)throw I(O,"type");l(",");var V=s();if(!As.test(V))throw I(V,"type");l(">");var ge=s();if(!ks.test(ge))throw I(ge,"name");l("=");var me=new _ie(k(ge),ze(s()),O,V);Vt(me,function(Oi){if(Oi==="option")Tt(me,Oi),l(";");else throw I(Oi)},function(){ji(me)}),M.add(me)}function kt(M,O){if(!ks.test(O=s()))throw I(O,"name");var V=new Dz(k(O));Vt(V,function(me){me==="option"?(Tt(V,me),l(";")):(a(me),m(V,"optional"))}),M.add(V)}function ut(M,O){if(!ks.test(O=s()))throw I(O,"name");var V=new bie(O);Vt(V,function(me){switch(me){case"option":Tt(V,me),l(";");break;case"reserved":te(V.reserved||(V.reserved=[]),!0);break;default:Gt(V,me)}}),M.add(V)}function Gt(M,O){if(!ks.test(O))throw I(O,"name");l("=");var V=ze(s(),!0),ge={options:void 0};ge.setOption=function(me,Ue){this.options===void 0&&(this.options={}),this.options[me]=Ue},Vt(ge,function(Ue){if(Ue==="option")Tt(ge,Ue),l(";");else throw I(Ue)},function(){ji(ge)}),M.add(O,V,ge.comment,ge.options)}function Tt(M,O){var V=l("(",!0);if(!As.test(O=s()))throw I(O,"name");var ge=O,me=ge,Ue;V&&(l(")"),ge="("+ge+")",me=ge,O=o(),Die.test(O)&&(Ue=O.slice(1),ge+=O,s())),l("=");var Oi=Ji(M,ge);jt(M,me,Oi,Ue)}function Ji(M,O){if(l("{",!0)){for(var V={};!l("}",!0);){if(!ks.test(zi=s()))throw I(zi,"name");if(zi===null)throw I(zi,"end of input");var ge,me=zi;if(l(":",!0),o()==="{")ge=Ji(M,O+"."+zi);else if(o()==="["){ge=[];var Ue;if(l("[",!0)){do Ue=L(!0),ge.push(Ue);while(l(",",!0));l("]"),typeof Ue<"u"&&ti(M,O+"."+zi,Ue)}}else ge=L(!0),ti(M,O+"."+zi,ge);var Oi=V[me];Oi&&(ge=[].concat(Oi).concat(ge)),V[me]=ge,l(",",!0),l(";",!0)}return V}var ba=L(!0);return ti(M,O,ba),ba}function ti(M,O,V){M.setOption&&M.setOption(O,V)}function jt(M,O,V,ge){M.setParsedOption&&M.setParsedOption(O,V,ge)}function ji(M){if(l("[",!0)){do Tt(M,"option");while(l(",",!0));l("]")}return M}function ii(M,O){if(!ks.test(O=s()))throw I(O,"service name");var V=new vie(O);Vt(V,function(me){if(!A(V,me))if(me==="rpc")en(V,me);else throw I(me)}),M.add(V)}function en(M,O){var V=c(),ge=O;if(!ks.test(O=s()))throw I(O,"name");var me=O,Ue,Oi,ba,kn;if(l("("),l("stream",!0)&&(Oi=!0),!As.test(O=s())||(Ue=O,l(")"),l("returns"),l("("),l("stream",!0)&&(kn=!0),!As.test(O=s())))throw I(O);ba=O,l(")");var Xp=new yie(me,ge,Ue,ba,Oi,kn);Xp.comment=V,Vt(Xp,function(hw){if(hw==="option")Tt(Xp,hw),l(";");else throw I(hw)}),M.add(Xp)}function wc(M,O){if(!As.test(O=s()))throw I(O,"reference");var V=O;Vt(null,function(me){switch(me){case"required":case"repeated":m(M,me,V);break;case"optional":v?m(M,"proto3_optional",V):m(M,"optional",V);break;default:if(!v||!As.test(me))throw I(me);a(me),m(M,"optional",V);break}})}for(var zi;(zi=s())!==null;)switch(zi){case"package":if(!d)throw I(zi);hi();break;case"import":if(!d)throw I(zi);Vi();break;case"syntax":if(!d)throw I(zi);vt();break;case"option":Tt(E,zi),l(";");break;default:if(A(E,zi)){d=!1;continue}throw I(zi)}return na.filename=null,{package:u,imports:h,weakImports:f,syntax:p,root:e}}});var Oz=x((Uxe,Mz)=>{"use strict";Mz.exports=zr;var kie=/\/|\./;function zr(t,e){kie.test(t)||(t="google/protobuf/"+t+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),zr[t]=e}zr("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var Rz;zr("duration",{Duration:Rz={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});zr("timestamp",{Timestamp:Rz});zr("empty",{Empty:{fields:{}}});zr("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});zr("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});zr("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});zr.get=function(e){return zr[e]||null}});var Pz=x((qxe,Nz)=>{"use strict";var oo=Nz.exports=wz();oo.build="full";oo.tokenize=cD();oo.parse=Az();oo.common=Oz();oo.Root._configure(oo.Type,oo.parse,oo.common)});var Lv=x((Hxe,Fz)=>{"use strict";Fz.exports=Pz()});var hD=x((Wxe,Aie)=>{Aie.exports={nested:{google:{nested:{protobuf:{nested:{FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}}}}}}}}});var zz=x((je,jz)=>{"use strict";var mn=Lv();jz.exports=je=mn.descriptor=mn.Root.fromJSON(hD()).lookup(".google.protobuf");var Lz=mn.Namespace,Pm=mn.Root,ra=mn.Enum,lo=mn.Type,co=mn.Field,Rie=mn.MapField,Bv=mn.OneOf,Fm=mn.Service,Vv=mn.Method;Pm.fromDescriptor=function(e){typeof e.length=="number"&&(e=je.FileDescriptorSet.decode(e));var i=new Pm;if(e.file)for(var n,r,s=0,a;s<e.file.length;++s){if(r=i,(n=e.file[s]).package&&n.package.length&&(r=i.define(n.package)),n.name&&n.name.length&&i.files.push(r.filename=n.name),n.messageType)for(a=0;a<n.messageType.length;++a)r.add(lo.fromDescriptor(n.messageType[a],n.syntax));if(n.enumType)for(a=0;a<n.enumType.length;++a)r.add(ra.fromDescriptor(n.enumType[a]));if(n.extension)for(a=0;a<n.extension.length;++a)r.add(co.fromDescriptor(n.extension[a]));if(n.service)for(a=0;a<n.service.length;++a)r.add(Fm.fromDescriptor(n.service[a]));var o=Yd(n.options,je.FileOptions);if(o){var l=Object.keys(o);for(a=0;a<l.length;++a)r.setOption(l[a],o[l[a]])}}return i};Pm.prototype.toDescriptor=function(e){var i=je.FileDescriptorSet.create();return Bz(this,i.file,e),i};function Bz(t,e,i){var n=je.FileDescriptorProto.create({name:t.filename||(t.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});i&&(n.syntax=i),t instanceof Pm||(n.package=t.fullName.substring(1));for(var r=0,s;r<t.nestedArray.length;++r)(s=t._nestedArray[r])instanceof lo?n.messageType.push(s.toDescriptor(i)):s instanceof ra?n.enumType.push(s.toDescriptor()):s instanceof co?n.extension.push(s.toDescriptor(i)):s instanceof Fm?n.service.push(s.toDescriptor()):s instanceof Lz&&Bz(s,e,i);n.options=Qd(t.options,je.FileOptions),n.messageType.length+n.enumType.length+n.extension.length+n.service.length&&e.push(n)}var Mie=0;lo.fromDescriptor=function(e,i){typeof e.length=="number"&&(e=je.DescriptorProto.decode(e));var n=new lo(e.name.length?e.name:"Type"+Mie++,Yd(e.options,je.MessageOptions)),r;if(e.oneofDecl)for(r=0;r<e.oneofDecl.length;++r)n.add(Bv.fromDescriptor(e.oneofDecl[r]));if(e.field)for(r=0;r<e.field.length;++r){var s=co.fromDescriptor(e.field[r],i);n.add(s),e.field[r].hasOwnProperty("oneofIndex")&&n.oneofsArray[e.field[r].oneofIndex].add(s)}if(e.extension)for(r=0;r<e.extension.length;++r)n.add(co.fromDescriptor(e.extension[r],i));if(e.nestedType)for(r=0;r<e.nestedType.length;++r)n.add(lo.fromDescriptor(e.nestedType[r],i)),e.nestedType[r].options&&e.nestedType[r].options.mapEntry&&n.setOption("map_entry",!0);if(e.enumType)for(r=0;r<e.enumType.length;++r)n.add(ra.fromDescriptor(e.enumType[r]));if(e.extensionRange&&e.extensionRange.length)for(n.extensions=[],r=0;r<e.extensionRange.length;++r)n.extensions.push([e.extensionRange[r].start,e.extensionRange[r].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(n.reserved=[],e.reservedRange)for(r=0;r<e.reservedRange.length;++r)n.reserved.push([e.reservedRange[r].start,e.reservedRange[r].end]);if(e.reservedName)for(r=0;r<e.reservedName.length;++r)n.reserved.push(e.reservedName[r])}return n};lo.prototype.toDescriptor=function(e){var i=je.DescriptorProto.create({name:this.name}),n;for(n=0;n<this.fieldsArray.length;++n){var r;if(i.field.push(r=this._fieldsArray[n].toDescriptor(e)),this._fieldsArray[n]instanceof Rie){var s=fD(this._fieldsArray[n].keyType,this._fieldsArray[n].resolvedKeyType),a=fD(this._fieldsArray[n].type,this._fieldsArray[n].resolvedType),o=a===11||a===14?this._fieldsArray[n].resolvedType&&Vz(this.parent,this._fieldsArray[n].resolvedType)||this._fieldsArray[n].type:void 0;i.nestedType.push(je.DescriptorProto.create({name:r.typeName,field:[je.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),je.FieldDescriptorProto.create({name:"value",number:2,label:1,type:a,typeName:o})],options:je.MessageOptions.create({mapEntry:!0})}))}}for(n=0;n<this.oneofsArray.length;++n)i.oneofDecl.push(this._oneofsArray[n].toDescriptor());for(n=0;n<this.nestedArray.length;++n)this._nestedArray[n]instanceof co?i.field.push(this._nestedArray[n].toDescriptor(e)):this._nestedArray[n]instanceof lo?i.nestedType.push(this._nestedArray[n].toDescriptor(e)):this._nestedArray[n]instanceof ra&&i.enumType.push(this._nestedArray[n].toDescriptor());if(this.extensions)for(n=0;n<this.extensions.length;++n)i.extensionRange.push(je.DescriptorProto.ExtensionRange.create({start:this.extensions[n][0],end:this.extensions[n][1]}));if(this.reserved)for(n=0;n<this.reserved.length;++n)typeof this.reserved[n]=="string"?i.reservedName.push(this.reserved[n]):i.reservedRange.push(je.DescriptorProto.ReservedRange.create({start:this.reserved[n][0],end:this.reserved[n][1]}));return i.options=Qd(this.options,je.MessageOptions),i};var Oie=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;co.fromDescriptor=function(e,i){if(typeof e.length=="number"&&(e=je.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var n;e.typeName&&e.typeName.length?n=e.typeName:n=Bie(e.type);var r;switch(e.label){case 1:r=void 0;break;case 2:r="required";break;case 3:r="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;e.extendee!==void 0&&(s=s.length?s:void 0);var a=new co(e.name.length?e.name:"field"+e.number,e.number,n,r,s);if(a.options=Yd(e.options,je.FieldOptions),e.defaultValue&&e.defaultValue.length){var o=e.defaultValue;switch(o){case"true":case"TRUE":o=!0;break;case"false":case"FALSE":o=!1;break;default:var l=Oie.exec(o);l&&(o=parseInt(o));break}a.setOption("default",o)}return Vie(e.type)&&(i==="proto3"?e.options&&!e.options.packed&&a.setOption("packed",!1):e.options&&e.options.packed||a.setOption("packed",!1)),a};co.prototype.toDescriptor=function(e){var i=je.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)i.type=11,i.typeName=mn.util.ucFirst(this.name),i.label=3;else{switch(i.type=fD(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:i.typeName=this.resolvedType?Vz(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":i.label=3;break;case"required":i.label=2;break;default:i.label=1;break}}if(i.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(i.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(i.options=Qd(this.options,je.FieldOptions),this.options.default!=null&&(i.defaultValue=String(this.options.default))),e==="proto3"?this.packed||((i.options||(i.options=je.FieldOptions.create())).packed=!1):this.packed&&((i.options||(i.options=je.FieldOptions.create())).packed=!0),i};var Nie=0;ra.fromDescriptor=function(e){typeof e.length=="number"&&(e=je.EnumDescriptorProto.decode(e));var i={};if(e.value)for(var n=0;n<e.value.length;++n){var r=e.value[n].name,s=e.value[n].number||0;i[r&&r.length?r:"NAME"+s]=s}return new ra(e.name&&e.name.length?e.name:"Enum"+Nie++,i,Yd(e.options,je.EnumOptions))};ra.prototype.toDescriptor=function(){for(var e=[],i=0,n=Object.keys(this.values);i<n.length;++i)e.push(je.EnumValueDescriptorProto.create({name:n[i],number:this.values[n[i]]}));return je.EnumDescriptorProto.create({name:this.name,value:e,options:Qd(this.options,je.EnumOptions)})};var Pie=0;Bv.fromDescriptor=function(e){return typeof e.length=="number"&&(e=je.OneofDescriptorProto.decode(e)),new Bv(e.name&&e.name.length?e.name:"oneof"+Pie++)};Bv.prototype.toDescriptor=function(){return je.OneofDescriptorProto.create({name:this.name})};var Fie=0;Fm.fromDescriptor=function(e){typeof e.length=="number"&&(e=je.ServiceDescriptorProto.decode(e));var i=new Fm(e.name&&e.name.length?e.name:"Service"+Fie++,Yd(e.options,je.ServiceOptions));if(e.method)for(var n=0;n<e.method.length;++n)i.add(Vv.fromDescriptor(e.method[n]));return i};Fm.prototype.toDescriptor=function(){for(var e=[],i=0;i<this.methodsArray.length;++i)e.push(this._methodsArray[i].toDescriptor());return je.ServiceDescriptorProto.create({name:this.name,method:e,options:Qd(this.options,je.ServiceOptions)})};var Lie=0;Vv.fromDescriptor=function(e){return typeof e.length=="number"&&(e=je.MethodDescriptorProto.decode(e)),new Vv(e.name&&e.name.length?e.name:"Method"+Lie++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,Yd(e.options,je.MethodOptions))};Vv.prototype.toDescriptor=function(){return je.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:Qd(this.options,je.MethodOptions)})};function Bie(t){switch(t){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+t)}function Vie(t){switch(t){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function fD(t,e){switch(t){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof ra)return 14;if(e instanceof lo)return e.group?10:11;throw Error("illegal type: "+t)}function Yd(t,e){if(t){for(var i=[],n=0,r,s,a;n<e.fieldsArray.length;++n)(s=(r=e._fieldsArray[n]).name)!=="uninterpretedOption"&&t.hasOwnProperty(s)&&(a=t[s],r.resolvedType instanceof ra&&typeof a=="number"&&r.resolvedType.valuesById[a]!==void 0&&(a=r.resolvedType.valuesById[a]),i.push(jie(s),a));return i.length?mn.util.toObject(i):void 0}}function Qd(t,e){if(t){for(var i=[],n=0,r=Object.keys(t),s,a;n<r.length;++n)if(a=t[s=r[n]],s!=="default"){var o=e.fields[s];!o&&!(o=e.fields[s=mn.util.camelCase(s)])||i.push(s,a)}return i.length?e.fromObject(mn.util.toObject(i)):void 0}}function Vz(t,e){var i=t.fullName.split("."),n=e.fullName.split("."),r=0,s=0,a=n.length-1;if(!(t instanceof Pm)&&e instanceof Lz)for(;r<i.length&&s<a&&i[r]===n[s];){var o=e.lookup(i[r++],!0);if(o!==null&&o!==e)break;++s}else for(;r<i.length&&s<a&&i[r]===n[s];++r,++s);return n.slice(s).join(".")}function jie(t){return t.substring(0,1)+t.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,i){return"_"+i.toLowerCase()})}});var Uz=x((Gxe,zie)=>{zie.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var qz=x((Kxe,Uie)=>{Uie.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var Hz=x(($xe,qie)=>{qie.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var $z=x(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.addCommonProtos=uo.loadProtosWithOptionsSync=uo.loadProtosWithOptions=void 0;var Wz=he("fs"),Gz=he("path"),Xd=Lv();function Kz(t,e){let i=t.resolvePath;t.resolvePath=(n,r)=>{if(Gz.isAbsolute(r))return r;for(let s of e){let a=Gz.join(s,r);try{return Wz.accessSync(a,Wz.constants.R_OK),a}catch{continue}}return process.emitWarning(`${r} not found in any of the include paths ${e}`),i(n,r)}}function Hie(t,e){return y(this,null,function*(){let i=new Xd.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));Kz(i,e.includeDirs)}let n=yield i.load(t,e);return n.resolveAll(),n})}uo.loadProtosWithOptions=Hie;function Wie(t,e){let i=new Xd.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");Kz(i,e.includeDirs)}let n=i.loadSync(t,e);return n.resolveAll(),n}uo.loadProtosWithOptionsSync=Wie;function Gie(){let t=Uz(),e=hD(),i=qz(),n=Hz();Xd.common("api",t.nested.google.nested.protobuf.nested),Xd.common("descriptor",e.nested.google.nested.protobuf.nested),Xd.common("source_context",i.nested.google.nested.protobuf.nested),Xd.common("type",n.nested.google.nested.protobuf.nested)}uo.addCommonProtos=Gie});var Xz=x((Qz,mD)=>{"use strict";var Yz=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function i(R,m,W){this.low=R|0,this.high=m|0,this.unsigned=!!W}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0});function n(R){return(R&&R.__isLong__)===!0}function r(R){var m=Math.clz32(R&-R);return R?31-m:m}i.isLong=n;var s={},a={};function o(R,m){var W,Ze,kt;return m?(R>>>=0,(kt=0<=R&&R<256)&&(Ze=a[R],Ze)?Ze:(W=c(R,0,!0),kt&&(a[R]=W),W)):(R|=0,(kt=-128<=R&&R<128)&&(Ze=s[R],Ze)?Ze:(W=c(R,R<0?-1:0,!1),kt&&(s[R]=W),W))}i.fromInt=o;function l(R,m){if(isNaN(R))return m?L:P;if(m){if(R<0)return L;if(R>=E)return Vi}else{if(R<=-k)return vt;if(R+1>=k)return hi}return R<0?l(-R,m).neg():c(R%v|0,R/v|0,m)}i.fromNumber=l;function c(R,m,W){return new i(R,m,W)}i.fromBits=c;var d=Math.pow;function u(R,m,W){if(R.length===0)throw Error("empty string");if(typeof m=="number"?(W=m,m=!1):m=!!m,R==="NaN"||R==="Infinity"||R==="+Infinity"||R==="-Infinity")return m?L:P;if(W=W||10,W<2||36<W)throw RangeError("radix");var Ze;if((Ze=R.indexOf("-"))>0)throw Error("interior hyphen");if(Ze===0)return u(R.substring(1),m,W).neg();for(var kt=l(d(W,8)),ut=P,Gt=0;Gt<R.length;Gt+=8){var Tt=Math.min(8,R.length-Gt),Ji=parseInt(R.substring(Gt,Gt+Tt),W);if(Tt<8){var ti=l(d(W,Tt));ut=ut.mul(ti).add(l(Ji))}else ut=ut.mul(kt),ut=ut.add(l(Ji))}return ut.unsigned=m,ut}i.fromString=u;function h(R,m){return typeof R=="number"?l(R,m):typeof R=="string"?u(R,m):c(R.low,R.high,typeof m=="boolean"?m:R.unsigned)}i.fromValue=h;var f=65536,p=1<<24,v=f*f,E=v*v,k=E/2,I=o(p),P=o(0);i.ZERO=P;var L=o(0,!0);i.UZERO=L;var te=o(1);i.ONE=te;var Ee=o(1,!0);i.UONE=Ee;var ze=o(-1);i.NEG_ONE=ze;var hi=c(-1,2147483647,!1);i.MAX_VALUE=hi;var Vi=c(-1,-1,!0);i.MAX_UNSIGNED_VALUE=Vi;var vt=c(0,-2147483648,!1);i.MIN_VALUE=vt;var A=i.prototype;A.toInt=function(){return this.unsigned?this.low>>>0:this.low},A.toNumber=function(){return this.unsigned?(this.high>>>0)*v+(this.low>>>0):this.high*v+(this.low>>>0)},A.toString=function(m){if(m=m||10,m<2||36<m)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(vt)){var W=l(m),Ze=this.div(W),kt=Ze.mul(W).sub(this);return Ze.toString(m)+kt.toInt().toString(m)}else return"-"+this.neg().toString(m);for(var ut=l(d(m,6),this.unsigned),Gt=this,Tt="";;){var Ji=Gt.div(ut),ti=Gt.sub(Ji.mul(ut)).toInt()>>>0,jt=ti.toString(m);if(Gt=Ji,Gt.isZero())return jt+Tt;for(;jt.length<6;)jt="0"+jt;Tt=""+jt+Tt}},A.getHighBits=function(){return this.high},A.getHighBitsUnsigned=function(){return this.high>>>0},A.getLowBits=function(){return this.low},A.getLowBitsUnsigned=function(){return this.low>>>0},A.getNumBitsAbs=function(){if(this.isNegative())return this.eq(vt)?64:this.neg().getNumBitsAbs();for(var m=this.high!=0?this.high:this.low,W=31;W>0&&!(m&1<<W);W--);return this.high!=0?W+33:W+1},A.isZero=function(){return this.high===0&&this.low===0},A.eqz=A.isZero,A.isNegative=function(){return!this.unsigned&&this.high<0},A.isPositive=function(){return this.unsigned||this.high>=0},A.isOdd=function(){return(this.low&1)===1},A.isEven=function(){return(this.low&1)===0},A.equals=function(m){return n(m)||(m=h(m)),this.unsigned!==m.unsigned&&this.high>>>31===1&&m.high>>>31===1?!1:this.high===m.high&&this.low===m.low},A.eq=A.equals,A.notEquals=function(m){return!this.eq(m)},A.neq=A.notEquals,A.ne=A.notEquals,A.lessThan=function(m){return this.comp(m)<0},A.lt=A.lessThan,A.lessThanOrEqual=function(m){return this.comp(m)<=0},A.lte=A.lessThanOrEqual,A.le=A.lessThanOrEqual,A.greaterThan=function(m){return this.comp(m)>0},A.gt=A.greaterThan,A.greaterThanOrEqual=function(m){return this.comp(m)>=0},A.gte=A.greaterThanOrEqual,A.ge=A.greaterThanOrEqual,A.compare=function(m){if(n(m)||(m=h(m)),this.eq(m))return 0;var W=this.isNegative(),Ze=m.isNegative();return W&&!Ze?-1:!W&&Ze?1:this.unsigned?m.high>>>0>this.high>>>0||m.high===this.high&&m.low>>>0>this.low>>>0?-1:1:this.sub(m).isNegative()?-1:1},A.comp=A.compare,A.negate=function(){return!this.unsigned&&this.eq(vt)?vt:this.not().add(te)},A.neg=A.negate,A.add=function(m){n(m)||(m=h(m));var W=this.high>>>16,Ze=this.high&65535,kt=this.low>>>16,ut=this.low&65535,Gt=m.high>>>16,Tt=m.high&65535,Ji=m.low>>>16,ti=m.low&65535,jt=0,ji=0,ii=0,en=0;return en+=ut+ti,ii+=en>>>16,en&=65535,ii+=kt+Ji,ji+=ii>>>16,ii&=65535,ji+=Ze+Tt,jt+=ji>>>16,ji&=65535,jt+=W+Gt,jt&=65535,c(ii<<16|en,jt<<16|ji,this.unsigned)},A.subtract=function(m){return n(m)||(m=h(m)),this.add(m.neg())},A.sub=A.subtract,A.multiply=function(m){if(this.isZero())return this;if(n(m)||(m=h(m)),e){var W=e.mul(this.low,this.high,m.low,m.high);return c(W,e.get_high(),this.unsigned)}if(m.isZero())return this.unsigned?L:P;if(this.eq(vt))return m.isOdd()?vt:P;if(m.eq(vt))return this.isOdd()?vt:P;if(this.isNegative())return m.isNegative()?this.neg().mul(m.neg()):this.neg().mul(m).neg();if(m.isNegative())return this.mul(m.neg()).neg();if(this.lt(I)&&m.lt(I))return l(this.toNumber()*m.toNumber(),this.unsigned);var Ze=this.high>>>16,kt=this.high&65535,ut=this.low>>>16,Gt=this.low&65535,Tt=m.high>>>16,Ji=m.high&65535,ti=m.low>>>16,jt=m.low&65535,ji=0,ii=0,en=0,wc=0;return wc+=Gt*jt,en+=wc>>>16,wc&=65535,en+=ut*jt,ii+=en>>>16,en&=65535,en+=Gt*ti,ii+=en>>>16,en&=65535,ii+=kt*jt,ji+=ii>>>16,ii&=65535,ii+=ut*ti,ji+=ii>>>16,ii&=65535,ii+=Gt*Ji,ji+=ii>>>16,ii&=65535,ji+=Ze*jt+kt*ti+ut*Ji+Gt*Tt,ji&=65535,c(en<<16|wc,ji<<16|ii,this.unsigned)},A.mul=A.multiply,A.divide=function(m){if(n(m)||(m=h(m)),m.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&m.low===-1&&m.high===-1)return this;var W=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,m.low,m.high);return c(W,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?L:P;var Ze,kt,ut;if(this.unsigned){if(m.unsigned||(m=m.toUnsigned()),m.gt(this))return L;if(m.gt(this.shru(1)))return Ee;ut=L}else{if(this.eq(vt)){if(m.eq(te)||m.eq(ze))return vt;if(m.eq(vt))return te;var Gt=this.shr(1);return Ze=Gt.div(m).shl(1),Ze.eq(P)?m.isNegative()?te:ze:(kt=this.sub(m.mul(Ze)),ut=Ze.add(kt.div(m)),ut)}else if(m.eq(vt))return this.unsigned?L:P;if(this.isNegative())return m.isNegative()?this.neg().div(m.neg()):this.neg().div(m).neg();if(m.isNegative())return this.div(m.neg()).neg();ut=P}for(kt=this;kt.gte(m);){Ze=Math.max(1,Math.floor(kt.toNumber()/m.toNumber()));for(var Tt=Math.ceil(Math.log(Ze)/Math.LN2),Ji=Tt<=48?1:d(2,Tt-48),ti=l(Ze),jt=ti.mul(m);jt.isNegative()||jt.gt(kt);)Ze-=Ji,ti=l(Ze,this.unsigned),jt=ti.mul(m);ti.isZero()&&(ti=te),ut=ut.add(ti),kt=kt.sub(jt)}return ut},A.div=A.divide,A.modulo=function(m){if(n(m)||(m=h(m)),e){var W=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,m.low,m.high);return c(W,e.get_high(),this.unsigned)}return this.sub(this.div(m).mul(m))},A.mod=A.modulo,A.rem=A.modulo,A.not=function(){return c(~this.low,~this.high,this.unsigned)},A.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},A.clz=A.countLeadingZeros,A.countTrailingZeros=function(){return this.low?r(this.low):r(this.high)+32},A.ctz=A.countTrailingZeros,A.and=function(m){return n(m)||(m=h(m)),c(this.low&m.low,this.high&m.high,this.unsigned)},A.or=function(m){return n(m)||(m=h(m)),c(this.low|m.low,this.high|m.high,this.unsigned)},A.xor=function(m){return n(m)||(m=h(m)),c(this.low^m.low,this.high^m.high,this.unsigned)},A.shiftLeft=function(m){return n(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?c(this.low<<m,this.high<<m|this.low>>>32-m,this.unsigned):c(0,this.low<<m-32,this.unsigned)},A.shl=A.shiftLeft,A.shiftRight=function(m){return n(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?c(this.low>>>m|this.high<<32-m,this.high>>m,this.unsigned):c(this.high>>m-32,this.high>=0?0:-1,this.unsigned)},A.shr=A.shiftRight,A.shiftRightUnsigned=function(m){return n(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?c(this.low>>>m|this.high<<32-m,this.high>>>m,this.unsigned):m===32?c(this.high,0,this.unsigned):c(this.high>>>m-32,0,this.unsigned)},A.shru=A.shiftRightUnsigned,A.shr_u=A.shiftRightUnsigned,A.rotateLeft=function(m){var W;return n(m)&&(m=m.toInt()),(m&=63)===0?this:m===32?c(this.high,this.low,this.unsigned):m<32?(W=32-m,c(this.low<<m|this.high>>>W,this.high<<m|this.low>>>W,this.unsigned)):(m-=32,W=32-m,c(this.high<<m|this.low>>>W,this.low<<m|this.high>>>W,this.unsigned))},A.rotl=A.rotateLeft,A.rotateRight=function(m){var W;return n(m)&&(m=m.toInt()),(m&=63)===0?this:m===32?c(this.high,this.low,this.unsigned):m<32?(W=32-m,c(this.high<<W|this.low>>>m,this.low<<W|this.high>>>m,this.unsigned)):(m-=32,W=32-m,c(this.low<<W|this.high>>>m,this.high<<W|this.low>>>m,this.unsigned))},A.rotr=A.rotateRight,A.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},A.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},A.toBytes=function(m){return m?this.toBytesLE():this.toBytesBE()},A.toBytesLE=function(){var m=this.high,W=this.low;return[W&255,W>>>8&255,W>>>16&255,W>>>24,m&255,m>>>8&255,m>>>16&255,m>>>24]},A.toBytesBE=function(){var m=this.high,W=this.low;return[m>>>24,m>>>16&255,m>>>8&255,m&255,W>>>24,W>>>16&255,W>>>8&255,W&255]},i.fromBytes=function(m,W,Ze){return Ze?i.fromBytesLE(m,W):i.fromBytesBE(m,W)},i.fromBytesLE=function(m,W){return new i(m[0]|m[1]<<8|m[2]<<16|m[3]<<24,m[4]|m[5]<<8|m[6]<<16|m[7]<<24,W)},i.fromBytesBE=function(m,W){return new i(m[4]<<24|m[5]<<16|m[6]<<8|m[7],m[0]<<24|m[1]<<16|m[2]<<8|m[3],W)};var Vt=i;return t.default=Vt,"default"in t?t.default:t}({});typeof define=="function"&&define.amd?define([],function(){return Yz}):typeof mD=="object"&&typeof Qz=="object"&&(mD.exports=Yz)});var bD=x(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.loadFileDescriptorSetFromObject=Yi.loadFileDescriptorSetFromBuffer=Yi.fromJSON=Yi.loadSync=Yi.load=Yi.isAnyExtension=Yi.Long=void 0;var Kie=Bj(),Rs=Lv(),gD=zz(),_D=$z(),$ie=Xz();Yi.Long=$ie;function Yie(t){return"@type"in t&&typeof t["@type"]=="string"}Yi.isAnyExtension=Yie;var e4={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function Qie(t,e){return t===""?e:t+"."+e}function Xie(t){return t instanceof Rs.Service||t instanceof Rs.Type||t instanceof Rs.Enum}function Zie(t){return t instanceof Rs.Namespace||t instanceof Rs.Root}function t4(t,e){let i=Qie(e,t.name);return Xie(t)?[[i,t]]:Zie(t)&&typeof t.nested<"u"?Object.keys(t.nested).map(n=>t4(t.nested[n],i)).reduce((n,r)=>n.concat(r),[]):[]}function Zz(t,e){return function(n){return t.toObject(t.decode(n),e)}}function Jz(t){return function(i){if(Array.isArray(i))throw new Error(`Failed to serialize message: expected object with ${t.name} structure, got array instead`);let n=t.fromObject(i);return t.encode(n).finish()}}function Jie(t,e,i,n){let r=t.resolvedRequestType,s=t.resolvedResponseType;return{path:"/"+e+"/"+t.name,requestStream:!!t.requestStream,responseStream:!!t.responseStream,requestSerialize:Jz(r),requestDeserialize:Zz(r,i),responseSerialize:Jz(s),responseDeserialize:Zz(s,i),originalName:Kie(t.name),requestType:pD(r,n),responseType:pD(s,n)}}function ene(t,e,i,n){let r={};for(let s of t.methodsArray)r[s.name]=Jie(s,e,i,n);return r}function pD(t,e){let i=t.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:i.$type.toObject(i,e4),fileDescriptorProtos:e}}function tne(t,e){let i=t.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:i.$type.toObject(i,e4),fileDescriptorProtos:e}}function ine(t,e,i,n){if(t instanceof Rs.Service)return ene(t,e,i,n);if(t instanceof Rs.Type)return pD(t,n);if(t instanceof Rs.Enum)return tne(t,n);throw new Error("Type mismatch in reflection object handling")}function jv(t,e){let i={};t.resolveAll();let r=t.toDescriptor("proto3").file.map(s=>Buffer.from(gD.FileDescriptorProto.encode(s).finish()));for(let[s,a]of t4(t,""))i[s]=ine(a,s,e,r);return i}function i4(t,e){e=e||{};let i=Rs.Root.fromDescriptor(t);return i.resolveAll(),jv(i,e)}function nne(t,e){return(0,_D.loadProtosWithOptions)(t,e).then(i=>jv(i,e))}Yi.load=nne;function rne(t,e){let i=(0,_D.loadProtosWithOptionsSync)(t,e);return jv(i,e)}Yi.loadSync=rne;function sne(t,e){e=e||{};let i=Rs.Root.fromJSON(t);return i.resolveAll(),jv(i,e)}Yi.fromJSON=sne;function ane(t,e){let i=gD.FileDescriptorSet.decode(t);return i4(i,e)}Yi.loadFileDescriptorSetFromBuffer=ane;function one(t,e){let i=gD.FileDescriptorSet.fromObject(t);return i4(i,e)}Yi.loadFileDescriptorSetFromObject=one;(0,_D.addCommonProtos)()});var Vl=x(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.setup=Ot.getChannelzServiceDefinition=Ot.getChannelzHandlers=Ot.unregisterChannelzRef=Ot.registerChannelzSocket=Ot.registerChannelzServer=Ot.registerChannelzSubchannel=Ot.registerChannelzChannel=Ot.ChannelzCallTracker=Ot.ChannelzChildrenTracker=Ot.ChannelzTrace=void 0;var n4=he("net"),Lm=dr(),Vm=st(),lne=Cs(),cne=ov(),dne=pI();function vD(t){return{channel_id:t.id,name:t.name}}function ED(t){return{subchannel_id:t.id,name:t.name}}function une(t){return{server_id:t.id}}function Uv(t){return{socket_id:t.id,name:t.name}}var r4=32,yD=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,i,n){let r=new Date;this.events.push({description:i,severity:e,timestamp:r,childChannel:n?.kind==="channel"?n:void 0,childSubchannel:n?.kind==="subchannel"?n:void 0}),this.events.length>=r4*2&&(this.events=this.events.slice(r4)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:sa(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:sa(e.timestamp),channel_ref:e.childChannel?vD(e.childChannel):null,subchannel_ref:e.childSubchannel?ED(e.childSubchannel):null}))}}};Ot.ChannelzTrace=yD;var wD=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var i,n,r;switch(e.kind){case"channel":{let s=(i=this.channelChildren.get(e.id))!==null&&i!==void 0?i:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(n=this.subchannelChildren.get(e.id))!==null&&n!==void 0?n:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(r=this.socketChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let i=this.channelChildren.get(e.id);i!==void 0&&(i.count-=1,i.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,i));break}case"subchannel":{let i=this.subchannelChildren.get(e.id);i!==void 0&&(i.count-=1,i.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,i));break}case"socket":{let i=this.socketChildren.get(e.id);i!==void 0&&(i.count-=1,i.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,i));break}}}getChildLists(){let e=[];for(let{ref:r}of this.channelChildren.values())e.push(r);let i=[];for(let{ref:r}of this.subchannelChildren.values())i.push(r);let n=[];for(let{ref:r}of this.socketChildren.values())n.push(r);return{channels:e,subchannels:i,sockets:n}}};Ot.ChannelzChildrenTracker=wD;var CD=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};Ot.ChannelzCallTracker=CD;var hne=1;function qv(){return hne++}var Bm=[],SD=[],ho=[],xD=[];function fne(t,e,i){let n=qv(),r={id:n,name:t,kind:"channel"};return i&&(Bm[n]={ref:r,getInfo:e}),r}Ot.registerChannelzChannel=fne;function mne(t,e,i){let n=qv(),r={id:n,name:t,kind:"subchannel"};return i&&(SD[n]={ref:r,getInfo:e}),r}Ot.registerChannelzSubchannel=mne;function pne(t,e){let i=qv(),n={id:i,kind:"server"};return e&&(ho[i]={ref:n,getInfo:t}),n}Ot.registerChannelzServer=pne;function gne(t,e,i){let n=qv(),r={id:n,name:t,kind:"socket"};return i&&(xD[n]={ref:r,getInfo:e}),r}Ot.registerChannelzSocket=gne;function _ne(t){switch(t.kind){case"channel":delete Bm[t.id];return;case"subchannel":delete SD[t.id];return;case"server":delete ho[t.id];return;case"socket":delete xD[t.id];return}}Ot.unregisterChannelzRef=_ne;function bne(t){let e=Number.parseInt(t,16);return[e/256|0,e%256]}function s4(t){if(t==="")return[];let e=t.split(":").map(n=>bne(n));return[].concat(...e)}function vne(t){if((0,n4.isIPv4)(t))return Buffer.from(Uint8Array.from(t.split(".").map(e=>Number.parseInt(e))));if((0,n4.isIPv6)(t)){let e,i,n=t.indexOf("::");n===-1?(e=t,i=""):(e=t.substring(0,n),i=t.substring(n+2));let r=Buffer.from(s4(e)),s=Buffer.from(s4(i)),a=Buffer.alloc(16-r.length-s.length,0);return Buffer.concat([r,a,s])}else return null}function o4(t){switch(t){case Lm.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case Lm.ConnectivityState.IDLE:return{state:"IDLE"};case Lm.ConnectivityState.READY:return{state:"READY"};case Lm.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case Lm.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function sa(t){if(!t)return null;let e=t.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function l4(t){let e=t.getInfo();return{ref:vD(t.ref),data:{target:e.target,state:o4(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:sa(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(i=>vD(i)),subchannel_ref:e.children.subchannels.map(i=>ED(i))}}function yne(t,e){let i=Number.parseInt(t.request.channel_id),n=Bm[i];if(n===void 0){e({code:Vm.Status.NOT_FOUND,details:"No channel data found for id "+i});return}e(null,{channel:l4(n)})}function wne(t,e){let i=Number.parseInt(t.request.max_results),n=[],r=Number.parseInt(t.request.start_channel_id);for(;r<Bm.length;r++){let s=Bm[r];if(s!==void 0&&(n.push(l4(s)),n.length>=i))break}e(null,{channel:n,end:r>=ho.length})}function c4(t){let e=t.getInfo();return{ref:une(t.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:sa(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(i=>Uv(i))}}function Cne(t,e){let i=Number.parseInt(t.request.server_id),n=ho[i];if(n===void 0){e({code:Vm.Status.NOT_FOUND,details:"No server data found for id "+i});return}e(null,{server:c4(n)})}function Ene(t,e){let i=Number.parseInt(t.request.max_results),n=[],r=Number.parseInt(t.request.start_server_id);for(;r<ho.length;r++){let s=ho[r];if(s!==void 0&&(n.push(c4(s)),n.length>=i))break}e(null,{server:n,end:r>=ho.length})}function Sne(t,e){let i=Number.parseInt(t.request.subchannel_id),n=SD[i];if(n===void 0){e({code:Vm.Status.NOT_FOUND,details:"No subchannel data found for id "+i});return}let r=n.getInfo(),s={ref:ED(n.ref),data:{target:r.target,state:o4(r.state),calls_started:r.callTracker.callsStarted,calls_succeeded:r.callTracker.callsSucceeded,calls_failed:r.callTracker.callsFailed,last_call_started_timestamp:sa(r.callTracker.lastCallStartedTimestamp),trace:r.trace.getTraceMessage()},socket_ref:r.children.sockets.map(a=>Uv(a))};e(null,{subchannel:s})}function a4(t){var e;return(0,lne.isTcpSubchannelAddress)(t)?{address:"tcpip_address",tcpip_address:{ip_address:(e=vne(t.host))!==null&&e!==void 0?e:void 0,port:t.port}}:{address:"uds_address",uds_address:{filename:t.path}}}function xne(t,e){var i,n,r,s,a;let o=Number.parseInt(t.request.socket_id),l=xD[o];if(l===void 0){e({code:Vm.Status.NOT_FOUND,details:"No socket data found for id "+o});return}let c=l.getInfo(),d=c.security?{model:"tls",tls:{cipher_suite:c.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(i=c.security.cipherSuiteStandardName)!==null&&i!==void 0?i:void 0,other_name:(n=c.security.cipherSuiteOtherName)!==null&&n!==void 0?n:void 0,local_certificate:(r=c.security.localCertificate)!==null&&r!==void 0?r:void 0,remote_certificate:(s=c.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,u={ref:Uv(l.ref),local:c.localAddress?a4(c.localAddress):null,remote:c.remoteAddress?a4(c.remoteAddress):null,remote_name:(a=c.remoteName)!==null&&a!==void 0?a:void 0,security:d,data:{keep_alives_sent:c.keepAlivesSent,streams_started:c.streamsStarted,streams_succeeded:c.streamsSucceeded,streams_failed:c.streamsFailed,last_local_stream_created_timestamp:sa(c.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:sa(c.lastRemoteStreamCreatedTimestamp),messages_received:c.messagesReceived,messages_sent:c.messagesSent,last_message_received_timestamp:sa(c.lastMessageReceivedTimestamp),last_message_sent_timestamp:sa(c.lastMessageSentTimestamp),local_flow_control_window:c.localFlowControlWindow?{value:c.localFlowControlWindow}:null,remote_flow_control_window:c.remoteFlowControlWindow?{value:c.remoteFlowControlWindow}:null}};e(null,{socket:u})}function Tne(t,e){let i=Number.parseInt(t.request.server_id),n=ho[i];if(n===void 0){e({code:Vm.Status.NOT_FOUND,details:"No server data found for id "+i});return}let r=Number.parseInt(t.request.start_socket_id),s=Number.parseInt(t.request.max_results),o=n.getInfo().sessionChildren.sockets.sort((d,u)=>d.id-u.id),l=[],c=0;for(;c<o.length&&!(o[c].id>=r&&(l.push(Uv(o[c])),l.length>=s));c++);e(null,{socket_ref:l,end:c>=o.length})}function d4(){return{GetChannel:yne,GetTopChannels:wne,GetServer:Cne,GetServers:Ene,GetSubchannel:Sne,GetSocket:xne,GetServerSockets:Tne}}Ot.getChannelzHandlers=d4;var zv=null;function u4(){if(zv)return zv;let t=bD().loadSync,e=t("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return zv=(0,dne.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,zv}Ot.getChannelzServiceDefinition=u4;function Ine(){(0,cne.registerAdminService)(u4,d4)}Ot.setup=Ine});var h4=x(Wv=>{"use strict";Object.defineProperty(Wv,"__esModule",{value:!0});Wv.Subchannel=void 0;var St=dr(),Dne=bm(),TD=qt(),Hv=st(),kne=Vn(),Ane=Cs(),Zd=Vl(),Rne="subchannel",Mne=~(1<<31),ID=class{constructor(e,i,n,r,s){var a;this.channelTarget=e,this.subchannelAddress=i,this.options=n,this.credentials=r,this.connector=s,this.connectivityState=St.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new Zd.ChannelzCallTracker,this.childrenTracker=new Zd.ChannelzChildrenTracker,this.streamTracker=new Zd.ChannelzCallTracker;let o={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new Dne.BackoffTimeout(()=>{this.handleBackoffTimer()},o),this.backoffTimeout.unref(),this.subchannelAddressString=(0,Ane.subchannelAddressToString)(i),this.keepaliveTime=(a=n["grpc.keepalive_time_ms"])!==null&&a!==void 0?a:-1,n["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Zd.ChannelzTrace,this.channelzRef=(0,Zd.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(n,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){TD.trace(Hv.LogVerbosity.DEBUG,Rne,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){TD.trace(Hv.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([St.ConnectivityState.TRANSIENT_FAILURE],St.ConnectivityState.CONNECTING):this.transitionToState([St.ConnectivityState.TRANSIENT_FAILURE],St.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let i=Math.min(this.keepaliveTime,Mne);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":i})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(i=>{this.transitionToState([St.ConnectivityState.CONNECTING],St.ConnectivityState.READY)?(this.transport=i,this.channelzEnabled&&this.childrenTracker.refChild(i.getChannelzRef()),i.addDisconnectListener(n=>{this.transitionToState([St.ConnectivityState.READY],St.ConnectivityState.IDLE),n&&this.keepaliveTime>0&&(this.keepaliveTime*=2,TD.log(Hv.LogVerbosity.ERROR,`Connection to ${(0,kne.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):i.shutdown()},i=>{this.transitionToState([St.ConnectivityState.CONNECTING],St.ConnectivityState.TRANSIENT_FAILURE,`${i}`)})}transitionToState(e,i,n){var r,s;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(St.ConnectivityState[this.connectivityState]+" -> "+St.ConnectivityState[i]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+St.ConnectivityState[i]);let a=this.connectivityState;switch(this.connectivityState=i,i){case St.ConnectivityState.READY:this.stopBackoff();break;case St.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case St.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(r=this.transport)===null||r===void 0||r.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case St.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${i}`)}for(let o of this.stateListeners)o(this,a,i,this.keepaliveTime,n);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,Zd.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([St.ConnectivityState.CONNECTING,St.ConnectivityState.READY],St.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,i,n,r){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:a=>{a.code===Hv.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,i,n,r,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([St.ConnectivityState.IDLE],St.ConnectivityState.CONNECTING)||this.connectivityState===St.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([St.ConnectivityState.TRANSIENT_FAILURE],St.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};Wv.Subchannel=ID});var RD=x(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.setup=po.DEFAULT_PORT=void 0;var f4=ys(),p4=he("dns"),g4=he("util"),One=UT(),DD=st(),kD=fn(),Nne=qt(),Pne=st(),fo=Vn(),m4=he("net"),Fne=bm(),Lne="dns_resolver";function mo(t){Nne.trace(Pne.LogVerbosity.DEBUG,Lne,t)}po.DEFAULT_PORT=443;var Bne=3e4,Vne=g4.promisify(p4.resolveTxt),jne=g4.promisify(p4.lookup);function zne(...t){let e=[];for(let i=0;i<Math.max.apply(null,t.map(n=>n.length));i++)for(let n of t)i<n.length&&e.push(n[i]);return e}var AD=class{constructor(e,i,n){var r,s,a;this.target=e,this.listener=i,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,mo("Resolver constructed for target "+(0,fo.uriToString)(e));let o=(0,fo.splitHostPort)(e.path);o===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,m4.isIPv4)(o.host)||(0,m4.isIPv6)(o.host)?(this.ipResult=[{host:o.host,port:(r=o.port)!==null&&r!==void 0?r:po.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=o.host,this.port=(s=o.port)!==null&&s!==void 0?s:po.DEFAULT_PORT),this.percentage=Math.random()*100,n["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:DD.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,fo.uriToString)(this.target)}`,metadata:new kD.Metadata};let l={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoff=new Fne.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},l),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(a=n["grpc.dns_min_time_between_resolutions_ms"])!==null&&a!==void 0?a:Bne,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(mo("Returning IP address for target "+(0,fo.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)mo("Failed to parse DNS address "+(0,fo.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:DD.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,fo.uriToString)(this.target)}`,metadata:new kD.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;mo("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=jne(e,{all:!0}),this.pendingLookupPromise.then(i=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let n=i.filter(a=>a.family===4),r=i.filter(a=>a.family===6);this.latestLookupResult=zne(r,n).map(a=>({host:a.address,port:+this.port}));let s="["+this.latestLookupResult.map(a=>a.host+":"+a.port).join(",")+"]";if(mo("Resolved addresses for target "+(0,fo.uriToString)(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},i=>{this.pendingLookupPromise!==null&&(mo("Resolution error for target "+(0,fo.uriToString)(this.target)+": "+i.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=Vne(e),this.pendingTxtPromise.then(i=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,One.extractAndSelectServiceConfig)(i,this.percentage)}catch(n){this.latestServiceConfigError={code:DD.Status.UNAVAILABLE,details:`Parsing service config failed with error ${n.message}`,metadata:new kD.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},i=>{}))}}startNextResolutionTimer(){var e,i;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(i=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||i===void 0?void 0:i.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?mo('resolution update delayed by "min time between resolutions" rate limit'):mo("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function Une(){(0,f4.registerResolver)("dns",AD),(0,f4.registerDefaultScheme)("dns")}po.setup=Une});var MD=x(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});tu.getProxiedConnection=tu.mapProxyName=void 0;var jm=qt(),Jd=st(),qne=ys(),Hne=he("http"),Wne=he("tls"),Gne=qt(),_4=Cs(),eu=Vn(),Kne=he("url"),$ne=RD(),Yne="proxy";function go(t){Gne.trace(Jd.LogVerbosity.DEBUG,Yne,t)}function Qne(){let t="",e="";if(process.env.grpc_proxy)e="grpc_proxy",t=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",t=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",t=process.env.http_proxy;else return{};let i;try{i=new Kne.URL(t)}catch{return(0,jm.log)(Jd.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(i.protocol!=="http:")return(0,jm.log)(Jd.LogVerbosity.ERROR,`"${i.protocol}" scheme not supported in proxy URI`),{};let n=null;i.username&&(i.password?((0,jm.log)(Jd.LogVerbosity.INFO,"userinfo found in proxy URI"),n=`${i.username}:${i.password}`):n=i.username);let r=i.hostname,s=i.port;s===""&&(s="80");let a={address:`${r}:${s}`};return n&&(a.creds=n),go("Proxy server "+a.address+" set by environment variable "+e),a}function Xne(){let t=process.env.no_grpc_proxy,e="no_grpc_proxy";return t||(t=process.env.no_proxy,e="no_proxy"),t?(go("No proxy server list set by environment variable "+e),t.split(",")):[]}function Zne(t,e){var i;let n={target:t,extraOptions:{}};if(((i=e["grpc.enable_http_proxy"])!==null&&i!==void 0?i:1)===0||t.scheme==="unix")return n;let r=Qne();if(!r.address)return n;let s=(0,eu.splitHostPort)(t.path);if(!s)return n;let a=s.host;for(let l of Xne())if(l===a)return go("Not using proxy for target in no_proxy list: "+(0,eu.uriToString)(t)),n;let o={"grpc.http_connect_target":(0,eu.uriToString)(t)};return r.creds&&(o["grpc.http_connect_creds"]=r.creds),{target:{scheme:"dns",path:r.address},extraOptions:o}}tu.mapProxyName=Zne;function Jne(t,e,i){var n;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let r=e["grpc.http_connect_target"],s=(0,eu.parseUri)(r);if(s===null)return Promise.resolve({});let a=(0,eu.splitHostPort)(s.path);if(a===null)return Promise.resolve({});let o=`${a.host}:${(n=a.port)!==null&&n!==void 0?n:$ne.DEFAULT_PORT}`,l={method:"CONNECT",path:o},c={Host:o};(0,_4.isTcpSubchannelAddress)(t)?(l.host=t.host,l.port=t.port):l.socketPath=t.path,"grpc.http_connect_creds"in e&&(c["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),l.headers=c;let d=(0,_4.subchannelAddressToString)(t);return go("Using proxy "+d+" to connect to "+l.path),new Promise((u,h)=>{let f=Hne.request(l);f.once("connect",(p,v,E)=>{var k;if(f.removeAllListeners(),v.removeAllListeners(),p.statusCode===200)if(go("Successfully connected to "+l.path+" through proxy "+d),"secureContext"in i){let I=(0,qne.getDefaultAuthority)(s),P=(0,eu.splitHostPort)(I),L=(k=P?.host)!==null&&k!==void 0?k:I,te=Wne.connect(Object.assign({host:L,servername:L,socket:v},i),()=>{go("Successfully established a TLS connection to "+l.path+" through proxy "+d),u({socket:te,realTarget:s})});te.on("error",Ee=>{go("Failed to establish a TLS connection to "+l.path+" through proxy "+d+" with error "+Ee.message),h()})}else go("Successfully established a plaintext connection to "+l.path+" through proxy "+d),u({socket:v,realTarget:s});else(0,jm.log)(Jd.LogVerbosity.ERROR,"Failed to connect to "+l.path+" through proxy "+d+" with status "+p.statusCode),h()}),f.once("error",p=>{f.removeAllListeners(),(0,jm.log)(Jd.LogVerbosity.ERROR,"Failed to connect to proxy "+d+" with error "+p.message),h()}),f.end()})}tu.getProxiedConnection=Jne});var ND=x(Gv=>{"use strict";Object.defineProperty(Gv,"__esModule",{value:!0});Gv.StreamDecoder=void 0;var aa=function(t){return t[t.NO_DATA=0]="NO_DATA",t[t.READING_SIZE=1]="READING_SIZE",t[t.READING_MESSAGE=2]="READING_MESSAGE",t}(aa||{}),OD=class{constructor(){this.readState=aa.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let i=0,n,r=[];for(;i<e.length;)switch(this.readState){case aa.NO_DATA:this.readCompressFlag=e.slice(i,i+1),i+=1,this.readState=aa.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case aa.READING_SIZE:if(n=Math.min(e.length-i,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,i,i+n),this.readSizeRemaining-=n,i+=n,this.readSizeRemaining===0)if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=aa.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=aa.NO_DATA,r.push(s)}break;case aa.READING_MESSAGE:if(n=Math.min(e.length-i,this.readMessageRemaining),this.readPartialMessage.push(e.slice(i,i+n)),this.readMessageRemaining-=n,i+=n,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),a=Buffer.concat(s,this.readMessageSize+5);this.readState=aa.NO_DATA,r.push(a)}break;default:throw new Error("Unexpected read state")}return r}};Gv.StreamDecoder=OD});var b4=x(Kv=>{"use strict";Object.defineProperty(Kv,"__esModule",{value:!0});Kv.Http2SubchannelCall=void 0;var oa=he("http2"),ere=he("os"),_t=st(),_o=fn(),tre=ND(),ire=qt(),nre=st(),rre="subchannel_call";function sre(t){for(let[e,i]of Object.entries(ere.constants.errno))if(i===t)return e;return"Unknown system error "+t}var PD=class{constructor(e,i,n,r,s){this.http2Stream=e,this.callEventTracker=i,this.listener=n,this.transport=r,this.callId=s,this.decoder=new tre.StreamDecoder,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=_t.Status.UNKNOWN,this.finalStatus=null,this.internalError=null,e.on("response",(a,o)=>{let l="";for(let c of Object.keys(a))l+="		"+c+": "+a[c]+`
`;switch(this.trace(`Received server headers:
`+l),a[":status"]){case 400:this.mappedStatusCode=_t.Status.INTERNAL;break;case 401:this.mappedStatusCode=_t.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=_t.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=_t.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=_t.Status.UNAVAILABLE;break;default:this.mappedStatusCode=_t.Status.UNKNOWN}if(o&oa.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(a);else{let c;try{c=_o.Metadata.fromHttp2Headers(a)}catch(d){this.endCall({code:_t.Status.UNKNOWN,details:d.message,metadata:new _o.Metadata});return}this.listener.onReceiveMetadata(c)}}),e.on("trailers",a=>{this.handleTrailers(a)}),e.on("data",a=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+a.length);let o=this.decoder.write(a);for(let l of o)this.trace("parsed message of length "+l.length),this.callEventTracker.addMessageReceived(),this.tryPush(l)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var a;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((a=this.finalStatus)===null||a===void 0?void 0:a.code)===_t.Status.OK)return;let o,l="";switch(e.rstCode){case oa.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;o=_t.Status.INTERNAL,l=`Received RST_STREAM with code ${e.rstCode}`;break;case oa.constants.NGHTTP2_REFUSED_STREAM:o=_t.Status.UNAVAILABLE,l="Stream refused by server";break;case oa.constants.NGHTTP2_CANCEL:o=_t.Status.CANCELLED,l="Call cancelled";break;case oa.constants.NGHTTP2_ENHANCE_YOUR_CALM:o=_t.Status.RESOURCE_EXHAUSTED,l="Bandwidth exhausted or memory limit exceeded";break;case oa.constants.NGHTTP2_INADEQUATE_SECURITY:o=_t.Status.PERMISSION_DENIED,l="Protocol not secure enough";break;case oa.constants.NGHTTP2_INTERNAL_ERROR:o=_t.Status.INTERNAL,this.internalError===null?l=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(o=_t.Status.UNAVAILABLE,l=this.internalError.message):l=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:o=_t.Status.INTERNAL,l=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:o,details:l,metadata:new _o.Metadata,rstCode:e.rstCode})})}),e.on("error",a=>{a.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+a.message+" code="+a.code+" errno="+sre(a.errno)+" syscall="+a.syscall),this.internalError=a),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:_t.Status.UNAVAILABLE,details:"Connection dropped",metadata:new _o.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){ire.trace(nre.LogVerbosity.DEBUG,rre,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===_t.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==_t.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callEventTracker.onStreamEnd(!0);let i="";for(let l of Object.keys(e))i+="		"+l+": "+e[l]+`
`;this.trace(`Received server trailers:
`+i);let n;try{n=_o.Metadata.fromHttp2Headers(e)}catch{n=new _o.Metadata}let r=n.getMap(),s=this.mappedStatusCode;if(s===_t.Status.UNKNOWN&&typeof r["grpc-status"]=="string"){let l=Number(r["grpc-status"]);l in _t.Status&&(s=l,this.trace("received status code "+l+" from server")),n.remove("grpc-status")}let a="";if(typeof r["grpc-message"]=="string"){try{a=decodeURI(r["grpc-message"])}catch{a=r["grpc-message"]}n.remove("grpc-message"),this.trace('received status details string "'+a+'" from server')}let o={code:s,details:a,metadata:n};this.endCall(o)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let i;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===_t.Status.OK?i=oa.constants.NGHTTP2_NO_ERROR:i=oa.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+i),this.http2Stream.close(i)}}cancelWithStatus(e,i){this.trace("cancelWithStatus code: "+e+' details: "'+i+'"'),this.endCall({code:e,details:i,metadata:new _o.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==_t.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,i){this.trace("write() called with message of length "+i.length);let n=r=>{process.nextTick(()=>{var s;let a=_t.Status.UNAVAILABLE;r?.code==="ERR_STREAM_WRITE_AFTER_END"&&(a=_t.Status.INTERNAL),r&&this.cancelWithStatus(a,`Write error: ${r.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+i.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(i,n)}catch(r){this.endCall({code:_t.Status.UNAVAILABLE,details:`Write failed with error ${r.message}`,metadata:new _o.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};Kv.Http2SubchannelCall=PD});var FD=x($v=>{"use strict";Object.defineProperty($v,"__esModule",{value:!0});$v.getNextCallNumber=void 0;var are=0;function ore(){return are++}$v.getNextCallNumber=ore});var w4=x(Qv=>{"use strict";Object.defineProperty(Qv,"__esModule",{value:!0});Qv.Http2SubchannelConnector=void 0;var zD=he("http2"),v4=he("tls"),LD=Vl(),zm=st(),lre=MD(),nu=qt(),y4=ys(),Yv=Cs(),iu=Vn(),cre=he("net"),dre=b4(),ure=FD(),BD="transport",hre="transport_flowctrl",fre=ST().version,{HTTP2_HEADER_AUTHORITY:mre,HTTP2_HEADER_CONTENT_TYPE:pre,HTTP2_HEADER_METHOD:gre,HTTP2_HEADER_PATH:_re,HTTP2_HEADER_TE:bre,HTTP2_HEADER_USER_AGENT:vre}=zD.constants,yre=2e4,wre=Buffer.from("too_many_pings","ascii"),VD=class{constructor(e,i,n,r){this.session=e,this.remoteName=r,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=yre,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new LD.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,Yv.subchannelAddressToString)(i),n["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,LD.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[n["grpc.primary_user_agent"],`grpc-node-js/${fre}`,n["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in n&&(this.keepaliveTimeMs=n["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in n&&(this.keepaliveTimeoutMs=n["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in n?this.keepaliveWithoutCalls=n["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(s,a,o)=>{let l=!1;s===zD.constants.NGHTTP2_ENHANCE_YOUR_CALM&&o&&o.equals(wre)&&(l=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+o?.toString()),this.reportDisconnectToOwner(l)}),e.once("error",s=>{this.trace("connection closed with error "+s.message)}),nu.isTracerEnabled(BD)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,i,n;let r=this.session.socket,s=r.remoteAddress?(0,Yv.stringToSubchannelAddress)(r.remoteAddress,r.remotePort):null,a=r.localAddress?(0,Yv.stringToSubchannelAddress)(r.localAddress,r.localPort):null,o;if(this.session.encrypted){let c=r,d=c.getCipher(),u=c.getCertificate(),h=c.getPeerCertificate();o={cipherSuiteStandardName:(e=d.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:d.standardName?null:d.name,localCertificate:u&&"raw"in u?u.raw:null,remoteCertificate:h&&"raw"in h?h.raw:null}}else o=null;return{remoteAddress:s,localAddress:a,security:o,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(i=this.session.state.localWindowSize)!==null&&i!==void 0?i:null,remoteFlowControlWindow:(n=this.session.state.remoteWindowSize)!==null&&n!==void 0?n:null}}trace(e){nu.trace(zm.LogVerbosity.DEBUG,BD,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){nu.trace(zm.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){nu.trace(zm.LogVerbosity.DEBUG,hre,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){nu.trace(zm.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(i=>i(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,i;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(i=(e=this.keepaliveTimeoutId).unref)===null||i===void 0||i.call(e));try{this.session.ping((n,r,s)=>{n&&(this.keepaliveTrace("Ping failed with error "+n.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch{this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,i;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):!this.keepaliveTimerId&&!this.keepaliveTimeoutId&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=(i=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)===null||i===void 0?void 0:i.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,i,n,r,s){let a=e.toHttp2Headers();a[mre]=i,a[vre]=this.userAgent,a[pre]="application/grpc",a[gre]="POST",a[_re]=n,a[bre]="trailers";let o;try{o=this.session.request(a)}catch(d){throw this.handleDisconnect(),d}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let l,c;return this.channelzEnabled?(this.streamTracker.addCallStarted(),l={addMessageSent:()=>{var d;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(d=s.addMessageSent)===null||d===void 0||d.call(s)},addMessageReceived:()=>{var d;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(d=s.addMessageReceived)===null||d===void 0||d.call(s)},onCallEnd:d=>{var u;(u=s.onCallEnd)===null||u===void 0||u.call(s,d),this.removeActiveCall(c)},onStreamEnd:d=>{var u;d?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(u=s.onStreamEnd)===null||u===void 0||u.call(s,d)}}):l={addMessageSent:()=>{var d;(d=s.addMessageSent)===null||d===void 0||d.call(s)},addMessageReceived:()=>{var d;(d=s.addMessageReceived)===null||d===void 0||d.call(s)},onCallEnd:d=>{var u;(u=s.onCallEnd)===null||u===void 0||u.call(s,d),this.removeActiveCall(c)},onStreamEnd:d=>{var u;(u=s.onStreamEnd)===null||u===void 0||u.call(s,d)}},c=new dre.Http2SubchannelCall(o,l,r,this,(0,ure.getNextCallNumber)()),this.addActiveCall(c),c}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}shutdown(){this.session.close(),(0,LD.unregisterChannelzRef)(this.channelzRef)}},jD=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){nu.trace(zm.LogVerbosity.DEBUG,BD,(0,iu.uriToString)(this.channelTarget)+" "+e)}createSession(e,i,n,r){return this.isShutdown?Promise.reject():new Promise((s,a)=>{var o,l,c;let d;r.realTarget?(d=(0,iu.uriToString)(r.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,iu.uriToString)(r.realTarget))):(d=null,this.trace("creating HTTP/2 session to "+(0,Yv.subchannelAddressToString)(e)));let u=(0,y4.getDefaultAuthority)((o=r.realTarget)!==null&&o!==void 0?o:this.channelTarget),h=i._getConnectionOptions()||{};h.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in n?h.maxSessionMemory=n["grpc-node.max_session_memory"]:h.maxSessionMemory=Number.MAX_SAFE_INTEGER;let f="http://";if("secureContext"in h){if(f="https://",n["grpc.ssl_target_name_override"]){let E=n["grpc.ssl_target_name_override"];h.checkServerIdentity=(k,I)=>(0,v4.checkServerIdentity)(E,I),h.servername=E}else{let E=(c=(l=(0,iu.splitHostPort)(u))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";h.servername=E}r.socket&&(h.createConnection=(E,k)=>r.socket)}else h.createConnection=(E,k)=>r.socket?r.socket:cre.connect(e);h=Object.assign(Object.assign(Object.assign({},h),e),{enableTrace:n["grpc-node.tls_enable_trace"]===1});let p=zD.connect(f+u,h);this.session=p;let v="Failed to connect";p.unref(),p.once("connect",()=>{p.removeAllListeners(),s(new VD(p,e,n,d)),this.session=null}),p.once("close",()=>{this.session=null,setImmediate(()=>{a(`${v} (${new Date().toISOString()})`)})}),p.once("error",E=>{v=E.message,this.trace("connection failed with error "+v)})})}connect(e,i,n){var r,s;if(this.isShutdown)return Promise.reject();let a=i._getConnectionOptions()||{};if("secureContext"in a){if(a.ALPNProtocols=["h2"],n["grpc.ssl_target_name_override"]){let o=n["grpc.ssl_target_name_override"];a.checkServerIdentity=(l,c)=>(0,v4.checkServerIdentity)(o,c),a.servername=o}else if("grpc.http_connect_target"in n){let o=(0,y4.getDefaultAuthority)((r=(0,iu.parseUri)(n["grpc.http_connect_target"]))!==null&&r!==void 0?r:{path:"localhost"}),l=(0,iu.splitHostPort)(o);a.servername=(s=l?.host)!==null&&s!==void 0?s:o}n["grpc-node.tls_enable_trace"]&&(a.enableTrace=!0)}return(0,lre.getProxiedConnection)(e,n,a).then(o=>this.createSession(e,i,n,o))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};Qv.Http2SubchannelConnector=jD});var C4=x(ru=>{"use strict";Object.defineProperty(ru,"__esModule",{value:!0});ru.getSubchannelPool=ru.SubchannelPool=void 0;var Cre=aj(),Ere=h4(),Sre=Cs(),xre=Vn(),Tre=w4(),Ire=1e4,Um=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let i in this.pool){let r=this.pool[i].filter(s=>!s.subchannel.unrefIfOneRef());r.length>0&&(e=!1),this.pool[i]=r}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,i;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},Ire),(i=(e=this.cleanupTimer).unref)===null||i===void 0||i.call(e))}getOrCreateSubchannel(e,i,n,r){this.ensureCleanupTask();let s=(0,xre.uriToString)(e);if(s in this.pool){let o=this.pool[s];for(let l of o)if((0,Sre.subchannelAddressEqual)(i,l.subchannelAddress)&&(0,Cre.channelOptionsEqual)(n,l.channelArguments)&&r._equals(l.channelCredentials))return l.subchannel}let a=new Ere.Subchannel(e,i,n,r,new Tre.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:i,channelArguments:n,channelCredentials:r,subchannel:a}),a.ref(),a}};ru.SubchannelPool=Um;var Dre=new Um;function kre(t){return t?Dre:new Um}ru.getSubchannelPool=kre});var qD=x(su=>{"use strict";Object.defineProperty(su,"__esModule",{value:!0});su.FilterStackFactory=su.FilterStack=void 0;var Xv=class{constructor(e){this.filters=e}sendMetadata(e){let i=e;for(let n=0;n<this.filters.length;n++)i=this.filters[n].sendMetadata(i);return i}receiveMetadata(e){let i=e;for(let n=this.filters.length-1;n>=0;n--)i=this.filters[n].receiveMetadata(i);return i}sendMessage(e){let i=e;for(let n=0;n<this.filters.length;n++)i=this.filters[n].sendMessage(i);return i}receiveMessage(e){let i=e;for(let n=this.filters.length-1;n>=0;n--)i=this.filters[n].receiveMessage(i);return i}receiveTrailers(e){let i=e;for(let n=this.filters.length-1;n>=0;n--)i=this.filters[n].receiveTrailers(i);return i}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};su.FilterStack=Xv;var UD=class t{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new t([...this.factories])}createFilter(){return new Xv(this.factories.map(e=>e.createFilter()))}};su.FilterStackFactory=UD});var HD=x(Zv=>{"use strict";Object.defineProperty(Zv,"__esModule",{value:!0});Zv.CompressionAlgorithms=void 0;var E4=function(t){return t[t.identity=0]="identity",t[t.deflate=1]="deflate",t[t.gzip=2]="gzip",t}(E4||(Zv.CompressionAlgorithms=E4={}))});var ey=x(Jv=>{"use strict";Object.defineProperty(Jv,"__esModule",{value:!0});Jv.BaseFilter=void 0;var WD=class{sendMetadata(e){return y(this,null,function*(){return e})}receiveMetadata(e){return e}sendMessage(e){return y(this,null,function*(){return e})}receiveMessage(e){return y(this,null,function*(){return e})}receiveTrailers(e){return e}};Jv.BaseFilter=WD});var T4=x(ou=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});ou.CompressionFilterFactory=ou.CompressionFilter=void 0;var ty=he("zlib"),x4=HD(),Are=st(),Rre=ey(),Mre=qt(),Ore=t=>typeof t=="number"&&typeof x4.CompressionAlgorithms[t]=="string",au=class{writeMessage(e,i){return y(this,null,function*(){let n=e;i&&(n=yield this.compressMessage(n));let r=Buffer.allocUnsafe(n.length+5);return r.writeUInt8(i?1:0,0),r.writeUInt32BE(n.length,1),n.copy(r,5),r})}readMessage(e){return y(this,null,function*(){let i=e.readUInt8(0)===1,n=e.slice(5);return i&&(n=yield this.decompressMessage(n)),n})}},jl=class extends au{compressMessage(e){return y(this,null,function*(){return e})}writeMessage(e,i){return y(this,null,function*(){let n=Buffer.allocUnsafe(e.length+5);return n.writeUInt8(0,0),n.writeUInt32BE(e.length,1),e.copy(n,5),n})}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},GD=class extends au{compressMessage(e){return new Promise((i,n)=>{ty.deflate(e,(r,s)=>{r?n(r):i(s)})})}decompressMessage(e){return new Promise((i,n)=>{ty.inflate(e,(r,s)=>{r?n(r):i(s)})})}},KD=class extends au{compressMessage(e){return new Promise((i,n)=>{ty.gzip(e,(r,s)=>{r?n(r):i(s)})})}decompressMessage(e){return new Promise((i,n)=>{ty.unzip(e,(r,s)=>{r?n(r):i(s)})})}},$D=class extends au{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function S4(t){switch(t){case"identity":return new jl;case"deflate":return new GD;case"gzip":return new KD;default:return new $D(t)}}var iy=class extends Rre.BaseFilter{constructor(e,i){var n;super(),this.sharedFilterConfig=i,this.sendCompression=new jl,this.receiveCompression=new jl,this.currentCompressionAlgorithm="identity";let r=e["grpc.default_compression_algorithm"];if(r!==void 0)if(Ore(r)){let s=x4.CompressionAlgorithms[r],a=(n=i.serverSupportedEncodingHeader)===null||n===void 0?void 0:n.split(",");(!a||a.includes(s))&&(this.currentCompressionAlgorithm=s,this.sendCompression=S4(this.currentCompressionAlgorithm))}else Mre.log(Are.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${r}`)}sendMetadata(e){return y(this,null,function*(){let i=yield e;return i.set("grpc-accept-encoding","identity,deflate,gzip"),i.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?i.remove("grpc-encoding"):i.set("grpc-encoding",this.currentCompressionAlgorithm),i})}receiveMetadata(e){let i=e.get("grpc-encoding");if(i.length>0){let r=i[0];typeof r=="string"&&(this.receiveCompression=S4(r))}e.remove("grpc-encoding");let n=e.get("grpc-accept-encoding")[0];return n&&(this.sharedFilterConfig.serverSupportedEncodingHeader=n,n.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new jl,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}sendMessage(e){return y(this,null,function*(){var i;let n=yield e,r;return this.sendCompression instanceof jl?r=!1:r=(((i=n.flags)!==null&&i!==void 0?i:0)&2)===0,{message:yield this.sendCompression.writeMessage(n.message,r),flags:n.flags}})}receiveMessage(e){return y(this,null,function*(){return this.receiveCompression.readMessage(yield e)})}};ou.CompressionFilter=iy;var YD=class{constructor(e,i){this.options=i,this.sharedFilterConfig={}}createFilter(){return new iy(this.options,this.sharedFilterConfig)}};ou.CompressionFilterFactory=YD});var D4=x(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});lu.MaxMessageSizeFilterFactory=lu.MaxMessageSizeFilter=void 0;var Nre=ey(),ny=st(),I4=fn(),ry=class extends Nre.BaseFilter{constructor(e){super(),this.maxSendMessageSize=ny.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=ny.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,"grpc.max_send_message_length"in e&&(this.maxSendMessageSize=e["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in e&&(this.maxReceiveMessageSize=e["grpc.max_receive_message_length"])}sendMessage(e){return y(this,null,function*(){if(this.maxSendMessageSize===-1)return e;{let i=yield e;if(i.message.length>this.maxSendMessageSize)throw{code:ny.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${i.message.length} vs. ${this.maxSendMessageSize})`,metadata:new I4.Metadata};return i}})}receiveMessage(e){return y(this,null,function*(){if(this.maxReceiveMessageSize===-1)return e;{let i=yield e;if(i.length>this.maxReceiveMessageSize)throw{code:ny.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${i.length} vs. ${this.maxReceiveMessageSize})`,metadata:new I4.Metadata};return i}})}};lu.MaxMessageSizeFilter=ry;var QD=class{constructor(e){this.options=e}createFilter(){return new ry(this.options)}};lu.MaxMessageSizeFilterFactory=QD});var sy=x(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.deadlineToString=Ms.getRelativeTimeout=Ms.getDeadlineTimeoutString=Ms.minDeadline=void 0;function Pre(...t){let e=1/0;for(let i of t){let n=i instanceof Date?i.getTime():i;n<e&&(e=n)}return e}Ms.minDeadline=Pre;var Fre=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function Lre(t){let e=new Date().getTime();t instanceof Date&&(t=t.getTime());let i=Math.max(t-e,0);for(let[n,r]of Fre){let s=i/r;if(s<1e8)return String(Math.ceil(s))+n}throw new Error("Deadline is too far in the future")}Ms.getDeadlineTimeoutString=Lre;var Bre=2147483647;function Vre(t){let e=t instanceof Date?t.getTime():t,i=new Date().getTime(),n=e-i;return n<0?0:n>Bre?1/0:n}Ms.getRelativeTimeout=Vre;function jre(t){if(t instanceof Date)return t.toISOString();{let e=new Date(t);return Number.isNaN(e.getTime())?""+t:e.toISOString()}}Ms.deadlineToString=jre});var oy=x(ay=>{"use strict";Object.defineProperty(ay,"__esModule",{value:!0});ay.restrictControlPlaneStatusCode=void 0;var Os=st(),zre=[Os.Status.OK,Os.Status.INVALID_ARGUMENT,Os.Status.NOT_FOUND,Os.Status.ALREADY_EXISTS,Os.Status.FAILED_PRECONDITION,Os.Status.ABORTED,Os.Status.OUT_OF_RANGE,Os.Status.DATA_LOSS];function Ure(t,e){return zre.includes(t)?{code:Os.Status.INTERNAL,details:`Invalid status from control plane: ${t} ${Os.Status[t]} ${e}`}:{code:t,details:e}}ay.restrictControlPlaneStatusCode=Ure});var A4=x(dy=>{"use strict";Object.defineProperty(dy,"__esModule",{value:!0});dy.LoadBalancingCall=void 0;var k4=dr(),ly=st(),qre=sy(),cy=fn(),qm=eo(),Hre=Vn(),Wre=qt(),XD=oy(),Gre=he("http2"),Kre="load_balancing_call",ZD=class{constructor(e,i,n,r,s,a,o){var l,c;this.channel=e,this.callConfig=i,this.methodName=n,this.host=r,this.credentials=s,this.deadline=a,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let d=this.methodName.split("/"),u="";d.length>=2&&(u=d[1]);let h=(c=(l=(0,Hre.splitHostPort)(this.host))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";this.serviceUrl=`https://${h}/${u}`}trace(e){Wre.trace(ly.LogVerbosity.DEBUG,Kre,"["+this.callNumber+"] "+e)}outputStatus(e,i){var n,r;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let s=Object.assign(Object.assign({},e),{progress:i});(n=this.listener)===null||n===void 0||n.onReceiveStatus(s),(r=this.onCallEnded)===null||r===void 0||r.call(this,s.code)}}doPick(){var e,i;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let n=this.channel.doPick(this.metadata,this.callConfig.pickInformation),r=n.subchannel?"("+n.subchannel.getChannelzRef().id+") "+n.subchannel.getAddress():""+n.subchannel;switch(this.trace("Pick result: "+qm.PickResultType[n.pickResultType]+" subchannel: "+r+" status: "+((e=n.status)===null||e===void 0?void 0:e.code)+" "+((i=n.status)===null||i===void 0?void 0:i.details)),n.pickResultType){case qm.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(o=>{var l,c,d;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let u=this.metadata.clone();if(u.merge(o),u.get("authorization").length>1&&this.outputStatus({code:ly.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new cy.Metadata},"PROCESSED"),n.subchannel.getConnectivityState()!==k4.ConnectivityState.READY){this.trace("Picked subchannel "+r+" has state "+k4.ConnectivityState[n.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&u.set("grpc-timeout",(0,qre.getDeadlineTimeoutString)(this.deadline));try{this.child=n.subchannel.getRealSubchannel().createCall(u,this.host,this.methodName,{onReceiveMetadata:h=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(h)},onReceiveMessage:h=>{this.trace("Received message"),this.listener.onReceiveMessage(h)},onReceiveStatus:h=>{this.trace("Received status"),h.rstCode===Gre.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(h,"REFUSED"):this.outputStatus(h,"PROCESSED")}})}catch(h){this.trace("Failed to start call on picked subchannel "+r+" with error "+h.message),this.outputStatus({code:ly.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+h.message,metadata:new cy.Metadata},"NOT_STARTED");return}(c=(l=this.callConfig).onCommitted)===null||c===void 0||c.call(l),(d=n.onCallStarted)===null||d===void 0||d.call(n),this.onCallEnded=n.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},o=>{let{code:l,details:c}=(0,XD.restrictControlPlaneStatusCode)(typeof o.code=="number"?o.code:ly.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${o.message}`);this.outputStatus({code:l,details:c,metadata:new cy.Metadata},"PROCESSED")});break;case qm.PickResultType.DROP:let{code:s,details:a}=(0,XD.restrictControlPlaneStatusCode)(n.status.code,n.status.details);setImmediate(()=>{this.outputStatus({code:s,details:a,metadata:n.status.metadata},"DROP")});break;case qm.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:o,details:l}=(0,XD.restrictControlPlaneStatusCode)(n.status.code,n.status.details);setImmediate(()=>{this.outputStatus({code:o,details:l,metadata:n.status.metadata},"PROCESSED")})}break;case qm.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,i){var n;this.trace("cancelWithStatus code: "+e+' details: "'+i+'"'),(n=this.child)===null||n===void 0||n.cancelWithStatus(e,i),this.outputStatus({code:e,details:i,metadata:new cy.Metadata},"PROCESSED")}getPeer(){var e,i;return(i=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&i!==void 0?i:this.channel.getTarget()}start(e,i){this.trace("start called"),this.listener=i,this.metadata=e,this.doPick()}sendMessageWithContext(e,i){this.trace("write() called with message of length "+i.length),this.child?this.child.sendMessageWithContext(e,i):this.pendingMessage={context:e,message:i}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};dy.LoadBalancingCall=ZD});var M4=x(hy=>{"use strict";Object.defineProperty(hy,"__esModule",{value:!0});hy.ResolvingCall=void 0;var cu=st(),uy=sy(),R4=fn(),$re=qt(),Yre=oy(),Qre="resolving_call",JD=class{constructor(e,i,n,r,s,a){this.channel=e,this.method=i,this.filterStackFactory=r,this.credentials=s,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=n.deadline,this.host=n.host,n.parentCall&&(n.flags&cu.Propagate.CANCELLATION&&n.parentCall.on("cancelled",()=>{this.cancelWithStatus(cu.Status.CANCELLED,"Cancelled by parent call")}),n.flags&cu.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+n.parentCall.getDeadline()),this.deadline=(0,uy.minDeadline)(this.deadline,n.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){$re.trace(cu.LogVerbosity.DEBUG,Qre,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,uy.deadlineToString)(this.deadline));let e=(0,uy.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let i=()=>{this.cancelWithStatus(cu.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(i):this.deadlineTimer=setTimeout(i,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let i=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+i.code+' details="'+i.details+'"'),this.statusWatchers.forEach(n=>n(i)),process.nextTick(()=>{var n;(n=this.listener)===null||n===void 0||n.onReceiveStatus(i)})}}sendMessageOnChild(e,i){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let n=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:i,flags:e.flags})).then(r=>{this.writeFilterPending=!1,n.sendMessageWithContext(e,r.message),this.pendingHalfClose&&n.halfClose()},r=>{this.cancelWithStatus(r.code,r.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let i=e.config;if(i.status!==cu.Status.OK){let{code:n,details:r}=(0,Yre.restrictControlPlaneStatusCode)(i.status,"Failed to route call to method "+this.method);this.outputStatus({code:n,details:r,metadata:new R4.Metadata});return}if(i.methodConfig.timeout){let n=new Date;n.setSeconds(n.getSeconds()+i.methodConfig.timeout.seconds),n.setMilliseconds(n.getMilliseconds()+i.methodConfig.timeout.nanos/1e6),this.deadline=(0,uy.minDeadline)(this.deadline,n),this.runDeadlineTimer()}this.filterStackFactory.push(i.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(n=>{this.child=this.channel.createInnerCall(i,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(n,{onReceiveMetadata:r=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(r))},onReceiveMessage:r=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(r).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:r=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=r:this.outputStatus(r)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},n=>{this.outputStatus(n)})}reportResolverError(e){var i;!((i=this.metadata)===null||i===void 0)&&i.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,i){var n;this.trace("cancelWithStatus code: "+e+' details: "'+i+'"'),(n=this.child)===null||n===void 0||n.cancelWithStatus(e,i),this.outputStatus({code:e,details:i,metadata:new R4.Metadata})}getPeer(){var e,i;return(i=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&i!==void 0?i:this.channel.getTarget()}start(e,i){this.trace("start called"),this.metadata=e.clone(),this.listener=i,this.getConfig()}sendMessageWithContext(e,i){this.trace("write() called with message of length "+i.length),this.child?this.sendMessageOnChild(e,i):this.pendingMessage={context:e,message:i}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};hy.ResolvingCall=JD});var O4=x(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.RetryingCall=bo.MessageBufferTracker=bo.RetryThrottler=void 0;var fy=st(),Xre=fn(),Zre=qt(),Jre="retrying_call",t1=class{constructor(e,i,n){this.maxTokens=e,this.tokenRatio=i,n?this.tokens=n.tokens*(e/n.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};bo.RetryThrottler=t1;var i1=class{constructor(e,i){this.totalLimit=e,this.limitPerCall=i,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,i){var n;let r=(n=this.allocatedPerCall.get(i))!==null&&n!==void 0?n:0;return this.limitPerCall-r<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(i,r+e),this.totalAllocated+=e,!0)}free(e,i){var n;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${i} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let r=(n=this.allocatedPerCall.get(i))!==null&&n!==void 0?n:0;if(r<e)throw new Error(`Invalid buffer allocation state: call ${i} freed ${e} > allocated for call ${r}`);this.allocatedPerCall.set(i,r-e)}freeAll(e){var i;let n=(i=this.allocatedPerCall.get(e))!==null&&i!==void 0?i:0;if(this.totalAllocated<n)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${n} > total allocated ${this.totalAllocated}`);this.totalAllocated-=n,this.allocatedPerCall.delete(e)}};bo.MessageBufferTracker=i1;var e1="grpc-previous-rpc-attempts",n1=class{constructor(e,i,n,r,s,a,o,l,c){if(this.channel=e,this.callConfig=i,this.methodName=n,this.host=r,this.credentials=s,this.deadline=a,this.callNumber=o,this.bufferTracker=l,this.retryThrottler=c,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,i.methodConfig.retryPolicy){this.state="RETRY";let d=i.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(d.initialBackoff.substring(0,d.initialBackoff.length-1))}else i.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){Zre.trace(fy.LogVerbosity.DEBUG,Jre,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var i;(i=this.listener)===null||i===void 0||i.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,i){this.trace("cancelWithStatus code: "+e+' details: "'+i+'"'),this.reportStatus({code:e,details:i,metadata:new Xre.Metadata});for(let{call:n}of this.underlyingCalls)n.cancelWithStatus(e,i)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var i;return(i=this.writeBuffer[e-this.writeBufferOffset])!==null&&i!==void 0?i:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let i=this.writeBufferOffset;i<e;i++){let n=this.getBufferEntry(i);n.allocated&&this.bufferTracker.free(n.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let i=0;i<this.underlyingCalls.length;i++)i!==e&&this.underlyingCalls[i].state!=="COMPLETED"&&(this.underlyingCalls[i].state="COMPLETED",this.underlyingCalls[i].call.cancelWithStatus(fy.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,i=-1;for(let[n,r]of this.underlyingCalls.entries())r.state==="ACTIVE"&&r.nextMessageToSend>e&&(e=r.nextMessageToSend,i=n);i===-1?this.state="TRANSPARENT_ONLY":this.commitCall(i)}isStatusCodeInList(e,i){return e.some(n=>n===i||n.toString().toLowerCase()===fy.Status[i].toLowerCase())}getNextRetryBackoffMs(){var e;let i=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!i)return 0;let n=Math.random()*this.nextRetryBackoffSec*1e3,r=Number(i.maxBackoff.substring(0,i.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*i.backoffMultiplier,r),n}maybeRetryCall(e,i){if(this.state!=="RETRY"){i(!1);return}let n=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(n.maxAttempts,5)){i(!1);return}let r;if(e===null)r=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",i(!1);return}else r=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var s,a;if(this.state!=="RETRY"){i(!1);return}(!((a=(s=this.retryThrottler)===null||s===void 0?void 0:s.canRetryCall())!==null&&a!==void 0)||a)&&(i(!0),this.attempts+=1,this.startNewAttempt())},r)}countActiveCalls(){let e=0;for(let i of this.underlyingCalls)i?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,i,n){var r,s,a;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(i),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((r=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&r!==void 0?r:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let o;if(n===null)o=0;else if(n<0){this.state="TRANSPARENT_ONLY",this.commitCall(i),this.reportStatus(e);return}else o=n;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(i),this.reportStatus(e))},o)}else this.commitCall(i),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((a=this.retryThrottler)===null||a===void 0||a.addCallFailed(),this.maybeRetryCall(n,o=>{o||(this.commitCall(i),this.reportStatus(e))})):(this.commitCall(i),this.reportStatus(e));break}}getPushback(e){let i=e.get("grpc-retry-pushback-ms");if(i.length===0)return null;try{return parseInt(i[0])}catch{return-1}}handleChildStatus(e,i){var n;if(this.underlyingCalls[i].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[i].call.getCallNumber()+"] in state "+this.underlyingCalls[i].state),this.underlyingCalls[i].state="COMPLETED",e.code===fy.Status.OK){(n=this.retryThrottler)===null||n===void 0||n.addCallSucceeded(),this.commitCall(i),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let r=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,i,r):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(i),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,i,r);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,i,n;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let r=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(r.maxAttempts,5))return;let s=(e=r.hedgingDelay)!==null&&e!==void 0?e:"0s",a=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},a*1e3),(n=(i=this.hedgingTimer).unref)===null||n===void 0||n.call(i)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let i=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let n=this.attempts-1,r=this.initialMetadata.clone();n>0&&r.set(e1,`${n}`);let s=!1;e.start(r,{onReceiveMetadata:a=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(i),s=!0,n>0&&a.set(e1,`${n}`),this.underlyingCalls[i].state==="ACTIVE"&&this.listener.onReceiveMetadata(a)},onReceiveMessage:a=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(i),this.underlyingCalls[i].state==="ACTIVE"&&this.listener.onReceiveMessage(a)},onReceiveStatus:a=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&n>0&&a.metadata.set(e1,`${n}`),this.handleChildStatus(a,i)}}),this.sendNextChildMessage(i),this.readStarted&&e.startRead()}start(e,i){this.trace("start called"),this.listener=i,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var i,n;let r=this.underlyingCalls[e],s=r.nextMessageToSend;(n=(i=this.getBufferEntry(s)).callback)===null||n===void 0||n.call(i),this.clearSentMessages(),r.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let i=this.underlyingCalls[e];if(i.state!=="COMPLETED"&&this.getBufferEntry(i.nextMessageToSend)){let n=this.getBufferEntry(i.nextMessageToSend);switch(n.entryType){case"MESSAGE":i.call.sendMessageWithContext({callback:r=>{this.handleChildWriteCompleted(e)}},n.message.message);break;case"HALF_CLOSE":i.nextMessageToSend+=1,i.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,i){var n;this.trace("write() called with message of length "+i.length);let r={message:i,flags:e.flags},s=this.getNextBufferIndex(),a={entryType:"MESSAGE",message:r,allocated:this.bufferTracker.allocate(i.length,this.callNumber)};if(this.writeBuffer.push(a),a.allocated){(n=e.callback)===null||n===void 0||n.call(e);for(let[o,l]of this.underlyingCalls.entries())l.state==="ACTIVE"&&l.nextMessageToSend===s&&l.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(o)}},i)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let o=this.underlyingCalls[this.committedCallIndex];a.callback=e.callback,o.state==="ACTIVE"&&o.nextMessageToSend===s&&o.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(this.committedCallIndex)}},i)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let i of this.underlyingCalls)i?.state==="ACTIVE"&&i.nextMessageToSend===e&&(i.nextMessageToSend+=1,i.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};bo.RetryingCall=n1});var py=x(my=>{"use strict";Object.defineProperty(my,"__esModule",{value:!0});my.BaseSubchannelWrapper=void 0;var r1=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};my.BaseSubchannelWrapper=r1});var F4=x(by=>{"use strict";Object.defineProperty(by,"__esModule",{value:!0});by.InternalChannel=void 0;var ese=Zb(),tse=sj(),ise=C4(),N4=eo(),Hm=st(),nse=qD(),rse=T4(),P4=ys(),s1=qt(),sse=D4(),ase=MD(),gy=Vn(),Ns=dr(),Wm=Vl(),ose=A4(),lse=sy(),cse=M4(),a1=FD(),dse=oy(),o1=O4(),use=py(),hse=2147483647,fse=1e3,mse=30*60*1e3,_y=new Map,pse=1<<24,gse=1<<20,l1=class extends use.BaseSubchannelWrapper{constructor(e,i){super(e),this.channel=i,this.refCount=0,this.subchannelStateListener=(n,r,s,a)=>{i.throttleKeepalive(a)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},c1=class{constructor(e,i,n){var r,s,a,o,l,c,d,u;if(this.credentials=i,this.options=n,this.connectivityState=Ns.ConnectivityState.IDLE,this.currentPicker=new N4.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new Wm.ChannelzCallTracker,this.childrenTracker=new Wm.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(i instanceof ese.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(n&&typeof n!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let h=(0,gy.parseUri)(e);if(h===null)throw new Error(`Could not parse target name "${e}"`);let f=(0,P4.mapUriDefaultScheme)(h);if(f===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},hse),(s=(r=this.callRefTimer).unref)===null||s===void 0||s.call(r),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Wm.ChannelzTrace,this.channelzRef=(0,Wm.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,P4.getDefaultAuthority)(f);let p=(0,ase.mapProxyName)(f,n);this.target=p.target,this.options=Object.assign({},this.options,p.extraOptions),this.subchannelPool=(0,ise.getSubchannelPool)(((a=n["grpc.use_local_subchannel_pool"])!==null&&a!==void 0?a:0)===0),this.retryBufferTracker=new o1.MessageBufferTracker((o=n["grpc.retry_buffer_size"])!==null&&o!==void 0?o:pse,(l=n["grpc.per_rpc_retry_buffer_size"])!==null&&l!==void 0?l:gse),this.keepaliveTime=(c=n["grpc.keepalive_time_ms"])!==null&&c!==void 0?c:-1,this.idleTimeoutMs=Math.max((d=n["grpc.client_idle_timeout_ms"])!==null&&d!==void 0?d:mse,fse);let v={createSubchannel:(k,I)=>{let P=this.subchannelPool.getOrCreateSubchannel(this.target,k,Object.assign({},this.options,I),this.credentials);P.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",P.getChannelzRef());let L=new l1(P,this);return this.wrappedSubchannels.add(L),L},updateState:(k,I)=>{this.currentPicker=I;let P=this.pickQueue.slice();this.pickQueue=[],P.length>0&&this.callRefTimerUnref();for(let L of P)L.doPick();this.updateState(k)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:k=>{this.channelzEnabled&&this.childrenTracker.refChild(k)},removeChannelzChild:k=>{this.channelzEnabled&&this.childrenTracker.unrefChild(k)}};this.resolvingLoadBalancer=new tse.ResolvingLoadBalancer(this.target,v,n,(k,I)=>{k.retryThrottling?_y.set(this.getTarget(),new o1.RetryThrottler(k.retryThrottling.maxTokens,k.retryThrottling.tokenRatio,_y.get(this.getTarget()))):_y.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=I,this.currentResolutionError=null,process.nextTick(()=>{let P=this.configSelectionQueue;this.configSelectionQueue=[],P.length>0&&this.callRefTimerUnref();for(let L of P)L.getConfig()})},k=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+k.code+' and details "'+k.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,dse.restrictControlPlaneStatusCode)(k.code,k.details)),{metadata:k.metadata}));let I=this.configSelectionQueue;this.configSelectionQueue=[],I.length>0&&this.callRefTimerUnref();for(let P of I)P.reportResolverError(k)}),this.filterStackFactory=new nse.FilterStackFactory([new sse.MaxMessageSizeFilterFactory(this.options),new rse.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(n,void 0,2));let E=new Error;(0,s1.trace)(Hm.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((u=E.stack)===null||u===void 0?void 0:u.substring(E.stack.indexOf(`
`)+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,i){(0,s1.trace)(i??Hm.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,gy.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,i,n,r;!((i=(e=this.callRefTimer).hasRef)===null||i===void 0)&&i.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(r=(n=this.callRefTimer).ref)===null||r===void 0||r.call(n))}callRefTimerUnref(){var e,i;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(i=(e=this.callRefTimer).unref)===null||i===void 0||i.call(e))}removeConnectivityStateWatcher(e){let i=this.connectivityStateWatchers.findIndex(n=>n===e);i>=0&&this.connectivityStateWatchers.splice(i,1)}updateState(e){(0,s1.trace)(Hm.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,gy.uriToString)(this.target)+" "+Ns.ConnectivityState[this.connectivityState]+" -> "+Ns.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Ns.ConnectivityState[e]),this.connectivityState=e;let i=this.connectivityStateWatchers.slice();for(let n of i)e!==n.currentState&&(n.timer&&clearTimeout(n.timer),this.removeConnectivityStateWatcher(n),n.callback());e!==Ns.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let i of this.wrappedSubchannels)i.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,i){return this.currentPicker.pick({metadata:e,extraPickInfo:i})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,i){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,i)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(Ns.ConnectivityState.IDLE),this.currentPicker=new N4.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var i,n;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let s=new Date().valueOf()-this.lastActivityTimestamp.valueOf();s>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-s)},e),(n=(i=this.idleTimer).unref)===null||n===void 0||n.call(i)}maybeStartIdleTimer(){this.connectivityState!==Ns.ConnectivityState.SHUTDOWN&&!this.idleTimer&&this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===Hm.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,i,n,r,s){let a=(0,a1.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+a+'] method="'+i+'"'),new ose.LoadBalancingCall(this,e,i,n,r,s,a)}createRetryingCall(e,i,n,r,s){let a=(0,a1.getNextCallNumber)();return this.trace("createRetryingCall ["+a+'] method="'+i+'"'),new o1.RetryingCall(this,e,i,n,r,s,a,this.retryBufferTracker,_y.get(this.getTarget()))}createInnerCall(e,i,n,r,s){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,i,n,r,s):this.createRetryingCall(e,i,n,r,s)}createResolvingCall(e,i,n,r,s){let a=(0,a1.getNextCallNumber)();this.trace("createResolvingCall ["+a+'] method="'+e+'", deadline='+(0,lse.deadlineToString)(i));let o={deadline:i,flags:s??Hm.Propagate.DEFAULTS,host:n??this.defaultAuthority,parentCall:r},l=new cse.ResolvingCall(this,e,o,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),a);return this.onCallStart(),l.addStatusWatcher(c=>{this.onCallEnd(c)}),l}close(){this.resolvingLoadBalancer.destroy(),this.updateState(Ns.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,Wm.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,gy.uriToString)(this.target)}getConnectivityState(e){let i=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),i}watchConnectivityState(e,i,n){if(this.connectivityState===Ns.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let r=null;if(i!==1/0){let a=i instanceof Date?i:new Date(i),o=new Date;if(i===-1/0||a<=o){process.nextTick(n,new Error("Deadline passed without connectivity state change"));return}r=setTimeout(()=>{this.removeConnectivityStateWatcher(s),n(new Error("Deadline passed without connectivity state change"))},a.getTime()-o.getTime())}let s={currentState:e,callback:n,timer:r};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,i,n,r,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof i=="number"||i instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===Ns.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,i,n,r,s)}};by.InternalChannel=c1});var fI=x(vy=>{"use strict";Object.defineProperty(vy,"__esModule",{value:!0});vy.ChannelImplementation=void 0;var _se=Zb(),bse=F4(),d1=class{constructor(e,i,n){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(i instanceof _se.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(n&&typeof n!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new bse.InternalChannel(e,i,n)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,i,n){this.internalChannel.watchConnectivityState(e,i,n)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,i,n,r,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof i=="number"||i instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,i,n,r,s)}};vy.ChannelImplementation=d1});var G4=x(vr=>{"use strict";Object.defineProperty(vr,"__esModule",{value:!0});vr.Http2ServerCallStream=vr.ServerDuplexStreamImpl=vr.ServerWritableStreamImpl=vr.ServerReadableStreamImpl=vr.ServerUnaryCallImpl=void 0;var z4=he("events"),du=he("http2"),f1=he("stream"),U4=he("zlib"),q4=he("util"),Nt=st(),m1=fn(),vse=ND(),H4=qt(),Km=Gb(),W4="server_call",yse=(0,q4.promisify)(U4.unzip),wse=(0,q4.promisify)(U4.inflate);function Gm(t){H4.trace(Nt.LogVerbosity.DEBUG,W4,t)}var Cse="grpc-accept-encoding",Ese="grpc-encoding",L4="grpc-message",B4="grpc-status",V4="grpc-timeout",Sse=/(\d{1,8})\s*([HMSmun])/,xse={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},Tse={[Cse]:"identity,deflate,gzip",[Ese]:"identity"},j4={[du.constants.HTTP2_HEADER_STATUS]:du.constants.HTTP_STATUS_OK,[du.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},Ise={waitForTrailers:!0},u1=class extends z4.EventEmitter{constructor(e,i,n){super(),this.call=e,this.metadata=i,this.request=n,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};vr.ServerUnaryCallImpl=u1;var yy=class extends f1.Readable{constructor(e,i,n,r){super({objectMode:!0}),this.call=e,this.metadata=i,this.deserialize=n,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,r)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};vr.ServerReadableStreamImpl=yy;var $m=class extends f1.Writable{constructor(e,i,n,r){super({objectMode:!0}),this.call=e,this.metadata=i,this.serialize=n,this.request=r,this.cancelled=!1,this.trailingMetadata=new m1.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,i,n){try{let r=this.call.serializeMessage(e);if(!this.call.write(r)){this.call.once("drain",n);return}}catch(r){this.emit("error",{details:(0,Km.getErrorMessage)(r),code:Nt.Status.INTERNAL})}n()}_final(e){this.call.sendStatus({code:Nt.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};vr.ServerWritableStreamImpl=$m;var uu=class extends f1.Duplex{constructor(e,i,n,r,s){super({objectMode:!0}),this.call=e,this.metadata=i,this.serialize=n,this.deserialize=r,this.cancelled=!1,this.trailingMetadata=new m1.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",a=>{this.call.sendError(a),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};vr.ServerDuplexStreamImpl=uu;uu.prototype._read=yy.prototype._read;uu.prototype._write=$m.prototype._write;uu.prototype._final=$m.prototype._final;var h1=class extends z4.EventEmitter{constructor(e,i,n){super(),this.stream=e,this.handler=i,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=Nt.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=Nt.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",r=>{}),this.stream.once("close",()=>{var r;Gm("Request to method "+((r=this.handler)===null||r===void 0?void 0:r.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:Nt.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in n&&(this.maxSendMessageSize=n["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in n&&(this.maxReceiveMessageSize=n["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,i){return i==="deflate"?wse(e.subarray(5)):i==="gzip"?yse(e.subarray(5)):i==="identity"?e.subarray(5):Promise.reject({code:Nt.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${i}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let i=e?e.toHttp2Headers():null,n=Object.assign(Object.assign(Object.assign({},j4),Tse),i);this.stream.respond(n,Ise)}receiveMetadata(e){let i=m1.Metadata.fromHttp2Headers(e);H4.isTracerEnabled(W4)&&Gm("Request to "+this.handler.path+" received headers "+JSON.stringify(i.toJSON()));let n=i.get(V4);if(n.length>0){let r=n[0].toString().match(Sse);if(r===null){let o=new Error("Invalid deadline");return o.code=Nt.Status.OUT_OF_RANGE,this.sendError(o),i}let s=+r[1]*xse[r[2]]|0,a=new Date;this.deadline=a.setMilliseconds(a.getMilliseconds()+s),this.deadlineTimer=setTimeout(Dse,s,this),i.remove(V4)}return i.remove(du.constants.HTTP2_HEADER_ACCEPT_ENCODING),i.remove(du.constants.HTTP2_HEADER_TE),i.remove(du.constants.HTTP2_HEADER_CONTENT_TYPE),i.remove("grpc-accept-encoding"),i}receiveUnaryMessage(e){return new Promise((i,n)=>{let{stream:r}=this,s=0,a=this,o=[],l=this.maxReceiveMessageSize;this.stream.on("data",c),this.stream.on("end",d),this.stream.on("error",d);function c(u){if(s+=u.byteLength,l!==-1&&s>l){r.removeListener("data",c),r.removeListener("end",d),r.removeListener("error",d),n({code:Nt.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${s} vs. ${l})`});return}o.push(u)}function d(u){if(r.removeListener("data",c),r.removeListener("end",d),r.removeListener("error",d),u!==void 0){n({code:Nt.Status.INTERNAL,details:u.message});return}if(s===0){n({code:Nt.Status.INTERNAL,details:"received empty unary message"});return}a.emit("receiveMessage");let h=Buffer.concat(o,s),p=h.readUInt8(0)===1?e:"identity",v=a.getDecompressedMessage(h,p);if(Buffer.isBuffer(v)){i(a.deserializeMessageWithInternalError(v));return}v.then(E=>i(a.deserializeMessageWithInternalError(E)),E=>n(E.code?E:{code:Nt.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}})}deserializeMessageWithInternalError(e){return y(this,null,function*(){try{return this.deserializeMessage(e)}catch(i){throw{details:(0,Km.getErrorMessage)(i),code:Nt.Status.INTERNAL}}})}serializeMessage(e){let i=this.handler.serialize(e),n=i.byteLength,r=Buffer.allocUnsafe(n+5);return r.writeUInt8(0,0),r.writeUInt32BE(n,1),i.copy(r,5),r}deserializeMessage(e){return this.handler.deserialize(e)}sendUnaryMessage(e,i,n,r){return y(this,null,function*(){if(!this.checkCancelled()){if(n===void 0&&(n=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&n&&(e.metadata=n),this.sendError(e);return}try{let s=this.serializeMessage(i);this.write(s),this.sendStatus({code:Nt.Status.OK,details:"OK",metadata:n})}catch(s){this.sendError({details:(0,Km.getErrorMessage)(s),code:Nt.Status.INTERNAL})}}})}sendStatus(e){var i,n;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===Nt.Status.OK),!this.checkCancelled())if(Gm("Request to method "+((i=this.handler)===null||i===void 0?void 0:i.path)+" ended with status code: "+Nt.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var r;let s=Object.assign({[B4]:e.code,[L4]:encodeURI(e.details)},(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.sendTrailers(s),this.statusSent=!0}),this.stream.end());else{let r=Object.assign(Object.assign({[B4]:e.code,[L4]:encodeURI(e.details)},j4),(n=e.metadata)===null||n===void 0?void 0:n.toHttp2Headers());this.stream.respond(r,{endStream:!0}),this.statusSent=!0}}sendError(e){let i={code:Nt.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(i.code=e.code,"details"in e&&typeof e.details=="string"&&(i.details=e.details)),this.sendStatus(i)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:Nt.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",i=>{e.cancelled=!0,e.emit("cancelled",i)}),this.once("callEnd",i=>e.emit("callEnd",i))}setupReadable(e,i){let n=new vse.StreamDecoder,r=!1,s=!1,a=!1,o=()=>y(this,null,function*(){!a&&r&&!s&&(a=!0,yield this.pushOrBufferMessage(e,null))});this.stream.on("data",l=>y(this,null,function*(){let c=n.write(l);s=!0,this.stream.pause();for(let d of c){if(this.maxReceiveMessageSize!==-1&&d.length>this.maxReceiveMessageSize){this.sendError({code:Nt.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${d.length} vs. ${this.maxReceiveMessageSize})`});return}this.emit("receiveMessage");let h=d.readUInt8(0)===1?i:"identity",f=yield this.getDecompressedMessage(d,h);if(!f)return;yield this.pushOrBufferMessage(e,f)}s=!1,this.stream.resume(),yield o()})),this.stream.once("end",()=>y(this,null,function*(){r=!0,yield o()}))}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let i=this.messagesToPush.shift(),n=e.push(i);if(i===null||n===!1){this.canPush=!1;break}}return this.canPush}pushOrBufferMessage(e,i){return y(this,null,function*(){this.isPushPending?this.bufferedMessages.push(i):yield this.pushMessage(e,i)})}pushMessage(e,i){return y(this,null,function*(){if(i===null){Gm("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}Gm("Received message of length "+i.length),this.isPushPending=!0;try{let n=yield this.deserializeMessage(i);this.canPush?e.push(n)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(n)}catch(n){this.bufferedMessages.length=0;let r=(0,Km.getErrorCode)(n);(r===null||r<Nt.Status.OK||r>Nt.Status.UNAUTHENTICATED)&&(r=Nt.Status.INTERNAL),e.emit("error",{details:(0,Km.getErrorMessage)(n),code:r})}this.isPushPending=!1,this.bufferedMessages.length>0&&(yield this.pushMessage(e,this.bufferedMessages.shift()))})}getPeer(){var e;let i=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return i?.remoteAddress?i.remotePort?`${i.remoteAddress}:${i.remotePort}`:i.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};vr.Http2ServerCallStream=h1;function Dse(t){let e=new Error("Deadline exceeded");e.code=Nt.Status.DEADLINE_EXCEEDED,t.sendError(e),t.cancelled=!0,t.emit("cancelled","deadline")}});var _1=x(wy=>{"use strict";Object.defineProperty(wy,"__esModule",{value:!0});wy.ServerCredentials=void 0;var K4=LT(),Ym=class{static createInsecure(){return new p1}static createSsl(e,i,n=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(i))throw new TypeError("keyCertPairs must be an array");if(typeof n!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let r=[],s=[];for(let a=0;a<i.length;a++){let o=i[a];if(o===null||typeof o!="object")throw new TypeError(`keyCertPair[${a}] must be an object`);if(!Buffer.isBuffer(o.private_key))throw new TypeError(`keyCertPair[${a}].private_key must be a Buffer`);if(!Buffer.isBuffer(o.cert_chain))throw new TypeError(`keyCertPair[${a}].cert_chain must be a Buffer`);r.push(o.cert_chain),s.push(o.private_key)}return new g1({ca:e||(0,K4.getDefaultRootsData)()||void 0,cert:r,key:s,requestCert:n,ciphers:K4.CIPHER_SUITES})}};wy.ServerCredentials=Ym;var p1=class extends Ym{_isSecure(){return!1}_getSettings(){return null}},g1=class extends Ym{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var Q4=x(Sy=>{"use strict";Object.defineProperty(Sy,"__esModule",{value:!0});Sy.Server=void 0;var vo=he("http2"),la=st(),zl=G4(),kse=_1(),$4=ys(),Cy=qt(),Ur=Cs(),Ase=Vn(),In=Vl(),Ey=~(1<<31),Rse=~(1<<31),Mse=2e4,{HTTP2_HEADER_PATH:Y4}=vo.constants,Ose="server";function Nse(){}function b1(t){return{code:la.Status.UNIMPLEMENTED,details:`The server does not implement the method ${t}`}}function Pse(t,e){let i=b1(e);switch(t){case"unary":return(n,r)=>{r(i,null)};case"clientStream":return(n,r)=>{r(i,null)};case"serverStream":return n=>{n.emit("error",i)};case"bidi":return n=>{n.emit("error",i)};default:throw new Error(`Invalid handlerType ${t}`)}}var v1=class{constructor(e){var i,n,r,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new In.ChannelzTrace,this.callTracker=new In.ChannelzCallTracker,this.listenerChildrenTracker=new In.ChannelzChildrenTracker,this.sessionChildrenTracker=new In.ChannelzChildrenTracker,this.options=e??{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,In.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(i=this.options["grpc.max_connection_age_ms"])!==null&&i!==void 0?i:Ey,this.maxConnectionAgeGraceMs=(n=this.options["grpc.max_connection_age_grace_ms"])!==null&&n!==void 0?n:Ey,this.keepaliveTimeMs=(r=this.options["grpc.keepalive_time_ms"])!==null&&r!==void 0?r:Rse,this.keepaliveTimeoutMs=(s=this.options["grpc.keepalive_timeout_ms"])!==null&&s!==void 0?s:Mse,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var i,n,r;let s=this.sessions.get(e),a=e.socket,o=a.remoteAddress?(0,Ur.stringToSubchannelAddress)(a.remoteAddress,a.remotePort):null,l=a.localAddress?(0,Ur.stringToSubchannelAddress)(a.localAddress,a.localPort):null,c;if(e.encrypted){let u=a,h=u.getCipher(),f=u.getCertificate(),p=u.getPeerCertificate();c={cipherSuiteStandardName:(i=h.standardName)!==null&&i!==void 0?i:null,cipherSuiteOtherName:h.standardName?null:h.name,localCertificate:f&&"raw"in f?f.raw:null,remoteCertificate:p&&"raw"in p?p.raw:null}}else c=null;return{remoteAddress:o,localAddress:l,security:c,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(n=e.state.localWindowSize)!==null&&n!==void 0?n:null,remoteFlowControlWindow:(r=e.state.remoteWindowSize)!==null&&r!==void 0?r:null}}}trace(e){Cy.trace(la.LogVerbosity.DEBUG,Ose,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,i){if(e===null||typeof e!="object"||i===null||typeof i!="object")throw new Error("addService() requires two objects as arguments");let n=Object.keys(e);if(n.length===0)throw new Error("Cannot add an empty service to a server");n.forEach(r=>{let s=e[r],a;s.requestStream?s.responseStream?a="bidi":a="clientStream":s.responseStream?a="serverStream":a="unary";let o=i[r],l;if(o===void 0&&typeof s.originalName=="string"&&(o=i[s.originalName]),o!==void 0?l=o.bind(i):l=Pse(a,r),this.register(s.path,l,s.responseSerialize,s.requestDeserialize,a)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(n=>{let r=e[n];this.unregister(r.path)})}bind(e,i){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,i,n){if(this.started===!0)throw new Error("server is already started");if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof e!="string")throw new TypeError("port must be a string");if(i===null||!(i instanceof kse.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof n!="function")throw new TypeError("callback must be a function");let r=(0,Ase.parseUri)(e);if(r===null)throw new Error(`Could not parse port "${e}"`);let s=(0,$4.mapUriDefaultScheme)(r);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let a={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?a.maxSessionMemory=this.options["grpc-node.max_session_memory"]:a.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(a.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let o=(f,p)=>{process.nextTick(()=>n(f,p))},l=()=>{let f;if(i._isSecure()){let p=Object.assign(a,i._getSettings());p.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,f=vo.createSecureServer(p),f.on("secureConnection",v=>{v.on("error",E=>{this.trace("An incoming TLS connection closed with error: "+E.message)})})}else f=vo.createServer(a);return f.setTimeout(0,Nse),this._setupHandlers(f),f},c=(f,p,v)=>f.length===0?Promise.resolve({port:p,count:v}):Promise.all(f.map(E=>{this.trace("Attempting to bind "+(0,Ur.subchannelAddressToString)(E));let k;(0,Ur.isTcpSubchannelAddress)(E)?k={host:E.host,port:p}:k=E;let I=l();return new Promise((P,L)=>{let te=Ee=>{this.trace("Failed to bind "+(0,Ur.subchannelAddressToString)(E)+" with error "+Ee.message),P(Ee)};I.once("error",te),I.listen(k,()=>{if(this.shutdown){I.close(),P(new Error("bindAsync failed because server is shutdown"));return}let Ee=I.address(),ze;typeof Ee=="string"?ze={path:Ee}:ze={host:Ee.address,port:Ee.port};let hi=(0,In.registerChannelzSocket)((0,Ur.subchannelAddressToString)(ze),()=>({localAddress:ze,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(hi),this.http2ServerList.push({server:I,channelzRef:hi}),this.trace("Successfully bound "+(0,Ur.subchannelAddressToString)(ze)),P("port"in ze?ze.port:p),I.removeListener("error",te)})})})).then(E=>{let k=0;for(let I of E)if(typeof I=="number"&&(k+=1,I!==p))throw new Error("Invalid state: multiple port numbers added from single address");return{port:p,count:k+v}}),d=f=>{if(f.length===0)return Promise.resolve({port:0,count:0});let p=f[0],v=l();return new Promise((E,k)=>{let I=P=>{this.trace("Failed to bind "+(0,Ur.subchannelAddressToString)(p)+" with error "+P.message),E(d(f.slice(1)))};v.once("error",I),v.listen(p,()=>{if(this.shutdown){v.close(),E({port:0,count:0});return}let P=v.address(),L={host:P.address,port:P.port},te=(0,In.registerChannelzSocket)((0,Ur.subchannelAddressToString)(L),()=>({localAddress:L,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(te),this.http2ServerList.push({server:v,channelzRef:te}),this.trace("Successfully bound "+(0,Ur.subchannelAddressToString)(L)),E(c(f.slice(1),P.port,1)),v.removeListener("error",I)})})},u={onSuccessfulResolution:(f,p,v)=>{if(u.onSuccessfulResolution=()=>{},this.shutdown&&o(new Error("bindAsync failed because server is shutdown"),0),f.length===0){o(new Error(`No addresses resolved for port ${e}`),0);return}let E;(0,Ur.isTcpSubchannelAddress)(f[0])?f[0].port===0?E=d(f):E=c(f,f[0].port,0):E=c(f,1,0),E.then(k=>{if(k.count===0){let I=`No address added out of total ${f.length} resolved`;Cy.log(la.LogVerbosity.ERROR,I),o(new Error(I),0)}else k.count<f.length&&Cy.log(la.LogVerbosity.INFO,`WARNING Only ${k.count} addresses added out of total ${f.length} resolved`),o(null,k.port)},k=>{let I=`No address added out of total ${f.length} resolved`;Cy.log(la.LogVerbosity.ERROR,I),o(new Error(I),0)})},onError:f=>{o(new Error(f.details),0)}};(0,$4.createResolver)(s,u,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:i}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(i),(0,In.unregisterChannelzRef)(i))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,i)=>{i.destroy(vo.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,In.unregisterChannelzRef)(this.channelzRef)}register(e,i,n,r,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:i,serialize:n,deserialize:r,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let i=s=>{this.channelzEnabled&&(0,In.unregisterChannelzRef)(this.channelzRef),e(s)},n=0;function r(){n--,n===0&&i()}this.started=!1,this.shutdown=!0;for(let{server:s,channelzRef:a}of this.http2ServerList)s.listening&&(n++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(a),(0,In.unregisterChannelzRef)(a)),r()}));this.sessions.forEach((s,a)=>{a.closed||(n+=1,a.close(r))}),n===0&&i()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,i){let n=i[vo.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof n!="string"||!n.startsWith("application/grpc")?(e.respond({[vo.constants.HTTP2_HEADER_STATUS]:vo.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let i=this.handlers.get(e);return i===void 0?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):i}_respondWithError(e,i,n=null){let r=new zl.Http2ServerCallStream(i,null,this.options);e.code===void 0&&(e.code=la.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),n?.streamTracker.addCallFailed()),r.sendError(e)}_channelzHandler(e,i){let n=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),n?.streamTracker.addCallStarted(),!this._verifyContentType(e,i)){this.callTracker.addCallFailed(),n?.streamTracker.addCallFailed();return}let r=i[Y4],s=this._retrieveHandler(r);if(!s){this._respondWithError(b1(r),e,n);return}let a=new zl.Http2ServerCallStream(e,s,this.options);a.once("callEnd",o=>{o===la.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),n&&(a.once("streamEnd",o=>{o?n.streamTracker.addCallSucceeded():n.streamTracker.addCallFailed()}),a.on("sendMessage",()=>{n.messagesSent+=1,n.lastMessageSentTimestamp=new Date}),a.on("receiveMessage",()=>{n.messagesReceived+=1,n.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(a,s,i)||(this.callTracker.addCallFailed(),n?.streamTracker.addCallFailed(),a.sendError({code:la.Status.INTERNAL,details:`Unknown handler type: ${s.type}`}))}_streamHandler(e,i){if(this._verifyContentType(e,i)!==!0)return;let n=i[Y4],r=this._retrieveHandler(n);if(!r){this._respondWithError(b1(n),e,null);return}let s=new zl.Http2ServerCallStream(e,r,this.options);this._runHandlerForCall(s,r,i)||s.sendError({code:la.Status.INTERNAL,details:`Unknown handler type: ${r.type}`})}_runHandlerForCall(e,i,n){var r;let s=e.receiveMetadata(n),a=(r=s.get("grpc-encoding")[0])!==null&&r!==void 0?r:"identity";s.remove("grpc-encoding");let{type:o}=i;if(o==="unary")Fse(e,i,s,a);else if(o==="clientStream")Lse(e,i,s,a);else if(o==="serverStream")Bse(e,i,s,a);else if(o==="bidi")Vse(e,i,s,a);else return!1;return!0}_setupHandlers(e){if(e===null)return;let i=e.address(),n="null";i&&(typeof i=="string"?n=i:n=i.address+":"+i.port),this.serverAddressString=n;let r=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",r.bind(this)),e.on("session",s=>{var a,o,l,c,d;if(!this.started){s.destroy();return}let u=(0,In.registerChannelzSocket)((a=s.socket.remoteAddress)!==null&&a!==void 0?a:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled),h={ref:u,streamTracker:new In.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,h);let f=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+f),this.sessionChildrenTracker.refChild(u));let p=null,v=null,E=!1;if(this.maxConnectionAgeMs!==Ey){let I=this.maxConnectionAgeMs/10,P=Math.random()*I*2-I;p=(l=(o=setTimeout(()=>{var L,te;E=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+f);try{s.goaway(vo.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==Ey&&(v=(te=(L=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs)).unref)===null||te===void 0?void 0:te.call(L))},this.maxConnectionAgeMs+P)).unref)===null||l===void 0?void 0:l.call(o)}let k=(d=(c=setInterval(()=>{var I,P;let L=(P=(I=setTimeout(()=>{E=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+f),s.close()},this.keepaliveTimeoutMs)).unref)===null||P===void 0?void 0:P.call(I);try{s.ping((te,Ee,ze)=>{clearTimeout(L)})}catch{s.destroy()}},this.keepaliveTimeMs)).unref)===null||d===void 0?void 0:d.call(c);s.on("close",()=>{this.channelzEnabled&&(E||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+f),this.sessionChildrenTracker.unrefChild(u),(0,In.unregisterChannelzRef)(u)),p&&clearTimeout(p),v&&clearTimeout(v),k&&clearTimeout(k),this.sessions.delete(s)})})}};Sy.Server=v1;function Fse(t,e,i,n){return y(this,null,function*(){try{let r=yield t.receiveUnaryMessage(n);if(r===void 0||t.cancelled)return;let s=new zl.ServerUnaryCallImpl(t,i,r);e.func(s,(a,o,l,c)=>{t.sendUnaryMessage(a,o,l,c)})}catch(r){t.sendError(r)}})}function Lse(t,e,i,n){let r=new zl.ServerReadableStreamImpl(t,i,e.deserialize,n);function s(a,o,l,c){r.destroy(),t.sendUnaryMessage(a,o,l,c)}t.cancelled||(r.on("error",s),e.func(r,s))}function Bse(t,e,i,n){return y(this,null,function*(){try{let r=yield t.receiveUnaryMessage(n);if(r===void 0||t.cancelled)return;let s=new zl.ServerWritableStreamImpl(t,i,e.serialize,r);e.func(s)}catch(r){t.sendError(r)}})}function Vse(t,e,i,n){let r=new zl.ServerDuplexStreamImpl(t,i,e.serialize,e.deserialize,n);t.cancelled||e.func(r)}});var X4=x(xy=>{"use strict";Object.defineProperty(xy,"__esModule",{value:!0});xy.StatusBuilder=void 0;var y1=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};xy.StatusBuilder=y1});var w1=x(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.isDuration=yo.durationToMs=yo.msToDuration=void 0;function jse(t){return{seconds:t/1e3|0,nanos:t%1e3*1e6|0}}yo.msToDuration=jse;function zse(t){return t.seconds*1e3+t.nanos/1e6|0}yo.durationToMs=zse;function Use(t){return typeof t.seconds=="number"&&typeof t.nanos=="number"}yo.isDuration=Use});var k1=x(wo=>{"use strict";var C1;Object.defineProperty(wo,"__esModule",{value:!0});wo.setup=wo.OutlierDetectionLoadBalancer=wo.OutlierDetectionLoadBalancingConfig=void 0;var Iy=dr(),J4=st(),Ul=w1(),eU=A1(),tU=Qa(),qse=sv(),Hse=eo(),Z4=Cs(),Wse=py(),Gse=qt(),Kse="outlier_detection";function ki(t){Gse.trace(J4.LogVerbosity.DEBUG,Kse,t)}var D1="outlier_detection",$se=((C1=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&C1!==void 0?C1:"true")==="true",Yse={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},Qse={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function hu(t,e,i,n){if(e in t&&typeof t[e]!==i){let r=n?`${n}.${e}`:e;throw new Error(`outlier detection config ${r} parse error: expected ${i}, got ${typeof t[e]}`)}}function E1(t,e,i){let n=i?`${i}.${e}`:e;if(e in t){if(!(0,Ul.isDuration)(t[e]))throw new Error(`outlier detection config ${n} parse error: expected Duration, got ${typeof t[e]}`);if(!(t[e].seconds>=0&&t[e].seconds<=315576e6&&t[e].nanos>=0&&t[e].nanos<=999999999))throw new Error(`outlier detection config ${n} parse error: values out of range for non-negative Duaration`)}}function Ty(t,e,i){let n=i?`${i}.${e}`:e;if(hu(t,e,"number",i),e in t&&!(t[e]>=0&&t[e]<=100))throw new Error(`outlier detection config ${n} parse error: value out of range for percentage (0-100)`)}var Qm=class t{constructor(e,i,n,r,s,a,o){if(this.childPolicy=o,o.length>0&&o[0].getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=i??3e4,this.maxEjectionTimeMs=n??3e5,this.maxEjectionPercent=r??10,this.successRateEjection=s?Object.assign(Object.assign({},Yse),s):null,this.failurePercentageEjection=a?Object.assign(Object.assign({},Qse),a):null}getLoadBalancerName(){return D1}toJsonObject(){return{interval:(0,Ul.msToDuration)(this.intervalMs),base_ejection_time:(0,Ul.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,Ul.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new t(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var i;if(E1(e,"interval"),E1(e,"base_ejection_time"),E1(e,"max_ejection_time"),Ty(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");hu(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),Ty(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),hu(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),hu(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");Ty(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),Ty(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),hu(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),hu(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new t(e.interval?(0,Ul.durationToMs)(e.interval):null,e.base_ejection_time?(0,Ul.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,Ul.durationToMs)(e.max_ejection_time):null,(i=e.max_ejection_percent)!==null&&i!==void 0?i:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(tU.validateLoadBalancingConfig))}};wo.OutlierDetectionLoadBalancingConfig=Qm;var x1=class extends Wse.BaseSubchannelWrapper{constructor(e,i){super(e),this.mapEntry=i,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((n,r,s,a)=>{if(this.childSubchannelState=s,!this.ejected)for(let o of this.stateListeners)o(this,r,s,a)})}getConnectivityState(){return this.ejected?Iy.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let i=this.stateListeners.indexOf(e);i>-1&&this.stateListeners.splice(i,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,Iy.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,Iy.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function S1(){return{success:0,failure:0}}var T1=class{constructor(){this.activeBucket=S1(),this.inactiveBucket=S1()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=S1()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},I1=class{constructor(e,i){this.wrappedPicker=e,this.countCalls=i}pick(e){let i=this.wrappedPicker.pick(e);if(i.pickResultType===Hse.PickResultType.COMPLETE){let n=i.subchannel,r=n.getMapEntry();if(r){let s=i.onCallEnded;return this.countCalls&&(s=a=>{var o;a===J4.Status.OK?r.counter.addSuccess():r.counter.addFailure(),(o=i.onCallEnded)===null||o===void 0||o.call(i,a)}),Object.assign(Object.assign({},i),{subchannel:n.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},i),{subchannel:n.getWrappedSubchannel()})}else return i}},Dy=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new qse.ChildLoadBalancerHandler((0,eU.createChildChannelControlHelper)(e,{createSubchannel:(i,n)=>{let r=e.createSubchannel(i,n),s=this.addressMap.get((0,Z4.subchannelAddressToString)(i)),a=new x1(r,s);return s?.currentEjectionTimestamp!==null&&a.eject(),s?.subchannelWrappers.push(a),a},updateState:(i,n)=>{i===Iy.ConnectivityState.READY?e.updateState(i,new I1(n,this.isCountingEnabled())):e.updateState(i,n)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let i of this.addressMap.values())i.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let i=this.latestConfig.getSuccessRateEjectionConfig();if(!i)return;ki("Running success rate check");let n=i.request_volume,r=0,s=[];for(let[u,h]of this.addressMap){let f=h.counter.getLastSuccesses(),p=h.counter.getLastFailures();ki("Stats for "+u+": successes="+f+" failures="+p+" targetRequestVolume="+n),f+p>=n&&(r+=1,s.push(f/(f+p)))}if(ki("Found "+r+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),r<i.minimum_hosts)return;let a=s.reduce((u,h)=>u+h)/s.length,o=0;for(let u of s){let h=u-a;o+=h*h}let l=o/s.length,c=Math.sqrt(l),d=a-c*(i.stdev_factor/1e3);ki("stdev="+c+" ejectionThreshold="+d);for(let[u,h]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let f=h.counter.getLastSuccesses(),p=h.counter.getLastFailures();if(f+p<n)continue;let v=f/(f+p);if(ki("Checking candidate "+u+" successRate="+v),v<d){let E=Math.random()*100;ki("Candidate "+u+" randomNumber="+E+" enforcement_percentage="+i.enforcement_percentage),E<i.enforcement_percentage&&(ki("Ejecting candidate "+u),this.eject(h,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let i=this.latestConfig.getFailurePercentageEjectionConfig();if(!i)return;ki("Running failure percentage check. threshold="+i.threshold+" request volume threshold="+i.request_volume);let n=0;for(let r of this.addressMap.values()){let s=r.counter.getLastSuccesses(),a=r.counter.getLastFailures();s+a>=i.request_volume&&(n+=1)}if(!(n<i.minimum_hosts))for(let[r,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let a=s.counter.getLastSuccesses(),o=s.counter.getLastFailures();if(ki("Candidate successes="+a+" failures="+o),a+o<i.request_volume)continue;if(o*100/(o+a)>i.threshold){let c=Math.random()*100;ki("Candidate "+r+" randomNumber="+c+" enforcement_percentage="+i.enforcement_percentage),c<i.enforcement_percentage&&(ki("Ejecting candidate "+r),this.eject(s,e))}}}eject(e,i){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let n of e.subchannelWrappers)n.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let i of e.subchannelWrappers)i.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var i,n;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(n=(i=this.ejectionTimer).unref)===null||n===void 0||n.call(i)}runChecks(){let e=new Date;if(ki("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[i,n]of this.addressMap.entries())if(n.currentEjectionTimestamp===null)n.ejectionTimeMultiplier>0&&(n.ejectionTimeMultiplier-=1);else{let r=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),a=new Date(n.currentEjectionTimestamp.getTime());a.setMilliseconds(a.getMilliseconds()+Math.min(r*n.ejectionTimeMultiplier,Math.max(r,s))),a<new Date&&(ki("Unejecting "+i),this.uneject(n))}}}updateAddressList(e,i,n){if(!(i instanceof Qm))return;let r=new Set;for(let a of e)r.add((0,Z4.subchannelAddressToString)(a));for(let a of r)this.addressMap.has(a)||(ki("Adding map entry for "+a),this.addressMap.set(a,{counter:new T1,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let a of this.addressMap.keys())r.has(a)||(ki("Removing map entry for "+a),this.addressMap.delete(a));let s=(0,tU.getFirstUsableConfig)(i.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,n),i.getSuccessRateEjectionConfig()||i.getFailurePercentageEjectionConfig())if(this.timerStartTime){ki("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let a=i.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(a)}else ki("Starting new timer"),this.timerStartTime=new Date,this.startTimer(i.getIntervalMs()),this.switchAllBuckets();else{ki("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let a of this.addressMap.values())this.uneject(a),a.ejectionTimeMultiplier=0}this.latestConfig=i}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return D1}};wo.OutlierDetectionLoadBalancer=Dy;function Xse(){$se&&(0,eU.registerLoadBalancerType)(D1,Dy,Qm)}wo.setup=Xse});var A1=x(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.OutlierDetectionLoadBalancingConfig=ke.BaseSubchannelWrapper=ke.registerAdminService=ke.FilterStackFactory=ke.BaseFilter=ke.PickResultType=ke.QueuePicker=ke.UnavailablePicker=ke.ChildLoadBalancerHandler=ke.subchannelAddressToString=ke.validateLoadBalancingConfig=ke.getFirstUsableConfig=ke.registerLoadBalancerType=ke.createChildChannelControlHelper=ke.BackoffTimeout=ke.durationToMs=ke.uriToString=ke.createResolver=ke.registerResolver=ke.log=ke.trace=void 0;var iU=qt();Object.defineProperty(ke,"trace",{enumerable:!0,get:function(){return iU.trace}});Object.defineProperty(ke,"log",{enumerable:!0,get:function(){return iU.log}});var nU=ys();Object.defineProperty(ke,"registerResolver",{enumerable:!0,get:function(){return nU.registerResolver}});Object.defineProperty(ke,"createResolver",{enumerable:!0,get:function(){return nU.createResolver}});var Zse=Vn();Object.defineProperty(ke,"uriToString",{enumerable:!0,get:function(){return Zse.uriToString}});var Jse=w1();Object.defineProperty(ke,"durationToMs",{enumerable:!0,get:function(){return Jse.durationToMs}});var eae=bm();Object.defineProperty(ke,"BackoffTimeout",{enumerable:!0,get:function(){return eae.BackoffTimeout}});var ky=Qa();Object.defineProperty(ke,"createChildChannelControlHelper",{enumerable:!0,get:function(){return ky.createChildChannelControlHelper}});Object.defineProperty(ke,"registerLoadBalancerType",{enumerable:!0,get:function(){return ky.registerLoadBalancerType}});Object.defineProperty(ke,"getFirstUsableConfig",{enumerable:!0,get:function(){return ky.getFirstUsableConfig}});Object.defineProperty(ke,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return ky.validateLoadBalancingConfig}});var tae=Cs();Object.defineProperty(ke,"subchannelAddressToString",{enumerable:!0,get:function(){return tae.subchannelAddressToString}});var iae=sv();Object.defineProperty(ke,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return iae.ChildLoadBalancerHandler}});var R1=eo();Object.defineProperty(ke,"UnavailablePicker",{enumerable:!0,get:function(){return R1.UnavailablePicker}});Object.defineProperty(ke,"QueuePicker",{enumerable:!0,get:function(){return R1.QueuePicker}});Object.defineProperty(ke,"PickResultType",{enumerable:!0,get:function(){return R1.PickResultType}});var nae=ey();Object.defineProperty(ke,"BaseFilter",{enumerable:!0,get:function(){return nae.BaseFilter}});var rae=qD();Object.defineProperty(ke,"FilterStackFactory",{enumerable:!0,get:function(){return rae.FilterStackFactory}});var sae=ov();Object.defineProperty(ke,"registerAdminService",{enumerable:!0,get:function(){return sae.registerAdminService}});var aae=py();Object.defineProperty(ke,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return aae.BaseSubchannelWrapper}});var oae=k1();Object.defineProperty(ke,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return oae.OutlierDetectionLoadBalancingConfig}})});var rU=x(Ay=>{"use strict";Object.defineProperty(Ay,"__esModule",{value:!0});Ay.setup=void 0;var lae=ys(),M1=class{constructor(e,i,n){this.listener=i,this.addresses=[],this.hasReturnedResult=!1;let r;e.authority===""?r="/"+e.path:r=e.path,this.addresses=[{path:r}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}};function cae(){(0,lae.registerResolver)("unix",M1)}Ay.setup=cae});var cU=x(Oy=>{"use strict";Object.defineProperty(Oy,"__esModule",{value:!0});Oy.setup=void 0;var sU=he("net"),Ry=st(),O1=fn(),aU=ys(),oU=Vn(),dae=qt(),uae="ip_resolver";function lU(t){dae.trace(Ry.LogVerbosity.DEBUG,uae,t)}var N1="ipv4",P1="ipv6",hae=443,My=class{constructor(e,i,n){var r;this.listener=i,this.addresses=[],this.error=null,this.hasReturnedResult=!1,lU("Resolver constructed for target "+(0,oU.uriToString)(e));let s=[];if(!(e.scheme===N1||e.scheme===P1)){this.error={code:Ry.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new O1.Metadata};return}let a=e.path.split(",");for(let o of a){let l=(0,oU.splitHostPort)(o);if(l===null){this.error={code:Ry.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${o}`,metadata:new O1.Metadata};return}if(e.scheme===N1&&!(0,sU.isIPv4)(l.host)||e.scheme===P1&&!(0,sU.isIPv6)(l.host)){this.error={code:Ry.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${o}`,metadata:new O1.Metadata};return}s.push({host:l.host,port:(r=l.port)!==null&&r!==void 0?r:hae})}this.addresses=s,lU("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function fae(){(0,aU.registerResolver)(N1,My),(0,aU.registerResolver)(P1,My)}Oy.setup=fae});var hU=x(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.setup=Ps.PickFirstLoadBalancer=Ps.shuffled=Ps.PickFirstLoadBalancingConfig=void 0;var dU=Qa(),Qi=dr(),Ny=eo(),mae=qt(),pae=st(),gae="pick_first";function F1(t){mae.trace(pae.LogVerbosity.DEBUG,gae,t)}var Xm="pick_first",_ae=250,Zm=class t{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return Xm}toJsonObject(){return{[Xm]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new t(e.shuffleAddressList===!0)}};Ps.PickFirstLoadBalancingConfig=Zm;var L1=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:Ny.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function uU(t){let e=t.slice();for(let i=e.length-1;i>1;i--){let n=Math.floor(Math.random()*(i+1)),r=e[i];e[i]=e[n],e[n]=r}return e}Ps.shuffled=uU;var Py=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=Qi.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(i,n,r,s,a)=>{this.onSubchannelStateUpdate(i,n,r,a)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(Qi.ConnectivityState.READY,new L1(this.currentPick)):this.children.length===0?this.updateState(Qi.ConnectivityState.IDLE,new Ny.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(Qi.ConnectivityState.TRANSIENT_FAILURE,new Ny.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(Qi.ConnectivityState.CONNECTING,new Ny.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,i,n,r){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){n!==Qi.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[a,o]of this.children.entries())if(e.realSubchannelEquals(o.subchannel)){n===Qi.ConnectivityState.READY&&this.pickSubchannel(o.subchannel),n===Qi.ConnectivityState.TRANSIENT_FAILURE&&(o.hasReportedTransientFailure=!0,r&&(this.lastError=r),this.maybeEnterStickyTransientFailureMode(),a===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(a+1)),o.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[i,n]of this.children.entries())if(i>=e){let r=n.subchannel.getConnectivityState();if(r===Qi.ConnectivityState.IDLE||r===Qi.ConnectivityState.CONNECTING){this.startConnecting(i);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var i,n;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===Qi.ConnectivityState.IDLE&&(F1("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var r;(r=this.children[e])===null||r===void 0||r.subchannel.startConnecting()})),this.connectionDelayTimeout=(n=(i=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},_ae)).unref)===null||n===void 0?void 0:n.call(i)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(F1("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.currentPick!==null&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,i){F1(Qi.ConnectivityState[this.currentState]+" -> "+Qi.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,i)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let i=e.map(n=>({subchannel:this.channelControlHelper.createSubchannel(n,{}),hasReportedTransientFailure:!1}));for(let{subchannel:n}of i)n.ref(),this.channelControlHelper.addChannelzChild(n.getChannelzRef());this.resetSubchannelList(),this.children=i;for(let{subchannel:n}of this.children)if(n.addConnectivityStateListener(this.subchannelStateListener),n.getConnectivityState()===Qi.ConnectivityState.READY){this.pickSubchannel(n);return}for(let n of this.children)n.subchannel.getConnectivityState()===Qi.ConnectivityState.TRANSIENT_FAILURE&&(n.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,i){i instanceof Zm&&(i.getShuffleAddressList()&&(e=uU(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===Qi.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return Xm}};Ps.PickFirstLoadBalancer=Py;function bae(){(0,dU.registerLoadBalancerType)(Xm,Py,Zm),(0,dU.registerDefaultLoadBalancerType)(Xm)}Ps.setup=bae});var mU=x(fu=>{"use strict";Object.defineProperty(fu,"__esModule",{value:!0});fu.setup=fu.RoundRobinLoadBalancer=void 0;var vae=Qa(),Xi=dr(),Fy=eo(),yae=Cs(),wae=qt(),Cae=st(),Eae="round_robin";function fU(t){wae.trace(Cae.LogVerbosity.DEBUG,Eae,t)}var Ly="round_robin",B1=class t{getLoadBalancerName(){return Ly}constructor(){}toJsonObject(){return{[Ly]:{}}}static createFromJson(e){return new t}},V1=class{constructor(e,i=0){this.subchannelList=e,this.nextIndex=i}pick(e){let i=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:Fy.PickResultType.COMPLETE,subchannel:i,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},By=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=Xi.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(i,n,r,s,a)=>{this.calculateAndUpdateState(),(r===Xi.ConnectivityState.TRANSIENT_FAILURE||r===Xi.ConnectivityState.IDLE)&&(a&&(this.lastError=a),this.channelControlHelper.requestReresolution(),i.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(i=>i.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(Xi.ConnectivityState.READY)>0){let e=this.subchannels.filter(n=>n.getConnectivityState()===Xi.ConnectivityState.READY),i=0;this.currentReadyPicker!==null&&(i=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),i<0&&(i=0)),this.updateState(Xi.ConnectivityState.READY,new V1(e,i))}else this.countSubchannelsWithState(Xi.ConnectivityState.CONNECTING)>0?this.updateState(Xi.ConnectivityState.CONNECTING,new Fy.QueuePicker(this)):this.countSubchannelsWithState(Xi.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(Xi.ConnectivityState.TRANSIENT_FAILURE,new Fy.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(Xi.ConnectivityState.IDLE,new Fy.QueuePicker(this))}updateState(e,i){fU(Xi.ConnectivityState[this.currentState]+" -> "+Xi.ConnectivityState[e]),e===Xi.ConnectivityState.READY?this.currentReadyPicker=i:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,i)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,i){this.resetSubchannelList(),fU("Connect to address list "+e.map(n=>(0,yae.subchannelAddressToString)(n))),this.subchannels=e.map(n=>this.channelControlHelper.createSubchannel(n,{}));for(let n of this.subchannels){n.ref(),n.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(n.getChannelzRef());let r=n.getConnectivityState();(r===Xi.ConnectivityState.IDLE||r===Xi.ConnectivityState.TRANSIENT_FAILURE)&&n.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return Ly}};fu.RoundRobinLoadBalancer=By;function Sae(){(0,vae.registerLoadBalancerType)(Ly,By,B1)}fu.setup=Sae});var bU=x(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.experimental=J.addAdminServicesToServer=J.getChannelzHandlers=J.getChannelzServiceDefinition=J.InterceptorConfigurationError=J.InterceptingCall=J.RequesterBuilder=J.ListenerBuilder=J.StatusBuilder=J.getClientChannel=J.ServerCredentials=J.Server=J.setLogVerbosity=J.setLogger=J.load=J.loadObject=J.CallCredentials=J.ChannelCredentials=J.waitForClientReady=J.closeClient=J.Channel=J.makeGenericClientConstructor=J.makeClientConstructor=J.loadPackageDefinition=J.Client=J.compressionAlgorithms=J.propagate=J.connectivityState=J.status=J.logVerbosity=J.Metadata=J.credentials=void 0;var Vy=PT();Object.defineProperty(J,"CallCredentials",{enumerable:!0,get:function(){return Vy.CallCredentials}});var xae=fI();Object.defineProperty(J,"Channel",{enumerable:!0,get:function(){return xae.ChannelImplementation}});var Tae=HD();Object.defineProperty(J,"compressionAlgorithms",{enumerable:!0,get:function(){return Tae.CompressionAlgorithms}});var Iae=dr();Object.defineProperty(J,"connectivityState",{enumerable:!0,get:function(){return Iae.ConnectivityState}});var jy=Zb();Object.defineProperty(J,"ChannelCredentials",{enumerable:!0,get:function(){return jy.ChannelCredentials}});var pU=hI();Object.defineProperty(J,"Client",{enumerable:!0,get:function(){return pU.Client}});var j1=st();Object.defineProperty(J,"logVerbosity",{enumerable:!0,get:function(){return j1.LogVerbosity}});Object.defineProperty(J,"status",{enumerable:!0,get:function(){return j1.Status}});Object.defineProperty(J,"propagate",{enumerable:!0,get:function(){return j1.Propagate}});var gU=qt(),z1=pI();Object.defineProperty(J,"loadPackageDefinition",{enumerable:!0,get:function(){return z1.loadPackageDefinition}});Object.defineProperty(J,"makeClientConstructor",{enumerable:!0,get:function(){return z1.makeClientConstructor}});Object.defineProperty(J,"makeGenericClientConstructor",{enumerable:!0,get:function(){return z1.makeClientConstructor}});var Dae=fn();Object.defineProperty(J,"Metadata",{enumerable:!0,get:function(){return Dae.Metadata}});var kae=Q4();Object.defineProperty(J,"Server",{enumerable:!0,get:function(){return kae.Server}});var Aae=_1();Object.defineProperty(J,"ServerCredentials",{enumerable:!0,get:function(){return Aae.ServerCredentials}});var Rae=X4();Object.defineProperty(J,"StatusBuilder",{enumerable:!0,get:function(){return Rae.StatusBuilder}});J.credentials={combineChannelCredentials:(t,...e)=>e.reduce((i,n)=>i.compose(n),t),combineCallCredentials:(t,...e)=>e.reduce((i,n)=>i.compose(n),t),createInsecure:jy.ChannelCredentials.createInsecure,createSsl:jy.ChannelCredentials.createSsl,createFromSecureContext:jy.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:Vy.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:Vy.CallCredentials.createFromGoogleCredential,createEmpty:Vy.CallCredentials.createEmpty};var Mae=t=>t.close();J.closeClient=Mae;var Oae=(t,e,i)=>t.waitForReady(e,i);J.waitForClientReady=Oae;var Nae=(t,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};J.loadObject=Nae;var Pae=(t,e,i)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};J.load=Pae;var Fae=t=>{gU.setLogger(t)};J.setLogger=Fae;var Lae=t=>{gU.setLoggerVerbosity(t)};J.setLogVerbosity=Lae;var Bae=t=>pU.Client.prototype.getChannel.call(t);J.getClientChannel=Bae;var zy=cI();Object.defineProperty(J,"ListenerBuilder",{enumerable:!0,get:function(){return zy.ListenerBuilder}});Object.defineProperty(J,"RequesterBuilder",{enumerable:!0,get:function(){return zy.RequesterBuilder}});Object.defineProperty(J,"InterceptingCall",{enumerable:!0,get:function(){return zy.InterceptingCall}});Object.defineProperty(J,"InterceptorConfigurationError",{enumerable:!0,get:function(){return zy.InterceptorConfigurationError}});var _U=Vl();Object.defineProperty(J,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return _U.getChannelzServiceDefinition}});Object.defineProperty(J,"getChannelzHandlers",{enumerable:!0,get:function(){return _U.getChannelzHandlers}});var Vae=ov();Object.defineProperty(J,"addAdminServicesToServer",{enumerable:!0,get:function(){return Vae.addAdminServicesToServer}});var jae=A1();J.experimental=jae;var zae=RD(),Uae=rU(),qae=cU(),Hae=hU(),Wae=mU(),Gae=k1(),Kae=Vl();zae.setup(),Uae.setup(),qae.setup(),Hae.setup(),Wae.setup(),Gae.setup(),Kae.setup()});var Rw;try{Rw=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Rw=!1}var Ge=(()=>{let e=class e{constructor(n){this._platformId=n,this.isBrowser=this._platformId?gh(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Rw)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(r){return new(r||e)(C(nn))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var wh;function z6(){if(wh==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>wh=!0}))}finally{wh=wh||!1}return wh}function Xn(t){return z6()?t:!!t.capture}var Tr=function(t){return t[t.NORMAL=0]="NORMAL",t[t.NEGATED=1]="NEGATED",t[t.INVERTED=2]="INVERTED",t}(Tr||{}),vg,Zo;function yg(){if(Zo==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return Zo=!1,Zo;if("scrollBehavior"in document.documentElement.style)Zo=!0;else{let t=Element.prototype.scrollTo;t?Zo=!/\{\s*\[native code\]\s*\}/.test(t.toString()):Zo=!1}}return Zo}function Pc(){if(typeof document!="object"||!document)return Tr.NORMAL;if(vg==null){let t=document.createElement("div"),e=t.style;t.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";let i=document.createElement("div"),n=i.style;n.width="2px",n.height="1px",t.appendChild(i),document.body.appendChild(t),vg=Tr.NORMAL,t.scrollLeft===0&&(t.scrollLeft=1,vg=t.scrollLeft===0?Tr.NEGATED:Tr.INVERTED),t.remove()}return vg}var Aw;function U6(){if(Aw==null){let t=typeof document<"u"?document.head:null;Aw=!!(t&&(t.createShadowRoot||t.attachShadow))}return Aw}function qM(t){if(U6()){let e=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function Ch(){let t=typeof document<"u"&&document?document.activeElement:null;for(;t&&t.shadowRoot;){let e=t.shadowRoot.activeElement;if(e===t)break;t=e}return t}function Ir(t){return t.composedPath?t.composedPath()[0]:t.target}function Eh(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Ea(t,...e){return e.length?e.some(i=>t[i]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}function Mw(t){return t!=null&&`${t}`!="false"}function wg(t,e=0){return q6(t)?Number(t):e}function q6(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}function Fc(t){return Array.isArray(t)?t:[t]}function $t(t){return t==null?"":typeof t=="string"?t:`${t}px`}function Dr(t){return t instanceof le?t.nativeElement:t}var HM=(()=>{let e=class e{create(n){return typeof MutationObserver>"u"?null:new MutationObserver(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),H6=(()=>{let e=class e{constructor(n){this._mutationObserverFactory=n,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((n,r)=>this._cleanupObserver(r))}observe(n){let r=Dr(n);return new ni(s=>{let o=this._observeElement(r).subscribe(s);return()=>{o.unsubscribe(),this._unobserveElement(r)}})}_observeElement(n){if(this._observedElements.has(n))this._observedElements.get(n).count++;else{let r=new be,s=this._mutationObserverFactory.create(a=>r.next(a));s&&s.observe(n,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(n,{observer:s,stream:r,count:1})}return this._observedElements.get(n).stream}_unobserveElement(n){this._observedElements.has(n)&&(this._observedElements.get(n).count--,this._observedElements.get(n).count||this._cleanupObserver(n))}_cleanupObserver(n){if(this._observedElements.has(n)){let{observer:r,stream:s}=this._observedElements.get(n);r&&r.disconnect(),s.complete(),this._observedElements.delete(n)}}};e.\u0275fac=function(r){return new(r||e)(C(HM))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),WM=(()=>{let e=class e{get disabled(){return this._disabled}set disabled(n){this._disabled=n,this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(n){this._debounce=wg(n),this._subscribe()}constructor(n,r,s){this._contentObserver=n,this._elementRef=r,this._ngZone=s,this.event=new ae,this._disabled=!1,this._currentSubscription=null}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();let n=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?n.pipe(xc(this.debounce)):n).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)(g(H6),g(le),g(re))},e.\u0275dir=ie({type:e,selectors:[["","cdkObserveContent",""]],inputs:{disabled:[G.HasDecoratorInputTransform,"cdkObserveContentDisabled","disabled",qe],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"],standalone:!0,features:[yt]});let t=e;return t})(),Cg=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({providers:[HM]});let t=e;return t})();var GM=new Set,Jo,W6=(()=>{let e=class e{constructor(n,r){this._platform=n,this._nonce=r,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):K6}matchMedia(n){return(this._platform.WEBKIT||this._platform.BLINK)&&G6(n,this._nonce),this._matchMedia(n)}};e.\u0275fac=function(r){return new(r||e)(C(Ge),C(pM,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function G6(t,e){if(!GM.has(t))try{Jo||(Jo=document.createElement("style"),e&&(Jo.nonce=e),Jo.setAttribute("type","text/css"),document.head.appendChild(Jo)),Jo.sheet&&(Jo.sheet.insertRule(`@media ${t} {body{ }}`,0),GM.add(t))}catch(i){console.error(i)}}function K6(t){return{matches:t==="all"||t==="",media:t,addListener:()=>{},removeListener:()=>{}}}var Eg=(()=>{let e=class e{constructor(n,r){this._mediaMatcher=n,this._zone=r,this._queries=new Map,this._destroySubject=new be}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(n){return KM(Fc(n)).some(s=>this._registerQuery(s).mql.matches)}observe(n){let s=KM(Fc(n)).map(o=>this._registerQuery(o).observable),a=rM(s);return a=Jp(a.pipe(mi(1)),a.pipe(Ic(1),xc(0))),a.pipe(Ie(o=>{let l={matches:!1,breakpoints:{}};return o.forEach(({matches:c,query:d})=>{l.matches=l.matches||c,l.breakpoints[d]=c}),l}))}_registerQuery(n){if(this._queries.has(n))return this._queries.get(n);let r=this._mediaMatcher.matchMedia(n),a={observable:new ni(o=>{let l=c=>this._zone.run(()=>o.next(c));return r.addListener(l),()=>{r.removeListener(l)}}).pipe(Kt(r),Ie(({matches:o})=>({query:n,matches:o})),ot(this._destroySubject)),mql:r};return this._queries.set(n,a),a}};e.\u0275fac=function(r){return new(r||e)(C(W6),C(re))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function KM(t){return t.map(e=>e.split(",")).reduce((e,i)=>e.concat(i)).map(e=>e.trim())}var $M={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"};var Nw=class{constructor(e,i){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new be,this._typeaheadSubscription=At.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=n=>n.disabled,this._pressedLetters=[],this.tabOut=new be,this.change=new be,e instanceof es?this._itemChangesSubscription=e.changes.subscribe(n=>this._itemsChanged(n.toArray())):bw(e)&&(this._effectRef=wM(()=>this._itemsChanged(e()),{injector:i}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Xr(i=>this._pressedLetters.push(i)),xc(e),zt(()=>this._pressedLetters.length>0),Ie(()=>this._pressedLetters.join(""))).subscribe(i=>{let n=this._getItemsArray();for(let r=1;r<n.length+1;r++){let s=(this._activeItemIndex+r)%n.length,a=n[s];if(!this._skipPredicateFn(a)&&a.getLabel().toUpperCase().trim().indexOf(i)===0){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,i=10){return this._pageUpAndDown={enabled:e,delta:i},this}setActiveItem(e){let i=this._activeItem;this.updateActiveItem(e),this._activeItem!==i&&this.change.next(this._activeItemIndex)}onKeydown(e){let i=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(i){case 9:this.tabOut.next();return;case 40:if(this._vertical&&r){this.setNextItemActive();break}else return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}else return;case 39:if(this._horizontal&&r){this._horizontal==="rtl"?this.setPreviousItemActive():this.setNextItemActive();break}else return;case 37:if(this._horizontal&&r){this._horizontal==="rtl"?this.setNextItemActive():this.setPreviousItemActive();break}else return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}else return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}else return;case 33:if(this._pageUpAndDown.enabled&&r){let s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}else return;case 34:if(this._pageUpAndDown.enabled&&r){let s=this._activeItemIndex+this._pageUpAndDown.delta,a=this._getItemsArray().length;this._setActiveItemByIndex(s<a?s:a-1,-1);break}else return;default:(r||Ea(e,"shiftKey"))&&(e.key&&e.key.length===1?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(i>=65&&i<=90||i>=48&&i<=57)&&this._letterKeyStream.next(String.fromCharCode(i)));return}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){let i=this._getItemsArray(),n=typeof e=="number"?e:i.indexOf(e),r=i[n];this._activeItem=r??null,this._activeItemIndex=n}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){let i=this._getItemsArray();for(let n=1;n<=i.length;n++){let r=(this._activeItemIndex+e*n+i.length)%i.length,s=i[r];if(!this._skipPredicateFn(s)){this.setActiveItem(r);return}}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,i){let n=this._getItemsArray();if(n[e]){for(;this._skipPredicateFn(n[e]);)if(e+=i,!n[e])return;this.setActiveItem(e)}}_getItemsArray(){return bw(this._items)?this._items():this._items instanceof es?this._items.toArray():this._items}_itemsChanged(e){if(this._activeItem){let i=e.indexOf(this._activeItem);i>-1&&i!==this._activeItemIndex&&(this._activeItemIndex=i)}}};var Bc=class extends Nw{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}};var sW=(()=>{let e=class e{constructor(n){this._platform=n}isDisabled(n){return n.hasAttribute("disabled")}isVisible(n){return oW(n)&&getComputedStyle(n).visibility==="visible"}isTabbable(n){if(!this._platform.isBrowser)return!1;let r=aW(pW(n));if(r&&(YM(r)===-1||!this.isVisible(r)))return!1;let s=n.nodeName.toLowerCase(),a=YM(n);return n.hasAttribute("contenteditable")?a!==-1:s==="iframe"||s==="object"||this._platform.WEBKIT&&this._platform.IOS&&!fW(n)?!1:s==="audio"?n.hasAttribute("controls")?a!==-1:!1:s==="video"?a===-1?!1:a!==null?!0:this._platform.FIREFOX||n.hasAttribute("controls"):n.tabIndex>=0}isFocusable(n,r){return mW(n)&&!this.isDisabled(n)&&(r?.ignoreVisibility||this.isVisible(n))}};e.\u0275fac=function(r){return new(r||e)(C(Ge))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function aW(t){try{return t.frameElement}catch{return null}}function oW(t){return!!(t.offsetWidth||t.offsetHeight||typeof t.getClientRects=="function"&&t.getClientRects().length)}function lW(t){let e=t.nodeName.toLowerCase();return e==="input"||e==="select"||e==="button"||e==="textarea"}function cW(t){return uW(t)&&t.type=="hidden"}function dW(t){return hW(t)&&t.hasAttribute("href")}function uW(t){return t.nodeName.toLowerCase()=="input"}function hW(t){return t.nodeName.toLowerCase()=="a"}function ZM(t){if(!t.hasAttribute("tabindex")||t.tabIndex===void 0)return!1;let e=t.getAttribute("tabindex");return!!(e&&!isNaN(parseInt(e,10)))}function YM(t){if(!ZM(t))return null;let e=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}function fW(t){let e=t.nodeName.toLowerCase(),i=e==="input"&&t.type;return i==="text"||i==="password"||e==="select"||e==="textarea"}function mW(t){return cW(t)?!1:lW(t)||dW(t)||t.hasAttribute("contenteditable")||ZM(t)}function pW(t){return t.ownerDocument&&t.ownerDocument.defaultView||window}var Pw=class{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,i,n,r,s=!1){this._element=e,this._checker=i,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){let e=this._startAnchor,i=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),i&&(i.removeEventListener("focus",this.endAnchorListener),i.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(i=>{this._executeOnStable(()=>i(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(i=>{this._executeOnStable(()=>i(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(i=>{this._executeOnStable(()=>i(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){let i=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return e=="start"?i.length?i[0]:this._getFirstTabbableElement(this._element):i.length?i[i.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){let i=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(i){if(!this._checker.isFocusable(i)){let n=this._getFirstTabbableElement(i);return n?.focus(e),!!n}return i.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){let i=this._getRegionBoundary("start");return i&&i.focus(e),!!i}focusLastTabbableElement(e){let i=this._getRegionBoundary("end");return i&&i.focus(e),!!i}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let i=e.children;for(let n=0;n<i.length;n++){let r=i[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(i[n]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let i=e.children;for(let n=i.length-1;n>=0;n--){let r=i[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(i[n]):null;if(r)return r}return null}_createAnchor(){let e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,i){e?i.setAttribute("tabindex","0"):i.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(mi(1)).subscribe(e)}},gW=(()=>{let e=class e{constructor(n,r,s){this._checker=n,this._ngZone=r,this._document=s}create(n,r=!1){return new Pw(n,this._checker,this._ngZone,this._document,r)}};e.\u0275fac=function(r){return new(r||e)(C(sW),C(re),C(He))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),JM=(()=>{let e=class e{get enabled(){return this.focusTrap?.enabled||!1}set enabled(n){this.focusTrap&&(this.focusTrap.enabled=n)}constructor(n,r,s){this._elementRef=n,this._focusTrapFactory=r,this._previouslyFocusedElement=null,Ne(Ge).isBrowser&&(this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0))}ngOnDestroy(){this.focusTrap?.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap?.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap&&!this.focusTrap.hasAttached()&&this.focusTrap.attachAnchors()}ngOnChanges(n){let r=n.autoCapture;r&&!r.firstChange&&this.autoCapture&&this.focusTrap?.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=Ch(),this.focusTrap?.focusInitialElementWhenReady()}};e.\u0275fac=function(r){return new(r||e)(g(le),g(gW),g(He))},e.\u0275dir=ie({type:e,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:[G.HasDecoratorInputTransform,"cdkTrapFocus","enabled",qe],autoCapture:[G.HasDecoratorInputTransform,"cdkTrapFocusAutoCapture","autoCapture",qe]},exportAs:["cdkTrapFocus"],standalone:!0,features:[yt,gi]});let t=e;return t})();function Fw(t){return t.buttons===0||t.detail===0}function Lw(t){let e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var _W=new K("cdk-input-modality-detector-options"),bW={ignoreKeys:[18,17,224,91,16]},eO=650,Lc=Xn({passive:!0,capture:!0}),vW=(()=>{let e=class e{get mostRecentModality(){return this._modality.value}constructor(n,r,s,a){this._platform=n,this._mostRecentTarget=null,this._modality=new lh(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(l=>l===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Ir(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<eO||(this._modality.next(Fw(o)?"keyboard":"mouse"),this._mostRecentTarget=Ir(o))},this._onTouchstart=o=>{if(Lw(o)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Ir(o)},this._options=Me(Me({},bW),a),this.modalityDetected=this._modality.pipe(Ic(1)),this.modalityChanged=this.modalityDetected.pipe(Sr()),n.isBrowser&&r.runOutsideAngular(()=>{s.addEventListener("keydown",this._onKeydown,Lc),s.addEventListener("mousedown",this._onMousedown,Lc),s.addEventListener("touchstart",this._onTouchstart,Lc)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Lc),document.removeEventListener("mousedown",this._onMousedown,Lc),document.removeEventListener("touchstart",this._onTouchstart,Lc))}};e.\u0275fac=function(r){return new(r||e)(C(Ge),C(re),C(He),C(_W,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),yW=new K("liveAnnouncerElement",{providedIn:"root",factory:wW});function wW(){return null}var CW=new K("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),EW=0,tO=(()=>{let e=class e{constructor(n,r,s,a){this._ngZone=r,this._defaultOptions=a,this._document=s,this._liveElement=n||this._createLiveElement()}announce(n,...r){let s=this._defaultOptions,a,o;return r.length===1&&typeof r[0]=="number"?o=r[0]:[a,o]=r,this.clear(),clearTimeout(this._previousTimeout),a||(a=s&&s.politeness?s.politeness:"polite"),o==null&&s&&(o=s.duration),this._liveElement.setAttribute("aria-live",a),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(l=>this._currentResolve=l)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=n,typeof o=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),o)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let n="cdk-live-announcer-element",r=this._document.getElementsByClassName(n),s=this._document.createElement("div");for(let a=0;a<r.length;a++)r[a].remove();return s.classList.add(n),s.classList.add("cdk-visually-hidden"),s.setAttribute("aria-atomic","true"),s.setAttribute("aria-live","polite"),s.id=`cdk-live-announcer-${EW++}`,this._document.body.appendChild(s),s}_exposeAnnouncerToModals(n){let r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let s=0;s<r.length;s++){let a=r[s],o=a.getAttribute("aria-owns");o?o.indexOf(n)===-1&&a.setAttribute("aria-owns",o+" "+n):a.setAttribute("aria-owns",n)}}};e.\u0275fac=function(r){return new(r||e)(C(yW,8),C(re),C(He),C(CW,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var xg=function(t){return t[t.IMMEDIATE=0]="IMMEDIATE",t[t.EVENTUAL=1]="EVENTUAL",t}(xg||{}),SW=new K("cdk-focus-monitor-default-options"),Sg=Xn({passive:!0,capture:!0}),Mh=(()=>{let e=class e{constructor(n,r,s,a,o){this._ngZone=n,this._platform=r,this._inputModalityDetector=s,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new be,this._rootNodeFocusAndBlurListener=l=>{let c=Ir(l);for(let d=c;d;d=d.parentElement)l.type==="focus"?this._onFocus(l,d):this._onBlur(l,d)},this._document=a,this._detectionMode=o?.detectionMode||xg.IMMEDIATE}monitor(n,r=!1){let s=Dr(n);if(!this._platform.isBrowser||s.nodeType!==1)return et();let a=qM(s)||this._getDocument(),o=this._elementInfo.get(s);if(o)return r&&(o.checkChildren=!0),o.subject;let l={checkChildren:r,subject:new be,rootNode:a};return this._elementInfo.set(s,l),this._registerGlobalListeners(l),l.subject}stopMonitoring(n){let r=Dr(n),s=this._elementInfo.get(r);s&&(s.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(s))}focusVia(n,r,s){let a=Dr(n),o=this._getDocument().activeElement;a===o?this._getClosestElementsInfo(a).forEach(([l,c])=>this._originChanged(l,r,c)):(this._setOrigin(r),typeof a.focus=="function"&&a.focus(s))}ngOnDestroy(){this._elementInfo.forEach((n,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(n){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(n)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:n&&this._isLastInteractionFromInputLabel(n)?"mouse":"program"}_shouldBeAttributedToTouch(n){return this._detectionMode===xg.EVENTUAL||!!n?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(n,r){n.classList.toggle("cdk-focused",!!r),n.classList.toggle("cdk-touch-focused",r==="touch"),n.classList.toggle("cdk-keyboard-focused",r==="keyboard"),n.classList.toggle("cdk-mouse-focused",r==="mouse"),n.classList.toggle("cdk-program-focused",r==="program")}_setOrigin(n,r=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=n,this._originFromTouchInteraction=n==="touch"&&r,this._detectionMode===xg.IMMEDIATE){clearTimeout(this._originTimeoutId);let s=this._originFromTouchInteraction?eO:1;this._originTimeoutId=setTimeout(()=>this._origin=null,s)}})}_onFocus(n,r){let s=this._elementInfo.get(r),a=Ir(n);!s||!s.checkChildren&&r!==a||this._originChanged(r,this._getFocusOrigin(a),s)}_onBlur(n,r){let s=this._elementInfo.get(r);!s||s.checkChildren&&n.relatedTarget instanceof Node&&r.contains(n.relatedTarget)||(this._setClasses(r),this._emitOrigin(s,null))}_emitOrigin(n,r){n.subject.observers.length&&this._ngZone.run(()=>n.subject.next(r))}_registerGlobalListeners(n){if(!this._platform.isBrowser)return;let r=n.rootNode,s=this._rootNodeFocusListenerCount.get(r)||0;s||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,Sg),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,Sg)}),this._rootNodeFocusListenerCount.set(r,s+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ot(this._stopInputModalityDetector)).subscribe(a=>{this._setOrigin(a,!0)}))}_removeGlobalListeners(n){let r=n.rootNode;if(this._rootNodeFocusListenerCount.has(r)){let s=this._rootNodeFocusListenerCount.get(r);s>1?this._rootNodeFocusListenerCount.set(r,s-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Sg),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Sg),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(n,r,s){this._setClasses(n,r),this._emitOrigin(s,r),this._lastFocusOrigin=r}_getClosestElementsInfo(n){let r=[];return this._elementInfo.forEach((s,a)=>{(a===n||s.checkChildren&&a.contains(n))&&r.push([a,s])}),r}_isLastInteractionFromInputLabel(n){let{_mostRecentTarget:r,mostRecentModality:s}=this._inputModalityDetector;if(s!=="mouse"||!r||r===n||n.nodeName!=="INPUT"&&n.nodeName!=="TEXTAREA"||n.disabled)return!1;let a=n.labels;if(a){for(let o=0;o<a.length;o++)if(a[o].contains(r))return!0}return!1}};e.\u0275fac=function(r){return new(r||e)(C(re),C(Ge),C(vW),C(He,8),C(SW,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Tg=(()=>{let e=class e{constructor(n,r){this._elementRef=n,this._focusMonitor=r,this._focusOrigin=null,this.cdkFocusChange=new ae}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){let n=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(n,n.nodeType===1&&n.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(r=>{this._focusOrigin=r,this.cdkFocusChange.emit(r)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)(g(le),g(Mh))},e.\u0275dir=ie({type:e,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"],standalone:!0});let t=e;return t})(),el=function(t){return t[t.NONE=0]="NONE",t[t.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",t[t.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",t}(el||{}),QM="cdk-high-contrast-black-on-white",XM="cdk-high-contrast-white-on-black",Ow="cdk-high-contrast-active",Bw=(()=>{let e=class e{constructor(n,r){this._platform=n,this._document=r,this._breakpointSubscription=Ne(Eg).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return el.NONE;let n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);let r=this._document.defaultView||window,s=r&&r.getComputedStyle?r.getComputedStyle(n):null,a=(s&&s.backgroundColor||"").replace(/ /g,"");switch(n.remove(),a){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return el.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return el.BLACK_ON_WHITE}return el.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let n=this._document.body.classList;n.remove(Ow,QM,XM),this._hasCheckedHighContrastMode=!0;let r=this.getHighContrastMode();r===el.BLACK_ON_WHITE?n.add(Ow,QM):r===el.WHITE_ON_BLACK&&n.add(Ow,XM)}}};e.\u0275fac=function(r){return new(r||e)(C(Ge),C(He))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),iO=(()=>{let e=class e{constructor(n){n._applyBodyHighContrastModeCssClasses()}};e.\u0275fac=function(r){return new(r||e)(C(Bw))},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[Cg]});let t=e;return t})();var xW=new K("cdk-dir-doc",{providedIn:"root",factory:TW});function TW(){return Ne(He)}var IW=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function DW(t){let e=t?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?IW.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var Ci=(()=>{let e=class e{constructor(n){if(this.value="ltr",this.change=new ae,n){let r=n.body?n.body.dir:null,s=n.documentElement?n.documentElement.dir:null;this.value=DW(r||s||"ltr")}}ngOnDestroy(){this.change.complete()}};e.\u0275fac=function(r){return new(r||e)(C(xW,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var rs=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({});let t=e;return t})();function kW(){return!0}var AW=new K("mat-sanity-checks",{providedIn:"root",factory:kW}),De=(()=>{let e=class e{constructor(n,r,s){this._sanityChecks=r,this._document=s,this._hasDoneGlobalChecks=!1,n._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(n){return Eh()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[n]}};e.\u0275fac=function(r){return new(r||e)(C(Bw),C(AW,8),C(He))},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[rs,rs]});let t=e;return t})();var Jn=class{constructor(){this._localeChanges=new be,this.localeChanges=this._localeChanges}getValidDateOrNull(e){return this.isDateInstance(e)&&this.isValid(e)?e:null}deserialize(e){return e==null||this.isDateInstance(e)&&this.isValid(e)?e:this.invalid()}setLocale(e){this.locale=e,this._localeChanges.next()}compareDate(e,i){return this.getYear(e)-this.getYear(i)||this.getMonth(e)-this.getMonth(i)||this.getDate(e)-this.getDate(i)}sameDate(e,i){if(e&&i){let n=this.isValid(e),r=this.isValid(i);return n&&r?!this.compareDate(e,i):n==r}return e==i}clampDate(e,i,n){return i&&this.compareDate(e,i)<0?i:n&&this.compareDate(e,n)>0?n:e}},Nh=new K("mat-date-formats");var Vc=(()=>{let e=class e{isErrorState(n,r){return!!(n&&n.invalid&&(n.touched||r&&r.submitted))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Zn=function(t){return t[t.FADING_IN=0]="FADING_IN",t[t.VISIBLE=1]="VISIBLE",t[t.FADING_OUT=2]="FADING_OUT",t[t.HIDDEN=3]="HIDDEN",t}(Zn||{}),Uw=class{constructor(e,i,n,r=!1){this._renderer=e,this.element=i,this.config=n,this._animationForciblyDisabledThroughCss=r,this.state=Zn.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},nO=Xn({passive:!0,capture:!0}),qw=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let i=Ir(e);i&&this._events.get(e.type)?.forEach((n,r)=>{(r===i||r.contains(i))&&n.forEach(s=>s.handleEvent(e))})}}addHandler(e,i,n,r){let s=this._events.get(i);if(s){let a=s.get(n);a?a.add(r):s.set(n,new Set([r]))}else this._events.set(i,new Map([[n,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(i,this._delegateEventHandler,nO)})}removeHandler(e,i,n){let r=this._events.get(e);if(!r)return;let s=r.get(i);s&&(s.delete(n),s.size===0&&r.delete(i),r.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,nO)))}},rO={enterDuration:225,exitDuration:150},RW=800,sO=Xn({passive:!0,capture:!0}),aO=["mousedown","touchstart"],oO=["mouseup","mouseleave","touchend","touchcancel"],Oh=class Oh{constructor(e,i,n,r){this._target=e,this._ngZone=i,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Dr(n))}fadeInRipple(e,i,n={}){let r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Me(Me({},rO),n.animation);n.centered&&(e=r.left+r.width/2,i=r.top+r.height/2);let a=n.radius||MW(e,i,r),o=e-r.left,l=i-r.top,c=s.enterDuration,d=document.createElement("div");d.classList.add("mat-ripple-element"),d.style.left=`${o-a}px`,d.style.top=`${l-a}px`,d.style.height=`${a*2}px`,d.style.width=`${a*2}px`,n.color!=null&&(d.style.backgroundColor=n.color),d.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(d);let u=window.getComputedStyle(d),h=u.transitionProperty,f=u.transitionDuration,p=h==="none"||f==="0s"||f==="0s, 0s"||r.width===0&&r.height===0,v=new Uw(this,d,n,p);d.style.transform="scale3d(1, 1, 1)",v.state=Zn.FADING_IN,n.persistent||(this._mostRecentTransientRipple=v);let E=null;return!p&&(c||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let k=()=>this._finishRippleTransition(v),I=()=>this._destroyRipple(v);d.addEventListener("transitionend",k),d.addEventListener("transitioncancel",I),E={onTransitionEnd:k,onTransitionCancel:I}}),this._activeRipples.set(v,E),(p||!c)&&this._finishRippleTransition(v),v}fadeOutRipple(e){if(e.state===Zn.FADING_OUT||e.state===Zn.HIDDEN)return;let i=e.element,n=Me(Me({},rO),e.config.animation);i.style.transitionDuration=`${n.exitDuration}ms`,i.style.opacity="0",e.state=Zn.FADING_OUT,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let i=Dr(e);!this._platform.isBrowser||!i||i===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=i,aO.forEach(n=>{Oh._eventManager.addHandler(this._ngZone,n,i,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{oO.forEach(i=>{this._triggerElement.addEventListener(i,this,sO)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Zn.FADING_IN?this._startFadeOutTransition(e):e.state===Zn.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let i=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=Zn.VISIBLE,!n&&(!i||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let i=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Zn.HIDDEN,i!==null&&(e.element.removeEventListener("transitionend",i.onTransitionEnd),e.element.removeEventListener("transitioncancel",i.onTransitionCancel)),e.element.remove()}_onMousedown(e){let i=Fw(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+RW;!this._target.rippleDisabled&&!i&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!Lw(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let i=e.changedTouches;if(i)for(let n=0;n<i.length;n++)this.fadeInRipple(i[n].clientX,i[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let i=e.state===Zn.VISIBLE||e.config.terminateOnPointerUp&&e.state===Zn.FADING_IN;!e.config.persistent&&i&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(aO.forEach(i=>Oh._eventManager.removeHandler(i,e,this)),this._pointerUpEventsRegistered&&oO.forEach(i=>e.removeEventListener(i,this,sO)))}};Oh._eventManager=new qw;var Hw=Oh;function MW(t,e,i){let n=Math.max(Math.abs(t-i.left),Math.abs(t-i.right)),r=Math.max(Math.abs(e-i.top),Math.abs(e-i.bottom));return Math.sqrt(n*n+r*r)}var Ww=new K("mat-ripple-global-options"),jc=(()=>{let e=class e{get disabled(){return this._disabled}set disabled(n){n&&this.fadeOutAllNonPersistent(),this._disabled=n,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(n){this._trigger=n,this._setupTriggerEventsIfEnabled()}constructor(n,r,s,a,o){this._elementRef=n,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=a||{},this._rippleRenderer=new Hw(this,r,n,s)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Me(Me(Me({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(n,r=0,s){return typeof n=="number"?this._rippleRenderer.fadeInRipple(n,r,Me(Me({},this.rippleConfig),s)):this._rippleRenderer.fadeInRipple(0,0,Me(Me({},this.rippleConfig),n))}};e.\u0275fac=function(r){return new(r||e)(g(le),g(re),g(Ge),g(Ww,8),g(qi,8))},e.\u0275dir=ie({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(r,s){r&2&&ce("mat-ripple-unbounded",s.unbounded)},inputs:{color:[G.None,"matRippleColor","color"],unbounded:[G.None,"matRippleUnbounded","unbounded"],centered:[G.None,"matRippleCentered","centered"],radius:[G.None,"matRippleRadius","radius"],animation:[G.None,"matRippleAnimation","animation"],disabled:[G.None,"matRippleDisabled","disabled"],trigger:[G.None,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0});let t=e;return t})(),Ph=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De,De]});let t=e;return t})();var OW=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De]});let t=e;return t})();var Gw=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[Ph,De,OW]});let t=e;return t})(),lO={capture:!0},cO=["focus","click","mouseenter","touchstart"],jw="mat-ripple-loader-uninitialized",zw="mat-ripple-loader-class-name",dO="mat-ripple-loader-centered",Ig="mat-ripple-loader-disabled",uO=(()=>{let e=class e{constructor(){this._document=Ne(He,{optional:!0}),this._animationMode=Ne(qi,{optional:!0}),this._globalRippleOptions=Ne(Ww,{optional:!0}),this._platform=Ne(Ge),this._ngZone=Ne(re),this._hosts=new Map,this._onInteraction=n=>{if(!(n.target instanceof HTMLElement))return;let s=n.target.closest(`[${jw}]`);s&&this._createRipple(s)},this._ngZone.runOutsideAngular(()=>{for(let n of cO)this._document?.addEventListener(n,this._onInteraction,lO)})}ngOnDestroy(){let n=this._hosts.keys();for(let r of n)this.destroyRipple(r);for(let r of cO)this._document?.removeEventListener(r,this._onInteraction,lO)}configureRipple(n,r){n.setAttribute(jw,""),(r.className||!n.hasAttribute(zw))&&n.setAttribute(zw,r.className||""),r.centered&&n.setAttribute(dO,""),r.disabled&&n.setAttribute(Ig,"")}getRipple(n){return this._hosts.get(n)||this._createRipple(n)}setDisabled(n,r){let s=this._hosts.get(n);if(s){s.disabled=r;return}r?n.setAttribute(Ig,""):n.removeAttribute(Ig)}_createRipple(n){if(!this._document)return;let r=this._hosts.get(n);if(r)return r;n.querySelector(".mat-ripple")?.remove();let s=this._document.createElement("span");s.classList.add("mat-ripple",n.getAttribute(zw)),n.append(s);let a=new jc(new le(s),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return a._isInitialized=!0,a.trigger=n,a.centered=n.hasAttribute(dO),a.disabled=n.hasAttribute(Ig),this.attachRipple(n,a),a}attachRipple(n,r){n.removeAttribute(jw),this._hosts.set(n,r)}destroyRipple(n){let r=this._hosts.get(n);r&&(r.ngOnDestroy(),this._hosts.delete(n))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Kw=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De,Kn,De]});let t=e;return t})();var $w=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De,De]});let t=e;return t})();var NW=["*"],Dg;function PW(){if(Dg===void 0&&(Dg=null,typeof window<"u")){let t=window;t.trustedTypes!==void 0&&(Dg=t.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return Dg}function Fh(t){return PW()?.createHTML(t)||t}function fO(t){return Error(`Unable to find icon with the name "${t}"`)}function FW(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}function mO(t){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${t}".`)}function pO(t){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${t}".`)}var Gs=class{constructor(e,i,n){this.url=e,this.svgText=i,this.options=n}},LW=(()=>{let e=class e{constructor(n,r,s,a){this._httpClient=n,this._sanitizer=r,this._errorHandler=a,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=s}addSvgIcon(n,r,s){return this.addSvgIconInNamespace("",n,r,s)}addSvgIconLiteral(n,r,s){return this.addSvgIconLiteralInNamespace("",n,r,s)}addSvgIconInNamespace(n,r,s,a){return this._addSvgIconConfig(n,r,new Gs(s,null,a))}addSvgIconResolver(n){return this._resolvers.push(n),this}addSvgIconLiteralInNamespace(n,r,s,a){let o=this._sanitizer.sanitize(kc.HTML,s);if(!o)throw pO(s);let l=Fh(o);return this._addSvgIconConfig(n,r,new Gs("",l,a))}addSvgIconSet(n,r){return this.addSvgIconSetInNamespace("",n,r)}addSvgIconSetLiteral(n,r){return this.addSvgIconSetLiteralInNamespace("",n,r)}addSvgIconSetInNamespace(n,r,s){return this._addSvgIconSetConfig(n,new Gs(r,null,s))}addSvgIconSetLiteralInNamespace(n,r,s){let a=this._sanitizer.sanitize(kc.HTML,r);if(!a)throw pO(r);let o=Fh(a);return this._addSvgIconSetConfig(n,new Gs("",o,s))}registerFontClassAlias(n,r=n){return this._fontCssClassesByAlias.set(n,r),this}classNameForFontAlias(n){return this._fontCssClassesByAlias.get(n)||n}setDefaultFontSetClass(...n){return this._defaultFontSetClass=n,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(n){let r=this._sanitizer.sanitize(kc.RESOURCE_URL,n);if(!r)throw mO(n);let s=this._cachedIconsByUrl.get(r);return s?et(kg(s)):this._loadSvgIconFromConfig(new Gs(n,null)).pipe(Xr(a=>this._cachedIconsByUrl.set(r,a)),Ie(a=>kg(a)))}getNamedSvgIcon(n,r=""){let s=gO(r,n),a=this._svgIconConfigs.get(s);if(a)return this._getSvgFromConfig(a);if(a=this._getIconConfigFromResolvers(r,n),a)return this._svgIconConfigs.set(s,a),this._getSvgFromConfig(a);let o=this._iconSetConfigs.get(r);return o?this._getSvgFromIconSetConfigs(n,o):Zp(fO(s))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(n){return n.svgText?et(kg(this._svgElementFromConfig(n))):this._loadSvgIconFromConfig(n).pipe(Ie(r=>kg(r)))}_getSvgFromIconSetConfigs(n,r){let s=this._extractIconWithNameFromAnySet(n,r);if(s)return et(s);let a=r.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(aM(l=>{let d=`Loading icon set URL: ${this._sanitizer.sanitize(kc.RESOURCE_URL,o.url)} failed: ${l.message}`;return this._errorHandler.handleError(new Error(d)),et(null)})));return eg(a).pipe(Ie(()=>{let o=this._extractIconWithNameFromAnySet(n,r);if(!o)throw fO(n);return o}))}_extractIconWithNameFromAnySet(n,r){for(let s=r.length-1;s>=0;s--){let a=r[s];if(a.svgText&&a.svgText.toString().indexOf(n)>-1){let o=this._svgElementFromConfig(a),l=this._extractSvgIconFromSet(o,n,a.options);if(l)return l}}return null}_loadSvgIconFromConfig(n){return this._fetchIcon(n).pipe(Xr(r=>n.svgText=r),Ie(()=>this._svgElementFromConfig(n)))}_loadSvgIconSetFromConfig(n){return n.svgText?et(null):this._fetchIcon(n).pipe(Xr(r=>n.svgText=r))}_extractSvgIconFromSet(n,r,s){let a=n.querySelector(`[id="${r}"]`);if(!a)return null;let o=a.cloneNode(!0);if(o.removeAttribute("id"),o.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(o,s);if(o.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(o),s);let l=this._svgElementFromString(Fh("<svg></svg>"));return l.appendChild(o),this._setSvgAttributes(l,s)}_svgElementFromString(n){let r=this._document.createElement("DIV");r.innerHTML=n;let s=r.querySelector("svg");if(!s)throw Error("<svg> tag not found");return s}_toSvgElement(n){let r=this._svgElementFromString(Fh("<svg></svg>")),s=n.attributes;for(let a=0;a<s.length;a++){let{name:o,value:l}=s[a];o!=="id"&&r.setAttribute(o,l)}for(let a=0;a<n.childNodes.length;a++)n.childNodes[a].nodeType===this._document.ELEMENT_NODE&&r.appendChild(n.childNodes[a].cloneNode(!0));return r}_setSvgAttributes(n,r){return n.setAttribute("fit",""),n.setAttribute("height","100%"),n.setAttribute("width","100%"),n.setAttribute("preserveAspectRatio","xMidYMid meet"),n.setAttribute("focusable","false"),r&&r.viewBox&&n.setAttribute("viewBox",r.viewBox),n}_fetchIcon(n){let{url:r,options:s}=n,a=s?.withCredentials??!1;if(!this._httpClient)throw FW();if(r==null)throw Error(`Cannot fetch icon from URL "${r}".`);let o=this._sanitizer.sanitize(kc.RESOURCE_URL,r);if(!o)throw mO(r);let l=this._inProgressUrlFetches.get(o);if(l)return l;let c=this._httpClient.get(o,{responseType:"text",withCredentials:a}).pipe(Ie(d=>Fh(d)),lM(()=>this._inProgressUrlFetches.delete(o)),tg());return this._inProgressUrlFetches.set(o,c),c}_addSvgIconConfig(n,r,s){return this._svgIconConfigs.set(gO(n,r),s),this}_addSvgIconSetConfig(n,r){let s=this._iconSetConfigs.get(n);return s?s.push(r):this._iconSetConfigs.set(n,[r]),this}_svgElementFromConfig(n){if(!n.svgElement){let r=this._svgElementFromString(n.svgText);this._setSvgAttributes(r,n.options),n.svgElement=r}return n.svgElement}_getIconConfigFromResolvers(n,r){for(let s=0;s<this._resolvers.length;s++){let a=this._resolvers[s](r,n);if(a)return BW(a)?new Gs(a.url,null,a.options):new Gs(a,null)}}};e.\u0275fac=function(r){return new(r||e)(C(SM,8),C(IM),C(He,8),C(rg))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function kg(t){return t.cloneNode(!0)}function gO(t,e){return t+":"+e}function BW(t){return!!(t.url&&t.options)}var VW=new K("MAT_ICON_DEFAULT_OPTIONS"),jW=new K("mat-icon-location",{providedIn:"root",factory:zW});function zW(){let t=Ne(He),e=t?t.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}var _O=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],UW=_O.map(t=>`[${t}]`).join(", "),qW=/^url\(['"]?#(.*?)['"]?\)$/,bO=(()=>{let e=class e{get color(){return this._color||this._defaultColor}set color(n){this._color=n}get svgIcon(){return this._svgIcon}set svgIcon(n){n!==this._svgIcon&&(n?this._updateSvgIcon(n):this._svgIcon&&this._clearSvgElement(),this._svgIcon=n)}get fontSet(){return this._fontSet}set fontSet(n){let r=this._cleanupFontValue(n);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(n){let r=this._cleanupFontValue(n);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}constructor(n,r,s,a,o,l){this._elementRef=n,this._iconRegistry=r,this._location=a,this._errorHandler=o,this.inline=!1,this._previousFontSetClass=[],this._currentIconFetch=At.EMPTY,l&&(l.color&&(this.color=this._defaultColor=l.color),l.fontSet&&(this.fontSet=l.fontSet)),s||n.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(n){if(!n)return["",""];let r=n.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${n}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let n=this._elementsWithExternalReferences;if(n&&n.size){let r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(n){this._clearSvgElement();let r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(n),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(n)}_clearSvgElement(){let n=this._elementRef.nativeElement,r=n.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){let s=n.childNodes[r];(s.nodeType!==1||s.nodeName.toLowerCase()==="svg")&&s.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let n=this._elementRef.nativeElement,r=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(s=>s.length>0);this._previousFontSetClass.forEach(s=>n.classList.remove(s)),r.forEach(s=>n.classList.add(s)),this._previousFontSetClass=r,this.fontIcon!==this._previousFontIconClass&&!r.includes("mat-ligature-font")&&(this._previousFontIconClass&&n.classList.remove(this._previousFontIconClass),this.fontIcon&&n.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(n){return typeof n=="string"?n.trim().split(" ")[0]:n}_prependPathToReferences(n){let r=this._elementsWithExternalReferences;r&&r.forEach((s,a)=>{s.forEach(o=>{a.setAttribute(o.name,`url('${n}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(n){let r=n.querySelectorAll(UW),s=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let a=0;a<r.length;a++)_O.forEach(o=>{let l=r[a],c=l.getAttribute(o),d=c?c.match(qW):null;if(d){let u=s.get(l);u||(u=[],s.set(l,u)),u.push({name:o,value:d[1]})}})}_updateSvgIcon(n){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),n){let[r,s]=this._splitIconName(n);r&&(this._svgNamespace=r),s&&(this._svgName=s),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(s,r).pipe(mi(1)).subscribe(a=>this._setSvgElement(a),a=>{let o=`Error retrieving icon ${r}:${s}! ${a.message}`;this._errorHandler.handleError(new Error(o))})}}};e.\u0275fac=function(r){return new(r||e)(g(le),g(LW),Ko("aria-hidden"),g(jW),g(rg),g(VW,8))},e.\u0275cmp=ne({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(r,s){r&2&&(xe("data-mat-icon-type",s._usingFontIcon()?"font":"svg")("data-mat-icon-name",s._svgName||s.fontIcon)("data-mat-icon-namespace",s._svgNamespace||s.fontSet)("fontIcon",s._usingFontIcon()?s.fontIcon:null),An(s.color?"mat-"+s.color:""),ce("mat-icon-inline",s.inline)("mat-icon-no-color",s.color!=="primary"&&s.color!=="accent"&&s.color!=="warn"))},inputs:{color:"color",inline:[G.HasDecoratorInputTransform,"inline","inline",qe],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],standalone:!0,features:[yt,se],ngContentSelectors:NW,decls:1,vars:0,template:function(r,s){r&1&&(wt(),Ke(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0});let t=e;return t})(),Lh=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De,De]});let t=e;return t})();var Yw=class{constructor(e){this._box=e,this._destroyed=new be,this._resizeSubject=new be,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(i=>this._resizeSubject.next(i)))}observe(e){return this._elementObservables.has(e)||this._elementObservables.set(e,new ni(i=>{let n=this._resizeSubject.subscribe(i);return this._resizeObserver?.observe(e,{box:this._box}),()=>{this._resizeObserver?.unobserve(e),n.unsubscribe(),this._elementObservables.delete(e)}}).pipe(zt(i=>i.some(n=>n.target===e)),Tc({bufferSize:1,refCount:!0}),ot(this._destroyed))),this._elementObservables.get(e)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},vO=(()=>{let e=class e{constructor(){this._observers=new Map,this._ngZone=Ne(re),typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,n]of this._observers)n.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(n,r){let s=r?.box||"content-box";return this._observers.has(s)||this._observers.set(s,new Yw(s)),this._observers.get(s).observe(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var HW=["notch"],WW=["matFormFieldNotchedOutline",""],GW=["*"],KW=["textField"],$W=["iconPrefixContainer"],YW=["textPrefixContainer"],QW=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],XW=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function ZW(t,e){t&1&&$(0,"span",17)}function JW(t,e){if(t&1&&(_(0,"label",16),Ke(1,1),Se(2,ZW,1,0,"span",17),b()),t&2){let i=j(2);H("floating",i._shouldLabelFloat())("monitorResize",i._hasOutline())("id",i._labelId),xe("for",i._control.id),w(2),Pe(2,!i.hideRequiredMarker&&i._control.required?2:-1)}}function eG(t,e){if(t&1&&Se(0,JW,3,5,"label",16),t&2){let i=j();Pe(0,i._hasFloatingLabel()?0:-1)}}function tG(t,e){t&1&&$(0,"div",5)}function iG(t,e){}function nG(t,e){if(t&1&&Se(0,iG,0,0,"ng-template",11),t&2){j(2);let i=ts(1);H("ngTemplateOutlet",i)}}function rG(t,e){if(t&1&&(_(0,"div",7),Se(1,nG,1,1,null,11),b()),t&2){let i=j();H("matFormFieldNotchedOutlineOpen",i._shouldLabelFloat()),w(),Pe(1,i._forceDisplayInfixLabel()?-1:1)}}function sG(t,e){t&1&&(_(0,"div",8,2),Ke(2,2),b())}function aG(t,e){t&1&&(_(0,"div",9,3),Ke(2,3),b())}function oG(t,e){}function lG(t,e){if(t&1&&Se(0,oG,0,0,"ng-template",11),t&2){j();let i=ts(1);H("ngTemplateOutlet",i)}}function cG(t,e){t&1&&(_(0,"div",12),Ke(1,4),b())}function dG(t,e){t&1&&(_(0,"div",13),Ke(1,5),b())}function uG(t,e){t&1&&$(0,"div",14)}function hG(t,e){if(t&1&&(_(0,"div",18),Ke(1,6),b()),t&2){let i=j();H("@transitionMessages",i._subscriptAnimationState)}}function fG(t,e){if(t&1&&(_(0,"mat-hint",20),F(1),b()),t&2){let i=j(2);H("id",i._hintLabelId),w(),it(i.hintLabel)}}function mG(t,e){if(t&1&&(_(0,"div",19),Se(1,fG,2,2,"mat-hint",20),Ke(2,7),$(3,"div",21),Ke(4,8),b()),t&2){let i=j();H("@transitionMessages",i._subscriptAnimationState),w(),Pe(1,i.hintLabel?1:-1)}}var yO=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=ie({type:e,selectors:[["mat-label"]],standalone:!0});let t=e;return t})();var pG=new K("MatError");var gG=0,wO=(()=>{let e=class e{constructor(){this.align="start",this.id=`mat-mdc-hint-${gG++}`}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=ie({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(r,s){r&2&&(Yo("id",s.id),xe("align",null),ce("mat-mdc-form-field-hint-end",s.align==="end"))},inputs:{align:"align",id:"id"},standalone:!0});let t=e;return t})(),_G=new K("MatPrefix");var bG=new K("MatSuffix");var kO=new K("FloatingLabelParent"),CO=(()=>{let e=class e{get floating(){return this._floating}set floating(n){this._floating=n,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(n){this._monitorResize=n,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(n){this._elementRef=n,this._floating=!1,this._monitorResize=!1,this._resizeObserver=Ne(vO),this._ngZone=Ne(re),this._parent=Ne(kO),this._resizeSubscription=new At}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return vG(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}};e.\u0275fac=function(r){return new(r||e)(g(le))},e.\u0275dir=ie({type:e,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(r,s){r&2&&ce("mdc-floating-label--float-above",s.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0});let t=e;return t})();function vG(t){let e=t;if(e.offsetParent!==null)return e.scrollWidth;let i=e.cloneNode(!0);i.style.setProperty("position","absolute"),i.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(i);let n=i.scrollWidth;return i.remove(),n}var EO="mdc-line-ripple--active",Ag="mdc-line-ripple--deactivating",SO=(()=>{let e=class e{constructor(n,r){this._elementRef=n,this._handleTransitionEnd=s=>{let a=this._elementRef.nativeElement.classList,o=a.contains(Ag);s.propertyName==="opacity"&&o&&a.remove(EO,Ag)},r.runOutsideAngular(()=>{n.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let n=this._elementRef.nativeElement.classList;n.remove(Ag),n.add(EO)}deactivate(){this._elementRef.nativeElement.classList.add(Ag)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}};e.\u0275fac=function(r){return new(r||e)(g(le),g(re))},e.\u0275dir=ie({type:e,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0});let t=e;return t})(),xO=(()=>{let e=class e{constructor(n,r){this._elementRef=n,this._ngZone=r,this.open=!1}ngAfterViewInit(){let n=this._elementRef.nativeElement.querySelector(".mdc-floating-label");n?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(n.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>n.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(n){!this.open||!n?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${n}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}};e.\u0275fac=function(r){return new(r||e)(g(le),g(re))},e.\u0275cmp=ne({type:e,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(r,s){if(r&1&&Be(HW,5),r&2){let a;de(a=ue())&&(s._notch=a.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(r,s){r&2&&ce("mdc-notched-outline--notched",s.open)},inputs:{open:[G.None,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[se],attrs:WW,ngContentSelectors:GW,decls:5,vars:0,consts:[["notch",""],[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(r,s){r&1&&(wt(),$(0,"div",1),_(1,"div",2,0),Ke(3),b(),$(4,"div",3))},encapsulation:2,changeDetection:0});let t=e;return t})(),yG={transitionMessages:$n("transitionMessages",[_i("enter",ht({opacity:1,transform:"translateY(0%)"})),Pi("void => enter",[ht({opacity:0,transform:"translateY(-5px)"}),Ni("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},Qw=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=ie({type:e});let t=e;return t})();var Xw=new K("MatFormField"),wG=new K("MAT_FORM_FIELD_DEFAULT_OPTIONS"),TO=0,IO="fill",CG="auto",DO="fixed",EG="translateY(-50%)",AO=(()=>{let e=class e{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(n){this._hideRequiredMarker=Mw(n)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||CG}set floatLabel(n){n!==this._floatLabel&&(this._floatLabel=n,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(n){let r=this._appearance,s=n||this._defaults?.appearance||IO;this._appearance=s,this._appearance==="outline"&&this._appearance!==r&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||DO}set subscriptSizing(n){this._subscriptSizing=n||this._defaults?.subscriptSizing||DO}get hintLabel(){return this._hintLabel}set hintLabel(n){this._hintLabel=n,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(n){this._explicitFormFieldControl=n}constructor(n,r,s,a,o,l,c,d){this._elementRef=n,this._changeDetectorRef=r,this._ngZone=s,this._dir=a,this._platform=o,this._defaults=l,this._animationMode=c,this._hideRequiredMarker=!1,this.color="primary",this._appearance=IO,this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId=`mat-mdc-form-field-label-${TO++}`,this._hintLabelId=`mat-mdc-hint-${TO++}`,this._subscriptAnimationState="",this._destroyed=new be,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,l&&(l.appearance&&(this.appearance=l.appearance),this._hideRequiredMarker=!!l?.hideRequiredMarker,l.color&&(this.color=l.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){let n=this._control;n.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${n.controlType}`),n.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),n.ngControl&&n.ngControl.valueChanges&&n.ngControl.valueChanges.pipe(ot(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(n=>!n._isText),this._hasTextPrefix=!!this._prefixChildren.find(n=>n._isText),this._hasIconSuffix=!!this._suffixChildren.find(n=>!n._isText),this._hasTextSuffix=!!this._suffixChildren.find(n=>n._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),fi(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(ot(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(ot(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(n){let r=this._control?this._control.ngControl:null;return r&&r[n]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let n=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&n.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let r=this._hintChildren?this._hintChildren.find(a=>a.align==="start"):null,s=this._hintChildren?this._hintChildren.find(a=>a.align==="end"):null;r?n.push(r.id):this._hintLabel&&n.push(this._hintLabelId),s&&n.push(s.id)}else this._errorChildren&&n.push(...this._errorChildren.map(r=>r.id));this._control.setDescribedByIds(n)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;let n=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){n.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdateOnStable=!0;return}let r=this._iconPrefixContainer?.nativeElement,s=this._textPrefixContainer?.nativeElement,a=r?.getBoundingClientRect().width??0,o=s?.getBoundingClientRect().width??0,l=this._dir.value==="rtl"?"-1":"1",c=`${a+o}px`,u=`calc(${l} * (${c} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;n.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${EG} translateX(${u})
    )`}_isAttachedToDom(){let n=this._elementRef.nativeElement;if(n.getRootNode){let r=n.getRootNode();return r&&r!==n}return document.documentElement.contains(n)}};e.\u0275fac=function(r){return new(r||e)(g(le),g(lt),g(re),g(Ci),g(Ge),g(wG,8),g(qi,8),g(He))},e.\u0275cmp=ne({type:e,selectors:[["mat-form-field"]],contentQueries:function(r,s,a){if(r&1&&(mt(a,yO,5),mt(a,yO,7),mt(a,Qw,5),mt(a,_G,5),mt(a,bG,5),mt(a,pG,5),mt(a,wO,5)),r&2){let o;de(o=ue())&&(s._labelChildNonStatic=o.first),de(o=ue())&&(s._labelChildStatic=o.first),de(o=ue())&&(s._formFieldControl=o.first),de(o=ue())&&(s._prefixChildren=o),de(o=ue())&&(s._suffixChildren=o),de(o=ue())&&(s._errorChildren=o),de(o=ue())&&(s._hintChildren=o)}},viewQuery:function(r,s){if(r&1&&(Be(KW,5),Be($W,5),Be(YW,5),Be(CO,5),Be(xO,5),Be(SO,5)),r&2){let a;de(a=ue())&&(s._textField=a.first),de(a=ue())&&(s._iconPrefixContainer=a.first),de(a=ue())&&(s._textPrefixContainer=a.first),de(a=ue())&&(s._floatingLabel=a.first),de(a=ue())&&(s._notchedOutline=a.first),de(a=ue())&&(s._lineRipple=a.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(r,s){r&2&&ce("mat-mdc-form-field-label-always-float",s._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",s._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",s._hasIconSuffix)("mat-form-field-invalid",s._control.errorState)("mat-form-field-disabled",s._control.disabled)("mat-form-field-autofilled",s._control.autofilled)("mat-form-field-no-animations",s._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",s.appearance=="fill")("mat-form-field-appearance-outline",s.appearance=="outline")("mat-form-field-hide-placeholder",s._hasFloatingLabel()&&!s._shouldLabelFloat())("mat-focused",s._control.focused)("mat-primary",s.color!=="accent"&&s.color!=="warn")("mat-accent",s.color==="accent")("mat-warn",s.color==="warn")("ng-untouched",s._shouldForward("untouched"))("ng-touched",s._shouldForward("touched"))("ng-pristine",s._shouldForward("pristine"))("ng-dirty",s._shouldForward("dirty"))("ng-valid",s._shouldForward("valid"))("ng-invalid",s._shouldForward("invalid"))("ng-pending",s._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[pt([{provide:Xw,useExisting:e},{provide:kO,useExisting:e}]),se],ngContentSelectors:XW,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(r,s){if(r&1){let a=ft();wt(QW),Se(0,eG,1,1,"ng-template",null,0,ag),_(2,"div",4,1),Z("click",function(l){return ve(a),ye(s._control.onContainerClick(l))}),Se(4,tG,1,0,"div",5),_(5,"div",6),Se(6,rG,2,2,"div",7)(7,sG,3,0,"div",8)(8,aG,3,0,"div",9),_(9,"div",10),Se(10,lG,1,1,null,11),Ke(11),b(),Se(12,cG,2,0,"div",12)(13,dG,2,0,"div",13),b(),Se(14,uG,1,0,"div",14),b(),_(15,"div",15),Se(16,hG,2,1)(17,mG,5,2),b()}if(r&2){let a;w(2),ce("mdc-text-field--filled",!s._hasOutline())("mdc-text-field--outlined",s._hasOutline())("mdc-text-field--no-label",!s._hasFloatingLabel())("mdc-text-field--disabled",s._control.disabled)("mdc-text-field--invalid",s._control.errorState),w(2),Pe(4,!s._hasOutline()&&!s._control.disabled?4:-1),w(2),Pe(6,s._hasOutline()?6:-1),w(),Pe(7,s._hasIconPrefix?7:-1),w(),Pe(8,s._hasTextPrefix?8:-1),w(2),Pe(10,!s._hasOutline()||s._forceDisplayInfixLabel()?10:-1),w(2),Pe(12,s._hasTextSuffix?12:-1),w(),Pe(13,s._hasIconSuffix?13:-1),w(),Pe(14,s._hasOutline()?-1:14),w(),ce("mat-mdc-form-field-subscript-dynamic-size",s.subscriptSizing==="dynamic"),w(),Pe(16,(a=s._getDisplayedMessages())==="error"?16:a==="hint"?17:-1)}},dependencies:[CO,xO,ph,SO,wO],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-hover-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-hover-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-hover-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-hover-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(.75*var(--mdc-outlined-text-field-label-text-size))}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mdc-outlined-text-field-label-text-size)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color)}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color)}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color)}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[yG.transitionMessages]},changeDetection:0});let t=e;return t})(),Sa=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De,Kn,Cg,De]});let t=e;return t})();var RO=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({});let t=e;return t})();var zO=(()=>{let e=class e{constructor(n,r){this._renderer=n,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}};e.\u0275fac=function(r){return new(r||e)(g(uh),g(le))},e.\u0275dir=ie({type:e});let t=e;return t})(),Bg=(()=>{let e=class e extends zO{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Jr(e)))(s||e)}})(),e.\u0275dir=ie({type:e,features:[tt]});let t=e;return t})(),qc=new K("");var SG={provide:qc,useExisting:Ui(()=>ss),multi:!0};function xG(){let t=yw()?yw().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var TG=new K(""),ss=(()=>{let e=class e extends zO{constructor(n,r,s){super(n,r),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!xG())}writeValue(n){let r=n??"";this.setProperty("value",r)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}};e.\u0275fac=function(r){return new(r||e)(g(uh),g(le),g(TG,8))},e.\u0275dir=ie({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,s){r&1&&Z("input",function(o){return s._handleInput(o.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(o){return s._compositionEnd(o.target.value)})},features:[pt([SG]),tt]});let t=e;return t})();function xa(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function UO(t){return t!=null&&typeof t.length=="number"}var iC=new K(""),nC=new K(""),IG=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,er=class{static min(e){return DG(e)}static max(e){return kG(e)}static required(e){return AG(e)}static requiredTrue(e){return RG(e)}static email(e){return MG(e)}static minLength(e){return OG(e)}static maxLength(e){return NG(e)}static pattern(e){return PG(e)}static nullValidator(e){return qO(e)}static compose(e){return YO(e)}static composeAsync(e){return XO(e)}};function DG(t){return e=>{if(xa(e.value)||xa(t))return null;let i=parseFloat(e.value);return!isNaN(i)&&i<t?{min:{min:t,actual:e.value}}:null}}function kG(t){return e=>{if(xa(e.value)||xa(t))return null;let i=parseFloat(e.value);return!isNaN(i)&&i>t?{max:{max:t,actual:e.value}}:null}}function AG(t){return xa(t.value)?{required:!0}:null}function RG(t){return t.value===!0?null:{required:!0}}function MG(t){return xa(t.value)||IG.test(t.value)?null:{email:!0}}function OG(t){return e=>xa(e.value)||!UO(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function NG(t){return e=>UO(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function PG(t){if(!t)return qO;let e,i;return typeof t=="string"?(i="",t.charAt(0)!=="^"&&(i+="^"),i+=t,t.charAt(t.length-1)!=="$"&&(i+="$"),e=new RegExp(i)):(i=t.toString(),e=t),n=>{if(xa(n.value))return null;let r=n.value;return e.test(r)?null:{pattern:{requiredPattern:i,actualValue:r}}}}function qO(t){return null}function HO(t){return t!=null}function WO(t){return vM(t)?Yr(t):t}function GO(t){let e={};return t.forEach(i=>{e=i!=null?Me(Me({},e),i):e}),Object.keys(e).length===0?null:e}function KO(t,e){return e.map(i=>i(t))}function FG(t){return!t.validate}function $O(t){return t.map(e=>FG(e)?e:i=>e.validate(i))}function YO(t){if(!t)return null;let e=t.filter(HO);return e.length==0?null:function(i){return GO(KO(i,e))}}function QO(t){return t!=null?YO($O(t)):null}function XO(t){if(!t)return null;let e=t.filter(HO);return e.length==0?null:function(i){let n=KO(i,e).map(WO);return eg(n).pipe(Ie(GO))}}function ZO(t){return t!=null?XO($O(t)):null}function MO(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function JO(t){return t._rawValidators}function eN(t){return t._rawAsyncValidators}function Zw(t){return t?Array.isArray(t)?t:[t]:[]}function Mg(t,e){return Array.isArray(t)?t.includes(e):t===e}function OO(t,e){let i=Zw(e);return Zw(t).forEach(r=>{Mg(i,r)||i.push(r)}),i}function NO(t,e){return Zw(e).filter(i=>!Mg(t,i))}var Og=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=QO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=ZO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,i){return this.control?this.control.hasError(e,i):!1}getError(e,i){return this.control?this.control.getError(e,i):null}},il=class extends Og{get formDirective(){return null}get path(){return null}},nl=class extends Og{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Ng=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},LG={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},x_e=tn(Me({},LG),{"[class.ng-submitted]":"isSubmitted"}),as=(()=>{let e=class e extends Ng{constructor(n){super(n)}};e.\u0275fac=function(r){return new(r||e)(g(nl,2))},e.\u0275dir=ie({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,s){r&2&&ce("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[tt]});let t=e;return t})(),Vg=(()=>{let e=class e extends Ng{constructor(n){super(n)}};e.\u0275fac=function(r){return new(r||e)(g(il,10))},e.\u0275dir=ie({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,s){r&2&&ce("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[tt]});let t=e;return t})();var Bh="VALID",Rg="INVALID",zc="PENDING",Vh="DISABLED";function rC(t){return(jg(t)?t.validators:t)||null}function BG(t){return Array.isArray(t)?QO(t):t||null}function sC(t,e){return(jg(e)?e.asyncValidators:t)||null}function VG(t){return Array.isArray(t)?ZO(t):t||null}function jg(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function tN(t,e,i){let n=t.controls;if(!(e?Object.keys(n):n).length)throw new Dc(1e3,"");if(!n[i])throw new Dc(1001,"")}function iN(t,e,i){t._forEachChild((n,r)=>{if(i[r]===void 0)throw new Dc(1002,"")})}var Uc=class{constructor(e,i){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(i)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Bh}get invalid(){return this.status===Rg}get pending(){return this.status==zc}get disabled(){return this.status===Vh}get enabled(){return this.status!==Vh}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(OO(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(OO(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(NO(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(NO(e,this._rawAsyncValidators))}hasValidator(e){return Mg(this._rawValidators,e)}hasAsyncValidator(e){return Mg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(i=>{i.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=zc,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let i=this._parentMarkedDirty(e.onlySelf);this.status=Vh,this.errors=null,this._forEachChild(n=>{n.disable(tn(Me({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(tn(Me({},e),{skipPristineCheck:i})),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){let i=this._parentMarkedDirty(e.onlySelf);this.status=Bh,this._forEachChild(n=>{n.enable(tn(Me({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(tn(Me({},e),{skipPristineCheck:i})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Bh||this.status===zc)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(i=>i._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Vh:Bh}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=zc,this._hasOwnPendingAsyncValidator=!0;let i=WO(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,i={}){this.errors=e,this._updateControlsErrors(i.emitEvent!==!1)}get(e){let i=e;return i==null||(Array.isArray(i)||(i=i.split(".")),i.length===0)?null:i.reduce((n,r)=>n&&n._find(r),this)}getError(e,i){let n=i?this.get(i):this;return n&&n.errors?n.errors[e]:null}hasError(e,i){return!!this.getError(e,i)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ae,this.statusChanges=new ae}_calculateStatus(){return this._allControlsDisabled()?Vh:this.errors?Rg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(zc)?zc:this._anyControlsHaveStatus(Rg)?Rg:Bh}_anyControlsHaveStatus(e){return this._anyControls(i=>i.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){jg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let i=this._parent&&this._parent.dirty;return!e&&!!i&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=BG(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=VG(this._rawAsyncValidators)}},Pg=class extends Uc{constructor(e,i,n){super(rC(i),sC(n,i)),this.controls=e,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,i){return this.controls[e]?this.controls[e]:(this.controls[e]=i,i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange),i)}addControl(e,i,n={}){this.registerControl(e,i),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}setControl(e,i,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],i&&this.registerControl(e,i),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,i={}){iN(this,!0,e),Object.keys(e).forEach(n=>{tN(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(e,i={}){e!=null&&(Object.keys(e).forEach(n=>{let r=this.controls[n];r&&r.patchValue(e[n],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(e={},i={}){this._forEachChild((n,r)=>{n.reset(e?e[r]:null,{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this._reduceChildren({},(e,i,n)=>(e[n]=i.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(i,n)=>n._syncPendingControls()?!0:i);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(i=>{let n=this.controls[i];n&&e(n,i)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[i,n]of Object.entries(this.controls))if(this.contains(i)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(i,n,r)=>((n.enabled||this.disabled)&&(i[r]=n.value),i))}_reduceChildren(e,i){let n=e;return this._forEachChild((r,s)=>{n=i(n,r,s)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Jw=class extends Pg{};var zg=new K("CallSetDisabledState",{providedIn:"root",factory:()=>Ug}),Ug="always";function nN(t,e){return[...e.path,t]}function eC(t,e,i=Ug){aC(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||i==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),zG(t,e),qG(t,e),UG(t,e),jG(t,e)}function PO(t,e,i=!0){let n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),Lg(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function Fg(t,e){t.forEach(i=>{i.registerOnValidatorChange&&i.registerOnValidatorChange(e)})}function jG(t,e){if(e.valueAccessor.setDisabledState){let i=n=>{e.valueAccessor.setDisabledState(n)};t.registerOnDisabledChange(i),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(i)})}}function aC(t,e){let i=JO(t);e.validator!==null?t.setValidators(MO(i,e.validator)):typeof i=="function"&&t.setValidators([i]);let n=eN(t);e.asyncValidator!==null?t.setAsyncValidators(MO(n,e.asyncValidator)):typeof n=="function"&&t.setAsyncValidators([n]);let r=()=>t.updateValueAndValidity();Fg(e._rawValidators,r),Fg(e._rawAsyncValidators,r)}function Lg(t,e){let i=!1;if(t!==null){if(e.validator!==null){let r=JO(t);if(Array.isArray(r)&&r.length>0){let s=r.filter(a=>a!==e.validator);s.length!==r.length&&(i=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let r=eN(t);if(Array.isArray(r)&&r.length>0){let s=r.filter(a=>a!==e.asyncValidator);s.length!==r.length&&(i=!0,t.setAsyncValidators(s))}}}let n=()=>{};return Fg(e._rawValidators,n),Fg(e._rawAsyncValidators,n),i}function zG(t,e){e.valueAccessor.registerOnChange(i=>{t._pendingValue=i,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&rN(t,e)})}function UG(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&rN(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function rN(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function qG(t,e){let i=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};t.registerOnChange(i),e._registerOnDestroy(()=>{t._unregisterOnChange(i)})}function HG(t,e){t==null,aC(t,e)}function WG(t,e){return Lg(t,e)}function sN(t,e){if(!t.hasOwnProperty("model"))return!1;let i=t.model;return i.isFirstChange()?!0:!Object.is(e,i.currentValue)}function GG(t){return Object.getPrototypeOf(t.constructor)===Bg}function KG(t,e){t._syncPendingControls(),e.forEach(i=>{let n=i.control;n.updateOn==="submit"&&n._pendingChange&&(i.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function aN(t,e){if(!e)return null;Array.isArray(e);let i,n,r;return e.forEach(s=>{s.constructor===ss?i=s:GG(s)?n=s:r=s}),r||n||i||null}function $G(t,e){let i=t.indexOf(e);i>-1&&t.splice(i,1)}function FO(t,e){let i=t.indexOf(e);i>-1&&t.splice(i,1)}function LO(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var jh=class extends Uc{constructor(e=null,i,n){super(rC(i),sC(n,i)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(i),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),jg(i)&&(i.nonNullable||i.initialValueIsDefault)&&(LO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,i={}){this.value=this._pendingValue=e,this._onChange.length&&i.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,i.emitViewToModelChange!==!1)),this.updateValueAndValidity(i)}patchValue(e,i={}){this.setValue(e,i)}reset(e=this.defaultValue,i={}){this._applyFormState(e),this.markAsPristine(i),this.markAsUntouched(i),this.setValue(this.value,i),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){FO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){FO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){LO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var YG=t=>t instanceof jh;var QG={provide:nl,useExisting:Ui(()=>rl)},BO=Promise.resolve(),rl=(()=>{let e=class e extends nl{constructor(n,r,s,a,o,l){super(),this._changeDetectorRef=o,this.callSetDisabledState=l,this.control=new jh,this._registered=!1,this.name="",this.update=new ae,this._parent=n,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=aN(this,a)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let r=n.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),sN(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){eC(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){BO.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let r=n.isDisabled.currentValue,s=r!==0&&qe(r);BO.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?nN(n,this._parent):[n]}};e.\u0275fac=function(r){return new(r||e)(g(il,9),g(iC,10),g(nC,10),g(qc,10),g(lt,8),g(zg,8))},e.\u0275dir=ie({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[G.None,"disabled","isDisabled"],model:[G.None,"ngModel","model"],options:[G.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[pt([QG]),tt,gi]});let t=e;return t})(),qg=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=ie({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})(),XG={provide:qc,useExisting:Ui(()=>zh),multi:!0},zh=(()=>{let e=class e extends Bg{writeValue(n){let r=n??"";this.setProperty("value",r)}registerOnChange(n){this.onChange=r=>{n(r==""?null:parseFloat(r))}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Jr(e)))(s||e)}})(),e.\u0275dir=ie({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,s){r&1&&Z("input",function(o){return s.onChange(o.target.value)})("blur",function(){return s.onTouched()})},features:[pt([XG]),tt]});let t=e;return t})();var oN=new K("");var ZG={provide:il,useExisting:Ui(()=>Uh)},Uh=(()=>{let e=class e extends il{constructor(n,r,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ae,this._setValidators(n),this._setAsyncValidators(r)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Lg(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){let r=this.form.get(n.path);return eC(r,n,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),r}getControl(n){return this.form.get(n.path)}removeControl(n){PO(n.control||null,n,!1),$G(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,r){this.form.get(n.path).setValue(r)}onSubmit(n){return this.submitted=!0,KG(this.form,this.directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{let r=n.control,s=this.form.get(n.path);r!==s&&(PO(r||null,n),YG(s)&&(eC(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){let r=this.form.get(n.path);HG(r,n),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){let r=this.form.get(n.path);r&&WG(r,n)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){aC(this.form,this),this._oldForm&&Lg(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(r){return new(r||e)(g(iC,10),g(nC,10),g(zg,8))},e.\u0275dir=ie({type:e,selectors:[["","formGroup",""]],hostBindings:function(r,s){r&1&&Z("submit",function(o){return s.onSubmit(o)})("reset",function(){return s.onReset()})},inputs:{form:[G.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[pt([ZG]),tt,gi]});let t=e;return t})();var JG={provide:nl,useExisting:Ui(()=>qh)},qh=(()=>{let e=class e extends nl{set isDisabled(n){}constructor(n,r,s,a,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new ae,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=aN(this,a)}ngOnChanges(n){this._added||this._setUpControl(),sN(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return nN(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(r){return new(r||e)(g(il,13),g(iC,10),g(nC,10),g(qc,10),g(oN,8))},e.\u0275dir=ie({type:e,selectors:[["","formControlName",""]],inputs:{name:[G.None,"formControlName","name"],isDisabled:[G.None,"disabled","isDisabled"],model:[G.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[pt([JG]),tt,gi]});let t=e;return t})(),e8={provide:qc,useExisting:Ui(()=>Hc),multi:!0};function lN(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function t8(t){return t.split(":")[0]}var Hc=(()=>{let e=class e extends Bg{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;let r=this._getOptionId(n),s=lN(r,n);this.setProperty("value",s)}registerOnChange(n){this.onChange=r=>{this.value=this._getOptionValue(r),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),n))return r;return null}_getOptionValue(n){let r=t8(n);return this._optionMap.has(r)?this._optionMap.get(r):n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Jr(e)))(s||e)}})(),e.\u0275dir=ie({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,s){r&1&&Z("change",function(o){return s.onChange(o.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[pt([e8]),tt]});let t=e;return t})(),Hg=(()=>{let e=class e{constructor(n,r,s){this._element=n,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(n){this._select!=null&&(this._select._optionMap.set(this.id,n),this._setElementValue(lN(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(r){return new(r||e)(g(le),g(uh),g(Hc,9))},e.\u0275dir=ie({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),i8={provide:qc,useExisting:Ui(()=>cN),multi:!0};function VO(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function n8(t){return t.split(":")[0]}var cN=(()=>{let e=class e extends Bg{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;let r;if(Array.isArray(n)){let s=n.map(a=>this._getOptionId(a));r=(a,o)=>{a._setSelected(s.indexOf(o.toString())>-1)}}else r=(s,a)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(n){this.onChange=r=>{let s=[],a=r.selectedOptions;if(a!==void 0){let o=a;for(let l=0;l<o.length;l++){let c=o[l],d=this._getOptionValue(c.value);s.push(d)}}else{let o=r.options;for(let l=0;l<o.length;l++){let c=o[l];if(c.selected){let d=this._getOptionValue(c.value);s.push(d)}}}this.value=s,n(s)}}_registerOption(n){let r=(this._idCounter++).toString();return this._optionMap.set(r,n),r}_getOptionId(n){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,n))return r;return null}_getOptionValue(n){let r=n8(n);return this._optionMap.has(r)?this._optionMap.get(r)._value:n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Jr(e)))(s||e)}})(),e.\u0275dir=ie({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,s){r&1&&Z("change",function(o){return s.onChange(o.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[pt([i8]),tt]});let t=e;return t})(),Wg=(()=>{let e=class e{constructor(n,r,s){this._element=n,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){this._select!=null&&(this._value=n,this._setElementValue(VO(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(VO(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(r){return new(r||e)(g(le),g(uh),g(cN,9))},e.\u0275dir=ie({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var dN=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({});let t=e;return t})(),tC=class extends Uc{constructor(e,i,n){super(rC(i),sC(n,i)),this.controls=e,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,i={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}insert(e,i,n={}){this.controls.splice(e,0,i),this._registerControl(i),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,i={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:i.emitEvent})}setControl(e,i,n={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),i&&(this.controls.splice(r,0,i),this._registerControl(i)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,i={}){iN(this,!1,e),e.forEach((n,r)=>{tN(this,!1,r),this.at(r).setValue(n,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(e,i={}){e!=null&&(e.forEach((n,r)=>{this.at(r)&&this.at(r).patchValue(n,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(e=[],i={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(i=>i._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((i,n)=>n._syncPendingControls()?!0:i,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((i,n)=>{e(i,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(i=>i.enabled&&e(i))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function jO(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var Wc=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let n=new e;return n.useNonNullable=!0,n}group(n,r=null){let s=this._reduceControls(n),a={};return jO(r)?a=r:r!==null&&(a.validators=r.validator,a.asyncValidators=r.asyncValidator),new Pg(s,a)}record(n,r=null){let s=this._reduceControls(n);return new Jw(s,r)}control(n,r,s){let a={};return this.useNonNullable?(jO(r)?a=r:(a.validators=r,a.asyncValidators=s),new jh(n,tn(Me({},a),{nonNullable:!0}))):new jh(n,r,s)}array(n,r,s){let a=n.map(o=>this._createControl(o));return new tC(a,r,s)}_reduceControls(n){let r={};return Object.keys(n).forEach(s=>{r[s]=this._createControl(n[s])}),r}_createControl(n){if(n instanceof jh)return n;if(n instanceof Uc)return n;if(Array.isArray(n)){let r=n[0],s=n.length>1?n[1]:null,a=n.length>2?n[2]:null;return this.control(r,s,a)}else return this.control(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var os=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:zg,useValue:n.callSetDisabledState??Ug}]}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[dN]});let t=e;return t})(),Ta=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:oN,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:zg,useValue:n.callSetDisabledState??Ug}]}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[dN]});let t=e;return t})();var oC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De,Sa,Sa,RO,De]});let t=e;return t})();var r8=["mat-button",""],s8=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],a8=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var o8=".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}";var l8=["mat-icon-button",""],c8=["*"];var d8=new K("MAT_BUTTON_CONFIG");var u8=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],hN=(()=>{let e=class e{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(n){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,n)}get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=n,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(n){this._disabled=n,this._updateRippleDisabled()}constructor(n,r,s,a){this._elementRef=n,this._platform=r,this._ngZone=s,this._animationMode=a,this._focusMonitor=Ne(Mh),this._rippleLoader=Ne(uO),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;let o=Ne(d8,{optional:!0}),l=n.nativeElement,c=l.classList;this.disabledInteractive=o?.disabledInteractive??!1,this._rippleLoader?.configureRipple(l,{className:"mat-mdc-button-ripple"});for(let{attribute:d,mdcClasses:u}of u8)l.hasAttribute(d)&&c.add(...u)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(n="program",r){n?this._focusMonitor.focusVia(this._elementRef.nativeElement,n,r):this._elementRef.nativeElement.focus(r)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}};e.\u0275fac=function(r){Ac()},e.\u0275dir=ie({type:e,inputs:{color:"color",disableRipple:[G.HasDecoratorInputTransform,"disableRipple","disableRipple",qe],disabled:[G.HasDecoratorInputTransform,"disabled","disabled",qe],ariaDisabled:[G.HasDecoratorInputTransform,"aria-disabled","ariaDisabled",qe],disabledInteractive:[G.HasDecoratorInputTransform,"disabledInteractive","disabledInteractive",qe]},features:[yt]});let t=e;return t})();var Wh=(()=>{let e=class e extends hN{constructor(n,r,s,a){super(n,r,s,a)}};e.\u0275fac=function(r){return new(r||e)(g(le),g(Ge),g(re),g(qi,8))},e.\u0275cmp=ne({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(r,s){r&2&&(xe("disabled",s._getDisabledAttribute())("aria-disabled",s._getAriaDisabled()),An(s.color?"mat-"+s.color:""),ce("mat-mdc-button-disabled",s.disabled)("mat-mdc-button-disabled-interactive",s.disabledInteractive)("_mat-animation-noopable",s._animationMode==="NoopAnimations")("mat-unthemed",!s.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[tt,se],attrs:r8,ngContentSelectors:a8,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,s){r&1&&(wt(s8),$(0,"span",0),Ke(1),_(2,"span",1),Ke(3,1),b(),Ke(4,2),$(5,"span",2)(6,"span",3)),r&2&&ce("mdc-button__ripple",!s._isFab)("mdc-fab__ripple",s._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px);display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);font-weight:var(--mdc-text-button-label-text-weight);text-transform:var(--mdc-text-button-label-text-transform);height:var(--mdc-text-button-container-height);border-radius:var(--mdc-text-button-container-shape);padding:0 var(--mat-text-button-horizontal-padding, 8px)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);font-weight:var(--mdc-filled-button-label-text-weight);text-transform:var(--mdc-filled-button-label-text-transform);height:var(--mdc-filled-button-container-height);border-radius:var(--mdc-filled-button-container-shape);padding:0 var(--mat-filled-button-horizontal-padding, 16px)}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color)}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);font-weight:var(--mdc-protected-button-label-text-weight);text-transform:var(--mdc-protected-button-label-text-transform);height:var(--mdc-protected-button-container-height);border-radius:var(--mdc-protected-button-container-shape);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow)}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color)}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);font-weight:var(--mdc-outlined-button-label-text-weight);text-transform:var(--mdc-outlined-button-label-text-transform);height:var(--mdc-outlined-button-container-height);border-radius:var(--mdc-outlined-button-container-shape);padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width);padding:0 var(--mat-outlined-button-horizontal-padding, 15px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color)}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape)}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width))}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button-base{text-decoration:none}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0});let t=e;return t})();var lC=(()=>{let e=class e extends hN{constructor(n,r,s,a){super(n,r,s,a),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}};e.\u0275fac=function(r){return new(r||e)(g(le),g(Ge),g(re),g(qi,8))},e.\u0275cmp=ne({type:e,selectors:[["button","mat-icon-button",""]],hostVars:14,hostBindings:function(r,s){r&2&&(xe("disabled",s._getDisabledAttribute())("aria-disabled",s._getAriaDisabled()),An(s.color?"mat-"+s.color:""),ce("mat-mdc-button-disabled",s.disabled)("mat-mdc-button-disabled-interactive",s.disabledInteractive)("_mat-animation-noopable",s._animationMode==="NoopAnimations")("mat-unthemed",!s.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[tt,se],attrs:l8,ngContentSelectors:c8,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,s){r&1&&(wt(),$(0,"span",0),Ke(1),$(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{color:var(--mdc-icon-button-icon-color)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{border-radius:50%;flex-shrink:0;text-align:center;width:var(--mdc-icon-button-state-layer-size, 48px);height:var(--mdc-icon-button-state-layer-size, 48px);padding:calc(calc(var(--mdc-icon-button-state-layer-size, 48px) - var(--mdc-icon-button-icon-size, 24px)) / 2);font-size:var(--mdc-icon-button-icon-size);-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled],.mat-mdc-icon-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-icon-button-ripple-color)}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-state-layer-color)}.mat-mdc-icon-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-disabled-state-layer-color)}.mat-mdc-icon-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-hover-state-layer-opacity)}.mat-mdc-icon-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-focus-state-layer-opacity)}.mat-mdc-icon-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-pressed-state-layer-opacity)}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-icon-button-touch-target-display)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',o8],encapsulation:2,changeDetection:0});let t=e;return t})();var sl=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De,Ph,De]});let t=e;return t})();var h8=20,cC=(()=>{let e=class e{constructor(n,r,s){this._ngZone=n,this._platform=r,this._scrolled=new be,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=s}register(n){this.scrollContainers.has(n)||this.scrollContainers.set(n,n.elementScrolled().subscribe(()=>this._scrolled.next(n)))}deregister(n){let r=this.scrollContainers.get(n);r&&(r.unsubscribe(),this.scrollContainers.delete(n))}scrolled(n=h8){return this._platform.isBrowser?new ni(r=>{this._globalSubscription||this._addGlobalListener();let s=n>0?this._scrolled.pipe(gw(n)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{s.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):et()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((n,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(n,r){let s=this.getAncestorScrollContainers(n);return this.scrolled(r).pipe(zt(a=>!a||s.indexOf(a)>-1))}getAncestorScrollContainers(n){let r=[];return this.scrollContainers.forEach((s,a)=>{this._scrollableContainsElement(a,n)&&r.push(a)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(n,r){let s=Dr(r),a=n.getElementRef().nativeElement;do if(s==a)return!0;while(s=s.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let n=this._getWindow();return Qr(n.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}};e.\u0275fac=function(r){return new(r||e)(C(re),C(Ge),C(He,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),dC=(()=>{let e=class e{constructor(n,r,s,a){this.elementRef=n,this.scrollDispatcher=r,this.ngZone=s,this.dir=a,this._destroyed=new be,this._elementScrolled=new ni(o=>this.ngZone.runOutsideAngular(()=>Qr(this.elementRef.nativeElement,"scroll").pipe(ot(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(n){let r=this.elementRef.nativeElement,s=this.dir&&this.dir.value=="rtl";n.left==null&&(n.left=s?n.end:n.start),n.right==null&&(n.right=s?n.start:n.end),n.bottom!=null&&(n.top=r.scrollHeight-r.clientHeight-n.bottom),s&&Pc()!=Tr.NORMAL?(n.left!=null&&(n.right=r.scrollWidth-r.clientWidth-n.left),Pc()==Tr.INVERTED?n.left=n.right:Pc()==Tr.NEGATED&&(n.left=n.right?-n.right:n.right)):n.right!=null&&(n.left=r.scrollWidth-r.clientWidth-n.right),this._applyScrollToOptions(n)}_applyScrollToOptions(n){let r=this.elementRef.nativeElement;yg()?r.scrollTo(n):(n.top!=null&&(r.scrollTop=n.top),n.left!=null&&(r.scrollLeft=n.left))}measureScrollOffset(n){let r="left",s="right",a=this.elementRef.nativeElement;if(n=="top")return a.scrollTop;if(n=="bottom")return a.scrollHeight-a.clientHeight-a.scrollTop;let o=this.dir&&this.dir.value=="rtl";return n=="start"?n=o?s:r:n=="end"&&(n=o?r:s),o&&Pc()==Tr.INVERTED?n==r?a.scrollWidth-a.clientWidth-a.scrollLeft:a.scrollLeft:o&&Pc()==Tr.NEGATED?n==r?a.scrollLeft+a.scrollWidth-a.clientWidth:-a.scrollLeft:n==r?a.scrollLeft:a.scrollWidth-a.clientWidth-a.scrollLeft}};e.\u0275fac=function(r){return new(r||e)(g(le),g(cC),g(re),g(Ci,8))},e.\u0275dir=ie({type:e,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0});let t=e;return t})(),f8=20,Gc=(()=>{let e=class e{constructor(n,r,s){this._platform=n,this._change=new be,this._changeListener=a=>{this._change.next(a)},this._document=s,r.runOutsideAngular(()=>{if(n.isBrowser){let a=this._getWindow();a.addEventListener("resize",this._changeListener),a.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let n=this._getWindow();n.removeEventListener("resize",this._changeListener),n.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let n={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),n}getViewportRect(){let n=this.getViewportScrollPosition(),{width:r,height:s}=this.getViewportSize();return{top:n.top,left:n.left,bottom:n.top+s,right:n.left+r,height:s,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let n=this._document,r=this._getWindow(),s=n.documentElement,a=s.getBoundingClientRect(),o=-a.top||n.body.scrollTop||r.scrollY||s.scrollTop||0,l=-a.left||n.body.scrollLeft||r.scrollX||s.scrollLeft||0;return{top:o,left:l}}change(n=f8){return n>0?this._change.pipe(gw(n)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let n=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:n.innerWidth,height:n.innerHeight}:{width:0,height:0}}};e.\u0275fac=function(r){return new(r||e)(C(Ge),C(re),C(He,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ks=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({});let t=e;return t})(),uC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[rs,Ks,rs,Ks]});let t=e;return t})();var hC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De,Ks,Ks,De]});let t=e;return t})();var Gh=class{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;e!=null&&(this._attachedHost=null,e.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(e){this._attachedHost=e}},Ia=class extends Gh{constructor(e,i,n,r,s){super(),this.component=e,this.viewContainerRef=i,this.injector=n,this.componentFactoryResolver=r,this.projectableNodes=s}},tr=class extends Gh{constructor(e,i,n,r){super(),this.templateRef=e,this.viewContainerRef=i,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,i=this.context){return this.context=i,super.attach(e)}detach(){return this.context=void 0,super.detach()}},fC=class extends Gh{constructor(e){super(),this.element=e instanceof le?e.nativeElement:e}},Kc=class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){if(e instanceof Ia)return this._attachedPortal=e,this.attachComponentPortal(e);if(e instanceof tr)return this._attachedPortal=e,this.attachTemplatePortal(e);if(this.attachDomPortal&&e instanceof fC)return this._attachedPortal=e,this.attachDomPortal(e)}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var Gg=class extends Kc{constructor(e,i,n,r,s){super(),this.outletElement=e,this._componentFactoryResolver=i,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=a=>{this._document;let o=a.element;o.parentNode;let l=this._document.createComment("dom-portal");o.parentNode.insertBefore(l,o),this.outletElement.appendChild(o),this._attachedPortal=a,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(o,l)})},this._document=s}attachComponentPortal(e){let n=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(n,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=n.create(e.injector||this._defaultInjector||vn.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let i=e.viewContainerRef,n=i.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=i.indexOf(n);r!==-1&&i.remove(r)}),this._attachedPortal=e,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}};var mN=(()=>{let e=class e extends tr{constructor(n,r){super(n,r)}};e.\u0275fac=function(r){return new(r||e)(g(ri),g(Wn))},e.\u0275dir=ie({type:e,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],standalone:!0,features:[tt]});let t=e;return t})();var ir=(()=>{let e=class e extends Kc{constructor(n,r,s){super(),this._componentFactoryResolver=n,this._viewContainerRef=r,this._isInitialized=!1,this.attached=new ae,this.attachDomPortal=a=>{this._document;let o=a.element;o.parentNode;let l=this._document.createComment("dom-portal");a.setAttachedHost(this),o.parentNode.insertBefore(l,o),this._getRootNode().appendChild(o),this._attachedPortal=a,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(o,l)})},this._document=s}get portal(){return this._attachedPortal}set portal(n){this.hasAttached()&&!n&&!this._isInitialized||(this.hasAttached()&&super.detach(),n&&super.attach(n),this._attachedPortal=n||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(n){n.setAttachedHost(this);let r=n.viewContainerRef!=null?n.viewContainerRef:this._viewContainerRef,a=(n.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(n.component),o=r.createComponent(a,r.length,n.injector||r.injector,n.projectableNodes||void 0);return r!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=n,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(n){n.setAttachedHost(this);let r=this._viewContainerRef.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=n,this._attachedRef=r,this.attached.emit(r),r}_getRootNode(){let n=this._viewContainerRef.element.nativeElement;return n.nodeType===n.ELEMENT_NODE?n:n.parentNode}};e.\u0275fac=function(r){return new(r||e)(g(Rc),g(Wn),g(He))},e.\u0275dir=ie({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[G.None,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[tt]});let t=e;return t})();var Da=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({});let t=e;return t})();var pN=yg(),mC=class{constructor(e,i){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=i}attach(){}enable(){if(this._canBeEnabled()){let e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=$t(-this._previousScrollPosition.left),e.style.top=$t(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let e=this._document.documentElement,i=this._document.body,n=e.style,r=i.style,s=n.scrollBehavior||"",a=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),pN&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),pN&&(n.scrollBehavior=s,r.scrollBehavior=a)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let i=this._document.body,n=this._viewportRuler.getViewportSize();return i.scrollHeight>n.height||i.scrollWidth>n.width}};var pC=class{constructor(e,i,n,r){this._scrollDispatcher=e,this._ngZone=i,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(this._scrollSubscription)return;let e=this._scrollDispatcher.scrolled(0).pipe(zt(i=>!i||!this._overlayRef.overlayElement.contains(i.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{let i=this._viewportRuler.getViewportScrollPosition().top;Math.abs(i-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},Kg=class{enable(){}disable(){}attach(){}};function gC(t,e){return e.some(i=>{let n=t.bottom<i.top,r=t.top>i.bottom,s=t.right<i.left,a=t.left>i.right;return n||r||s||a})}function gN(t,e){return e.some(i=>{let n=t.top<i.top,r=t.bottom>i.bottom,s=t.left<i.left,a=t.right>i.right;return n||r||s||a})}var _C=class{constructor(e,i,n,r){this._scrollDispatcher=e,this._viewportRuler=i,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(!this._scrollSubscription){let e=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(e).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let i=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();gC(i,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},p8=(()=>{let e=class e{constructor(n,r,s,a){this._scrollDispatcher=n,this._viewportRuler=r,this._ngZone=s,this.noop=()=>new Kg,this.close=o=>new pC(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new mC(this._viewportRuler,this._document),this.reposition=o=>new _C(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=a}};e.\u0275fac=function(r){return new(r||e)(C(cC),C(Gc),C(re),C(He))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),$c=class{constructor(e){if(this.scrollStrategy=new Kg,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){let i=Object.keys(e);for(let n of i)e[n]!==void 0&&(this[n]=e[n])}}};var bC=class{constructor(e,i){this.connectionPair=e,this.scrollableViewProperties=i}};var wN=(()=>{let e=class e{constructor(n){this._attachedOverlays=[],this._document=n}ngOnDestroy(){this.detach()}add(n){this.remove(n),this._attachedOverlays.push(n)}remove(n){let r=this._attachedOverlays.indexOf(n);r>-1&&this._attachedOverlays.splice(r,1),this._attachedOverlays.length===0&&this.detach()}};e.\u0275fac=function(r){return new(r||e)(C(He))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),g8=(()=>{let e=class e extends wN{constructor(n,r){super(n),this._ngZone=r,this._keydownListener=s=>{let a=this._attachedOverlays;for(let o=a.length-1;o>-1;o--)if(a[o]._keydownEvents.observers.length>0){let l=a[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>l.next(s)):l.next(s);break}}}add(n){super.add(n),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}};e.\u0275fac=function(r){return new(r||e)(C(He),C(re,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),_8=(()=>{let e=class e extends wN{constructor(n,r,s){super(n),this._platform=r,this._ngZone=s,this._cursorStyleIsSet=!1,this._pointerDownListener=a=>{this._pointerDownEventTarget=Ir(a)},this._clickListener=a=>{let o=Ir(a),l=a.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;let c=this._attachedOverlays.slice();for(let d=c.length-1;d>-1;d--){let u=c[d];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(u.overlayElement.contains(o)||u.overlayElement.contains(l))break;let h=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>h.next(a)):h.next(a)}}}add(n){if(super.add(n),!this._isAttached){let r=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(r)):this._addEventListeners(r),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let n=this._document.body;n.removeEventListener("pointerdown",this._pointerDownListener,!0),n.removeEventListener("click",this._clickListener,!0),n.removeEventListener("auxclick",this._clickListener,!0),n.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(n.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(n){n.addEventListener("pointerdown",this._pointerDownListener,!0),n.addEventListener("click",this._clickListener,!0),n.addEventListener("auxclick",this._clickListener,!0),n.addEventListener("contextmenu",this._clickListener,!0)}};e.\u0275fac=function(r){return new(r||e)(C(He),C(Ge),C(re,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),CN=(()=>{let e=class e{constructor(n,r){this._platform=r,this._document=n}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let n="cdk-overlay-container";if(this._platform.isBrowser||Eh()){let s=this._document.querySelectorAll(`.${n}[platform="server"], .${n}[platform="test"]`);for(let a=0;a<s.length;a++)s[a].remove()}let r=this._document.createElement("div");r.classList.add(n),Eh()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}};e.\u0275fac=function(r){return new(r||e)(C(He),C(Ge))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),vC=class{constructor(e,i,n,r,s,a,o,l,c,d=!1){this._portalOutlet=e,this._host=i,this._pane=n,this._config=r,this._ngZone=s,this._keyboardDispatcher=a,this._document=o,this._location=l,this._outsideClickDispatcher=c,this._animationsDisabled=d,this._backdropElement=null,this._backdropClick=new be,this._attachments=new be,this._detachments=new be,this._locationChanges=At.EMPTY,this._backdropClickHandler=u=>this._backdropClick.next(u),this._backdropTransitionendHandler=u=>{this._disposeBackdrop(u.target)},this._keydownEvents=new be,this._outsidePointerEvents=new be,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let i=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(mi(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof i?.onDestroy=="function"&&i.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),i}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){let e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=Me(Me({},this._config),e),this._updateElementSize()}setDirection(e){this._config=tn(Me({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){let e=this._config.direction;return e?typeof e=="string"?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let e=this._pane.style;e.width=$t(this._config.width),e.height=$t(this._config.height),e.minWidth=$t(this._config.minWidth),e.minHeight=$t(this._config.minHeight),e.maxWidth=$t(this._config.maxWidth),e.maxHeight=$t(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){let e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e=this._backdropElement;if(e){if(this._animationsDisabled){this._disposeBackdrop(e);return}e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,i,n){let r=Fc(i||[]).filter(s=>!!s);r.length&&(n?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{let e=this._ngZone.onStable.pipe(ot(fi(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){let e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},_N="cdk-overlay-connected-position-bounding-box",b8=/([A-Za-z%]+)$/,$g=class{get positions(){return this._preferredPositions}constructor(e,i,n,r,s){this._viewportRuler=i,this._document=n,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new be,this._resizeSubscription=At.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._overlayRef&&this._overlayRef,this._validatePositions(),e.hostElement.classList.add(_N),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let e=this._originRect,i=this._overlayRect,n=this._viewportRect,r=this._containerRect,s=[],a;for(let o of this._preferredPositions){let l=this._getOriginPoint(e,r,o),c=this._getOverlayPoint(l,i,o),d=this._getOverlayFit(c,i,n,o);if(d.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(o,l);return}if(this._canFitWithFlexibleDimensions(d,c,n)){s.push({position:o,origin:l,overlayRect:i,boundingBoxRect:this._calculateBoundingBoxRect(l,o)});continue}(!a||a.overlayFit.visibleArea<d.visibleArea)&&(a={overlayFit:d,overlayPoint:c,originPoint:l,position:o,overlayRect:i})}if(s.length){let o=null,l=-1;for(let c of s){let d=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);d>l&&(l=d,o=c)}this._isPushed=!1,this._applyPosition(o.position,o.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(a.position,a.originPoint);return}this._applyPosition(a.position,a.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&al(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(_N),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let i=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,i)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,e.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,i,n){let r;if(n.originX=="center")r=e.left+e.width/2;else{let a=this._isRtl()?e.right:e.left,o=this._isRtl()?e.left:e.right;r=n.originX=="start"?a:o}i.left<0&&(r-=i.left);let s;return n.originY=="center"?s=e.top+e.height/2:s=n.originY=="top"?e.top:e.bottom,i.top<0&&(s-=i.top),{x:r,y:s}}_getOverlayPoint(e,i,n){let r;n.overlayX=="center"?r=-i.width/2:n.overlayX==="start"?r=this._isRtl()?-i.width:0:r=this._isRtl()?0:-i.width;let s;return n.overlayY=="center"?s=-i.height/2:s=n.overlayY=="top"?0:-i.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,i,n,r){let s=vN(i),{x:a,y:o}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(a+=l),c&&(o+=c);let d=0-a,u=a+s.width-n.width,h=0-o,f=o+s.height-n.height,p=this._subtractOverflows(s.width,d,u),v=this._subtractOverflows(s.height,h,f),E=p*v;return{visibleArea:E,isCompletelyWithinViewport:s.width*s.height===E,fitsInViewportVertically:v===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,i,n){if(this._hasFlexibleDimensions){let r=n.bottom-i.y,s=n.right-i.x,a=bN(this._overlayRef.getConfig().minHeight),o=bN(this._overlayRef.getConfig().minWidth),l=e.fitsInViewportVertically||a!=null&&a<=r,c=e.fitsInViewportHorizontally||o!=null&&o<=s;return l&&c}return!1}_pushOverlayOnScreen(e,i,n){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};let r=vN(i),s=this._viewportRect,a=Math.max(e.x+r.width-s.width,0),o=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-n.top-e.y,0),c=Math.max(s.left-n.left-e.x,0),d=0,u=0;return r.width<=s.width?d=c||-a:d=e.x<this._viewportMargin?s.left-n.left-e.x:0,r.height<=s.height?u=l||-o:u=e.y<this._viewportMargin?s.top-n.top-e.y:0,this._previousPushAmount={x:d,y:u},{x:e.x+d,y:e.y+u}}_applyPosition(e,i){if(this._setTransformOrigin(e),this._setOverlayElementStyles(i,e),this._setBoundingBoxStyles(i,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){let n=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!v8(this._lastScrollVisibility,n)){let r=new bC(e,n);this._positionChanges.next(r)}this._lastScrollVisibility=n}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;let i=this._boundingBox.querySelectorAll(this._transformOriginSelector),n,r=e.overlayY;e.overlayX==="center"?n="center":this._isRtl()?n=e.overlayX==="start"?"right":"left":n=e.overlayX==="start"?"left":"right";for(let s=0;s<i.length;s++)i[s].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(e,i){let n=this._viewportRect,r=this._isRtl(),s,a,o;if(i.overlayY==="top")a=e.y,s=n.height-a+this._viewportMargin;else if(i.overlayY==="bottom")o=n.height-e.y+this._viewportMargin*2,s=n.height-o+this._viewportMargin;else{let f=Math.min(n.bottom-e.y+n.top,e.y),p=this._lastBoundingBoxSize.height;s=f*2,a=e.y-f,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(a=e.y-p/2)}let l=i.overlayX==="start"&&!r||i.overlayX==="end"&&r,c=i.overlayX==="end"&&!r||i.overlayX==="start"&&r,d,u,h;if(c)h=n.width-e.x+this._viewportMargin*2,d=e.x-this._viewportMargin;else if(l)u=e.x,d=n.right-e.x;else{let f=Math.min(n.right-e.x+n.left,e.x),p=this._lastBoundingBoxSize.width;d=f*2,u=e.x-f,d>p&&!this._isInitialRender&&!this._growAfterOpen&&(u=e.x-p/2)}return{top:a,left:u,bottom:o,right:h,width:d,height:s}}_setBoundingBoxStyles(e,i){let n=this._calculateBoundingBoxRect(e,i);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));let r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{let s=this._overlayRef.getConfig().maxHeight,a=this._overlayRef.getConfig().maxWidth;r.height=$t(n.height),r.top=$t(n.top),r.bottom=$t(n.bottom),r.width=$t(n.width),r.left=$t(n.left),r.right=$t(n.right),i.overlayX==="center"?r.alignItems="center":r.alignItems=i.overlayX==="end"?"flex-end":"flex-start",i.overlayY==="center"?r.justifyContent="center":r.justifyContent=i.overlayY==="bottom"?"flex-end":"flex-start",s&&(r.maxHeight=$t(s)),a&&(r.maxWidth=$t(a))}this._lastBoundingBoxSize=n,al(this._boundingBox.style,r)}_resetBoundingBoxStyles(){al(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){al(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,i){let n={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(r){let d=this._viewportRuler.getViewportScrollPosition();al(n,this._getExactOverlayY(i,e,d)),al(n,this._getExactOverlayX(i,e,d))}else n.position="static";let o="",l=this._getOffset(i,"x"),c=this._getOffset(i,"y");l&&(o+=`translateX(${l}px) `),c&&(o+=`translateY(${c}px)`),n.transform=o.trim(),a.maxHeight&&(r?n.maxHeight=$t(a.maxHeight):s&&(n.maxHeight="")),a.maxWidth&&(r?n.maxWidth=$t(a.maxWidth):s&&(n.maxWidth="")),al(this._pane.style,n)}_getExactOverlayY(e,i,n){let r={top:"",bottom:""},s=this._getOverlayPoint(i,this._overlayRect,e);if(this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),e.overlayY==="bottom"){let a=this._document.documentElement.clientHeight;r.bottom=`${a-(s.y+this._overlayRect.height)}px`}else r.top=$t(s.y);return r}_getExactOverlayX(e,i,n){let r={left:"",right:""},s=this._getOverlayPoint(i,this._overlayRect,e);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n));let a;if(this._isRtl()?a=e.overlayX==="end"?"left":"right":a=e.overlayX==="end"?"right":"left",a==="right"){let o=this._document.documentElement.clientWidth;r.right=`${o-(s.x+this._overlayRect.width)}px`}else r.left=$t(s.x);return r}_getScrollVisibility(){let e=this._getOriginRect(),i=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:gN(e,n),isOriginOutsideView:gC(e,n),isOverlayClipped:gN(i,n),isOverlayOutsideView:gC(i,n)}}_subtractOverflows(e,...i){return i.reduce((n,r)=>n-Math.max(r,0),e)}_getNarrowedViewportRect(){let e=this._document.documentElement.clientWidth,i=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+e-this._viewportMargin,bottom:n.top+i-this._viewportMargin,width:e-2*this._viewportMargin,height:i-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,i){return i==="x"?e.offsetX==null?this._offsetX:e.offsetX:e.offsetY==null?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&Fc(e).forEach(i=>{i!==""&&this._appliedPanelClasses.indexOf(i)===-1&&(this._appliedPanelClasses.push(i),this._pane.classList.add(i))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){let e=this._origin;if(e instanceof le)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();let i=e.width||0,n=e.height||0;return{top:e.y,bottom:e.y+n,left:e.x,right:e.x+i,height:n,width:i}}};function al(t,e){for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function bN(t){if(typeof t!="number"&&t!=null){let[e,i]=t.split(b8);return!i||i==="px"?parseFloat(e):null}return t||null}function vN(t){return{top:Math.floor(t.top),right:Math.floor(t.right),bottom:Math.floor(t.bottom),left:Math.floor(t.left),width:Math.floor(t.width),height:Math.floor(t.height)}}function v8(t,e){return t===e?!0:t.isOriginClipped===e.isOriginClipped&&t.isOriginOutsideView===e.isOriginOutsideView&&t.isOverlayClipped===e.isOverlayClipped&&t.isOverlayOutsideView===e.isOverlayOutsideView}var yN="cdk-global-overlay-wrapper",yC=class{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){let i=e.getConfig();this._overlayRef=e,this._width&&!i.width&&e.updateSize({width:this._width}),this._height&&!i.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(yN),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let e=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:a,maxHeight:o}=n,l=(r==="100%"||r==="100vw")&&(!a||a==="100%"||a==="100vw"),c=(s==="100%"||s==="100vh")&&(!o||o==="100%"||o==="100vh"),d=this._xPosition,u=this._xOffset,h=this._overlayRef.getConfig().direction==="rtl",f="",p="",v="";l?v="flex-start":d==="center"?(v="center",h?p=u:f=u):h?d==="left"||d==="end"?(v="flex-end",f=u):(d==="right"||d==="start")&&(v="flex-start",p=u):d==="left"||d==="start"?(v="flex-start",f=u):(d==="right"||d==="end")&&(v="flex-end",p=u),e.position=this._cssPosition,e.marginLeft=l?"0":f,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=l?"0":p,i.justifyContent=v,i.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let e=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement,n=i.style;i.classList.remove(yN),n.justifyContent=n.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}},y8=(()=>{let e=class e{constructor(n,r,s,a){this._viewportRuler=n,this._document=r,this._platform=s,this._overlayContainer=a}global(){return new yC}flexibleConnectedTo(n){return new $g(n,this._viewportRuler,this._document,this._platform,this._overlayContainer)}};e.\u0275fac=function(r){return new(r||e)(C(Gc),C(He),C(Ge),C(CN))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),w8=0,kr=(()=>{let e=class e{constructor(n,r,s,a,o,l,c,d,u,h,f,p){this.scrollStrategies=n,this._overlayContainer=r,this._componentFactoryResolver=s,this._positionBuilder=a,this._keyboardDispatcher=o,this._injector=l,this._ngZone=c,this._document=d,this._directionality=u,this._location=h,this._outsideClickDispatcher=f,this._animationsModuleType=p}create(n){let r=this._createHostElement(),s=this._createPaneElement(r),a=this._createPortalOutlet(s),o=new $c(n);return o.direction=o.direction||this._directionality.value,new vC(a,r,s,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations")}position(){return this._positionBuilder}_createPaneElement(n){let r=this._document.createElement("div");return r.id=`cdk-overlay-${w8++}`,r.classList.add("cdk-overlay-pane"),n.appendChild(r),r}_createHostElement(){let n=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(n),n}_createPortalOutlet(n){return this._appRef||(this._appRef=this._injector.get(cg)),new Gg(n,this._componentFactoryResolver,this._appRef,this._injector,this._document)}};e.\u0275fac=function(r){return new(r||e)(C(p8),C(CN),C(Rc),C(y8),C(g8),C(vn),C(re),C(He),C(Ci),C(EM),C(_8),C(qi,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var C8=new K("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let t=Ne(kr);return()=>t.scrollStrategies.reposition()}});function E8(t){return()=>t.scrollStrategies.reposition()}var S8={provide:C8,deps:[kr],useFactory:E8},Yc=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({providers:[kr,S8],imports:[rs,Da,uC,uC]});let t=e;return t})();function T8(t,e){if(t&1){let i=ft();_(0,"div",1)(1,"button",2),Z("click",function(){ve(i);let r=j();return ye(r.action())}),F(2),b()()}if(t&2){let i=j();w(2),yn(" ",i.data.action," ")}}var I8=["label"];function D8(t,e){}var k8=Math.pow(2,31)-1,Kh=class{constructor(e,i){this._overlayRef=i,this._afterDismissed=new be,this._afterOpened=new be,this._onAction=new be,this._dismissedByAction=!1,this.containerInstance=e,e._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(e){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(e,k8))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},EN=new K("MatSnackBarData"),Qc=class{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}},A8=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=ie({type:e,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"],standalone:!0});let t=e;return t})(),R8=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=ie({type:e,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"],standalone:!0});let t=e;return t})(),M8=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=ie({type:e,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"],standalone:!0});let t=e;return t})(),SN=(()=>{let e=class e{constructor(n,r){this.snackBarRef=n,this.data=r}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}};e.\u0275fac=function(r){return new(r||e)(g(Kh),g(EN))},e.\u0275cmp=ne({type:e,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],standalone:!0,features:[se],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(r,s){r&1&&(_(0,"div",0),F(1),b(),Se(2,T8,3,1,"div",1)),r&2&&(w(),yn(" ",s.data.message,`
`),w(),Pe(2,s.hasAction?2:-1))},dependencies:[Wh,A8,R8,M8],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0});let t=e;return t})(),O8={snackBarState:$n("state",[_i("void, hidden",ht({transform:"scale(0.8)",opacity:0})),_i("visible",ht({transform:"scale(1)",opacity:1})),Pi("* => visible",Ni("150ms cubic-bezier(0, 0, 0.2, 1)")),Pi("* => void, * => hidden",Ni("75ms cubic-bezier(0.4, 0.0, 1, 1)",ht({opacity:0})))])},N8=0,P8=(()=>{let e=class e extends Kc{constructor(n,r,s,a,o){super(),this._ngZone=n,this._elementRef=r,this._changeDetectorRef=s,this._platform=a,this.snackBarConfig=o,this._document=Ne(He),this._trackedModals=new Set,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new be,this._onExit=new be,this._onEnter=new be,this._animationState="void",this._liveElementId=`mat-snack-bar-container-live-${N8++}`,this.attachDomPortal=l=>{this._assertNotAttached();let c=this._portalOutlet.attachDomPortal(l);return this._afterPortalAttached(),c},o.politeness==="assertive"&&!o.announcementMessage?this._live="assertive":o.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert"))}attachComponentPortal(n){this._assertNotAttached();let r=this._portalOutlet.attachComponentPortal(n);return this._afterPortalAttached(),r}attachTemplatePortal(n){this._assertNotAttached();let r=this._portalOutlet.attachTemplatePortal(n);return this._afterPortalAttached(),r}onAnimationEnd(n){let{fromState:r,toState:s}=n;if((s==="void"&&r!=="void"||s==="hidden")&&this._completeExit(),s==="visible"){let a=this._onEnter;this._ngZone.run(()=>{a.next(),a.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let n=this._elementRef.nativeElement,r=this.snackBarConfig.panelClass;r&&(Array.isArray(r)?r.forEach(o=>n.classList.add(o)):n.classList.add(r)),this._exposeToModals();let s=this._label.nativeElement,a="mdc-snackbar__label";s.classList.toggle(a,!s.querySelector(`.${a}`))}_exposeToModals(){let n=this._liveElementId,r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let s=0;s<r.length;s++){let a=r[s],o=a.getAttribute("aria-owns");this._trackedModals.add(a),o?o.indexOf(n)===-1&&a.setAttribute("aria-owns",o+" "+n):a.setAttribute("aria-owns",n)}}_clearFromModals(){this._trackedModals.forEach(n=>{let r=n.getAttribute("aria-owns");if(r){let s=r.replace(this._liveElementId,"").trim();s.length>0?n.setAttribute("aria-owns",s):n.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{let n=this._elementRef.nativeElement.querySelector("[aria-hidden]"),r=this._elementRef.nativeElement.querySelector("[aria-live]");if(n&&r){let s=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&n.contains(document.activeElement)&&(s=document.activeElement),n.removeAttribute("aria-hidden"),r.appendChild(n),s?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}};e.\u0275fac=function(r){return new(r||e)(g(re),g(le),g(lt),g(Ge),g(Qc))},e.\u0275cmp=ne({type:e,selectors:[["mat-snack-bar-container"]],viewQuery:function(r,s){if(r&1&&(Be(ir,7),Be(I8,7)),r&2){let a;de(a=ue())&&(s._portalOutlet=a.first),de(a=ue())&&(s._label=a.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container","mdc-snackbar--open"],hostVars:1,hostBindings:function(r,s){r&1&&fh("@state.done",function(o){return s.onAnimationEnd(o)}),r&2&&hh("@state",s._animationState)},standalone:!0,features:[tt,se],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(r,s){r&1&&(_(0,"div",1)(1,"div",2,0)(3,"div",3),Se(4,D8,0,0,"ng-template",4),b(),$(5,"div"),b()()),r&2&&(w(5),xe("aria-live",s._live)("role",s._role)("id",s._liveElementId))},dependencies:[ir],styles:['.mdc-snackbar{display:none;position:fixed;right:0;bottom:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;pointer-events:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-snackbar--opening,.mdc-snackbar--open,.mdc-snackbar--closing{display:flex}.mdc-snackbar--open .mdc-snackbar__label,.mdc-snackbar--open .mdc-snackbar__actions{visibility:visible}.mdc-snackbar__surface{padding-left:0;padding-right:8px;display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;transform:scale(0.8);opacity:0}.mdc-snackbar__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-snackbar__surface::before{border-color:CanvasText}}[dir=rtl] .mdc-snackbar__surface,.mdc-snackbar__surface[dir=rtl]{padding-left:8px;padding-right:0}.mdc-snackbar--open .mdc-snackbar__surface{transform:scale(1);opacity:1;pointer-events:auto}.mdc-snackbar--closing .mdc-snackbar__surface{transform:scale(1)}.mdc-snackbar__label{padding-left:16px;padding-right:8px;width:100%;flex-grow:1;box-sizing:border-box;margin:0;visibility:hidden;padding-top:14px;padding-bottom:14px}[dir=rtl] .mdc-snackbar__label,.mdc-snackbar__label[dir=rtl]{padding-left:8px;padding-right:16px}.mdc-snackbar__label::before{display:inline;content:attr(data-mdc-snackbar-label-text)}.mdc-snackbar__actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box;visibility:hidden}.mdc-snackbar__action+.mdc-snackbar__dismiss{margin-left:8px;margin-right:0}[dir=rtl] .mdc-snackbar__action+.mdc-snackbar__dismiss,.mdc-snackbar__action+.mdc-snackbar__dismiss[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-snack-bar-container{margin:8px;position:static}.mat-mdc-snack-bar-container .mdc-snackbar__surface{min-width:344px}@media(max-width: 480px),(max-width: 344px){.mat-mdc-snack-bar-container .mdc-snackbar__surface{min-width:100%}}@media(max-width: 480px),(max-width: 344px){.mat-mdc-snack-bar-container{width:100vw}}.mat-mdc-snack-bar-container .mdc-snackbar__surface{max-width:672px}.mat-mdc-snack-bar-container .mdc-snackbar__surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12)}.mat-mdc-snack-bar-container .mdc-snackbar__surface{background-color:var(--mdc-snackbar-container-color)}.mat-mdc-snack-bar-container .mdc-snackbar__surface{border-radius:var(--mdc-snackbar-container-shape)}.mat-mdc-snack-bar-container .mdc-snackbar__label{color:var(--mdc-snackbar-supporting-text-color)}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-size:var(--mdc-snackbar-supporting-text-size);font-family:var(--mdc-snackbar-supporting-text-font);font-weight:var(--mdc-snackbar-supporting-text-weight);line-height:var(--mdc-snackbar-supporting-text-line-height)}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){color:var(--mat-snack-bar-button-color);--mat-text-button-state-layer-color:currentColor;--mat-text-button-ripple-color:currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}.mat-mdc-snack-bar-container .mdc-snackbar__label::before{display:none}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-handset .mdc-snackbar__surface{width:100%}'],encapsulation:2,data:{animation:[O8.snackBarState]}});let t=e;return t})();function F8(){return new Qc}var L8=new K("mat-snack-bar-default-options",{providedIn:"root",factory:F8}),B8=(()=>{let e=class e{get _openedSnackBarRef(){let n=this._parentSnackBar;return n?n._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(n){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=n:this._snackBarRefAtThisLevel=n}constructor(n,r,s,a,o,l){this._overlay=n,this._live=r,this._injector=s,this._breakpointObserver=a,this._parentSnackBar=o,this._defaultConfig=l,this._snackBarRefAtThisLevel=null,this.simpleSnackBarComponent=SN,this.snackBarContainerComponent=P8,this.handsetCssClass="mat-mdc-snack-bar-handset"}openFromComponent(n,r){return this._attach(n,r)}openFromTemplate(n,r){return this._attach(n,r)}open(n,r="",s){let a=Me(Me({},this._defaultConfig),s);return a.data={message:n,action:r},a.announcementMessage===n&&(a.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,a)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(n,r){let s=r&&r.viewContainerRef&&r.viewContainerRef.injector,a=vn.create({parent:s||this._injector,providers:[{provide:Qc,useValue:r}]}),o=new Ia(this.snackBarContainerComponent,r.viewContainerRef,a),l=n.attach(o);return l.instance.snackBarConfig=r,l.instance}_attach(n,r){let s=Me(Me(Me({},new Qc),this._defaultConfig),r),a=this._createOverlay(s),o=this._attachSnackBarContainer(a,s),l=new Kh(o,a);if(n instanceof ri){let c=new tr(n,null,{$implicit:s.data,snackBarRef:l});l.instance=o.attachTemplatePortal(c)}else{let c=this._createInjector(s,l),d=new Ia(n,void 0,c),u=o.attachComponentPortal(d);l.instance=u.instance}return this._breakpointObserver.observe($M.HandsetPortrait).pipe(ot(a.detachments())).subscribe(c=>{a.overlayElement.classList.toggle(this.handsetCssClass,c.matches)}),s.announcementMessage&&o._onAnnounce.subscribe(()=>{this._live.announce(s.announcementMessage,s.politeness)}),this._animateSnackBar(l,s),this._openedSnackBarRef=l,this._openedSnackBarRef}_animateSnackBar(n,r){n.afterDismissed().subscribe(()=>{this._openedSnackBarRef==n&&(this._openedSnackBarRef=null),r.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{n.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):n.containerInstance.enter(),r.duration&&r.duration>0&&n.afterOpened().subscribe(()=>n._dismissAfter(r.duration))}_createOverlay(n){let r=new $c;r.direction=n.direction;let s=this._overlay.position().global(),a=n.direction==="rtl",o=n.horizontalPosition==="left"||n.horizontalPosition==="start"&&!a||n.horizontalPosition==="end"&&a,l=!o&&n.horizontalPosition!=="center";return o?s.left("0"):l?s.right("0"):s.centerHorizontally(),n.verticalPosition==="top"?s.top("0"):s.bottom("0"),r.positionStrategy=s,this._overlay.create(r)}_createInjector(n,r){let s=n&&n.viewContainerRef&&n.viewContainerRef.injector;return vn.create({parent:s||this._injector,providers:[{provide:Kh,useValue:r},{provide:EN,useValue:n.data}]})}};e.\u0275fac=function(r){return new(r||e)(C(kr),C(tO),C(vn),C(Eg),C(e,12),C(L8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var wC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({providers:[B8],imports:[Yc,Da,sl,De,SN,De]});let t=e;return t})();var V8=new K("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let t=Ne(kr);return()=>t.scrollStrategies.reposition()}});function j8(t){return()=>t.scrollStrategies.reposition()}var z8={provide:V8,deps:[kr],useFactory:j8};var CC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({providers:[z8],imports:[Kn,Yc,Gw,De,Ks,Sa,Gw,De]});let t=e;return t})();var TC=["*"];function U8(t,e){t&1&&Ke(0)}var q8=["tabListContainer"],H8=["tabList"],W8=["tabListInner"],G8=["nextPaginator"],K8=["previousPaginator"],$8=t=>({animationDuration:t}),Y8=(t,e)=>({value:t,params:e});function Q8(t,e){}var X8=["tabBodyWrapper"],Z8=["tabHeader"];function J8(t,e){}function e9(t,e){if(t&1&&Se(0,J8,0,0,"ng-template",12),t&2){let i=j().$implicit;H("cdkPortalOutlet",i.templateLabel)}}function t9(t,e){if(t&1&&F(0),t&2){let i=j().$implicit;it(i.textLabel)}}function i9(t,e){if(t&1){let i=ft();_(0,"div",7,2),Z("click",function(){let r=ve(i),s=r.$implicit,a=r.$index,o=j(),l=ts(1);return ye(o._handleClick(s,l,a))})("cdkFocusChange",function(r){let s=ve(i).$index,a=j();return ye(a._tabFocusChanged(r,s))}),$(2,"span",8)(3,"div",9),_(4,"span",10)(5,"span",11),Se(6,e9,1,1,null,12)(7,t9,1,1),b()()()}if(t&2){let i=e.$implicit,n=e.$index,r=ts(1),s=j();ce("mdc-tab--active",s.selectedIndex===n),H("id",s._getTabLabelId(n))("ngClass",i.labelClass)("disabled",i.disabled)("fitInkBarToContent",s.fitInkBarToContent),xe("tabIndex",s._getTabIndex(n))("aria-posinset",n+1)("aria-setsize",s._tabs.length)("aria-controls",s._getTabContentId(n))("aria-selected",s.selectedIndex===n)("aria-label",i.ariaLabel||null)("aria-labelledby",!i.ariaLabel&&i.ariaLabelledby?i.ariaLabelledby:null),w(3),H("matRippleTrigger",r)("matRippleDisabled",i.disabled||s.disableRipple),w(3),Pe(6,i.templateLabel?6:7)}}function n9(t,e){t&1&&Ke(0)}function r9(t,e){if(t&1){let i=ft();_(0,"mat-tab-body",13),Z("_onCentered",function(){ve(i);let r=j();return ye(r._removeTabBodyWrapperHeight())})("_onCentering",function(r){ve(i);let s=j();return ye(s._setTabBodyWrapperHeight(r))}),b()}if(t&2){let i=e.$implicit,n=e.$index,r=j();ce("mat-mdc-tab-body-active",r.selectedIndex===n),H("id",r._getTabContentId(n))("ngClass",i.bodyClass)("content",i.content)("position",i.position)("origin",i.origin)("animationDuration",r.animationDuration)("preserveContent",r.preserveContent),xe("tabindex",r.contentTabIndex!=null&&r.selectedIndex===n?r.contentTabIndex:null)("aria-labelledby",r._getTabLabelId(n))("aria-hidden",r.selectedIndex!==n)}}var s9=new K("MatTabContent"),a9=(()=>{let e=class e{constructor(n){this.template=n}};e.\u0275fac=function(r){return new(r||e)(g(ri))},e.\u0275dir=ie({type:e,selectors:[["","matTabContent",""]],standalone:!0,features:[pt([{provide:s9,useExisting:e}])]});let t=e;return t})(),o9=new K("MatTabLabel"),IN=new K("MAT_TAB"),l9=(()=>{let e=class e extends mN{constructor(n,r,s){super(n,r),this._closestTab=s}};e.\u0275fac=function(r){return new(r||e)(g(ri),g(Wn),g(IN,8))},e.\u0275dir=ie({type:e,selectors:[["","mat-tab-label",""],["","matTabLabel",""]],standalone:!0,features:[pt([{provide:o9,useExisting:e}]),tt]});let t=e;return t})(),DN=new K("MAT_TAB_GROUP"),IC=(()=>{let e=class e{get templateLabel(){return this._templateLabel}set templateLabel(n){this._setTemplateLabelInput(n)}get content(){return this._contentPortal}constructor(n,r){this._viewContainerRef=n,this._closestTabGroup=r,this.disabled=!1,this._explicitContent=void 0,this.textLabel="",this._contentPortal=null,this._stateChanges=new be,this.position=null,this.origin=null,this.isActive=!1}ngOnChanges(n){(n.hasOwnProperty("textLabel")||n.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new tr(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(n){n&&n._closestTab===this&&(this._templateLabel=n)}};e.\u0275fac=function(r){return new(r||e)(g(Wn),g(DN,8))},e.\u0275cmp=ne({type:e,selectors:[["mat-tab"]],contentQueries:function(r,s,a){if(r&1&&(mt(a,l9,5),mt(a,a9,7,ri)),r&2){let o;de(o=ue())&&(s.templateLabel=o.first),de(o=ue())&&(s._explicitContent=o.first)}},viewQuery:function(r,s){if(r&1&&Be(ri,7),r&2){let a;de(a=ue())&&(s._implicitContent=a.first)}},hostAttrs:["hidden",""],inputs:{disabled:[G.HasDecoratorInputTransform,"disabled","disabled",qe],textLabel:[G.None,"label","textLabel"],ariaLabel:[G.None,"aria-label","ariaLabel"],ariaLabelledby:[G.None,"aria-labelledby","ariaLabelledby"],labelClass:"labelClass",bodyClass:"bodyClass"},exportAs:["matTab"],standalone:!0,features:[pt([{provide:IN,useExisting:e}]),yt,gi,se],ngContentSelectors:TC,decls:1,vars:0,template:function(r,s){r&1&&(wt(),Se(0,U8,1,0,"ng-template"))},encapsulation:2});let t=e;return t})(),EC="mdc-tab-indicator--active",xN="mdc-tab-indicator--no-transition",SC=class{constructor(e){this._items=e}hide(){this._items.forEach(e=>e.deactivateInkBar())}alignToElement(e){let i=this._items.find(r=>r.elementRef.nativeElement===e),n=this._currentItem;if(i!==n&&(n?.deactivateInkBar(),i)){let r=n?.elementRef.nativeElement.getBoundingClientRect?.();i.activateInkBar(r),this._currentItem=i}}},c9=(()=>{let e=class e{constructor(){this._elementRef=Ne(le),this._fitToContent=!1}get fitInkBarToContent(){return this._fitToContent}set fitInkBarToContent(n){this._fitToContent!==n&&(this._fitToContent=n,this._inkBarElement&&this._appendInkBarElement())}activateInkBar(n){let r=this._elementRef.nativeElement;if(!n||!r.getBoundingClientRect||!this._inkBarContentElement){r.classList.add(EC);return}let s=r.getBoundingClientRect(),a=n.width/s.width,o=n.left-s.left;r.classList.add(xN),this._inkBarContentElement.style.setProperty("transform",`translateX(${o}px) scaleX(${a})`),r.getBoundingClientRect(),r.classList.remove(xN),r.classList.add(EC),this._inkBarContentElement.style.setProperty("transform","")}deactivateInkBar(){this._elementRef.nativeElement.classList.remove(EC)}ngOnInit(){this._createInkBarElement()}ngOnDestroy(){this._inkBarElement?.remove(),this._inkBarElement=this._inkBarContentElement=null}_createInkBarElement(){let n=this._elementRef.nativeElement.ownerDocument||document,r=this._inkBarElement=n.createElement("span"),s=this._inkBarContentElement=n.createElement("span");r.className="mdc-tab-indicator",s.className="mdc-tab-indicator__content mdc-tab-indicator__content--underline",r.appendChild(this._inkBarContentElement),this._appendInkBarElement()}_appendInkBarElement(){this._inkBarElement;let n=this._fitToContent?this._elementRef.nativeElement.querySelector(".mdc-tab__content"):this._elementRef.nativeElement;n.appendChild(this._inkBarElement)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=ie({type:e,inputs:{fitInkBarToContent:[G.HasDecoratorInputTransform,"fitInkBarToContent","fitInkBarToContent",qe]},features:[yt]});let t=e;return t})();var kN=(()=>{let e=class e extends c9{constructor(n){super(),this.elementRef=n,this.disabled=!1}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}};e.\u0275fac=function(r){return new(r||e)(g(le))},e.\u0275dir=ie({type:e,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(r,s){r&2&&(xe("aria-disabled",!!s.disabled),ce("mat-mdc-tab-disabled",s.disabled))},inputs:{disabled:[G.HasDecoratorInputTransform,"disabled","disabled",qe]},standalone:!0,features:[yt,tt]});let t=e;return t})(),TN=Xn({passive:!0}),d9=650,u9=100,h9=(()=>{let e=class e{get selectedIndex(){return this._selectedIndex}set selectedIndex(n){let r=isNaN(n)?0:n;this._selectedIndex!=r&&(this._selectedIndexChanged=!0,this._selectedIndex=r,this._keyManager&&this._keyManager.updateActiveItem(r))}constructor(n,r,s,a,o,l,c){this._elementRef=n,this._changeDetectorRef=r,this._viewportRuler=s,this._dir=a,this._ngZone=o,this._platform=l,this._animationMode=c,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new be,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new be,this.disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new ae,this.indexFocused=new ae,o.runOutsideAngular(()=>{Qr(n.nativeElement,"mouseleave").pipe(ot(this._destroyed)).subscribe(()=>{this._stopInterval()})})}ngAfterViewInit(){Qr(this._previousPaginator.nativeElement,"touchstart",TN).pipe(ot(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),Qr(this._nextPaginator.nativeElement,"touchstart",TN).pipe(ot(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){let n=this._dir?this._dir.change:et("ltr"),r=this._viewportRuler.change(150),s=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new Bc(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap().skipPredicate(()=>!1),this._keyManager.updateActiveItem(this._selectedIndex),this._ngZone.onStable.pipe(mi(1)).subscribe(s),fi(n,r,this._items.changes,this._itemsResized()).pipe(ot(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>{Promise.resolve().then(()=>{this._scrollDistance=Math.max(0,Math.min(this._getMaxScrollDistance(),this._scrollDistance)),s()})}),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.subscribe(a=>{this.indexFocused.emit(a),this._setTabFocus(a)})}_itemsResized(){return typeof ResizeObserver!="function"?nM:this._items.changes.pipe(Kt(this._items),pi(n=>new ni(r=>this._ngZone.runOutsideAngular(()=>{let s=new ResizeObserver(a=>r.next(a));return n.forEach(a=>s.observe(a.elementRef.nativeElement)),()=>{s.disconnect()}}))),Ic(1),zt(n=>n.some(r=>r.contentRect.width>0&&r.contentRect.height>0)))}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._keyManager?.destroy(),this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(n){if(!Ea(n))switch(n.keyCode){case 13:case 32:if(this.focusIndex!==this.selectedIndex){let r=this._items.get(this.focusIndex);r&&!r.disabled&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(n))}break;default:this._keyManager.onKeydown(n)}}_onContentChanges(){let n=this._elementRef.nativeElement.textContent;n!==this._currentTextContent&&(this._currentTextContent=n||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(n){!this._isValidIndex(n)||this.focusIndex===n||!this._keyManager||this._keyManager.setActiveItem(n)}_isValidIndex(n){return this._items?!!this._items.toArray()[n]:!0}_setTabFocus(n){if(this._showPaginationControls&&this._scrollToLabel(n),this._items&&this._items.length){this._items.toArray()[n].focus();let r=this._tabListContainer.nativeElement;this._getLayoutDirection()=="ltr"?r.scrollLeft=0:r.scrollLeft=r.scrollWidth-r.offsetWidth}}_getLayoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;let n=this.scrollDistance,r=this._getLayoutDirection()==="ltr"?-n:n;this._tabList.nativeElement.style.transform=`translateX(${Math.round(r)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(n){this._scrollTo(n)}_scrollHeader(n){let r=this._tabListContainer.nativeElement.offsetWidth,s=(n=="before"?-1:1)*r/3;return this._scrollTo(this._scrollDistance+s)}_handlePaginatorClick(n){this._stopInterval(),this._scrollHeader(n)}_scrollToLabel(n){if(this.disablePagination)return;let r=this._items?this._items.toArray()[n]:null;if(!r)return;let s=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:a,offsetWidth:o}=r.elementRef.nativeElement,l,c;this._getLayoutDirection()=="ltr"?(l=a,c=l+o):(c=this._tabListInner.nativeElement.offsetWidth-a,l=c-o);let d=this.scrollDistance,u=this.scrollDistance+s;l<d?this.scrollDistance-=d-l:c>u&&(this.scrollDistance+=Math.min(c-u,l-d))}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{let n=this._tabListInner.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;n||(this.scrollDistance=0),n!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=n}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=this.scrollDistance==0,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){let n=this._tabListInner.nativeElement.scrollWidth,r=this._tabListContainer.nativeElement.offsetWidth;return n-r||0}_alignInkBarToSelectedTab(){let n=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,r=n?n.elementRef.nativeElement:null;r?this._inkBar.alignToElement(r):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(n,r){r&&r.button!=null&&r.button!==0||(this._stopInterval(),sM(d9,u9).pipe(ot(fi(this._stopScrolling,this._destroyed))).subscribe(()=>{let{maxScrollDistance:s,distance:a}=this._scrollHeader(n);(a===0||a>=s)&&this._stopInterval()}))}_scrollTo(n){if(this.disablePagination)return{maxScrollDistance:0,distance:0};let r=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(r,n)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:r,distance:this._scrollDistance}}};e.\u0275fac=function(r){return new(r||e)(g(le),g(lt),g(Gc),g(Ci,8),g(re),g(Ge),g(qi,8))},e.\u0275dir=ie({type:e,inputs:{disablePagination:[G.HasDecoratorInputTransform,"disablePagination","disablePagination",qe],selectedIndex:[G.HasDecoratorInputTransform,"selectedIndex","selectedIndex",va]},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[yt]});let t=e;return t})(),f9=(()=>{let e=class e extends h9{constructor(n,r,s,a,o,l,c){super(n,r,s,a,o,l,c),this.disableRipple=!1}ngAfterContentInit(){this._inkBar=new SC(this._items),super.ngAfterContentInit()}_itemSelected(n){n.preventDefault()}};e.\u0275fac=function(r){return new(r||e)(g(le),g(lt),g(Gc),g(Ci,8),g(re),g(Ge),g(qi,8))},e.\u0275cmp=ne({type:e,selectors:[["mat-tab-header"]],contentQueries:function(r,s,a){if(r&1&&mt(a,kN,4),r&2){let o;de(o=ue())&&(s._items=o)}},viewQuery:function(r,s){if(r&1&&(Be(q8,7),Be(H8,7),Be(W8,7),Be(G8,5),Be(K8,5)),r&2){let a;de(a=ue())&&(s._tabListContainer=a.first),de(a=ue())&&(s._tabList=a.first),de(a=ue())&&(s._tabListInner=a.first),de(a=ue())&&(s._nextPaginator=a.first),de(a=ue())&&(s._previousPaginator=a.first)}},hostAttrs:[1,"mat-mdc-tab-header"],hostVars:4,hostBindings:function(r,s){r&2&&ce("mat-mdc-tab-header-pagination-controls-enabled",s._showPaginationControls)("mat-mdc-tab-header-rtl",s._getLayoutDirection()=="rtl")},inputs:{disableRipple:[G.HasDecoratorInputTransform,"disableRipple","disableRipple",qe]},standalone:!0,features:[yt,tt,se],ngContentSelectors:TC,decls:13,vars:10,consts:[["previousPaginator",""],["tabListContainer",""],["tabList",""],["tabListInner",""],["nextPaginator",""],["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-mdc-tab-header-pagination","mat-mdc-tab-header-pagination-before",3,"click","mousedown","touchend","matRippleDisabled","disabled"],[1,"mat-mdc-tab-header-pagination-chevron"],[1,"mat-mdc-tab-label-container",3,"keydown"],["role","tablist",1,"mat-mdc-tab-list",3,"cdkObserveContent"],[1,"mat-mdc-tab-labels"],["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-mdc-tab-header-pagination","mat-mdc-tab-header-pagination-after",3,"mousedown","click","touchend","matRippleDisabled","disabled"]],template:function(r,s){if(r&1){let a=ft();wt(),_(0,"button",5,0),Z("click",function(){return ve(a),ye(s._handlePaginatorClick("before"))})("mousedown",function(l){return ve(a),ye(s._handlePaginatorPress("before",l))})("touchend",function(){return ve(a),ye(s._stopInterval())}),$(2,"div",6),b(),_(3,"div",7,1),Z("keydown",function(l){return ve(a),ye(s._handleKeydown(l))}),_(5,"div",8,2),Z("cdkObserveContent",function(){return ve(a),ye(s._onContentChanges())}),_(7,"div",9,3),Ke(9),b()()(),_(10,"button",10,4),Z("mousedown",function(l){return ve(a),ye(s._handlePaginatorPress("after",l))})("click",function(){return ve(a),ye(s._handlePaginatorClick("after"))})("touchend",function(){return ve(a),ye(s._stopInterval())}),$(12,"div",6),b()}r&2&&(ce("mat-mdc-tab-header-pagination-disabled",s._disableScrollBefore),H("matRippleDisabled",s._disableScrollBefore||s.disableRipple)("disabled",s._disableScrollBefore||null),w(3),ce("_mat-animation-noopable",s._animationMode==="NoopAnimations"),w(7),ce("mat-mdc-tab-header-pagination-disabled",s._disableScrollAfter),H("matRippleDisabled",s._disableScrollAfter||s.disableRipple)("disabled",s._disableScrollAfter||null))},dependencies:[jc,WM],styles:[".mat-mdc-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mdc-tab-indicator .mdc-tab-indicator__content{transition-duration:var(--mat-tab-animation-duration, 250ms)}.mat-mdc-tab-header-pagination{-webkit-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:rgba(0,0,0,0);touch-action:none;box-sizing:content-box;background:none;border:none;outline:0;padding:0}.mat-mdc-tab-header-pagination::-moz-focus-inner{border:0}.mat-mdc-tab-header-pagination .mat-ripple-element{opacity:.12;background-color:var(--mat-tab-header-inactive-ripple-color)}.mat-mdc-tab-header-pagination-controls-enabled .mat-mdc-tab-header-pagination{display:flex}.mat-mdc-tab-header-pagination-before,.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-after{padding-left:4px}.mat-mdc-tab-header-pagination-before .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-after .mat-mdc-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-before,.mat-mdc-tab-header-pagination-after{padding-right:4px}.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-before .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-header-pagination-after .mat-mdc-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-mdc-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;height:8px;width:8px;border-color:var(--mat-tab-header-pagination-icon-color)}.mat-mdc-tab-header-pagination-disabled{box-shadow:none;cursor:default;pointer-events:none}.mat-mdc-tab-header-pagination-disabled .mat-mdc-tab-header-pagination-chevron{opacity:.4}.mat-mdc-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-mdc-tab-list{transition:none}._mat-animation-noopable span.mdc-tab-indicator__content,._mat-animation-noopable span.mdc-tab__text-label{transition:none}.mat-mdc-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1;border-bottom-style:solid;border-bottom-width:var(--mat-tab-header-divider-height);border-bottom-color:var(--mat-tab-header-divider-color)}.mat-mdc-tab-group-inverted-header .mat-mdc-tab-label-container{border-bottom:none;border-top-style:solid;border-top-width:var(--mat-tab-header-divider-height);border-top-color:var(--mat-tab-header-divider-color)}.mat-mdc-tab-labels{display:flex;flex:1 0 auto}[mat-align-tabs=center]>.mat-mdc-tab-header .mat-mdc-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-mdc-tab-header .mat-mdc-tab-labels{justify-content:flex-end}.mat-mdc-tab::before{margin:5px}.cdk-high-contrast-active .mat-mdc-tab[aria-disabled=true]{color:GrayText}"],encapsulation:2});let t=e;return t})(),m9=new K("MAT_TABS_CONFIG"),p9={translateTab:$n("translateTab",[_i("center, void, left-origin-center, right-origin-center",ht({transform:"none"})),_i("left",ht({transform:"translate3d(-100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),_i("right",ht({transform:"translate3d(100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),Pi("* => left, * => right, left => center, right => center",Ni("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),Pi("void => left-origin-center",[ht({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"}),Ni("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),Pi("void => right-origin-center",[ht({transform:"translate3d(100%, 0, 0)",visibility:"hidden"}),Ni("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])},g9=(()=>{let e=class e extends ir{constructor(n,r,s,a){super(n,r,a),this._host=s,this._centeringSub=At.EMPTY,this._leavingSub=At.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(Kt(this._host._isCenterPosition(this._host._position))).subscribe(n=>{n&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this._host.preserveContent||this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)(g(Rc),g(Wn),g(Ui(()=>AN)),g(He))},e.\u0275dir=ie({type:e,selectors:[["","matTabBodyHost",""]],standalone:!0,features:[tt]});let t=e;return t})(),AN=(()=>{let e=class e{set position(n){this._positionIndex=n,this._computePositionAnimationState()}constructor(n,r,s){this._elementRef=n,this._dir=r,this._dirChangeSubscription=At.EMPTY,this._translateTabComplete=new be,this._onCentering=new ae,this._beforeCentering=new ae,this._afterLeavingCenter=new ae,this._onCentered=new ae(!0),this.animationDuration="500ms",this.preserveContent=!1,r&&(this._dirChangeSubscription=r.change.subscribe(a=>{this._computePositionAnimationState(a),s.markForCheck()})),this._translateTabComplete.pipe(Sr((a,o)=>a.fromState===o.fromState&&a.toState===o.toState)).subscribe(a=>{this._isCenterPosition(a.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(a.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}ngOnInit(){this._position=="center"&&this.origin!=null&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(n){let r=this._isCenterPosition(n.toState);this._beforeCentering.emit(r),r&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_isCenterPosition(n){return n=="center"||n=="left-origin-center"||n=="right-origin-center"}_computePositionAnimationState(n=this._getLayoutDirection()){this._positionIndex<0?this._position=n=="ltr"?"left":"right":this._positionIndex>0?this._position=n=="ltr"?"right":"left":this._position="center"}_computePositionFromOrigin(n){let r=this._getLayoutDirection();return r=="ltr"&&n<=0||r=="rtl"&&n>0?"left-origin-center":"right-origin-center"}};e.\u0275fac=function(r){return new(r||e)(g(le),g(Ci,8),g(lt))},e.\u0275cmp=ne({type:e,selectors:[["mat-tab-body"]],viewQuery:function(r,s){if(r&1&&Be(ir,5),r&2){let a;de(a=ue())&&(s._portalHost=a.first)}},hostAttrs:[1,"mat-mdc-tab-body"],inputs:{_content:[G.None,"content","_content"],origin:"origin",animationDuration:"animationDuration",preserveContent:"preserveContent",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"},standalone:!0,features:[se],decls:3,vars:6,consts:[["content",""],["cdkScrollable","",1,"mat-mdc-tab-body-content"],["matTabBodyHost",""]],template:function(r,s){if(r&1){let a=ft();_(0,"div",1,0),Z("@translateTab.start",function(l){return ve(a),ye(s._onTranslateTabStarted(l))})("@translateTab.done",function(l){return ve(a),ye(s._translateTabComplete.next(l))}),Se(2,Q8,0,0,"ng-template",2),b()}r&2&&H("@translateTab",Qo(3,Y8,s._position,mh(1,$8,s.animationDuration)))},dependencies:[g9,dC],styles:['.mat-mdc-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-mdc-tab-body.mat-mdc-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-mdc-tab-group.mat-mdc-tab-group-dynamic-height .mat-mdc-tab-body.mat-mdc-tab-body-active{overflow-y:hidden}.mat-mdc-tab-body-content{height:100%;overflow:auto}.mat-mdc-tab-group-dynamic-height .mat-mdc-tab-body-content{overflow:hidden}.mat-mdc-tab-body-content[style*="visibility: hidden"]{display:none}'],encapsulation:2,data:{animation:[p9.translateTab]}});let t=e;return t})(),_9=0,b9=!0,RN=(()=>{let e=class e{get fitInkBarToContent(){return this._fitInkBarToContent}set fitInkBarToContent(n){this._fitInkBarToContent=n,this._changeDetectorRef.markForCheck()}get selectedIndex(){return this._selectedIndex}set selectedIndex(n){this._indexToSelect=isNaN(n)?null:n}get animationDuration(){return this._animationDuration}set animationDuration(n){let r=n+"";this._animationDuration=/^\d+$/.test(r)?n+"ms":r}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(n){this._contentTabIndex=isNaN(n)?null:n}get backgroundColor(){return this._backgroundColor}set backgroundColor(n){if(!b9)throw new Error("mat-tab-group background color must be set through the Sass theming API");let r=this._elementRef.nativeElement.classList;r.remove("mat-tabs-with-background",`mat-background-${this.backgroundColor}`),n&&r.add("mat-tabs-with-background",`mat-background-${n}`),this._backgroundColor=n}constructor(n,r,s,a){this._elementRef=n,this._changeDetectorRef=r,this._animationMode=a,this._tabs=new es,this._indexToSelect=0,this._lastFocusedTabIndex=null,this._tabBodyWrapperHeight=0,this._tabsSubscription=At.EMPTY,this._tabLabelSubscription=At.EMPTY,this._fitInkBarToContent=!1,this.stretchTabs=!0,this.dynamicHeight=!1,this._selectedIndex=null,this.headerPosition="above",this.disablePagination=!1,this.disableRipple=!1,this.preserveContent=!1,this.selectedIndexChange=new ae,this.focusChange=new ae,this.animationDone=new ae,this.selectedTabChange=new ae(!0),this._isServer=!Ne(Ge).isBrowser,this._groupId=_9++,this.animationDuration=s&&s.animationDuration?s.animationDuration:"500ms",this.disablePagination=s&&s.disablePagination!=null?s.disablePagination:!1,this.dynamicHeight=s&&s.dynamicHeight!=null?s.dynamicHeight:!1,s?.contentTabIndex!=null&&(this.contentTabIndex=s.contentTabIndex),this.preserveContent=!!s?.preserveContent,this.fitInkBarToContent=s&&s.fitInkBarToContent!=null?s.fitInkBarToContent:!1,this.stretchTabs=s&&s.stretchTabs!=null?s.stretchTabs:!0}ngAfterContentChecked(){let n=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=n){let r=this._selectedIndex==null;if(!r){this.selectedTabChange.emit(this._createChangeEvent(n));let s=this._tabBodyWrapper.nativeElement;s.style.minHeight=s.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((s,a)=>s.isActive=a===n),r||(this.selectedIndexChange.emit(n),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((r,s)=>{r.position=s-n,this._selectedIndex!=null&&r.position==0&&!r.origin&&(r.origin=n-this._selectedIndex)}),this._selectedIndex!==n&&(this._selectedIndex=n,this._lastFocusedTabIndex=null,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{let n=this._clampTabIndex(this._indexToSelect);if(n===this._selectedIndex){let r=this._tabs.toArray(),s;for(let a=0;a<r.length;a++)if(r[a].isActive){this._indexToSelect=this._selectedIndex=a,this._lastFocusedTabIndex=null,s=r[a];break}!s&&r[n]&&Promise.resolve().then(()=>{r[n].isActive=!0,this.selectedTabChange.emit(this._createChangeEvent(n))})}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(Kt(this._allTabs)).subscribe(n=>{this._tabs.reset(n.filter(r=>r._closestTabGroup===this||!r._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}updatePagination(){this._tabHeader&&this._tabHeader.updatePagination()}focusTab(n){let r=this._tabHeader;r&&(r.focusIndex=n)}_focusChanged(n){this._lastFocusedTabIndex=n,this.focusChange.emit(this._createChangeEvent(n))}_createChangeEvent(n){let r=new xC;return r.index=n,this._tabs&&this._tabs.length&&(r.tab=this._tabs.toArray()[n]),r}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=fi(...this._tabs.map(n=>n._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(n){return Math.min(this._tabs.length-1,Math.max(n||0,0))}_getTabLabelId(n){return`mat-tab-label-${this._groupId}-${n}`}_getTabContentId(n){return`mat-tab-content-${this._groupId}-${n}`}_setTabBodyWrapperHeight(n){if(!this.dynamicHeight||!this._tabBodyWrapperHeight)return;let r=this._tabBodyWrapper.nativeElement;r.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(r.style.height=n+"px")}_removeTabBodyWrapperHeight(){let n=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=n.clientHeight,n.style.height="",this.animationDone.emit()}_handleClick(n,r,s){r.focusIndex=s,n.disabled||(this.selectedIndex=s)}_getTabIndex(n){let r=this._lastFocusedTabIndex??this.selectedIndex;return n===r?0:-1}_tabFocusChanged(n,r){n&&n!=="mouse"&&n!=="touch"&&(this._tabHeader.focusIndex=r)}};e.\u0275fac=function(r){return new(r||e)(g(le),g(lt),g(m9,8),g(qi,8))},e.\u0275cmp=ne({type:e,selectors:[["mat-tab-group"]],contentQueries:function(r,s,a){if(r&1&&mt(a,IC,5),r&2){let o;de(o=ue())&&(s._allTabs=o)}},viewQuery:function(r,s){if(r&1&&(Be(X8,5),Be(Z8,5)),r&2){let a;de(a=ue())&&(s._tabBodyWrapper=a.first),de(a=ue())&&(s._tabHeader=a.first)}},hostAttrs:[1,"mat-mdc-tab-group"],hostVars:10,hostBindings:function(r,s){r&2&&(An("mat-"+(s.color||"primary")),xr("--mat-tab-animation-duration",s.animationDuration),ce("mat-mdc-tab-group-dynamic-height",s.dynamicHeight)("mat-mdc-tab-group-inverted-header",s.headerPosition==="below")("mat-mdc-tab-group-stretch-tabs",s.stretchTabs))},inputs:{color:"color",fitInkBarToContent:[G.HasDecoratorInputTransform,"fitInkBarToContent","fitInkBarToContent",qe],stretchTabs:[G.HasDecoratorInputTransform,"mat-stretch-tabs","stretchTabs",qe],dynamicHeight:[G.HasDecoratorInputTransform,"dynamicHeight","dynamicHeight",qe],selectedIndex:[G.HasDecoratorInputTransform,"selectedIndex","selectedIndex",va],headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:[G.HasDecoratorInputTransform,"contentTabIndex","contentTabIndex",va],disablePagination:[G.HasDecoratorInputTransform,"disablePagination","disablePagination",qe],disableRipple:[G.HasDecoratorInputTransform,"disableRipple","disableRipple",qe],preserveContent:[G.HasDecoratorInputTransform,"preserveContent","preserveContent",qe],backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},exportAs:["matTabGroup"],standalone:!0,features:[pt([{provide:DN,useExisting:e}]),yt,se],ngContentSelectors:TC,decls:9,vars:6,consts:[["tabHeader",""],["tabBodyWrapper",""],["tabNode",""],[3,"indexFocused","selectFocusedIndex","selectedIndex","disableRipple","disablePagination"],["role","tab","matTabLabelWrapper","","cdkMonitorElementFocus","",1,"mdc-tab","mat-mdc-tab","mat-mdc-focus-indicator",3,"id","mdc-tab--active","ngClass","disabled","fitInkBarToContent"],[1,"mat-mdc-tab-body-wrapper"],["role","tabpanel",3,"id","mat-mdc-tab-body-active","ngClass","content","position","origin","animationDuration","preserveContent"],["role","tab","matTabLabelWrapper","","cdkMonitorElementFocus","",1,"mdc-tab","mat-mdc-tab","mat-mdc-focus-indicator",3,"click","cdkFocusChange","id","ngClass","disabled","fitInkBarToContent"],[1,"mdc-tab__ripple"],["mat-ripple","",1,"mat-mdc-tab-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mdc-tab__content"],[1,"mdc-tab__text-label"],[3,"cdkPortalOutlet"],["role","tabpanel",3,"_onCentered","_onCentering","id","ngClass","content","position","origin","animationDuration","preserveContent"]],template:function(r,s){if(r&1){let a=ft();wt(),_(0,"mat-tab-header",3,0),Z("indexFocused",function(l){return ve(a),ye(s._focusChanged(l))})("selectFocusedIndex",function(l){return ve(a),ye(s.selectedIndex=l)}),si(2,i9,8,16,"div",4,rn),b(),Se(4,n9,1,0),_(5,"div",5,1),si(7,r9,1,12,"mat-tab-body",6,rn),b()}r&2&&(H("selectedIndex",s.selectedIndex||0)("disableRipple",s.disableRipple)("disablePagination",s.disablePagination),w(2),ai(s._tabs),w(2),Pe(4,s._isServer?4:-1),w(),ce("_mat-animation-noopable",s._animationMode==="NoopAnimations"),w(2),ai(s._tabs))},dependencies:[f9,kN,Tg,ya,jc,ir,AN],styles:['.mdc-tab{min-width:90px;padding-right:24px;padding-left:24px;display:flex;flex:1 0 auto;justify-content:center;box-sizing:border-box;margin:0;padding-top:0;padding-bottom:0;border:none;outline:none;text-align:center;white-space:nowrap;cursor:pointer;-webkit-appearance:none;z-index:1}.mdc-tab::-moz-focus-inner{padding:0;border:0}.mdc-tab[hidden]{display:none}.mdc-tab--min-width{flex:0 1 auto}.mdc-tab__content{display:flex;align-items:center;justify-content:center;height:inherit;pointer-events:none}.mdc-tab__text-label{transition:150ms color linear;display:inline-block;line-height:1;z-index:2}.mdc-tab__icon{transition:150ms color linear;z-index:2}.mdc-tab--stacked .mdc-tab__content{flex-direction:column;align-items:center;justify-content:center}.mdc-tab--stacked .mdc-tab__text-label{padding-top:6px;padding-bottom:4px}.mdc-tab--active .mdc-tab__text-label,.mdc-tab--active .mdc-tab__icon{transition-delay:100ms}.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label{padding-left:8px;padding-right:0}[dir=rtl] .mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label,.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label[dir=rtl]{padding-left:0;padding-right:8px}.mdc-tab-indicator{display:flex;position:absolute;top:0;left:0;justify-content:center;width:100%;height:100%;pointer-events:none;z-index:1}.mdc-tab-indicator__content{transform-origin:left;opacity:0}.mdc-tab-indicator__content--underline{align-self:flex-end;box-sizing:border-box;width:100%;border-top-style:solid}.mdc-tab-indicator__content--icon{align-self:center;margin:0 auto}.mdc-tab-indicator--active .mdc-tab-indicator__content{opacity:1}.mdc-tab-indicator .mdc-tab-indicator__content{transition:250ms transform cubic-bezier(0.4, 0, 0.2, 1)}.mdc-tab-indicator--no-transition .mdc-tab-indicator__content{transition:none}.mdc-tab-indicator--fade .mdc-tab-indicator__content{transition:150ms opacity linear}.mdc-tab-indicator--active.mdc-tab-indicator--fade .mdc-tab-indicator__content{transition-delay:100ms}.mat-mdc-tab-ripple{position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none}.mat-mdc-tab{-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-decoration:none;background:none;font-family:var(--mat-tab-header-label-text-font);font-size:var(--mat-tab-header-label-text-size);letter-spacing:var(--mat-tab-header-label-text-tracking);line-height:var(--mat-tab-header-label-text-line-height);font-weight:var(--mat-tab-header-label-text-weight)}.mat-mdc-tab .mdc-tab-indicator__content--underline{border-color:var(--mdc-tab-indicator-active-indicator-color)}.mat-mdc-tab .mdc-tab-indicator__content--underline{border-top-width:var(--mdc-tab-indicator-active-indicator-height)}.mat-mdc-tab .mdc-tab-indicator__content--underline{border-radius:var(--mdc-tab-indicator-active-indicator-shape)}.mat-mdc-tab:not(.mdc-tab--stacked){height:var(--mdc-secondary-navigation-tab-container-height)}.mat-mdc-tab:not(:disabled).mdc-tab--active .mdc-tab__icon{fill:currentColor}.mat-mdc-tab:not(:disabled):hover.mdc-tab--active .mdc-tab__icon{fill:currentColor}.mat-mdc-tab:not(:disabled):focus.mdc-tab--active .mdc-tab__icon{fill:currentColor}.mat-mdc-tab:not(:disabled):active.mdc-tab--active .mdc-tab__icon{fill:currentColor}.mat-mdc-tab:disabled.mdc-tab--active .mdc-tab__icon{fill:currentColor}.mat-mdc-tab:not(:disabled):not(.mdc-tab--active) .mdc-tab__icon{fill:currentColor}.mat-mdc-tab:not(:disabled):hover:not(.mdc-tab--active) .mdc-tab__icon{fill:currentColor}.mat-mdc-tab:not(:disabled):focus:not(.mdc-tab--active) .mdc-tab__icon{fill:currentColor}.mat-mdc-tab:not(:disabled):active:not(.mdc-tab--active) .mdc-tab__icon{fill:currentColor}.mat-mdc-tab:disabled:not(.mdc-tab--active) .mdc-tab__icon{fill:currentColor}.mat-mdc-tab.mdc-tab{flex-grow:0}.mat-mdc-tab:hover .mdc-tab__text-label{color:var(--mat-tab-header-inactive-hover-label-text-color)}.mat-mdc-tab:focus .mdc-tab__text-label{color:var(--mat-tab-header-inactive-focus-label-text-color)}.mat-mdc-tab.mdc-tab--active .mdc-tab__text-label{color:var(--mat-tab-header-active-label-text-color)}.mat-mdc-tab.mdc-tab--active .mdc-tab__ripple::before,.mat-mdc-tab.mdc-tab--active .mat-ripple-element{background-color:var(--mat-tab-header-active-ripple-color)}.mat-mdc-tab.mdc-tab--active:hover .mdc-tab__text-label{color:var(--mat-tab-header-active-hover-label-text-color)}.mat-mdc-tab.mdc-tab--active:hover .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-header-active-hover-indicator-color)}.mat-mdc-tab.mdc-tab--active:focus .mdc-tab__text-label{color:var(--mat-tab-header-active-focus-label-text-color)}.mat-mdc-tab.mdc-tab--active:focus .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-header-active-focus-indicator-color)}.mat-mdc-tab.mat-mdc-tab-disabled{opacity:.4;pointer-events:none}.mat-mdc-tab.mat-mdc-tab-disabled .mdc-tab__content{pointer-events:none}.mat-mdc-tab.mat-mdc-tab-disabled .mdc-tab__ripple::before,.mat-mdc-tab.mat-mdc-tab-disabled .mat-ripple-element{background-color:var(--mat-tab-header-disabled-ripple-color)}.mat-mdc-tab .mdc-tab__ripple::before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;pointer-events:none;background-color:var(--mat-tab-header-inactive-ripple-color)}.mat-mdc-tab .mdc-tab__text-label{color:var(--mat-tab-header-inactive-label-text-color);display:inline-flex;align-items:center}.mat-mdc-tab .mdc-tab__content{position:relative;pointer-events:auto}.mat-mdc-tab:hover .mdc-tab__ripple::before{opacity:.04}.mat-mdc-tab.cdk-program-focused .mdc-tab__ripple::before,.mat-mdc-tab.cdk-keyboard-focused .mdc-tab__ripple::before{opacity:.12}.mat-mdc-tab .mat-ripple-element{opacity:.12;background-color:var(--mat-tab-header-inactive-ripple-color)}.mat-mdc-tab-group.mat-mdc-tab-group-stretch-tabs>.mat-mdc-tab-header .mat-mdc-tab{flex-grow:1}.mat-mdc-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination{background-color:var(--mat-tab-header-with-background-background-color)}.mat-mdc-tab-group.mat-tabs-with-background.mat-primary>.mat-mdc-tab-header .mat-mdc-tab .mdc-tab__text-label{color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background.mat-primary>.mat-mdc-tab-header .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background:not(.mat-primary)>.mat-mdc-tab-header .mat-mdc-tab:not(.mdc-tab--active) .mdc-tab__text-label{color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background:not(.mat-primary)>.mat-mdc-tab-header .mat-mdc-tab:not(.mdc-tab--active) .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-focus-indicator::before,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-mdc-focus-indicator::before{border-color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-ripple-element,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mdc-tab__ripple::before,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-ripple-element,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mdc-tab__ripple::before{background-color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-mdc-tab-header-pagination-chevron{color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-mdc-tab-group-inverted-header{flex-direction:column-reverse}.mat-mdc-tab-group.mat-mdc-tab-group-inverted-header .mdc-tab-indicator__content--underline{align-self:flex-start}.mat-mdc-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-mdc-tab-body-wrapper._mat-animation-noopable{transition:none !important;animation:none !important}'],encapsulation:2});let t=e;return t})(),xC=class{};var DC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De,De]});let t=e;return t})();var kC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De]});let t=e;return t})();var AC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[De,De]});let t=e;return t})();var y9=["*"];function w9(t,e){t&1&&Ke(0)}var RC=(()=>{let e=class e{constructor(n){this._elementRef=n}focus(){this._elementRef.nativeElement.focus()}};e.\u0275fac=function(r){return new(r||e)(g(le))},e.\u0275dir=ie({type:e,selectors:[["","cdkStepHeader",""]],hostAttrs:["role","tab"],standalone:!0});let t=e;return t})(),MC=(()=>{let e=class e{constructor(n){this.template=n}};e.\u0275fac=function(r){return new(r||e)(g(ri))},e.\u0275dir=ie({type:e,selectors:[["","cdkStepLabel",""]],standalone:!0});let t=e;return t})(),C9=0;var $s={NUMBER:"number",EDIT:"edit",DONE:"done",ERROR:"error"},OC=new K("STEPPER_GLOBAL_OPTIONS"),Yg=(()=>{let e=class e{get completed(){return this._completedOverride==null?this._getDefaultCompleted():this._completedOverride}set completed(n){this._completedOverride=n}_getDefaultCompleted(){return this.stepControl?this.stepControl.valid&&this.interacted:this.interacted}get hasError(){return this._customError==null?this._getDefaultError():this._customError}set hasError(n){this._customError=n}_getDefaultError(){return this.stepControl&&this.stepControl.invalid&&this.interacted}constructor(n,r){this._stepper=n,this.interacted=!1,this.interactedStream=new ae,this.editable=!0,this.optional=!1,this._completedOverride=null,this._customError=null,this._stepperOptions=r||{},this._displayDefaultIndicatorType=this._stepperOptions.displayDefaultIndicatorType!==!1}select(){this._stepper.selected=this}reset(){this.interacted=!1,this._completedOverride!=null&&(this._completedOverride=!1),this._customError!=null&&(this._customError=!1),this.stepControl&&this.stepControl.reset()}ngOnChanges(){this._stepper._stateChanged()}_markAsInteracted(){this.interacted||(this.interacted=!0,this.interactedStream.emit(this))}_showError(){return this._stepperOptions.showError??this._customError!=null}};e.\u0275fac=function(r){return new(r||e)(g(Ui(()=>Qg)),g(OC,8))},e.\u0275cmp=ne({type:e,selectors:[["cdk-step"]],contentQueries:function(r,s,a){if(r&1&&mt(a,MC,5),r&2){let o;de(o=ue())&&(s.stepLabel=o.first)}},viewQuery:function(r,s){if(r&1&&Be(ri,7),r&2){let a;de(a=ue())&&(s.content=a.first)}},inputs:{stepControl:"stepControl",label:"label",errorMessage:"errorMessage",ariaLabel:[G.None,"aria-label","ariaLabel"],ariaLabelledby:[G.None,"aria-labelledby","ariaLabelledby"],state:"state",editable:[G.HasDecoratorInputTransform,"editable","editable",qe],optional:[G.HasDecoratorInputTransform,"optional","optional",qe],completed:[G.HasDecoratorInputTransform,"completed","completed",qe],hasError:[G.HasDecoratorInputTransform,"hasError","hasError",qe]},outputs:{interactedStream:"interacted"},exportAs:["cdkStep"],standalone:!0,features:[yt,gi,se],ngContentSelectors:y9,decls:1,vars:0,template:function(r,s){r&1&&(wt(),Se(0,w9,1,0,"ng-template"))},encapsulation:2,changeDetection:0});let t=e;return t})(),Qg=(()=>{let e=class e{get selectedIndex(){return this._selectedIndex}set selectedIndex(n){this.steps&&this._steps?(this._isValidIndex(n),this.selected?._markAsInteracted(),this._selectedIndex!==n&&!this._anyControlsInvalidOrPending(n)&&(n>=this._selectedIndex||this.steps.toArray()[n].editable)&&this._updateSelectedItemIndex(n)):this._selectedIndex=n}get selected(){return this.steps?this.steps.toArray()[this.selectedIndex]:void 0}set selected(n){this.selectedIndex=n&&this.steps?this.steps.toArray().indexOf(n):-1}get orientation(){return this._orientation}set orientation(n){this._orientation=n,this._keyManager&&this._keyManager.withVerticalOrientation(n==="vertical")}constructor(n,r,s){this._dir=n,this._changeDetectorRef=r,this._elementRef=s,this._destroyed=new be,this.steps=new es,this._sortedHeaders=new es,this.linear=!1,this._selectedIndex=0,this.selectionChange=new ae,this.selectedIndexChange=new ae,this._orientation="horizontal",this._groupId=C9++}ngAfterContentInit(){this._steps.changes.pipe(Kt(this._steps),ot(this._destroyed)).subscribe(n=>{this.steps.reset(n.filter(r=>r._stepper===this)),this.steps.notifyOnChanges()})}ngAfterViewInit(){this._stepHeader.changes.pipe(Kt(this._stepHeader),ot(this._destroyed)).subscribe(n=>{this._sortedHeaders.reset(n.toArray().sort((r,s)=>r._elementRef.nativeElement.compareDocumentPosition(s._elementRef.nativeElement)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)),this._sortedHeaders.notifyOnChanges()}),this._keyManager=new Bc(this._sortedHeaders).withWrap().withHomeAndEnd().withVerticalOrientation(this._orientation==="vertical"),(this._dir?this._dir.change:et()).pipe(Kt(this._layoutDirection()),ot(this._destroyed)).subscribe(n=>this._keyManager.withHorizontalOrientation(n)),this._keyManager.updateActiveItem(this._selectedIndex),this.steps.changes.subscribe(()=>{this.selected||(this._selectedIndex=Math.max(this._selectedIndex-1,0))}),this._isValidIndex(this._selectedIndex)||(this._selectedIndex=0)}ngOnDestroy(){this._keyManager?.destroy(),this.steps.destroy(),this._sortedHeaders.destroy(),this._destroyed.next(),this._destroyed.complete()}next(){this.selectedIndex=Math.min(this._selectedIndex+1,this.steps.length-1)}previous(){this.selectedIndex=Math.max(this._selectedIndex-1,0)}reset(){this._updateSelectedItemIndex(0),this.steps.forEach(n=>n.reset()),this._stateChanged()}_getStepLabelId(n){return`cdk-step-label-${this._groupId}-${n}`}_getStepContentId(n){return`cdk-step-content-${this._groupId}-${n}`}_stateChanged(){this._changeDetectorRef.markForCheck()}_getAnimationDirection(n){let r=n-this._selectedIndex;return r<0?this._layoutDirection()==="rtl"?"next":"previous":r>0?this._layoutDirection()==="rtl"?"previous":"next":"current"}_getIndicatorType(n,r=$s.NUMBER){let s=this.steps.toArray()[n],a=this._isCurrentStep(n);return s._displayDefaultIndicatorType?this._getDefaultIndicatorLogic(s,a):this._getGuidelineLogic(s,a,r)}_getDefaultIndicatorLogic(n,r){return n._showError()&&n.hasError&&!r?$s.ERROR:!n.completed||r?$s.NUMBER:n.editable?$s.EDIT:$s.DONE}_getGuidelineLogic(n,r,s=$s.NUMBER){return n._showError()&&n.hasError&&!r?$s.ERROR:n.completed&&!r?$s.DONE:n.completed&&r?s:n.editable&&r?$s.EDIT:s}_isCurrentStep(n){return this._selectedIndex===n}_getFocusIndex(){return this._keyManager?this._keyManager.activeItemIndex:this._selectedIndex}_updateSelectedItemIndex(n){let r=this.steps.toArray();this.selectionChange.emit({selectedIndex:n,previouslySelectedIndex:this._selectedIndex,selectedStep:r[n],previouslySelectedStep:r[this._selectedIndex]}),this._containsFocus()?this._keyManager.setActiveItem(n):this._keyManager.updateActiveItem(n),this._selectedIndex=n,this.selectedIndexChange.emit(this._selectedIndex),this._stateChanged()}_onKeydown(n){let r=Ea(n),s=n.keyCode,a=this._keyManager;a.activeItemIndex!=null&&!r&&(s===32||s===13)?(this.selectedIndex=a.activeItemIndex,n.preventDefault()):a.setFocusOrigin("keyboard").onKeydown(n)}_anyControlsInvalidOrPending(n){return this.linear&&n>=0?this.steps.toArray().slice(0,n).some(r=>{let s=r.stepControl;return(s?s.invalid||s.pending||!r.interacted:!r.completed)&&!r.optional&&!r._completedOverride}):!1}_layoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_containsFocus(){let n=this._elementRef.nativeElement,r=Ch();return n===r||n.contains(r)}_isValidIndex(n){return n>-1&&(!this.steps||n<this.steps.length)}};e.\u0275fac=function(r){return new(r||e)(g(Ci,8),g(lt),g(le))},e.\u0275dir=ie({type:e,selectors:[["","cdkStepper",""]],contentQueries:function(r,s,a){if(r&1&&(mt(a,Yg,5),mt(a,RC,5)),r&2){let o;de(o=ue())&&(s._steps=o),de(o=ue())&&(s._stepHeader=o)}},inputs:{linear:[G.HasDecoratorInputTransform,"linear","linear",qe],selectedIndex:[G.HasDecoratorInputTransform,"selectedIndex","selectedIndex",va],selected:"selected",orientation:"orientation"},outputs:{selectionChange:"selectionChange",selectedIndexChange:"selectedIndexChange"},exportAs:["cdkStepper"],standalone:!0,features:[yt]});let t=e;return t})();var MN=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[rs]});let t=e;return t})();function E9(t,e){if(t&1&&$o(0,2),t&2){let i=j();H("ngTemplateOutlet",i.iconOverrides[i.state])("ngTemplateOutletContext",i._getIconContext())}}function S9(t,e){if(t&1&&(_(0,"span",7),F(1),b()),t&2){let i=j(2);w(),it(i._getDefaultTextForState(i.state))}}function x9(t,e){if(t&1&&(_(0,"span",8),F(1),b()),t&2){let i=j(3);w(),it(i._intl.completedLabel)}}function T9(t,e){if(t&1&&(_(0,"span",8),F(1),b()),t&2){let i=j(3);w(),it(i._intl.editableLabel)}}function I9(t,e){if(t&1&&(Se(0,x9,2,1,"span",8)(1,T9,2,1),_(2,"mat-icon",7),F(3),b()),t&2){let i=j(2);Pe(0,i.state==="done"?0:i.state==="edit"?1:-1),w(3),it(i._getDefaultTextForState(i.state))}}function D9(t,e){if(t&1&&Se(0,S9,2,1)(1,I9,4,2),t&2){let i,n=j();Pe(0,(i=n.state)==="number"?0:1)}}function k9(t,e){t&1&&(_(0,"div",4),$o(1,9),b()),t&2&&(w(),H("ngTemplateOutlet",e.template))}function A9(t,e){if(t&1&&(_(0,"div",4),F(1),b()),t&2){let i=j();w(),it(i.label)}}function R9(t,e){if(t&1&&(_(0,"div",5),F(1),b()),t&2){let i=j();w(),it(i._intl.optionalLabel)}}function M9(t,e){if(t&1&&(_(0,"div",6),F(1),b()),t&2){let i=j();w(),it(i.errorMessage)}}var NN=["*"];function O9(t,e){}function N9(t,e){if(t&1&&(Ke(0),Se(1,O9,0,0,"ng-template",0)),t&2){let i=j();w(),H("cdkPortalOutlet",i._portal)}}var PN=(t,e)=>({step:t,i:e}),FN=t=>({animationDuration:t}),LN=(t,e)=>({value:t,params:e});function P9(t,e){t&1&&Ke(0)}function F9(t,e){t&1&&$(0,"div",6)}function L9(t,e){if(t&1&&($o(0,5),Se(1,F9,1,0,"div",6)),t&2){let i=e.$implicit,n=e.$index,r=e.$index,s=e.$count;j(2);let a=ts(4);H("ngTemplateOutlet",a)("ngTemplateOutletContext",Qo(3,PN,i,n)),w(),Pe(1,r!==s-1?1:-1)}}function B9(t,e){if(t&1){let i=ft();_(0,"div",7),Z("@horizontalStepTransition.done",function(r){ve(i);let s=j(2);return ye(s._animationDone.next(r))}),$o(1,8),b()}if(t&2){let i=e.$implicit,n=e.$index,r=j(2);ce("mat-horizontal-stepper-content-inactive",r.selectedIndex!==n),H("@horizontalStepTransition",Qo(8,LN,r._getAnimationDirection(n),mh(6,FN,r._getAnimationDuration())))("id",r._getStepContentId(n)),xe("aria-labelledby",r._getStepLabelId(n)),w(),H("ngTemplateOutlet",i.content)}}function V9(t,e){if(t&1&&(_(0,"div",1)(1,"div",2),si(2,L9,2,6,null,null,rn),b(),_(4,"div",3),si(5,B9,2,11,"div",4,rn),b()()),t&2){let i=j();w(2),ai(i.steps),w(3),ai(i.steps)}}function j9(t,e){if(t&1){let i=ft();_(0,"div",9),$o(1,5),_(2,"div",10)(3,"div",11),Z("@verticalStepTransition.done",function(r){ve(i);let s=j(2);return ye(s._animationDone.next(r))}),_(4,"div",12),$o(5,8),b()()()()}if(t&2){let i=e.$implicit,n=e.$index,r=e.$index,s=e.$count,a=j(2),o=ts(4);w(),H("ngTemplateOutlet",o)("ngTemplateOutletContext",Qo(10,PN,i,n)),w(),ce("mat-stepper-vertical-line",r!==s-1),w(),ce("mat-vertical-stepper-content-inactive",a.selectedIndex!==n),H("@verticalStepTransition",Qo(15,LN,a._getAnimationDirection(n),mh(13,FN,a._getAnimationDuration())))("id",a._getStepContentId(n)),xe("aria-labelledby",a._getStepLabelId(n)),w(2),H("ngTemplateOutlet",i.content)}}function z9(t,e){if(t&1&&si(0,j9,6,18,"div",9,rn),t&2){let i=j();ai(i.steps)}}function U9(t,e){if(t&1){let i=ft();_(0,"mat-step-header",13),Z("click",function(){let r=ve(i).step;return ye(r.select())})("keydown",function(r){ve(i);let s=j();return ye(s._onKeydown(r))}),b()}if(t&2){let i=e.step,n=e.i,r=j();ce("mat-horizontal-stepper-header",r.orientation==="horizontal")("mat-vertical-stepper-header",r.orientation==="vertical"),H("tabIndex",r._getFocusIndex()===n?0:-1)("id",r._getStepLabelId(n))("index",n)("state",r._getIndicatorType(n,i.state))("label",i.stepLabel||i.label)("selected",r.selectedIndex===n)("active",r._stepIsNavigable(n,i))("optional",i.optional)("errorMessage",i.errorMessage)("iconOverrides",r._iconOverrides)("disableRipple",r.disableRipple||!r._stepIsNavigable(n,i))("color",i.color||r.color),xe("aria-posinset",n+1)("aria-setsize",r.steps.length)("aria-controls",r._getStepContentId(n))("aria-selected",r.selectedIndex==n)("aria-label",i.ariaLabel||null)("aria-labelledby",!i.ariaLabel&&i.ariaLabelledby?i.ariaLabelledby:null)("aria-disabled",r._stepIsNavigable(n,i)?null:!0)}}var NC=(()=>{let e=class e extends MC{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Jr(e)))(s||e)}})(),e.\u0275dir=ie({type:e,selectors:[["","matStepLabel",""]],standalone:!0,features:[tt]});let t=e;return t})(),Xg=(()=>{let e=class e{constructor(){this.changes=new be,this.optionalLabel="Optional",this.completedLabel="Completed",this.editableLabel="Editable"}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function q9(t){return t||new Xg}var H9={provide:Xg,deps:[[new Zr,new dh,Xg]],useFactory:q9},PC=(()=>{let e=class e extends RC{constructor(n,r,s,a){super(s),this._intl=n,this._focusMonitor=r,this._intlSubscription=n.changes.subscribe(()=>a.markForCheck())}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._intlSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._elementRef)}focus(n,r){n?this._focusMonitor.focusVia(this._elementRef,n,r):this._elementRef.nativeElement.focus(r)}_stringLabel(){return this.label instanceof NC?null:this.label}_templateLabel(){return this.label instanceof NC?this.label:null}_getHostElement(){return this._elementRef.nativeElement}_getIconContext(){return{index:this.index,active:this.active,optional:this.optional}}_getDefaultTextForState(n){return n=="number"?`${this.index+1}`:n=="edit"?"create":n=="error"?"warning":n}};e.\u0275fac=function(r){return new(r||e)(g(Xg),g(Mh),g(le),g(lt))},e.\u0275cmp=ne({type:e,selectors:[["mat-step-header"]],hostAttrs:["role","tab",1,"mat-step-header"],hostVars:2,hostBindings:function(r,s){r&2&&An("mat-"+(s.color||"primary"))},inputs:{state:"state",label:"label",errorMessage:"errorMessage",iconOverrides:"iconOverrides",index:"index",selected:"selected",active:"active",optional:"optional",disableRipple:"disableRipple",color:"color"},standalone:!0,features:[tt,se],decls:10,vars:17,consts:[["matRipple","",1,"mat-step-header-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-step-icon-content"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-step-label"],[1,"mat-step-text-label"],[1,"mat-step-optional"],[1,"mat-step-sub-label-error"],["aria-hidden","true"],[1,"cdk-visually-hidden"],[3,"ngTemplateOutlet"]],template:function(r,s){if(r&1&&($(0,"div",0),_(1,"div")(2,"div",1),Se(3,E9,1,2,"ng-container",2)(4,D9,2,1),b()(),_(5,"div",3),Se(6,k9,2,1,"div",4)(7,A9,2,1)(8,R9,2,1,"div",5)(9,M9,2,1,"div",6),b()),r&2){let a;H("matRippleTrigger",s._getHostElement())("matRippleDisabled",s.disableRipple),w(),vw("mat-step-icon-state-",s.state," mat-step-icon"),ce("mat-step-icon-selected",s.selected),w(2),Pe(3,s.iconOverrides&&s.iconOverrides[s.state]?3:4),w(2),ce("mat-step-label-active",s.active)("mat-step-label-selected",s.selected)("mat-step-label-error",s.state=="error"),w(),Pe(6,(a=s._templateLabel())?6:s._stringLabel()?7:-1,a),w(2),Pe(8,s.optional&&s.state!="error"?8:-1),w(),Pe(9,s.state==="error"?9:-1)}},dependencies:[jc,ph,bO],styles:['.mat-step-header{overflow:hidden;outline:none;cursor:pointer;position:relative;box-sizing:content-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-step-header:focus .mat-focus-indicator::before{content:""}.mat-step-header:hover[aria-disabled=true]{cursor:default}.mat-step-header:hover:not([aria-disabled]),.mat-step-header:hover[aria-disabled=false]{background-color:var(--mat-stepper-header-hover-state-layer-color);border-radius:var(--mat-stepper-header-hover-state-layer-shape)}.mat-step-header.cdk-keyboard-focused,.mat-step-header.cdk-program-focused{background-color:var(--mat-stepper-header-focus-state-layer-color);border-radius:var(--mat-stepper-header-focus-state-layer-shape)}@media(hover: none){.mat-step-header:hover{background:none}}.cdk-high-contrast-active .mat-step-header{outline:solid 1px}.cdk-high-contrast-active .mat-step-header[aria-selected=true] .mat-step-label{text-decoration:underline}.cdk-high-contrast-active .mat-step-header[aria-disabled=true]{outline-color:GrayText}.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-label,.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-icon,.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-optional{color:GrayText}.mat-step-optional{font-size:12px;color:var(--mat-stepper-header-optional-label-text-color)}.mat-step-sub-label-error{font-size:12px;font-weight:normal}.mat-step-icon{border-radius:50%;height:24px;width:24px;flex-shrink:0;position:relative;color:var(--mat-stepper-header-icon-foreground-color);background-color:var(--mat-stepper-header-icon-background-color)}.mat-step-icon-content{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex}.mat-step-icon .mat-icon{font-size:16px;height:16px;width:16px}.mat-step-icon-state-error{background-color:var(--mat-stepper-header-error-state-icon-background-color);color:var(--mat-stepper-header-error-state-icon-foreground-color)}.mat-step-icon-state-error .mat-icon{font-size:24px;height:24px;width:24px}.mat-step-label{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:50px;vertical-align:middle;font-family:var(--mat-stepper-header-label-text-font);font-size:var(--mat-stepper-header-label-text-size);font-weight:var(--mat-stepper-header-label-text-weight);color:var(--mat-stepper-header-label-text-color)}.mat-step-label.mat-step-label-active{color:var(--mat-stepper-header-selected-state-label-text-color)}.mat-step-label.mat-step-label-error{color:var(--mat-stepper-header-error-state-label-text-color);font-size:var(--mat-stepper-header-error-state-label-text-size)}.mat-step-label.mat-step-label-selected{font-size:var(--mat-stepper-header-selected-state-label-text-size);font-weight:var(--mat-stepper-header-selected-state-label-text-weight)}.mat-step-text-label{text-overflow:ellipsis;overflow:hidden}.mat-step-header .mat-step-header-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-step-icon-selected{background-color:var(--mat-stepper-header-selected-state-icon-background-color);color:var(--mat-stepper-header-selected-state-icon-foreground-color)}.mat-step-icon-state-done{background-color:var(--mat-stepper-header-done-state-icon-background-color);color:var(--mat-stepper-header-done-state-icon-foreground-color)}.mat-step-icon-state-edit{background-color:var(--mat-stepper-header-edit-state-icon-background-color);color:var(--mat-stepper-header-edit-state-icon-foreground-color)}'],encapsulation:2,changeDetection:0});let t=e;return t})(),BN="500ms",VN="225ms",ON={horizontalStepTransition:$n("horizontalStepTransition",[_i("previous",ht({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"})),_i("current",ht({transform:"none",visibility:"inherit"})),_i("next",ht({transform:"translate3d(100%, 0, 0)",visibility:"hidden"})),Pi("* => *",ww([Ni("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)"),Sw("@*",Ew(),{optional:!0})]),{params:{animationDuration:BN}})]),verticalStepTransition:$n("verticalStepTransition",[_i("previous",ht({height:"0px",visibility:"hidden"})),_i("next",ht({height:"0px",visibility:"hidden"})),_i("current",ht({height:"*",visibility:"inherit"})),Pi("* <=> current",ww([Ni("{{animationDuration}} cubic-bezier(0.4, 0.0, 0.2, 1)"),Sw("@*",Ew(),{optional:!0})]),{params:{animationDuration:VN}})])},W9=(()=>{let e=class e{constructor(n){this.templateRef=n}};e.\u0275fac=function(r){return new(r||e)(g(ri))},e.\u0275dir=ie({type:e,selectors:[["ng-template","matStepperIcon",""]],inputs:{name:[G.None,"matStepperIcon","name"]},standalone:!0});let t=e;return t})(),G9=(()=>{let e=class e{constructor(n){this._template=n}};e.\u0275fac=function(r){return new(r||e)(g(ri))},e.\u0275dir=ie({type:e,selectors:[["ng-template","matStepContent",""]],standalone:!0});let t=e;return t})(),K9=(()=>{let e=class e extends Yg{constructor(n,r,s,a){super(n,a),this._errorStateMatcher=r,this._viewContainerRef=s,this._isSelected=At.EMPTY,this.stepLabel=void 0}ngAfterContentInit(){this._isSelected=this._stepper.steps.changes.pipe(pi(()=>this._stepper.selectionChange.pipe(Ie(n=>n.selectedStep===this),Kt(this._stepper.selected===this)))).subscribe(n=>{n&&this._lazyContent&&!this._portal&&(this._portal=new tr(this._lazyContent._template,this._viewContainerRef))})}ngOnDestroy(){this._isSelected.unsubscribe()}isErrorState(n,r){let s=this._errorStateMatcher.isErrorState(n,r),a=!!(n&&n.invalid&&this.interacted);return s||a}};e.\u0275fac=function(r){return new(r||e)(g(Ui(()=>jN)),g(Vc,4),g(Wn),g(OC,8))},e.\u0275cmp=ne({type:e,selectors:[["mat-step"]],contentQueries:function(r,s,a){if(r&1&&(mt(a,NC,5),mt(a,G9,5)),r&2){let o;de(o=ue())&&(s.stepLabel=o.first),de(o=ue())&&(s._lazyContent=o.first)}},hostAttrs:["hidden",""],inputs:{color:"color"},exportAs:["matStep"],standalone:!0,features:[pt([{provide:Vc,useExisting:e},{provide:Yg,useExisting:e}]),tt,se],ngContentSelectors:NN,decls:1,vars:0,consts:[[3,"cdkPortalOutlet"]],template:function(r,s){r&1&&(wt(),Se(0,N9,2,1,"ng-template"))},dependencies:[ir],encapsulation:2,changeDetection:0});let t=e;return t})(),jN=(()=>{let e=class e extends Qg{get animationDuration(){return this._animationDuration}set animationDuration(n){this._animationDuration=/^\d+$/.test(n)?n+"ms":n}constructor(n,r,s){super(n,r,s),this._stepHeader=void 0,this._steps=void 0,this.steps=new es,this.animationDone=new ae,this.labelPosition="end",this.headerPosition="top",this._iconOverrides={},this._animationDone=new be,this._animationDuration="",this._isServer=!Ne(Ge).isBrowser;let a=s.nativeElement.nodeName.toLowerCase();this.orientation=a==="mat-vertical-stepper"?"vertical":"horizontal"}ngAfterContentInit(){super.ngAfterContentInit(),this._icons.forEach(({name:n,templateRef:r})=>this._iconOverrides[n]=r),this.steps.changes.pipe(ot(this._destroyed)).subscribe(()=>{this._stateChanged()}),this._animationDone.pipe(Sr((n,r)=>n.fromState===r.fromState&&n.toState===r.toState),ot(this._destroyed)).subscribe(n=>{n.toState==="current"&&this.animationDone.emit()})}_stepIsNavigable(n,r){return r.completed||this.selectedIndex===n||!this.linear}_getAnimationDuration(){return this.animationDuration?this.animationDuration:this.orientation==="horizontal"?BN:VN}};e.\u0275fac=function(r){return new(r||e)(g(Ci,8),g(lt),g(le))},e.\u0275cmp=ne({type:e,selectors:[["mat-stepper"],["mat-vertical-stepper"],["mat-horizontal-stepper"],["","matStepper",""]],contentQueries:function(r,s,a){if(r&1&&(mt(a,K9,5),mt(a,W9,5)),r&2){let o;de(o=ue())&&(s._steps=o),de(o=ue())&&(s._icons=o)}},viewQuery:function(r,s){if(r&1&&Be(PC,5),r&2){let a;de(a=ue())&&(s._stepHeader=a)}},hostAttrs:["role","tablist"],hostVars:11,hostBindings:function(r,s){r&2&&(xe("aria-orientation",s.orientation),ce("mat-stepper-horizontal",s.orientation==="horizontal")("mat-stepper-vertical",s.orientation==="vertical")("mat-stepper-label-position-end",s.orientation==="horizontal"&&s.labelPosition=="end")("mat-stepper-label-position-bottom",s.orientation==="horizontal"&&s.labelPosition=="bottom")("mat-stepper-header-position-bottom",s.headerPosition==="bottom"))},inputs:{disableRipple:"disableRipple",color:"color",labelPosition:"labelPosition",headerPosition:"headerPosition",animationDuration:"animationDuration"},outputs:{animationDone:"animationDone"},exportAs:["matStepper","matVerticalStepper","matHorizontalStepper"],standalone:!0,features:[pt([{provide:Qg,useExisting:e}]),tt,se],ngContentSelectors:NN,decls:5,vars:2,consts:[["stepTemplate",""],[1,"mat-horizontal-stepper-wrapper"],[1,"mat-horizontal-stepper-header-container"],[1,"mat-horizontal-content-container"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id","mat-horizontal-stepper-content-inactive"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-stepper-horizontal-line"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id"],[3,"ngTemplateOutlet"],[1,"mat-step"],[1,"mat-vertical-content-container"],["role","tabpanel",1,"mat-vertical-stepper-content",3,"id"],[1,"mat-vertical-content"],[3,"click","keydown","tabIndex","id","index","state","label","selected","active","optional","errorMessage","iconOverrides","disableRipple","color"]],template:function(r,s){if(r&1&&(wt(),Se(0,P9,1,0)(1,V9,7,0)(2,z9,2,0)(3,U9,1,23,"ng-template",null,0,ag)),r&2){let a;Pe(0,s._isServer?0:-1),w(),Pe(1,(a=s.orientation)==="horizontal"?1:a==="vertical"?2:-1)}},dependencies:[ph,PC],styles:['.mat-stepper-vertical,.mat-stepper-horizontal{display:block;font-family:var(--mat-stepper-container-text-font);background:var(--mat-stepper-container-color)}.mat-horizontal-stepper-header-container{white-space:nowrap;display:flex;align-items:center}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header-container{align-items:flex-start}.mat-stepper-header-position-bottom .mat-horizontal-stepper-header-container{order:1}.mat-stepper-horizontal-line{border-top-width:1px;border-top-style:solid;flex:auto;height:0;margin:0 -16px;min-width:32px;border-top-color:var(--mat-stepper-line-color)}.mat-stepper-label-position-bottom .mat-stepper-horizontal-line{margin:0;min-width:0;position:relative;top:calc(calc((var(--mat-stepper-header-height) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{border-top-width:1px;border-top-style:solid;content:"";display:inline-block;height:0;position:absolute;width:calc(50% - 20px)}.mat-horizontal-stepper-header{display:flex;height:72px;overflow:hidden;align-items:center;padding:0 24px;height:var(--mat-stepper-header-height)}.mat-horizontal-stepper-header .mat-step-icon{margin-right:8px;flex:none}[dir=rtl] .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:8px}.mat-horizontal-stepper-header::before,.mat-horizontal-stepper-header::after{border-top-color:var(--mat-stepper-line-color)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{padding:calc((var(--mat-stepper-header-height) - 24px) / 2) 24px}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::after{top:calc(calc((var(--mat-stepper-header-height) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{box-sizing:border-box;flex-direction:column;height:auto}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{right:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before{left:0}[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:last-child::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:first-child::after{display:none}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-label{padding:16px 0 0 0;text-align:center;width:100%}.mat-vertical-stepper-header{display:flex;align-items:center;height:24px;padding:calc((var(--mat-stepper-header-height) - 24px) / 2) 24px}.mat-vertical-stepper-header .mat-step-icon{margin-right:12px}[dir=rtl] .mat-vertical-stepper-header .mat-step-icon{margin-right:0;margin-left:12px}.mat-horizontal-stepper-wrapper{display:flex;flex-direction:column}.mat-horizontal-stepper-content{outline:0}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-inactive{height:0;overflow:hidden}.mat-horizontal-stepper-content:not(.mat-horizontal-stepper-content-inactive){visibility:inherit !important}.mat-horizontal-content-container{overflow:hidden;padding:0 24px 24px 24px}.cdk-high-contrast-active .mat-horizontal-content-container{outline:solid 1px}.mat-stepper-header-position-bottom .mat-horizontal-content-container{padding:24px 24px 0 24px}.mat-vertical-content-container{margin-left:36px;border:0;position:relative}.cdk-high-contrast-active .mat-vertical-content-container{outline:solid 1px}[dir=rtl] .mat-vertical-content-container{margin-left:0;margin-right:36px}.mat-stepper-vertical-line::before{content:"";position:absolute;left:0;border-left-width:1px;border-left-style:solid;border-left-color:var(--mat-stepper-line-color);top:calc(8px - calc((var(--mat-stepper-header-height) - 24px) / 2));bottom:calc(8px - calc((var(--mat-stepper-header-height) - 24px) / 2))}[dir=rtl] .mat-stepper-vertical-line::before{left:auto;right:0}.mat-vertical-stepper-content{overflow:hidden;outline:0}.mat-vertical-stepper-content:not(.mat-vertical-stepper-content-inactive){visibility:inherit !important}.mat-vertical-content{padding:0 24px 24px 24px}.mat-step:last-child .mat-vertical-content-container{border:none}'],encapsulation:2,data:{animation:[ON.horizontalStepTransition,ON.verticalStepTransition]},changeDetection:0});let t=e;return t})();var FC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({providers:[H9,Vc],imports:[De,Kn,Da,MN,Lh,Ph,jN,PC,De]});let t=e;return t})();var Y9=["mat-calendar-body",""];function Q9(t,e){if(t&1&&(_(0,"tr",0)(1,"td",3),F(2),b()()),t&2){let i=j();w(),xr("padding-top",i._cellPadding)("padding-bottom",i._cellPadding),xe("colspan",i.numCols),w(),yn(" ",i.label," ")}}function X9(t,e){if(t&1&&(_(0,"td",3),F(1),b()),t&2){let i=j(2);xr("padding-top",i._cellPadding)("padding-bottom",i._cellPadding),xe("colspan",i._firstRowOffset),w(),yn(" ",i._firstRowOffset>=i.labelMinRequiredCells?i.label:""," ")}}function Z9(t,e){if(t&1){let i=ft();_(0,"td",6)(1,"button",7),Z("click",function(r){let s=ve(i).$implicit,a=j(2);return ye(a._cellClicked(s,r))})("focus",function(r){let s=ve(i).$implicit,a=j(2);return ye(a._emitActiveDateChange(s,r))}),_(2,"span",8),F(3),b(),$(4,"span",9),b()()}if(t&2){let i=e.$implicit,n=e.$index,r=j().$index,s=j();xr("width",s._cellWidth)("padding-top",s._cellPadding)("padding-bottom",s._cellPadding),xe("data-mat-row",r)("data-mat-col",n),w(),ce("mat-calendar-body-disabled",!i.enabled)("mat-calendar-body-active",s._isActiveCell(r,n))("mat-calendar-body-range-start",s._isRangeStart(i.compareValue))("mat-calendar-body-range-end",s._isRangeEnd(i.compareValue))("mat-calendar-body-in-range",s._isInRange(i.compareValue))("mat-calendar-body-comparison-bridge-start",s._isComparisonBridgeStart(i.compareValue,r,n))("mat-calendar-body-comparison-bridge-end",s._isComparisonBridgeEnd(i.compareValue,r,n))("mat-calendar-body-comparison-start",s._isComparisonStart(i.compareValue))("mat-calendar-body-comparison-end",s._isComparisonEnd(i.compareValue))("mat-calendar-body-in-comparison-range",s._isInComparisonRange(i.compareValue))("mat-calendar-body-preview-start",s._isPreviewStart(i.compareValue))("mat-calendar-body-preview-end",s._isPreviewEnd(i.compareValue))("mat-calendar-body-in-preview",s._isInPreview(i.compareValue)),H("ngClass",i.cssClasses)("tabindex",s._isActiveCell(r,n)?0:-1),xe("aria-label",i.ariaLabel)("aria-disabled",!i.enabled||null)("aria-pressed",s._isSelected(i.compareValue))("aria-current",s.todayValue===i.compareValue?"date":null)("aria-describedby",s._getDescribedby(i.compareValue)),w(),ce("mat-calendar-body-selected",s._isSelected(i.compareValue))("mat-calendar-body-comparison-identical",s._isComparisonIdentical(i.compareValue))("mat-calendar-body-today",s.todayValue===i.compareValue),w(),yn(" ",i.displayValue," ")}}function J9(t,e){if(t&1&&(_(0,"tr",1),Se(1,X9,2,6,"td",4),si(2,Z9,5,48,"td",5,rn),b()),t&2){let i=e.$implicit,n=e.$index,r=j();w(),Pe(1,n===0&&r._firstRowOffset?1:-1),w(),ai(i)}}function eK(t,e){if(t&1&&(_(0,"th",2)(1,"span",6),F(2),b(),_(3,"span",3),F(4),b()()),t&2){let i=e.$implicit;w(2),it(i.long),w(2),it(i.narrow)}}var tK=["*"];function iK(t,e){}function nK(t,e){if(t&1){let i=ft();_(0,"mat-month-view",2),En("activeDateChange",function(r){ve(i);let s=j();return Cn(s.activeDate,r)||(s.activeDate=r),ye(r)}),Z("_userSelection",function(r){ve(i);let s=j();return ye(s._dateSelected(r))})("dragStarted",function(r){ve(i);let s=j();return ye(s._dragStarted(r))})("dragEnded",function(r){ve(i);let s=j();return ye(s._dragEnded(r))}),b()}if(t&2){let i=j();wn("activeDate",i.activeDate),H("selected",i.selected)("dateFilter",i.dateFilter)("maxDate",i.maxDate)("minDate",i.minDate)("dateClass",i.dateClass)("comparisonStart",i.comparisonStart)("comparisonEnd",i.comparisonEnd)("startDateAccessibleName",i.startDateAccessibleName)("endDateAccessibleName",i.endDateAccessibleName)("activeDrag",i._activeDrag)}}function rK(t,e){if(t&1){let i=ft();_(0,"mat-year-view",3),En("activeDateChange",function(r){ve(i);let s=j();return Cn(s.activeDate,r)||(s.activeDate=r),ye(r)}),Z("monthSelected",function(r){ve(i);let s=j();return ye(s._monthSelectedInYearView(r))})("selectedChange",function(r){ve(i);let s=j();return ye(s._goToDateInView(r,"month"))}),b()}if(t&2){let i=j();wn("activeDate",i.activeDate),H("selected",i.selected)("dateFilter",i.dateFilter)("maxDate",i.maxDate)("minDate",i.minDate)("dateClass",i.dateClass)}}function sK(t,e){if(t&1){let i=ft();_(0,"mat-multi-year-view",4),En("activeDateChange",function(r){ve(i);let s=j();return Cn(s.activeDate,r)||(s.activeDate=r),ye(r)}),Z("yearSelected",function(r){ve(i);let s=j();return ye(s._yearSelectedInMultiYearView(r))})("selectedChange",function(r){ve(i);let s=j();return ye(s._goToDateInView(r,"year"))}),b()}if(t&2){let i=j();wn("activeDate",i.activeDate),H("selected",i.selected)("dateFilter",i.dateFilter)("maxDate",i.maxDate)("minDate",i.minDate)("dateClass",i.dateClass)}}function aK(t,e){}var oK=["button"],lK=[[["","matDatepickerToggleIcon",""]]],cK=["[matDatepickerToggleIcon]"];function dK(t,e){t&1&&(ng(),_(0,"svg",2),$(1,"path",3),b())}var Qh=(()=>{let e=class e{constructor(){this.changes=new be,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(n,r){return`${n} \u2013 ${r}`}formatYearRangeLabel(n,r){return`${n} to ${r}`}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Yh=class{constructor(e,i,n,r,s={},a=e,o){this.value=e,this.displayValue=i,this.ariaLabel=n,this.enabled=r,this.cssClasses=s,this.compareValue=a,this.rawValue=o}},uK=1,zN=Xn({passive:!1,capture:!0}),ka=Xn({passive:!0,capture:!0}),Zg=Xn({passive:!0}),Xc=(()=>{let e=class e{ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}constructor(n,r){this._elementRef=n,this._ngZone=r,this._platform=Ne(Ge),this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new ae,this.previewChange=new ae,this.activeDateChange=new ae,this.dragStarted=new ae,this.dragEnded=new ae,this._didDragSinceMouseDown=!1,this._enterHandler=s=>{if(this._skipNextFocus&&s.type==="focus"){this._skipNextFocus=!1;return}if(s.target&&this.isRange){let a=this._getCellFromElement(s.target);a&&this._ngZone.run(()=>this.previewChange.emit({value:a.enabled?a:null,event:s}))}},this._touchmoveHandler=s=>{if(!this.isRange)return;let a=UN(s),o=a?this._getCellFromElement(a):null;a!==s.target&&(this._didDragSinceMouseDown=!0),BC(s.target)&&s.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:o?.enabled?o:null,event:s}))},this._leaveHandler=s=>{this.previewEnd!==null&&this.isRange&&(s.type!=="blur"&&(this._didDragSinceMouseDown=!0),s.target&&this._getCellFromElement(s.target)&&!(s.relatedTarget&&this._getCellFromElement(s.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:s})))},this._mousedownHandler=s=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;let a=s.target&&this._getCellFromElement(s.target);!a||!this._isInRange(a.compareValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:a.rawValue,event:s})})},this._mouseupHandler=s=>{if(!this.isRange)return;let a=BC(s.target);if(!a){this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:s})});return}a.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{let o=this._getCellFromElement(a);this.dragEnded.emit({value:o?.rawValue??null,event:s})})},this._touchendHandler=s=>{let a=UN(s);a&&this._mouseupHandler({target:a})},this._id=`mat-calendar-body-${uK++}`,this._startDateLabelId=`${this._id}-start-date`,this._endDateLabelId=`${this._id}-end-date`,r.runOutsideAngular(()=>{let s=n.nativeElement;s.addEventListener("touchmove",this._touchmoveHandler,zN),s.addEventListener("mouseenter",this._enterHandler,ka),s.addEventListener("focus",this._enterHandler,ka),s.addEventListener("mouseleave",this._leaveHandler,ka),s.addEventListener("blur",this._leaveHandler,ka),s.addEventListener("mousedown",this._mousedownHandler,Zg),s.addEventListener("touchstart",this._mousedownHandler,Zg),this._platform.isBrowser&&(window.addEventListener("mouseup",this._mouseupHandler),window.addEventListener("touchend",this._touchendHandler))})}_cellClicked(n,r){this._didDragSinceMouseDown||n.enabled&&this.selectedValueChange.emit({value:n.value,event:r})}_emitActiveDateChange(n,r){n.enabled&&this.activeDateChange.emit({value:n.value,event:r})}_isSelected(n){return this.startValue===n||this.endValue===n}ngOnChanges(n){let r=n.numCols,{rows:s,numCols:a}=this;(n.rows||r)&&(this._firstRowOffset=s&&s.length&&s[0].length?a-s[0].length:0),(n.cellAspectRatio||r||!this._cellPadding)&&(this._cellPadding=`${50*this.cellAspectRatio/a}%`),(r||!this._cellWidth)&&(this._cellWidth=`${100/a}%`)}ngOnDestroy(){let n=this._elementRef.nativeElement;n.removeEventListener("touchmove",this._touchmoveHandler,zN),n.removeEventListener("mouseenter",this._enterHandler,ka),n.removeEventListener("focus",this._enterHandler,ka),n.removeEventListener("mouseleave",this._leaveHandler,ka),n.removeEventListener("blur",this._leaveHandler,ka),n.removeEventListener("mousedown",this._mousedownHandler,Zg),n.removeEventListener("touchstart",this._mousedownHandler,Zg),this._platform.isBrowser&&(window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("touchend",this._touchendHandler))}_isActiveCell(n,r){let s=n*this.numCols+r;return n&&(s-=this._firstRowOffset),s==this.activeCell}_focusActiveCell(n=!0){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(mi(1)).subscribe(()=>{setTimeout(()=>{let r=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");r&&(n||(this._skipNextFocus=!0),r.focus())})})})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(n){return VC(n,this.startValue,this.endValue)}_isRangeEnd(n){return jC(n,this.startValue,this.endValue)}_isInRange(n){return zC(n,this.startValue,this.endValue,this.isRange)}_isComparisonStart(n){return VC(n,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(n,r,s){if(!this._isComparisonStart(n)||this._isRangeStart(n)||!this._isInRange(n))return!1;let a=this.rows[r][s-1];if(!a){let o=this.rows[r-1];a=o&&o[o.length-1]}return a&&!this._isRangeEnd(a.compareValue)}_isComparisonBridgeEnd(n,r,s){if(!this._isComparisonEnd(n)||this._isRangeEnd(n)||!this._isInRange(n))return!1;let a=this.rows[r][s+1];if(!a){let o=this.rows[r+1];a=o&&o[0]}return a&&!this._isRangeStart(a.compareValue)}_isComparisonEnd(n){return jC(n,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(n){return zC(n,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(n){return this.comparisonStart===this.comparisonEnd&&n===this.comparisonStart}_isPreviewStart(n){return VC(n,this.previewStart,this.previewEnd)}_isPreviewEnd(n){return jC(n,this.previewStart,this.previewEnd)}_isInPreview(n){return zC(n,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(n){return this.isRange?this.startValue===n&&this.endValue===n?`${this._startDateLabelId} ${this._endDateLabelId}`:this.startValue===n?this._startDateLabelId:this.endValue===n?this._endDateLabelId:null:null}_getCellFromElement(n){let r=BC(n);if(r){let s=r.getAttribute("data-mat-row"),a=r.getAttribute("data-mat-col");if(s&&a)return this.rows[parseInt(s)][parseInt(a)]}return null}};e.\u0275fac=function(r){return new(r||e)(g(le),g(re))},e.\u0275cmp=ne({type:e,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],standalone:!0,features:[gi,se],attrs:Y9,decls:7,vars:5,consts:[["aria-hidden","true"],["role","row"],[1,"mat-calendar-body-hidden-label",3,"id"],[1,"mat-calendar-body-label"],[1,"mat-calendar-body-label",3,"paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"click","focus","ngClass","tabindex"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(r,s){r&1&&(Se(0,Q9,3,6,"tr",0),si(1,J9,4,1,"tr",1,rn),_(3,"label",2),F(4),b(),_(5,"label",2),F(6),b()),r&2&&(Pe(0,s._firstRowOffset<s.labelMinRequiredCells?0:-1),w(),ai(s.rows),w(2),H("id",s._startDateLabelId),w(),yn(" ",s.startDateAccessibleName,`
`),w(),H("id",s._endDateLabelId),w(),yn(" ",s.endDateAccessibleName,`
`))},dependencies:[ya],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-outline-color)}.mat-calendar-body-label{height:0;line-height:0;text-align:start;padding-left:4.7142857143%;padding-right:4.7142857143%;font-size:var(--mat-datepicker-calendar-body-label-text-size);font-weight:var(--mat-datepicker-calendar-body-label-text-weight);color:var(--mat-datepicker-calendar-body-label-text-color)}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview{color:var(--mat-datepicker-calendar-date-preview-state-outline-color)}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.mat-calendar-body-disabled>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){color:var(--mat-datepicker-calendar-date-disabled-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-disabled-state-outline-color)}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px;color:var(--mat-datepicker-calendar-date-text-color);border-color:var(--mat-datepicker-calendar-date-outline-color)}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical),.cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-focus-state-background-color)}@media(hover: hover){.mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-hover-state-background-color)}}.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-state-background-color);color:var(--mat-datepicker-calendar-date-selected-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-disabled-state-background-color)}.mat-calendar-body-selected.mat-calendar-body-today{box-shadow:inset 0 0 0 1px var(--mat-datepicker-calendar-date-today-selected-state-outline-color)}.mat-calendar-body-in-range::before{background:var(--mat-datepicker-calendar-date-in-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-bridge-start::before,[dir=rtl] .mat-calendar-body-comparison-bridge-end::before{background:linear-gradient(to right, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-comparison-bridge-end::before,[dir=rtl] .mat-calendar-body-comparison-bridge-start::before{background:linear-gradient(to left, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-in-range>.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range.mat-calendar-body-in-range::after{background:var(--mat-datepicker-calendar-date-in-overlap-range-state-background-color)}.mat-calendar-body-comparison-identical.mat-calendar-body-selected,.mat-calendar-body-in-comparison-range>.mat-calendar-body-selected{background:var(--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color)}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}'],encapsulation:2,changeDetection:0});let t=e;return t})();function LC(t){return t?.nodeName==="TD"}function BC(t){let e;return LC(t)?e=t:LC(t.parentNode)?e=t.parentNode:LC(t.parentNode?.parentNode)&&(e=t.parentNode.parentNode),e?.getAttribute("data-mat-row")!=null?e:null}function VC(t,e,i){return i!==null&&e!==i&&t<i&&t===e}function jC(t,e,i){return e!==null&&e!==i&&t>=e&&t===i}function zC(t,e,i,n){return n&&e!==null&&i!==null&&e!==i&&t>=e&&t<=i}function UN(t){let e=t.changedTouches[0];return document.elementFromPoint(e.clientX,e.clientY)}var nr=class{constructor(e,i){this.start=e,this.end=i}},Jg=(()=>{let e=class e{constructor(n,r){this.selection=n,this._adapter=r,this._selectionChanged=new be,this.selectionChanged=this._selectionChanged,this.selection=n}updateSelection(n,r){let s=this.selection;this.selection=n,this._selectionChanged.next({selection:n,source:r,oldValue:s})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(n){return this._adapter.isDateInstance(n)&&this._adapter.isValid(n)}};e.\u0275fac=function(r){Ac()},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let t=e;return t})(),hK=(()=>{let e=class e extends Jg{constructor(n){super(null,n)}add(n){super.updateSelection(n,this)}isValid(){return this.selection!=null&&this._isValidDateInstance(this.selection)}isComplete(){return this.selection!=null}clone(){let n=new e(this._adapter);return n.updateSelection(this.selection,this),n}};e.\u0275fac=function(r){return new(r||e)(C(Jn))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let t=e;return t})();function fK(t,e){return t||new hK(e)}var mK={provide:Jg,deps:[[new Zr,new dh,Jg],Jn],useFactory:fK};var KN=new K("MAT_DATE_RANGE_SELECTION_STRATEGY");var UC=7,qN=(()=>{let e=class e{get activeDate(){return this._activeDate}set activeDate(n){let r=this._activeDate,s=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(s,this.minDate,this.maxDate),this._hasSameMonthAndYear(r,this._activeDate)||this._init()}get selected(){return this._selected}set selected(n){n instanceof nr?this._selected=n:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(n){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get maxDate(){return this._maxDate}set maxDate(n){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}constructor(n,r,s,a,o){this._changeDetectorRef=n,this._dateFormats=r,this._dateAdapter=s,this._dir=a,this._rangeStrategy=o,this._rerenderSubscription=At.EMPTY,this.activeDrag=null,this.selectedChange=new ae,this._userSelection=new ae,this.dragStarted=new ae,this.dragEnded=new ae,this.activeDateChange=new ae,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Kt(null)).subscribe(()=>this._init())}ngOnChanges(n){let r=n.comparisonStart||n.comparisonEnd;r&&!r.firstChange&&this._setRanges(this.selected),n.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(n){let r=n.value,s=this._getDateFromDayOfMonth(r),a,o;this._selected instanceof nr?(a=this._getDateInCurrentMonth(this._selected.start),o=this._getDateInCurrentMonth(this._selected.end)):a=o=this._getDateInCurrentMonth(this._selected),(a!==r||o!==r)&&this.selectedChange.emit(s),this._userSelection.emit({value:s,event:n.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(n){let r=n.value,s=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(r),this._dateAdapter.compareDate(s,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(n){let r=this._activeDate,s=this._isRtl();switch(n.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,s?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,s?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=n.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=n.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:this._selectionKeyPressed=!0,this._canSelect(this._activeDate)&&n.preventDefault();return;case 27:this._previewEnd!=null&&!Ea(n)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:n}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:n})),n.preventDefault(),n.stopPropagation());return;default:return}this._dateAdapter.compareDate(r,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),n.preventDefault()}_handleCalendarBodyKeyup(n){(n.keyCode===32||n.keyCode===13)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:n}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let n=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(UC+this._dateAdapter.getDayOfWeek(n)-this._dateAdapter.getFirstDayOfWeek())%UC,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(n){this._matCalendarBody._focusActiveCell(n)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:n,value:r}){if(this._rangeStrategy){let s=r?r.rawValue:null,a=this._rangeStrategy.createPreview(s,this.selected,n);if(this._previewStart=this._getCellCompareValue(a.start),this._previewEnd=this._getCellCompareValue(a.end),this.activeDrag&&s){let o=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,s,n);o&&(this._previewStart=this._getCellCompareValue(o.start),this._previewEnd=this._getCellCompareValue(o.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(n){if(this.activeDrag)if(n.value){let r=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,n.value,n.event);this.dragEnded.emit({value:r??null,event:n.event})}else this.dragEnded.emit({value:null,event:n.event})}_getDateFromDayOfMonth(n){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),n)}_initWeekdays(){let n=this._dateAdapter.getFirstDayOfWeek(),r=this._dateAdapter.getDayOfWeekNames("narrow"),a=this._dateAdapter.getDayOfWeekNames("long").map((o,l)=>({long:o,narrow:r[l]}));this._weekdays=a.slice(n).concat(a.slice(0,n))}_createWeekCells(){let n=this._dateAdapter.getNumDaysInMonth(this.activeDate),r=this._dateAdapter.getDateNames();this._weeks=[[]];for(let s=0,a=this._firstWeekOffset;s<n;s++,a++){a==UC&&(this._weeks.push([]),a=0);let o=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),s+1),l=this._shouldEnableDate(o),c=this._dateAdapter.format(o,this._dateFormats.display.dateA11yLabel),d=this.dateClass?this.dateClass(o,"month"):void 0;this._weeks[this._weeks.length-1].push(new Yh(s+1,r[s],c,l,d,this._getCellCompareValue(o),o))}}_shouldEnableDate(n){return!!n&&(!this.minDate||this._dateAdapter.compareDate(n,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(n,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(n))}_getDateInCurrentMonth(n){return n&&this._hasSameMonthAndYear(n,this.activeDate)?this._dateAdapter.getDate(n):null}_hasSameMonthAndYear(n,r){return!!(n&&r&&this._dateAdapter.getMonth(n)==this._dateAdapter.getMonth(r)&&this._dateAdapter.getYear(n)==this._dateAdapter.getYear(r))}_getCellCompareValue(n){if(n){let r=this._dateAdapter.getYear(n),s=this._dateAdapter.getMonth(n),a=this._dateAdapter.getDate(n);return new Date(r,s,a).getTime()}return null}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setRanges(n){n instanceof nr?(this._rangeStart=this._getCellCompareValue(n.start),this._rangeEnd=this._getCellCompareValue(n.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(n),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(n){return!this.dateFilter||this.dateFilter(n)}_clearPreview(){this._previewStart=this._previewEnd=null}};e.\u0275fac=function(r){return new(r||e)(g(lt),g(Nh,8),g(Jn,8),g(Ci,8),g(KN,8))},e.\u0275cmp=ne({type:e,selectors:[["mat-month-view"]],viewQuery:function(r,s){if(r&1&&Be(Xc,5),r&2){let a;de(a=ue())&&(s._matCalendarBody=a.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],standalone:!0,features:[gi,se],decls:8,vars:14,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col"],["aria-hidden","true"],["colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown","label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName"],[1,"cdk-visually-hidden"]],template:function(r,s){r&1&&(_(0,"table",0)(1,"thead",1)(2,"tr"),si(3,eK,5,2,"th",2,rn),b(),_(5,"tr",3),$(6,"th",4),b()(),_(7,"tbody",5),Z("selectedValueChange",function(o){return s._dateSelected(o)})("activeDateChange",function(o){return s._updateActiveDate(o)})("previewChange",function(o){return s._previewChanged(o)})("dragStarted",function(o){return s.dragStarted.emit(o)})("dragEnded",function(o){return s._dragEnded(o)})("keyup",function(o){return s._handleCalendarBodyKeyup(o)})("keydown",function(o){return s._handleCalendarBodyKeydown(o)}),b()()),r&2&&(w(3),ai(s._weekdays),w(4),H("label",s._monthLabel)("rows",s._weeks)("todayValue",s._todayDate)("startValue",s._rangeStart)("endValue",s._rangeEnd)("comparisonStart",s._comparisonRangeStart)("comparisonEnd",s._comparisonRangeEnd)("previewStart",s._previewStart)("previewEnd",s._previewEnd)("isRange",s._isRange)("labelMinRequiredCells",3)("activeCell",s._dateAdapter.getDate(s.activeDate)-1)("startDateAccessibleName",s.startDateAccessibleName)("endDateAccessibleName",s.endDateAccessibleName))},dependencies:[Xc],encapsulation:2,changeDetection:0});let t=e;return t})(),Mn=24,qC=4,HN=(()=>{let e=class e{get activeDate(){return this._activeDate}set activeDate(n){let r=this._activeDate,s=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(s,this.minDate,this.maxDate),$N(this._dateAdapter,r,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(n){n instanceof nr?this._selected=n:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n)),this._setSelectedYear(n)}get minDate(){return this._minDate}set minDate(n){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get maxDate(){return this._maxDate}set maxDate(n){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}constructor(n,r,s){this._changeDetectorRef=n,this._dateAdapter=r,this._dir=s,this._rerenderSubscription=At.EMPTY,this.selectedChange=new ae,this.yearSelected=new ae,this.activeDateChange=new ae,this._dateAdapter,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Kt(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());let r=this._dateAdapter.getYear(this._activeDate)-$h(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let s=0,a=[];s<Mn;s++)a.push(r+s),a.length==qC&&(this._years.push(a.map(o=>this._createCellForYear(o))),a=[]);this._changeDetectorRef.markForCheck()}_yearSelected(n){let r=n.value,s=this._dateAdapter.createDate(r,0,1),a=this._getDateFromYear(r);this.yearSelected.emit(s),this.selectedChange.emit(a)}_updateActiveDate(n){let r=n.value,s=this._activeDate;this.activeDate=this._getDateFromYear(r),this._dateAdapter.compareDate(s,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(n){let r=this._activeDate,s=this._isRtl();switch(n.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,s?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,s?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-qC);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,qC);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-$h(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,Mn-$h(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,n.altKey?-Mn*10:-Mn);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,n.altKey?Mn*10:Mn);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),n.preventDefault()}_handleCalendarBodyKeyup(n){(n.keyCode===32||n.keyCode===13)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:n}),this._selectionKeyPressed=!1)}_getActiveCell(){return $h(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(n){let r=this._dateAdapter.getMonth(this.activeDate),s=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(n,r,1));return this._dateAdapter.createDate(n,r,Math.min(this._dateAdapter.getDate(this.activeDate),s))}_createCellForYear(n){let r=this._dateAdapter.createDate(n,0,1),s=this._dateAdapter.getYearName(r),a=this.dateClass?this.dateClass(r,"multi-year"):void 0;return new Yh(n,s,s,this._shouldEnableYear(n),a)}_shouldEnableYear(n){if(n==null||this.maxDate&&n>this._dateAdapter.getYear(this.maxDate)||this.minDate&&n<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;let r=this._dateAdapter.createDate(n,0,1);for(let s=r;this._dateAdapter.getYear(s)==n;s=this._dateAdapter.addCalendarDays(s,1))if(this.dateFilter(s))return!0;return!1}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setSelectedYear(n){if(this._selectedYear=null,n instanceof nr){let r=n.start||n.end;r&&(this._selectedYear=this._dateAdapter.getYear(r))}else n&&(this._selectedYear=this._dateAdapter.getYear(n))}};e.\u0275fac=function(r){return new(r||e)(g(lt),g(Jn,8),g(Ci,8))},e.\u0275cmp=ne({type:e,selectors:[["mat-multi-year-view"]],viewQuery:function(r,s){if(r&1&&Be(Xc,5),r&2){let a;de(a=ue())&&(s._matCalendarBody=a.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],standalone:!0,features:[se],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell"]],template:function(r,s){r&1&&(_(0,"table",0)(1,"thead",1)(2,"tr"),$(3,"th",2),b()(),_(4,"tbody",3),Z("selectedValueChange",function(o){return s._yearSelected(o)})("activeDateChange",function(o){return s._updateActiveDate(o)})("keyup",function(o){return s._handleCalendarBodyKeyup(o)})("keydown",function(o){return s._handleCalendarBodyKeydown(o)}),b()()),r&2&&(w(4),H("rows",s._years)("todayValue",s._todayYear)("startValue",s._selectedYear)("endValue",s._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",s._getActiveCell()))},dependencies:[Xc],encapsulation:2,changeDetection:0});let t=e;return t})();function $N(t,e,i,n,r){let s=t.getYear(e),a=t.getYear(i),o=YN(t,n,r);return Math.floor((s-o)/Mn)===Math.floor((a-o)/Mn)}function $h(t,e,i,n){let r=t.getYear(e);return pK(r-YN(t,i,n),Mn)}function YN(t,e,i){let n=0;return i?n=t.getYear(i)-Mn+1:e&&(n=t.getYear(e)),n}function pK(t,e){return(t%e+e)%e}var WN=(()=>{let e=class e{get activeDate(){return this._activeDate}set activeDate(n){let r=this._activeDate,s=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(s,this.minDate,this.maxDate),this._dateAdapter.getYear(r)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(n){n instanceof nr?this._selected=n:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n)),this._setSelectedMonth(n)}get minDate(){return this._minDate}set minDate(n){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get maxDate(){return this._maxDate}set maxDate(n){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}constructor(n,r,s,a){this._changeDetectorRef=n,this._dateFormats=r,this._dateAdapter=s,this._dir=a,this._rerenderSubscription=At.EMPTY,this.selectedChange=new ae,this.monthSelected=new ae,this.activeDateChange=new ae,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Kt(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(n){let r=n.value,s=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),r,1);this.monthSelected.emit(s);let a=this._getDateFromMonth(r);this.selectedChange.emit(a)}_updateActiveDate(n){let r=n.value,s=this._activeDate;this.activeDate=this._getDateFromMonth(r),this._dateAdapter.compareDate(s,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(n){let r=this._activeDate,s=this._isRtl();switch(n.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,s?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,s?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,n.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,n.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(r,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),n.preventDefault()}_handleCalendarBodyKeyup(n){(n.keyCode===32||n.keyCode===13)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:n}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let n=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(r=>r.map(s=>this._createCellForMonth(s,n[s]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(n){return n&&this._dateAdapter.getYear(n)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(n):null}_getDateFromMonth(n){let r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,1),s=this._dateAdapter.getNumDaysInMonth(r);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,Math.min(this._dateAdapter.getDate(this.activeDate),s))}_createCellForMonth(n,r){let s=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,1),a=this._dateAdapter.format(s,this._dateFormats.display.monthYearA11yLabel),o=this.dateClass?this.dateClass(s,"year"):void 0;return new Yh(n,r.toLocaleUpperCase(),a,this._shouldEnableMonth(n),o)}_shouldEnableMonth(n){let r=this._dateAdapter.getYear(this.activeDate);if(n==null||this._isYearAndMonthAfterMaxDate(r,n)||this._isYearAndMonthBeforeMinDate(r,n))return!1;if(!this.dateFilter)return!0;let s=this._dateAdapter.createDate(r,n,1);for(let a=s;this._dateAdapter.getMonth(a)==n;a=this._dateAdapter.addCalendarDays(a,1))if(this.dateFilter(a))return!0;return!1}_isYearAndMonthAfterMaxDate(n,r){if(this.maxDate){let s=this._dateAdapter.getYear(this.maxDate),a=this._dateAdapter.getMonth(this.maxDate);return n>s||n===s&&r>a}return!1}_isYearAndMonthBeforeMinDate(n,r){if(this.minDate){let s=this._dateAdapter.getYear(this.minDate),a=this._dateAdapter.getMonth(this.minDate);return n<s||n===s&&r<a}return!1}_isRtl(){return this._dir&&this._dir.value==="rtl"}_setSelectedMonth(n){n instanceof nr?this._selectedMonth=this._getMonthInCurrentYear(n.start)||this._getMonthInCurrentYear(n.end):this._selectedMonth=this._getMonthInCurrentYear(n)}};e.\u0275fac=function(r){return new(r||e)(g(lt),g(Nh,8),g(Jn,8),g(Ci,8))},e.\u0275cmp=ne({type:e,selectors:[["mat-year-view"]],viewQuery:function(r,s){if(r&1&&Be(Xc,5),r&2){let a;de(a=ue())&&(s._matCalendarBody=a.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],standalone:!0,features:[se],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell"]],template:function(r,s){r&1&&(_(0,"table",0)(1,"thead",1)(2,"tr"),$(3,"th",2),b()(),_(4,"tbody",3),Z("selectedValueChange",function(o){return s._monthSelected(o)})("activeDateChange",function(o){return s._updateActiveDate(o)})("keyup",function(o){return s._handleCalendarBodyKeyup(o)})("keydown",function(o){return s._handleCalendarBodyKeydown(o)}),b()()),r&2&&(w(4),H("label",s._yearLabel)("rows",s._months)("todayValue",s._todayMonth)("startValue",s._selectedMonth)("endValue",s._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",s._dateAdapter.getMonth(s.activeDate)))},dependencies:[Xc],encapsulation:2,changeDetection:0});let t=e;return t})(),gK=1,QN=(()=>{let e=class e{constructor(n,r,s,a,o){this._intl=n,this.calendar=r,this._dateAdapter=s,this._dateFormats=a,this._id=`mat-calendar-header-${gK++}`,this._periodButtonLabelId=`${this._id}-period-label`,this.calendar.stateChanges.subscribe(()=>o.markForCheck())}get periodButtonText(){return this.calendar.currentView=="month"?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():this.calendar.currentView=="year"?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return this.calendar.currentView=="month"?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():this.calendar.currentView=="year"?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return this.calendar.currentView=="month"?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView=this.calendar.currentView=="month"?"multi-year":"month"}previousClicked(){this.calendar.activeDate=this.calendar.currentView=="month"?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,this.calendar.currentView=="year"?-1:-Mn)}nextClicked(){this.calendar.activeDate=this.calendar.currentView=="month"?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,this.calendar.currentView=="year"?1:Mn)}previousEnabled(){return this.calendar.minDate?!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate):!0}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(n,r){return this.calendar.currentView=="month"?this._dateAdapter.getYear(n)==this._dateAdapter.getYear(r)&&this._dateAdapter.getMonth(n)==this._dateAdapter.getMonth(r):this.calendar.currentView=="year"?this._dateAdapter.getYear(n)==this._dateAdapter.getYear(r):$N(this._dateAdapter,n,r,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){let r=this._dateAdapter.getYear(this.calendar.activeDate)-$h(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),s=r+Mn-1,a=this._dateAdapter.getYearName(this._dateAdapter.createDate(r,0,1)),o=this._dateAdapter.getYearName(this._dateAdapter.createDate(s,0,1));return[a,o]}};e.\u0275fac=function(r){return new(r||e)(g(Qh),g(Ui(()=>HC)),g(Jn,8),g(Nh,8),g(lt))},e.\u0275cmp=ne({type:e,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],standalone:!0,features:[se],ngContentSelectors:tK,decls:13,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],[1,"cdk-visually-hidden",3,"id"],["mat-button","","type","button","aria-live","polite",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"click","disabled"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"click","disabled"]],template:function(r,s){r&1&&(wt(),_(0,"div",0)(1,"div",1)(2,"label",2),F(3),b(),_(4,"button",3),Z("click",function(){return s.currentPeriodClicked()}),_(5,"span",4),F(6),b(),ng(),_(7,"svg",5),$(8,"polygon",6),b()(),mM(),$(9,"div",7),Ke(10),_(11,"button",8),Z("click",function(){return s.previousClicked()}),b(),_(12,"button",9),Z("click",function(){return s.nextClicked()}),b()()()),r&2&&(w(2),H("id",s._periodButtonLabelId),w(),it(s.periodButtonDescription),w(),xe("aria-label",s.periodButtonLabel)("aria-describedby",s._periodButtonLabelId),w(2),it(s.periodButtonText),w(),ce("mat-calendar-invert",s.calendar.currentView!=="month"),w(4),H("disabled",!s.previousEnabled()),xe("aria-label",s.prevButtonLabel),w(),H("disabled",!s.nextEnabled()),xe("aria-label",s.nextButtonLabel))},dependencies:[Wh,lC],encapsulation:2,changeDetection:0});let t=e;return t})(),HC=(()=>{let e=class e{get startAt(){return this._startAt}set startAt(n){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get selected(){return this._selected}set selected(n){n instanceof nr?this._selected=n:this._selected=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get minDate(){return this._minDate}set minDate(n){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get maxDate(){return this._maxDate}set maxDate(n){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get activeDate(){return this._clampedActiveDate}set activeDate(n){this._clampedActiveDate=this._dateAdapter.clampDate(n,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(n){let r=this._currentView!==n?n:null;this._currentView=n,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),r&&this.viewChanged.emit(r)}constructor(n,r,s,a){this._dateAdapter=r,this._dateFormats=s,this._changeDetectorRef=a,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new ae,this.yearSelected=new ae,this.monthSelected=new ae,this.viewChanged=new ae(!0),this._userSelection=new ae,this._userDragDrop=new ae,this._activeDrag=null,this.stateChanges=new be,this._intlChanges=n.changes.subscribe(()=>{a.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new Ia(this.headerComponent||QN),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(n){let r=n.minDate&&!this._dateAdapter.sameDate(n.minDate.previousValue,n.minDate.currentValue)?n.minDate:void 0,s=n.maxDate&&!this._dateAdapter.sameDate(n.maxDate.previousValue,n.maxDate.currentValue)?n.maxDate:void 0,a=r||s||n.dateFilter;if(a&&!a.firstChange){let o=this._getCurrentViewComponent();o&&(this._changeDetectorRef.detectChanges(),o._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(n){let r=n.value;(this.selected instanceof nr||r&&!this._dateAdapter.sameDate(r,this.selected))&&this.selectedChange.emit(r),this._userSelection.emit(n)}_yearSelectedInMultiYearView(n){this.yearSelected.emit(n)}_monthSelectedInYearView(n){this.monthSelected.emit(n)}_goToDateInView(n,r){this.activeDate=n,this.currentView=r}_dragStarted(n){this._activeDrag=n}_dragEnded(n){this._activeDrag&&(n.value&&this._userDragDrop.emit(n),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}};e.\u0275fac=function(r){return new(r||e)(g(Qh),g(Jn,8),g(Nh,8),g(lt))},e.\u0275cmp=ne({type:e,selectors:[["mat-calendar"]],viewQuery:function(r,s){if(r&1&&(Be(qN,5),Be(WN,5),Be(HN,5)),r&2){let a;de(a=ue())&&(s.monthView=a.first),de(a=ue())&&(s.yearView=a.first),de(a=ue())&&(s.multiYearView=a.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],standalone:!0,features:[pt([mK]),gi,se],decls:5,vars:2,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content"],[3,"activeDateChange","_userSelection","dragStarted","dragEnded","activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDateChange","monthSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","yearSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"]],template:function(r,s){if(r&1&&(Se(0,iK,0,0,"ng-template",0),_(1,"div",1),Se(2,nK,1,11)(3,rK,1,6)(4,sK,1,6),b()),r&2){let a;H("cdkPortalOutlet",s._calendarHeaderPortal),w(2),Pe(2,(a=s.currentView)==="month"?2:a==="year"?3:a==="multi-year"?4:-1)}},dependencies:[ir,Tg,qN,WN,HN],styles:['.mat-calendar{display:block;font-family:var(--mat-datepicker-calendar-text-font);font-size:var(--mat-datepicker-calendar-text-size)}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px;font-size:var(--mat-datepicker-calendar-period-button-text-size);font-weight:var(--mat-datepicker-calendar-period-button-text-weight);--mdc-text-button-label-text-color:var(--mat-datepicker-calendar-period-button-text-color)}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle;fill:var(--mat-datepicker-calendar-period-button-icon-color)}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-datepicker-content .mat-calendar-previous-button:not(.mat-mdc-button-disabled),.mat-datepicker-content .mat-calendar-next-button:not(.mat-mdc-button-disabled){color:var(--mat-datepicker-calendar-navigation-button-icon-color)}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0;color:var(--mat-datepicker-calendar-header-text-color);font-size:var(--mat-datepicker-calendar-header-text-size);font-weight:var(--mat-datepicker-calendar-header-text-weight)}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px;background:var(--mat-datepicker-calendar-header-divider-color)}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0});let t=e;return t})(),GN={transformPanel:$n("transformPanel",[Pi("void => enter-dropdown",Ni("120ms cubic-bezier(0, 0, 0.2, 1)",Cw([ht({opacity:0,transform:"scale(1, 0.8)"}),ht({opacity:1,transform:"scale(1, 1)"})]))),Pi("void => enter-dialog",Ni("150ms cubic-bezier(0, 0, 0.2, 1)",Cw([ht({opacity:0,transform:"scale(0.7)"}),ht({transform:"none",opacity:1})]))),Pi("* => void",Ni("100ms linear",ht({opacity:0})))]),fadeInCalendar:$n("fadeInCalendar",[_i("void",ht({opacity:0})),_i("enter",ht({opacity:1})),Pi("void => *",Ni("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])};var _K=new K("mat-datepicker-scroll-strategy",{providedIn:"root",factory:()=>{let t=Ne(kr);return()=>t.scrollStrategies.reposition()}});function bK(t){return()=>t.scrollStrategies.reposition()}var vK={provide:_K,deps:[kr],useFactory:bK},yK=(()=>{let e=class e{constructor(n,r,s,a,o,l){this._elementRef=n,this._changeDetectorRef=r,this._globalModel=s,this._dateAdapter=a,this._rangeSelectionStrategy=o,this._subscriptions=new At,this._animationDone=new be,this._isAnimating=!1,this._actionsPortal=null,this._closeButtonText=l.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(n){let r=this._model.selection,s=n.value,a=r instanceof nr;if(a&&this._rangeSelectionStrategy){let o=this._rangeSelectionStrategy.selectionFinished(s,r,n.event);this._model.updateSelection(o,this)}else s&&(a||!this._dateAdapter.sameDate(s,r))&&this._model.add(s);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(n){this._model.updateSelection(n.value,this)}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_handleAnimationEvent(n){this._isAnimating=n.phaseName==="start",this._isAnimating||this._animationDone.next()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(n,r){this._model=n?this._globalModel.clone():this._globalModel,this._actionsPortal=n,r&&this._changeDetectorRef.detectChanges()}};e.\u0275fac=function(r){return new(r||e)(g(le),g(lt),g(Jg),g(Jn),g(KN,8),g(Qh))},e.\u0275cmp=ne({type:e,selectors:[["mat-datepicker-content"]],viewQuery:function(r,s){if(r&1&&Be(HC,5),r&2){let a;de(a=ue())&&(s._calendar=a.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:5,hostBindings:function(r,s){r&1&&fh("@transformPanel.start",function(o){return s._handleAnimationEvent(o)})("@transformPanel.done",function(o){return s._handleAnimationEvent(o)}),r&2&&(hh("@transformPanel",s._animationState),An(s.color?"mat-"+s.color:""),ce("mat-datepicker-content-touch",s.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],standalone:!0,features:[se],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop","id","ngClass","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"focus","blur","click","color"]],template:function(r,s){if(r&1&&(_(0,"div",0)(1,"mat-calendar",1),Z("yearSelected",function(o){return s.datepicker._selectYear(o)})("monthSelected",function(o){return s.datepicker._selectMonth(o)})("viewChanged",function(o){return s.datepicker._viewChanged(o)})("_userSelection",function(o){return s._handleUserSelection(o)})("_userDragDrop",function(o){return s._handleUserDragDrop(o)}),b(),Se(2,aK,0,0,"ng-template",2),_(3,"button",3),Z("focus",function(){return s._closeButtonFocused=!0})("blur",function(){return s._closeButtonFocused=!1})("click",function(){return s.datepicker.close()}),F(4),b()()),r&2){let a;ce("mat-datepicker-content-container-with-custom-header",s.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",s._actionsPortal),xe("aria-modal",!0)("aria-labelledby",(a=s._dialogLabelId)!==null&&a!==void 0?a:void 0),w(),H("id",s.datepicker.id)("ngClass",s.datepicker.panelClass)("startAt",s.datepicker.startAt)("startView",s.datepicker.startView)("minDate",s.datepicker._getMinDate())("maxDate",s.datepicker._getMaxDate())("dateFilter",s.datepicker._getDateFilter())("headerComponent",s.datepicker.calendarHeaderComponent)("selected",s._getSelected())("dateClass",s.datepicker.dateClass)("comparisonStart",s.comparisonStart)("comparisonEnd",s.comparisonEnd)("@fadeInCalendar","enter")("startDateAccessibleName",s.startDateAccessibleName)("endDateAccessibleName",s.endDateAccessibleName),w(),H("cdkPortalOutlet",s._actionsPortal),w(),ce("cdk-visually-hidden",!s._closeButtonFocused),H("color",s.color||"primary"),w(),it(s._closeButtonText)}},dependencies:[JM,HC,ya,ir,Wh],styles:[".mat-datepicker-content{display:block;border-radius:4px;background-color:var(--mat-datepicker-calendar-container-background-color);color:var(--mat-datepicker-calendar-container-text-color);box-shadow:var(--mat-datepicker-calendar-container-elevation-shadow);border-radius:var(--mat-datepicker-calendar-container-shape)}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;box-shadow:var(--mat-datepicker-calendar-container-touch-elevation-shadow);border-radius:var(--mat-datepicker-calendar-container-touch-shape);position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[GN.transformPanel,GN.fadeInCalendar]},changeDetection:0});let t=e;return t})();var wK=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=ie({type:e,selectors:[["","matDatepickerToggleIcon",""]],standalone:!0});let t=e;return t})(),CK=(()=>{let e=class e{get disabled(){return this._disabled===void 0&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(n){this._disabled=n}constructor(n,r,s){this._intl=n,this._changeDetectorRef=r,this._stateChanges=At.EMPTY;let a=Number(s);this.tabIndex=a||a===0?a:null}ngOnChanges(n){n.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(n){this.datepicker&&!this.disabled&&(this.datepicker.open(),n.stopPropagation())}_watchStateChanges(){let n=this.datepicker?this.datepicker.stateChanges:et(),r=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:et(),s=this.datepicker?fi(this.datepicker.openedStream,this.datepicker.closedStream):et();this._stateChanges.unsubscribe(),this._stateChanges=fi(this._intl.changes,n,r,s).subscribe(()=>this._changeDetectorRef.markForCheck())}};e.\u0275fac=function(r){return new(r||e)(g(Qh),g(lt),Ko("tabindex"))},e.\u0275cmp=ne({type:e,selectors:[["mat-datepicker-toggle"]],contentQueries:function(r,s,a){if(r&1&&mt(a,wK,5),r&2){let o;de(o=ue())&&(s._customIcon=o.first)}},viewQuery:function(r,s){if(r&1&&Be(oK,5),r&2){let a;de(a=ue())&&(s._button=a.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(r,s){r&1&&Z("click",function(o){return s._open(o)}),r&2&&(xe("tabindex",null)("data-mat-calendar",s.datepicker?s.datepicker.id:null),ce("mat-datepicker-toggle-active",s.datepicker&&s.datepicker.opened)("mat-accent",s.datepicker&&s.datepicker.color==="accent")("mat-warn",s.datepicker&&s.datepicker.color==="warn"))},inputs:{datepicker:[G.None,"for","datepicker"],tabIndex:"tabIndex",ariaLabel:[G.None,"aria-label","ariaLabel"],disabled:[G.HasDecoratorInputTransform,"disabled","disabled",qe],disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],standalone:!0,features:[yt,gi,se],ngContentSelectors:cK,decls:4,vars:6,consts:[["button",""],["mat-icon-button","","type","button",3,"disabled","disableRipple"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(r,s){r&1&&(wt(lK),_(0,"button",1,0),Se(2,dK,2,0,":svg:svg",2),Ke(3),b()),r&2&&(H("disabled",s.disabled)("disableRipple",s.disableRipple),xe("aria-haspopup",s.datepicker?"dialog":null)("aria-label",s.ariaLabel||s._intl.openCalendarLabel)("tabindex",s.disabled?-1:s.tabIndex),w(2),Pe(2,s._customIcon?-1:2))},dependencies:[lC],styles:[".mat-datepicker-toggle{pointer-events:auto;color:var(--mat-datepicker-toggle-icon-color)}.mat-datepicker-toggle-active{color:var(--mat-datepicker-toggle-active-state-icon-color)}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}"],encapsulation:2,changeDetection:0});let t=e;return t})();var WC=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({providers:[Qh,vK],imports:[Kn,sl,Yc,iO,Da,De,yK,CK,QN,Ks]});let t=e;return t})();var EK=[Kw,$w,Lh,AO,oC,sl,hC,wC,CC,DC,kC,AC,FC,Sa,WC],ol=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=X({type:e}),e.\u0275inj=Q({imports:[EK,Kw,$w,Lh,oC,sl,hC,wC,CC,DC,kC,AC,FC,Sa,WC]});let t=e;return t})();var XN=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=ne({type:e,selectors:[["app-header"]],standalone:!0,features:[se],decls:7,vars:0,consts:[[1,"navbar","navbar-expand-lg","navbar-light","bg-white","z-index-3","py-3"],[1,"container"],["href","#","rel","tooltip","title","Designed and Coded by Creative Tim","data-placement","bottom",1,"navbar-brand"],[1,"navbar-brand"],[1,"fas","fa-user"]],template:function(r,s){r&1&&(_(0,"nav",0)(1,"div",1),$(2,"a",2),_(3,"span",3),F(4," Controle financeiro "),b(),_(5,"a",3),$(6,"i",4),b()()())},dependencies:[ol],styles:[".navbar[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;z-index:1000;background-color:#333;color:#fff;padding:10px 20px}"]});let t=e;return t})();var ZN=(()=>{let e=class e{constructor(){this.title="esquema"}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=ne({type:e,selectors:[["app-root"]],standalone:!0,features:[se],decls:1,vars:0,template:function(r,s){r&1&&$(0,"router-outlet")},dependencies:[AM]});let t=e;return t})();var Zc=class t{constructor(e,i,n,r){this.nome=e,this.saldoInicial=i,this.renda=n,this.despesa=r}static criarApartirdaLocalStorage(e){return new t(e.nome,e.saldoInicial,e.renda,e.despesa)}mostrarSaldoinicial(){return this.saldoInicial}mostrarTotalRenda(){return this.renda.reduce((e,i)=>e+i.valor,0)}mostrarTotalDespesa(){return this.despesa.reduce((e,i)=>e+i.valor,0)}calcularSaldoAtual(){let e=this.mostrarTotalRenda(),i=this.mostrarTotalDespesa();return this.saldoInicial+e-i}adicionarRenda(e){this.renda.push(e)}adicionarDespesa(e){this.despesa.push(e)}alterarSaldoInicial(e){this.saldoInicial=e}mostrarTransacoes(){let e=[];return this.renda,this.despesa}};var Aa=(()=>{let e=class e{constructor(){this.options=JSON.parse(localStorage.getItem("projetosSelect"))}consultarProjetosLocalStorage(){return!!localStorage.getItem("projetos")}consultarOptionsLocalStorage(){return!!localStorage.getItem("projetosSelect")}criarProjetosDefault(){this.options=["Projeto 1","Projeto 2","Projeto 3"],localStorage.setItem("projetosSelect",JSON.stringify(this.options));let n=[];for(let r of this.options){let s=new Zc(r,0,[],[]);n.push(s)}return localStorage.setItem("projetos",JSON.stringify(n)),localStorage.setItem("ultimoProjeto","Projeto 1"),this.listaProjetos=n,n}criarNovosProjetos(n,r){console.log(this.listaProjetos);let s=new Zc(n,r,[],[]);this.listaProjetos.push(s),console.log(s),this.options.push(n),localStorage.setItem("ultimoProjeto",n),localStorage.setItem("projetos",JSON.stringify(this.listaProjetos)),localStorage.setItem("projetosSelect",JSON.stringify(this.options))}recuperarProjetos(){let n=localStorage.getItem("projetos"),s=JSON.parse(n).map(a=>Zc.criarApartirdaLocalStorage(a));return this.listaProjetos=s,s}buscarUltimoProjetoSelecionado(){return localStorage.getItem("ultimoProjeto")?localStorage.getItem("ultimoProjeto"):"Projeto 3"}retornarProjetoSelecionado(n,r){return n.find(s=>s.nome==r)}mostarRenda(n){return this.listaProjetos.find(s=>s.nome===n).renda}mostarDespesa(n){return this.listaProjetos.find(s=>s.nome===n).despesa}mostrarTransacoes(n){let r=[];return this.listaProjetos.find(s=>s.nome===n).despesa.forEach(s=>{r.push(s)}),this.listaProjetos.find(s=>s.nome===n).renda.forEach(s=>{r.push(s)}),r}excluirProjeto(n){if(this.listaProjetos[1]===void 0)alert("Esse \xE9 o \xFAltimo projeto. Tente edita-lo");else{let r=this.listaProjetos.findIndex(a=>a.nome===n);this.listaProjetos.splice(r,1),localStorage.setItem("projetos",JSON.stringify(this.listaProjetos));let s=this.options.findIndex(a=>a===n);this.options.splice(s,1),localStorage.setItem("projetosSelect",JSON.stringify(this.options)),localStorage.getItem("ultimoProjeto")===n&&localStorage.setItem("ultimoProjeto",this.listaProjetos[0].nome)}}atualizarProjeto(n,r,s){let a=this.listaProjetos.find(l=>l.nome===n);a.nome=r,a.saldoInicial=s;let o=this.options.findIndex(l=>l==n);this.options[o]=r,localStorage.setItem("projetosSelect",JSON.stringify(this.options)),localStorage.setItem("ultimoProjeto",r),localStorage.setItem("projetos",JSON.stringify(this.listaProjetos))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var SK=()=>["/"];function xK(t,e){if(t&1){let i=ft();_(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22),Z("click",function(){let r=ve(i).$index,s=j();return ye(s.chamarColapso(r,!0))}),_(4,"h5",23)(5,"button",24)(6,"h6",25),F(7),b(),_(8,"p",26),F(9),b(),$(10,"i",27)(11,"i",28),b()(),_(12,"div",29)(13,"div",30)(14,"label",11),F(15,"Nomo do projeto"),b(),_(16,"input",12),En("ngModelChange",function(r){ve(i);let s=j();return Cn(s.novoProjeto,r)||(s.novoProjeto=r),ye(r)}),b(),_(17,"label",11),F(18,"Saldo inicial"),b(),_(19,"input",13),En("ngModelChange",function(r){ve(i);let s=j();return Cn(s.saldoInicialProjeto,r)||(s.saldoInicialProjeto=r),ye(r)}),b(),_(20,"div",14)(21,"button",31),Z("click",function(){let r=ve(i).$index,s=j();return ye(s.excluir(r))}),F(22,"Excluir"),b(),_(23,"button",32),Z("click",function(){let r=ve(i).$index,s=j();return ye(s.atualizarProjeto(r))}),F(24,"Salvar"),b()()()()()()()()}if(t&2){let i=e.$implicit,n=e.$index,r=j();w(5),xe("data-bs-target","#collapseOne"+n),w(2),it(i.nome),w(2),it(i.calcularSaldoAtual()),w(3),H("id","collapseOne"+n),w(4),wn("ngModel",r.novoProjeto),w(3),wn("ngModel",r.saldoInicialProjeto),w(2),xe("data-bs-target","#collapseOne"+n),w(2),xe("data-bs-target","#collapseOne"+n)}}var JN=(()=>{let e=class e{constructor(n,r){this.projetosSevices=n,this.formBuilder=r}ngOnInit(){this.listaProjetos=this.projetosSevices.recuperarProjetos()}selecionar(){localStorage.setItem("ultimoProjeto",this.projetoSelecionado.nome)}excluir(n){this.projetosSevices.excluirProjeto(this.listaProjetos[n].nome),this.listaProjetos=this.projetosSevices.recuperarProjetos()}criarProjeto(){console.log(this.novoProjeto,this.saldoInicialProjeto),this.saldoInicialProjeto||(this.saldoInicialProjeto=0),this.projetosSevices.criarNovosProjetos(this.novoProjeto,this.saldoInicialProjeto),this.listaProjetos=this.projetosSevices.recuperarProjetos()}chamarColapso(n,r){r?(this.novoProjeto=this.listaProjetos[n].nome,this.saldoInicialProjeto=this.listaProjetos[n].saldoInicial):(this.novoProjeto="",this.saldoInicialProjeto=0)}atualizarProjeto(n){this.saldoInicialProjeto||(this.saldoInicialProjeto=0),this.projetosSevices.atualizarProjeto(this.listaProjetos[n].nome,this.novoProjeto,this.saldoInicialProjeto),this.listaProjetos=this.projetosSevices.recuperarProjetos()}};e.\u0275fac=function(r){return new(r||e)(g(Aa),g(Wc))},e.\u0275cmp=ne({type:e,selectors:[["app-editar-projetos"]],standalone:!0,features:[se],decls:30,vars:4,consts:[[1,"col-lg-9","col-12","mx-auto"],[1,"navbar","navbar-expand-lg","navbar-light","bg-white","z-index-3","py-3"],[1,"container"],["rel","tooltip","title","Designed and Coded by Creative Tim","data-placement","bottom",1,"navbar-brand",3,"routerLink"],[1,"fas","fa-arrow-left"],["href","#","rel","tooltip","title","Designed and Coded by Creative Tim","data-placement","bottom",1,"navbar-brand"],[1,"example-spacer"],[1,"d-flex","justify-content-center","card","card-body","mt-4"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseExample1","aria-expanded","false","aria-controls","collapseExample1",1,"btn","btn-primary",3,"click"],["id","collapseExample1",1,"collapse"],[1,"card","card-body","mt-4"],[1,"form-label"],["type","text","id","nome-projeto","onfocus","focused(this)","onfocusout","defocused(this)",1,"form-control",3,"ngModelChange","ngModel"],["type","number","id","saldo-inicial","onfocus","focused(this)","onfocusout","defocused(this)",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-end","mt-4"],["type","button","name","button","data-bs-toggle","collapse","data-bs-target","#collapseExample1","aria-expanded","false","aria-controls","collapseExample1",1,"btn","btn-light","m-0"],["type","submit","name","button","data-bs-toggle","collapse","data-bs-target","#collapseExample1","aria-expanded","false","aria-controls","collapseExample1",1,"btn","bg-gradient-primary","m-0","ms-2",3,"click"],[1,"card"],[1,"accordion-1"],[1,"row"],[1,"col-md-10","mx-auto"],["id","accordionRental",1,"accordion"],[1,"accordion-item","mb-3",3,"click"],["id","headingOne",1,"accordion-header"],["type","button","data-bs-toggle","collapse","aria-expanded","false","aria-controls","collapseOne",1,"accordion-button","border-bottom","font-weight-bold","collapsed","botao-sanfona"],[1,"mb-0","text-xs"],[1,"text-xs","text-secondary","mb-0"],["aria-hidden","true",1,"collapse-close","fa","fa-plus","text-xs","pt-1","position-absolute","end-0","me-3"],["aria-hidden","true",1,"collapse-open","fa","fa-minus","text-xs","pt-1","position-absolute","end-0","me-3"],["aria-labelledby","headingOne","data-bs-parent","#accordionRental",1,"accordion-collapse","collapse",3,"id"],[1,"accordion-body","text-sm","opacity-8"],["type","button","name","button","data-bs-toggle","collapse","aria-expanded","false","aria-controls","collapseOne",1,"btn","btn-light","m-0",3,"click"],["type","submit","name","button","data-bs-toggle","collapse","aria-expanded","false","aria-controls","collapseOne",1,"btn","bg-gradient-primary","m-0","ms-2",3,"click"]],template:function(r,s){r&1&&(_(0,"div",0)(1,"nav",1)(2,"div",2)(3,"a",3),$(4,"i",4),b(),_(5,"a",5),F(6," Controle financeiro "),b(),_(7,"a",5),$(8,"span",6),b()()(),_(9,"p",7)(10,"button",8),Z("click",function(){return s.chamarColapso(-1,!1)}),F(11," Novo Projeto "),b()(),_(12,"div",9)(13,"div",10)(14,"label",11),F(15,"Nomo do projeto"),b(),_(16,"input",12),En("ngModelChange",function(o){return Cn(s.novoProjeto,o)||(s.novoProjeto=o),o}),b(),_(17,"label",11),F(18,"Saldo inicial"),b(),_(19,"input",13),En("ngModelChange",function(o){return Cn(s.saldoInicialProjeto,o)||(s.saldoInicialProjeto=o),o}),b(),_(20,"div",14)(21,"button",15),F(22,"Cancelar"),b(),_(23,"button",16),Z("click",function(){return s.criarProjeto()}),F(24,"Salvar"),b()()()(),_(25,"div",17)(26,"div",18)(27,"div",2),si(28,xK,25,8,"div",19,Mc),b()()()()),r&2&&(w(3),H("routerLink",Gn(3,SK)),w(13),wn("ngModel",s.novoProjeto),w(3),wn("ngModel",s.saldoInicialProjeto),w(9),ai(s.listaProjetos))},dependencies:[os,ss,zh,as,rl,Ta,is],styles:[".botao-sanfona[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:baseline}"]});let t=e;return t})();var Ra=(()=>{let e=class e{constructor(){}consultarCategoriRendaLocalStorage(){return!!localStorage.getItem("categoriasRenda")}consultarCategoriDespesaLocalStorage(){return!!localStorage.getItem("categoriasDespesa")}buscarCategoriasRenda(){if(localStorage.getItem("categoriasRenda")){let n=JSON.parse(localStorage.getItem("categoriasRenda"));return this.categoriasRenda=n,this.categoriasRenda}else{let n=["Salario","Comiss\xE3o","Vendas"];return this.categoriasRenda=n,localStorage.setItem("categoriasRenda",JSON.stringify(this.categoriasRenda)),n}}buscarCategoriasDespesa(){if(localStorage.getItem("categoriasDespesa")){let n=JSON.parse(localStorage.getItem("categoriasDespesa"));return this.categoriasDespesa=n,this.categoriasDespesa}else{let n=["Mercado","Restaurante","Contas"];return this.categoriasDespesa=n,localStorage.setItem("categoriasDespesa",JSON.stringify(this.categoriasDespesa)),n}}editarCategorias(n,r,s){if(n==="renda"){let a=this.categoriasRenda.findIndex(o=>o===r);this.categoriasRenda[a]=s,localStorage.setItem("categoriasRenda",JSON.stringify(this.categoriasRenda))}else{let a=this.categoriasDespesa.findIndex(o=>o===r);this.categoriasDespesa[a]=s,localStorage.setItem("categoriasDespesa",JSON.stringify(this.categoriasDespesa))}}adicionarCategoria(n,r){n==="renda"?(this.categoriasRenda.push(r),localStorage.setItem("categoriasRenda",JSON.stringify(this.categoriasRenda))):(this.categoriasDespesa.push(r),localStorage.setItem("categoriasDespesa",JSON.stringify(this.categoriasDespesa)))}excluirCategoria(n,r){if(n==="renda"){let s=this.categoriasRenda.findIndex(a=>a===r);this.categoriasRenda.splice(s,1),localStorage.setItem("categoriasRenda",JSON.stringify(this.categoriasRenda))}else{let s=this.categoriasDespesa.findIndex(a=>a===r);this.categoriasDespesa.splice(s,1),localStorage.setItem("categoriasDespesa",JSON.stringify(this.categoriasDespesa))}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var TK="firebase",IK="10.10.0";sn(TK,IK,"app");var rr=new og("ANGULARFIRE2_VERSION");var DK=(t,e)=>{let i=e?[e]:bg(),n=[];return i.forEach(r=>{r.container.getProvider(t).instances.forEach(a=>{n.includes(a)||n.push(a)})}),n},Ys=class{constructor(){return DK(kK)}},kK="app-check";function GC(){}var i_=class{zone;delegate;constructor(e,i=iM){this.zone=e,this.delegate=i}now(){return this.delegate.now()}schedule(e,i,n){let r=this.zone,s=function(a){r.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,i,n)}},KC=class{zone;task=null;constructor(e){this.zone=e}call(e,i){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",GC,{},GC,GC)),i.pipe(Xr({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ll=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(i){this.ngZone=i,this.outsideAngular=i.runOutsideAngular(()=>new i_(Zone.current)),this.insideAngular=i.run(()=>new i_(Zone.current,Cc)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||t)(C(re))};static \u0275prov=ee({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function AK(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Yt(t){return RK(AK())(t)}function RK(t){return function(i){return i=i.lift(new KC(t.ngZone)),i.pipe(Ec(t.outsideAngular),Wo(t.insideAngular))}}var n_=class{constructor(e){return e}},YC=class{constructor(){return bg()}};function MK(t){return t&&t.length===1?t[0]:new n_(yh())}var eP=new K("angularfire2._apps"),OK={provide:n_,useFactory:MK,deps:[[new Zr,eP]]},NK={provide:YC,deps:[[new Zr,eP]]};var tP=(()=>{class t{constructor(i){sn("angularfire",rr.full,"core"),sn("angularfire",rr.full,"app"),sn("angular",lg.full,i.toString())}static \u0275fac=function(n){return new(n||t)(C(nn))};static \u0275mod=X({type:t});static \u0275inj=Q({providers:[OK,NK]})}return t})();var PK=new Map,FK={activated:!1,tokenObservers:[]},LK={initialized:!1,enabled:!1};function Ar(t){return PK.get(t)||Object.assign({},FK)}function oP(){return LK}var BK="https://content-firebaseappcheck.googleapis.com/v1";var VK="exchangeDebugToken",iP={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Iwe=24*60*60*1e3;var XC=class{constructor(e,i,n,r,s){if(this.operation=e,this.retryPolicy=i,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return y(this,null,function*(){this.stop();try{this.pending=new wi,this.pending.promise.catch(i=>{}),yield jK(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new wi,this.pending.promise.catch(i=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(i){this.retryPolicy(i)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let i=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),i}}};function jK(t){return new Promise(e=>{setTimeout(e,t)})}var zK={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Ma=new LM("appCheck","AppCheck",zK);function lP(t){if(!Ar(t).activated)throw Ma.create("use-before-activation",{appName:t.name})}function cP(n,r){return y(this,arguments,function*({url:t,body:e},i){let s={"Content-Type":"application/json"},a=i.getImmediate({optional:!0});if(a){let f=yield a.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let o={method:"POST",body:JSON.stringify(e),headers:s},l;try{l=yield fetch(t,o)}catch(f){throw Ma.create("fetch-network-error",{originalErrorMessage:f?.message})}if(l.status!==200)throw Ma.create("fetch-status-error",{httpStatus:l.status});let c;try{c=yield l.json()}catch(f){throw Ma.create("fetch-parse-error",{originalErrorMessage:f?.message})}let d=c.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw Ma.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let u=Number(d[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+u,issuedAtTimeMillis:h}})}function dP(t,e){let{projectId:i,appId:n,apiKey:r}=t.options;return{url:`${BK}/projects/${i}/apps/${n}:${VK}?key=${r}`,body:{debug_token:e}}}var UK="firebase-app-check-database",qK=1,ZC="firebase-app-check-store";var r_=null;function HK(){return r_||(r_=new Promise((t,e)=>{try{let i=indexedDB.open(UK,qK);i.onsuccess=n=>{t(n.target.result)},i.onerror=n=>{var r;e(Ma.create("storage-open",{originalErrorMessage:(r=n.target.error)===null||r===void 0?void 0:r.message}))},i.onupgradeneeded=n=>{let r=n.target.result;switch(n.oldVersion){case 0:r.createObjectStore(ZC,{keyPath:"compositeKey"})}}}catch(i){e(Ma.create("storage-open",{originalErrorMessage:i?.message}))}}),r_)}function WK(t,e){return GK(KK(t),e)}function GK(t,e){return y(this,null,function*(){let n=(yield HK()).transaction(ZC,"readwrite"),s=n.objectStore(ZC).put({compositeKey:t,value:e});return new Promise((a,o)=>{s.onsuccess=l=>{a()},n.onerror=l=>{var c;o(Ma.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})})}function KK(t){return`${t.options.appId}-${t.name}`}var JC=new Ca("@firebase/app-check");function QC(t,e){return fg()?WK(t,e).catch(i=>{JC.warn(`Failed to write token to IndexedDB. Error: ${i}`)}):Promise.resolve()}function uP(){return oP().enabled}function hP(){return y(this,null,function*(){let t=oP();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var $K={error:"UNKNOWN_ERROR"};function YK(t){return ug.encodeString(JSON.stringify(t),!1)}function eE(t,e=!1){return y(this,null,function*(){let i=t.app;lP(i);let n=Ar(i),r=n.token,s;if(r&&!Xh(r)&&(n.token=void 0,r=void 0),!r){let l=yield n.cachedTokenPromise;l&&(Xh(l)?r=l:yield QC(i,void 0))}if(!e&&r&&Xh(r))return{token:r.token};let a=!1;if(uP()){n.exchangeTokenPromise||(n.exchangeTokenPromise=cP(dP(i,yield hP()),t.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),a=!0);let l=yield n.exchangeTokenPromise;return yield QC(i,l),n.token=l,{token:l.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),a=!0),r=yield Ar(i).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?JC.warn(l.message):JC.error(l),s=l}let o;return r?s?Xh(r)?o={token:r.token,internalError:s}:o=rP(s):(o={token:r.token},n.token=r,yield QC(i,r)):o=rP(s),a&&JK(i,o),o})}function QK(t){return y(this,null,function*(){let e=t.app;lP(e);let{provider:i}=Ar(e);if(uP()){let n=yield hP(),{token:r}=yield cP(dP(e,n),t.heartbeatServiceProvider);return{token:r}}else{let{token:n}=yield i.getToken();return{token:n}}})}function XK(t,e,i,n){let{app:r}=t,s=Ar(r),a={next:i,error:n,type:e};if(s.tokenObservers=[...s.tokenObservers,a],s.token&&Xh(s.token)){let o=s.token;Promise.resolve().then(()=>{i({token:o.token}),nP(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>nP(t))}function fP(t,e){let i=Ar(t),n=i.tokenObservers.filter(r=>r.next!==e);n.length===0&&i.tokenRefresher&&i.tokenRefresher.isRunning()&&i.tokenRefresher.stop(),i.tokenObservers=n}function nP(t){let{app:e}=t,i=Ar(e),n=i.tokenRefresher;n||(n=ZK(t),i.tokenRefresher=n),!n.isRunning()&&i.isTokenAutoRefreshEnabled&&n.start()}function ZK(t){let{app:e}=t;return new XC(()=>y(this,null,function*(){let i=Ar(e),n;if(i.token?n=yield eE(t,!0):n=yield eE(t),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{let i=Ar(e);if(i.token){let n=i.token.issuedAtTimeMillis+(i.token.expireTimeMillis-i.token.issuedAtTimeMillis)*.5+3e5,r=i.token.expireTimeMillis-5*60*1e3;return n=Math.min(n,r),Math.max(0,n-Date.now())}else return 0},iP.RETRIAL_MIN_WAIT,iP.RETRIAL_MAX_WAIT)}function JK(t,e){let i=Ar(t).tokenObservers;for(let n of i)try{n.type==="EXTERNAL"&&e.error!=null?n.error(e.error):n.next(e)}catch{}}function Xh(t){return t.expireTimeMillis-Date.now()>0}function rP(t){return{token:YK($K),error:t}}var tE=class{constructor(e,i){this.app=e,this.heartbeatServiceProvider=i}_delete(){let{tokenObservers:e}=Ar(this.app);for(let i of e)fP(this.app,i.next);return Promise.resolve()}};function e$(t,e){return new tE(t,e)}function t$(t){return{getToken:e=>eE(t,e),getLimitedUseToken:()=>QK(t),addTokenListener:e=>XK(t,"INTERNAL",e),removeTokenListener:e=>fP(t.app,e)}}var i$="@firebase/app-check",n$="0.8.3";var r$="app-check",sP="app-check-internal";function s$(){Xo(new Rn(r$,t=>{let e=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat");return e$(e,i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,i)=>{t.getProvider(sP).initialize()})),Xo(new Rn(sP,t=>{let e=t.getProvider("app-check").getImmediate();return t$(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),sn(i$,n$)}s$();var a$=["localhost","0.0.0.0","127.0.0.1"],Vwe=typeof window<"u"&&a$.includes(window.location.hostname);var o$="firebase",l$="10.10.0";vi.registerVersion(o$,l$,"app-compat");var c$=["ngOnDestroy"],pP=(t,e,i,n={})=>new Proxy(t,{get:(r,s)=>i.runOutsideAngular(()=>{if(t[s])return n?.spy?.get&&n.spy.get(s,t[s]),t[s];if(c$.indexOf(s)>-1)return()=>{};let a=e.toPromise().then(o=>{let l=o?.[s];return typeof l=="function"?l.bind(o):l?.then?l.then(c=>i.run(()=>c)):i.run(()=>l)});return new Proxy(()=>{},{get:(o,l)=>a[l],apply:(o,l,c)=>a.then(d=>{let u=d?.(...c);return n?.spy?.apply&&n.spy.apply(s,c,u),u})})})});var s_=class{constructor(e){return e}},Oa=new K("angularfire2.app.options"),Na=new K("angularfire2.app.name");function cl(t,e,i){let n=typeof i=="string"&&i||"[DEFAULT]",r=typeof i=="object"&&i||{};r.name=r.name||n;let a=vi.apps.filter(o=>o&&o.name===r.name)[0]||e.runOutsideAngular(()=>vi.initializeApp(t,r));try{if(JSON.stringify(t)!==JSON.stringify(a.options)){let o=!!module.hot;d$("error",`${a.name} Firebase App already initialized with different options${o?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new s_(a)}var d$=(t,...e)=>{Oc()&&typeof console<"u"&&console[t](...e)},u$={provide:s_,useFactory:cl,deps:[Oa,re,[new Zr,Na]]},a_=(()=>{class t{static initializeApp(i,n){return{ngModule:t,providers:[{provide:Oa,useValue:i},{provide:Na,useValue:n}]}}constructor(i){vi.registerVersion("angularfire",rr.full,"core"),vi.registerVersion("angularfire",rr.full,"app-compat"),vi.registerVersion("angular",lg.full,i.toString())}static \u0275fac=function(n){return new(n||t)(C(nn))};static \u0275mod=X({type:t});static \u0275inj=Q({providers:[u$]})}return t})();function Jc(t,e,i,n,r){let[,s,a]=globalThis.\u0275AngularfireInstanceCache.find(o=>o[0]===t)||[];if(s)return h$(r,a)||(mP("error",`${e} was already initialized on the ${i} Firebase App with different settings.${f$?" You may need to reload as Firebase is not HMR aware.":""}`),mP("warn",{is:r,was:a})),s;{let o=n();return globalThis.\u0275AngularfireInstanceCache.push([t,o,r]),o}}function h$(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var f$=typeof module<"u"&&!!module.hot,mP=(t,...e)=>{Oc()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Zh=new K("angularfire2.auth.use-emulator"),Jh=new K("angularfire2.auth.settings"),ef=new K("angularfire2.auth.tenant-id"),tf=new K("angularfire2.auth.langugage-code"),nf=new K("angularfire2.auth.use-device-language"),rf=new K("angularfire.auth.persistence"),sf=(t,e,i,n,r,s,a,o)=>Jc(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let l=e.runOutsideAngular(()=>t.auth());if(i&&l.useEmulator(...i),n&&(l.tenantId=n),l.languageCode=r,s&&l.useDeviceLanguage(),a)for(let[c,d]of Object.entries(a))l.settings[c]=d;return o&&l.setPersistence(o),l},[i,n,r,s,a,o]),dl=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(i,n,r,s,a,o,l,c,d,u,h,f){let p=new be,v=et(void 0).pipe(Wo(a.outsideAngular),pi(()=>s.runOutsideAngular(()=>import("./chunk-T2EFLLJT.mjs"))),Ie(()=>cl(i,s,n)),Ie(E=>sf(E,s,o,c,d,u,l,h)),Tc({bufferSize:1,refCount:!1}));if(dg(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=et(null);else{v.pipe(cM()).subscribe();let E=v.pipe(pi(P=>P.getRedirectResult().then(L=>L,()=>null)),Yt,Tc({bufferSize:1,refCount:!1})),k=v.pipe(pi(P=>new ni(L=>({unsubscribe:s.runOutsideAngular(()=>P.onAuthStateChanged(te=>L.next(te),te=>L.error(te),()=>L.complete()))})))),I=v.pipe(pi(P=>new ni(L=>({unsubscribe:s.runOutsideAngular(()=>P.onIdTokenChanged(te=>L.next(te),te=>L.error(te),()=>L.complete()))}))));this.authState=E.pipe(_w(k),Ec(a.outsideAngular),Wo(a.insideAngular)),this.user=E.pipe(_w(I),Ec(a.outsideAngular),Wo(a.insideAngular)),this.idToken=this.user.pipe(pi(P=>P?Yr(P.getIdToken()):et(null))),this.idTokenResult=this.user.pipe(pi(P=>P?Yr(P.getIdTokenResult()):et(null))),this.credential=fi(E,p,this.authState.pipe(zt(P=>!P))).pipe(Ie(P=>P?.user?P:null),Ec(a.outsideAngular),Wo(a.insideAngular))}return pP(this,v,s,{spy:{apply:(E,k,I)=>{(E.startsWith("signIn")||E.startsWith("createUser"))&&I.then(P=>p.next(P))}}})}static \u0275fac=function(n){return new(n||t)(C(Oa),C(Na,8),C(nn),C(re),C(ll),C(Zh,8),C(Jh,8),C(ef,8),C(tf,8),C(nf,8),C(rf,8),C(Ys,8))};static \u0275prov=ee({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),o_=(()=>{class t{constructor(){vi.registerVersion("angularfire",rr.full,"auth-compat")}static \u0275fac=function(n){return new(n||t)};static \u0275mod=X({type:t});static \u0275inj=Q({providers:[dl]})}return t})();var l_=(()=>{let e=class e{constructor(n,r){this.auth=n,this.router=r,this.userSubject=new lh(null)}login(n,r){return y(this,null,function*(){try{let s=yield this.auth.signInWithEmailAndPassword(n,r);return this.user=s.user.multiFactor,this.setUserSubject(this.user),this.router.navigate(["/"]),s.user.multiFactor}catch(s){return this.erro=s,s}})}setUserSubject(n){sessionStorage.setItem("user",btoa(JSON.stringify(n.user.email))),sessionStorage.setItem("token",btoa(JSON.stringify(n.user.accessToken))),this.userSubject.next(n)}};e.\u0275fac=function(r){return new(r||e)(C(dl),C(RM))},e.\u0275prov=ee({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var m$=()=>["adicionar-despesa"],p$=()=>["adicionar-renda"];function g$(t,e){if(t&1&&(_(0,"option",7),F(1),b()),t&2){let i=e.$implicit;H("value",i),w(),it(i)}}function _$(t,e){if(t&1&&(_(0,"li",20)(1,"div",24)(2,"div",25)(3,"a",26),$(4,"i",27),b(),_(5,"span",28),F(6),b(),_(7,"span",29),F(8),b()(),_(9,"div")(10,"div",30),$(11,"div",31),b()()()()),t&2){let i=e.$implicit,n=j();w(6),it(i.categoria),w(2),yn("",(i.valor/n.despesa*100).toFixed(2),"%"),w(3),xr("width",i.valor/n.despesa*100,"%"),H("ngClass","w-"+i.valor/n.despesa*100)}}var c_=(()=>{let e=class e{constructor(n,r,s){this.createPojectService=n,this.categoriasService=r,this.authService=s,this.despesaRenda="Despesa",this.detalhesPorCategoria=[],this.teste=100,this.corBotao=!0}ngOnInit(){this.carregarProjetos(this.createPojectService.consultarProjetosLocalStorage()),this.primeirosOptions=(localStorage.getItem("projetosSelect")?.slice(2,-2)).split('","'),this.opcaoSelecionada=this.createPojectService.buscarUltimoProjetoSelecionado(),this.listaCategorias=this.categoriasService.buscarCategoriasRenda(),this.mostrarResultados()}carregarProjetos(n){n===!1?this.listaProjetos=this.createPojectService.criarProjetosDefault():this.listaProjetos=this.createPojectService.recuperarProjetos()}salvarProjetoSelecionado(){localStorage.setItem("ultimoProjeto",this.opcaoSelecionada),this.mostrarResultados()}mostrarResultados(){let n=this.listaProjetos.find(r=>r.nome==this.opcaoSelecionada);this.saldoInicial=n.mostrarSaldoinicial(),this.renda=n.mostrarTotalRenda(),this.despesa=n.mostrarTotalDespesa(),this.saldoFinal=n.calcularSaldoAtual(),this.mostrarValoresPorCategoria("renda")}mostrarValoresPorCategoria(n){let r=this.listaProjetos.find(a=>a.nome==this.opcaoSelecionada),s=[];if(n==="renda"){this.corBotao=!0;let a=r.renda.reduce((o,l)=>{let{categoria:c,valor:d}=l;return o[c]||(o[c]={categoria:c,valor:0}),o[c].valor+=d,o},{});for(let o in a)s.push(a[o])}else{this.corBotao=!1;let a=r.despesa.reduce((o,l)=>{let{categoria:c,valor:d}=l;return o[c]||(o[c]={categoria:c,valor:0}),o[c].valor+=d,o},{});for(let o in a)s.push(a[o])}this.detalhesPorCategoria=s}};e.\u0275fac=function(r){return new(r||e)(g(Aa),g(Ra),g(l_))},e.\u0275cmp=ne({type:e,selectors:[["app-home"]],standalone:!0,features:[se],decls:54,vars:13,consts:[[1,"g-sidenav-show","bg-gray-100"],[1,"main-content","position-relative","border-radius-lg"],[1,"card","card-body","mt-4"],[1,"row","mt-4"],[1,"form-group"],["for","example-search-input",1,"form-control-label"],[1,"form-control",3,"ngModelChange","change","ngModel"],[3,"value"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseExample","aria-expanded","false","aria-controls","collapseExample",1,"btn","btn-primary",2,"height","3rem"],["id","collapseExample",1,"collapse"],[1,"row"],[1,"col-6"],["type","button","name","button",1,"btn","bg-gradient-primary","col-12",3,"routerLink"],["type","button","name","button",1,"btn","btn-light","col-12",3,"routerLink"],[1,"nav","nav-justified",2,"margin-bottom","1.5rem","background-color","#f7f9fa","border-radius","1rem","padding",".25rem"],[1,"nav-item"],[1,"nav-link","active",3,"click"],[1,"nav-link",3,"click"],["id","myTabContent",1,"tab-content"],[1,"list-group"],[1,"list-group-item","border-0","d-flex","align-items-center","px-0","mb-2"],[1,"divmaeresultado"],[1,"divResultadoTitulos"],[1,"divResultadoValor"],[1,"w-100"],[1,"d-flex","align-items-center","mb-2"],["href","javascript:;",1,"btn","btn-slack","btn-simple","mb-0","p-0"],["aria-hidden","true",1,"fab","fa-slack","fa-lg"],[1,"me-2","text-sm","font-weight-bold","text-capitalize","ms-2"],[1,"ms-auto","text-sm","font-weight-bold"],[1,"progress","progress-md"],["role","progressbar","aria-valuenow","15","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-gradient-dark",3,"ngClass"]],template:function(r,s){r&1&&(_(0,"body",0)(1,"main",1),$(2,"app-header"),_(3,"div",2)(4,"div",3)(5,"div",4)(6,"label",5),F(7,"\xA0"),b(),_(8,"select",6),En("ngModelChange",function(o){return Cn(s.opcaoSelecionada,o)||(s.opcaoSelecionada=o),o}),Z("change",function(){return s.salvarProjetoSelecionado()}),si(9,g$,2,2,"option",7,rn),b()()(),_(11,"p",3)(12,"button",8),F(13," Adicionar Tranca\xE7\xE3o "),b()(),_(14,"div",9)(15,"div",10)(16,"div",11)(17,"button",12),F(18,"Despesa"),b()(),_(19,"div",11)(20,"button",13),F(21,"Renda"),b()()()()(),_(22,"div",2)(23,"ul",14)(24,"li",15)(25,"a",16),Z("click",function(){return s.mostrarValoresPorCategoria("renda")}),F(26," Renda "),b()(),_(27,"li",15)(28,"a",17),Z("click",function(){return s.mostrarValoresPorCategoria("despesa")}),F(29," Despesa "),b()()(),_(30,"div",18)(31,"ul",19),si(32,_$,12,5,"li",20,Mc),b()()(),_(34,"div",2)(35,"div",21)(36,"div",22)(37,"div"),F(38,"Saldo inicial:"),b(),_(39,"div"),F(40,"Renda:"),b(),_(41,"div"),F(42,"Despesa:"),b(),_(43,"div"),F(44,"Saldo final:"),b()(),_(45,"div",23)(46,"div"),F(47),b(),_(48,"div"),F(49),b(),_(50,"div"),F(51),b(),_(52,"div"),F(53),b()()()()()()),r&2&&(w(8),wn("ngModel",s.opcaoSelecionada),w(),ai(s.primeirosOptions),w(8),H("routerLink",Gn(11,m$)),w(3),H("routerLink",Gn(12,p$)),w(5),ce("corBotao",s.corBotao),w(3),ce("corBotao",!s.corBotao),w(4),ai(s.detalhesPorCategoria),w(15),it(s.saldoInicial),w(2),it(s.renda),w(2),it(s.despesa),w(2),it(s.saldoFinal))},dependencies:[ol,is,os,Hg,Wg,Hc,as,rl,XN,Kn,ya],styles:["body[_ngcontent-%COMP%]{background-color:#82928d;margin:auto;border-radius:.5rem;height:92vh}.divmaeresultado[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;width:90%}.divResultadoTitulos[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:end;width:47%}.divResultadoValor[_ngcontent-%COMP%]{display:flex;flex-direction:column}.corBotao[_ngcontent-%COMP%]{background-color:#fff;color:#000;border-radius:1rem}"]});let t=e;return t})();var b$=()=>["editar-projetos"],v$=()=>["editar-cateforias"],_P=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=ne({type:e,selectors:[["app-configuracoes"]],standalone:!0,features:[se],decls:21,vars:4,consts:[[1,"col-lg-9","col-12","mx-auto"],[1,"card","card-body","mt-4"],[1,"table-responsive"],[1,"table","align-items-center","mb-0"],[1,"d-flex","px-2",3,"routerLink"],[1,"my-auto"],[1,"mb-0","text-xs"]],template:function(r,s){r&1&&(_(0,"body",0)(1,"div",1)(2,"div",2)(3,"table",3)(4,"tbody")(5,"tr")(6,"td")(7,"div")(8,"a",4),$(9,"div"),_(10,"div",5)(11,"h2",6),F(12,"Editar Projetos"),b()()()()()(),_(13,"tr")(14,"td")(15,"div")(16,"a",4),$(17,"div"),_(18,"div",5)(19,"h2",6),F(20,"Editar Categorias"),b()()()()()()()()()()()),r&2&&(w(8),H("routerLink",Gn(2,b$)),w(8),H("routerLink",Gn(3,v$)))},dependencies:[is],styles:["body[_ngcontent-%COMP%]{margin:auto;border-radius:.5rem;height:92vh}"]});let t=e;return t})();var bP=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=ne({type:e,selectors:[["app-main"]],standalone:!0,features:[se],decls:7,vars:0,consts:[["headerPosition","below"],["label","Home"],["label","Relat\xF3rios"],["label","Op\xE7\xF5es"]],template:function(r,s){r&1&&(_(0,"mat-tab-group",0)(1,"mat-tab",1),$(2,"app-home"),b(),_(3,"mat-tab",2),$(4,"app-home"),b(),_(5,"mat-tab",3),$(6,"app-configuracoes"),b()())},dependencies:[ol,IC,RN,c_,_P],styles:["mat-tab-group[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;z-index:999}"]});let t=e;return t})();var y$=()=>[""];function w$(t,e){if(t&1&&(_(0,"option",8),F(1),b()),t&2){let i=e.$implicit;H("value",i),w(),it(i)}}var d_=(()=>{let e=class e{constructor(n){this.formBuilder=n,this.dadosEnviados=new ae,this.titulo="",this.categorias=[]}ngOnInit(){this.transacoes=this.formBuilder.group({valor:["",[er.required]],categoria:["",[er.required]],descricao:["",[er.required]],data:[this.obterDataAtualFormatada(),[er.required]],hora:[this.obterHoraAtual(),[er.required]]})}obterHoraAtual(){let n=new Date,r=n.getHours(),s=n.getMinutes();return`${r}:${s}`}obterDataAtualFormatada(){let n=new Date,r=n.getFullYear(),s=this.formatarData(n.getMonth()+1),a=this.formatarData(n.getDate());return`${r}-${s}-${a}`}formatarData(n){return n<10?`0${n}`:`${n}`}subimtForm(){console.log(this.transacoes.value),this.dadosEnviados.emit(this.transacoes.value),this.transacoes.patchValue({valor:"",descricao:""})}};e.\u0275fac=function(r){return new(r||e)(g(Wc))},e.\u0275cmp=ne({type:e,selectors:[["app-transacao"]],inputs:{titulo:"titulo",categorias:"categorias"},outputs:{dadosEnviados:"dadosEnviados"},standalone:!0,features:[se],decls:27,vars:4,consts:[[1,"col-lg-9","col-12","mx-auto"],[1,"card","card-body","mt-4",3,"ngSubmit","formGroup"],[1,"mb-0"],[1,"horizontal","dark","my-3"],["type","number","id","projectName","onfocus","focused(this)","onfocusout","defocused(this)","formControlName","valor",1,"form-control"],[1,"form-group"],["for","example-search-input",1,"form-control-label"],["formControlName","categoria",1,"form-control"],[3,"value"],["type","text","id","projectName","onfocus","focused(this)","onfocusout","defocused(this)","formControlName","descricao",1,"form-control"],[1,"row"],[1,"col-6"],[1,"form-label"],["type","date","placeholder","Please select start date","data-input","","onfocus","focused(this)","onfocusout","defocused(this)","formControlName","data",1,"form-control","datetimepicker","flatpickr-input"],["type","time","placeholder","Please select end date","data-input","","onfocus","focused(this)","onfocusout","defocused(this)","formControlName","hora",1,"form-control","datetimepicker","flatpickr-input"],[1,"d-flex","justify-content-end","mt-4"],["type","button","name","button",1,"btn","btn-light","m-0",3,"routerLink"],["type","submit","name","button",1,"btn","bg-gradient-primary","m-0","ms-2"]],template:function(r,s){r&1&&(_(0,"div",0)(1,"form",1),Z("ngSubmit",function(){return s.subimtForm()}),_(2,"h1",2),F(3),b(),$(4,"hr",3)(5,"input",4),_(6,"div",5)(7,"label",6),F(8,"\xA0"),b(),_(9,"select",7),si(10,w$,2,2,"option",8,rn),b()(),$(12,"input",9),_(13,"div",10)(14,"div",11)(15,"label",12),F(16,"Data"),b(),$(17,"input",13),b(),_(18,"div",11)(19,"label",12),F(20,"Hora"),b(),$(21,"input",14),b()(),_(22,"div",15)(23,"button",16),F(24,"Cancelar"),b(),_(25,"button",17),F(26,"Salvar"),b()()()()),r&2&&(w(),H("formGroup",s.transacoes),w(2),it(s.titulo),w(7),ai(s.categorias),w(13),H("routerLink",Gn(3,y$)))},dependencies:[os,qg,Hg,Wg,ss,zh,Hc,as,Vg,Ta,Uh,qh,is]});let t=e;return t})();var rE=(()=>{let e=class e{constructor(n,r){this.projetosService=n,this.categorias=r,this.tituloHeader="Adicionar despesa"}ngOnInit(){this.ultimoProjeto=this.projetosService.buscarUltimoProjetoSelecionado(),this.listaProjetos=this.projetosService.recuperarProjetos(),this.listaCategorias=this.categorias.buscarCategoriasDespesa()}receberDados(n){this.listaProjetos.find(r=>r.nome==this.ultimoProjeto).adicionarDespesa(n),localStorage.setItem("projetos",JSON.stringify(this.listaProjetos))}};e.\u0275fac=function(r){return new(r||e)(g(Aa),g(Ra))},e.\u0275cmp=ne({type:e,selectors:[["app-adicionar-despesa"]],standalone:!0,features:[se],decls:1,vars:2,consts:[[3,"dadosEnviados","titulo","categorias"]],template:function(r,s){r&1&&(_(0,"app-transacao",0),Z("dadosEnviados",function(o){return s.receberDados(o)}),b()),r&2&&(sg("titulo",s.tituloHeader),H("categorias",s.listaCategorias))},dependencies:[d_]});let t=e;return t})();var vP=(()=>{let e=class e{constructor(n,r){this.projetoSevice=n,this.categorias=r,this.tituloHeader="Adicionar renda"}ngOnInit(){this.ultimoProjeto=this.projetoSevice.buscarUltimoProjetoSelecionado(),this.listaProjetos=this.projetoSevice.recuperarProjetos(),this.listaCategorias=this.categorias.buscarCategoriasRenda(),console.log(this.listaCategorias)}receberDados(n){this.listaProjetos.find(r=>r.nome==this.ultimoProjeto).adicionarRenda(n),localStorage.setItem("projetos",JSON.stringify(this.listaProjetos))}};e.\u0275fac=function(r){return new(r||e)(g(Aa),g(Ra))},e.\u0275cmp=ne({type:e,selectors:[["app-adicionar-renda"]],standalone:!0,features:[se],decls:1,vars:2,consts:[[3,"dadosEnviados","titulo","categorias"]],template:function(r,s){r&1&&(_(0,"app-transacao",0),Z("dadosEnviados",function(o){return s.receberDados(o)}),b()),r&2&&(sg("titulo",s.tituloHeader),H("categorias",s.listaCategorias))},dependencies:[d_]});let t=e;return t})();var C$=()=>["/"];function E$(t,e){if(t&1){let i=ft();_(0,"div",21)(1,"div",22)(2,"div",23)(3,"div",24)(4,"h5",25)(5,"button",26),F(6),$(7,"i",27)(8,"i",28),b()(),_(9,"div",29)(10,"div",30)(11,"label",15),F(12,"Nome da categoria"),b(),_(13,"input",16),En("ngModelChange",function(r){ve(i);let s=j();return Cn(s.inputCategoria,r)||(s.inputCategoria=r),ye(r)}),b(),_(14,"div",17)(15,"button",31),Z("click",function(){let r=ve(i).$implicit,s=j();return ye(s.excluirCategoria(r))}),F(16,"Excluir"),b(),_(17,"button",32),Z("click",function(){let r=ve(i).$implicit,s=j();return ye(s.editarCategoria(r))}),F(18,"Salvar"),b()()()()()()()()}if(t&2){let i=e.$implicit,n=e.$index,r=j();w(5),xe("data-bs-target","#collapseOne"+n),w(),yn(" ",i," "),w(3),H("id","collapseOne"+n),w(4),wn("ngModel",r.inputCategoria),w(2),xe("data-bs-target","#collapseOne"+n),w(2),xe("data-bs-target","#collapseOne"+n)}}var yP=(()=>{let e=class e{constructor(n){this.categoriasService=n,this.categoriasRenda=[],this.categoriasDespesa=[],this.listaCategorias=[],this.inputCategoria="",this.corBotao=!0}ngOnInit(){this.categoriasRenda=this.categoriasService.buscarCategoriasRenda(),this.categoriasDespesa=this.categoriasService.buscarCategoriasDespesa(),this.listaCategorias=this.categoriasRenda,this.rendaDespesa="renda",console.log(this.categoriasDespesa,this.categoriasRenda)}excluirCategoria(n){this.categoriasService.excluirCategoria(this.rendaDespesa,n)}editarCategoria(n){this.categoriasService.editarCategorias(this.rendaDespesa,n,this.inputCategoria),this.inputCategoria=""}criarCategoria(){this.categoriasService.adicionarCategoria(this.rendaDespesa,this.inputCategoria),this.inputCategoria=""}mudarRendaDespesa(n){this.rendaDespesa=n,n==="renda"?(this.listaCategorias=this.categoriasRenda,this.corBotao=!0):(this.listaCategorias=this.categoriasDespesa,this.corBotao=!1)}};e.\u0275fac=function(r){return new(r||e)(g(Ra))},e.\u0275cmp=ne({type:e,selectors:[["app-editar-categorias"]],standalone:!0,features:[se],decls:34,vars:7,consts:[[1,"col-lg-9","col-12","mx-auto"],[1,"navbar","navbar-expand-lg","navbar-light","bg-white","z-index-3","py-3"],[1,"container"],["rel","tooltip","title","Designed and Coded by Creative Tim","data-placement","bottom",1,"navbar-brand",3,"routerLink"],[1,"fas","fa-arrow-left"],["href","#","rel","tooltip","title","Designed and Coded by Creative Tim","data-placement","bottom",1,"navbar-brand"],[1,"example-spacer"],[1,"d-flex","justify-content-center","card","card-body","mt-4"],[1,"nav","nav-justified",2,"margin-bottom","1.5rem","background-color","#f7f9fa","border-radius","1rem","padding",".25rem"],[1,"nav-item"],[1,"nav-link","active",3,"click"],[1,"nav-link",3,"click"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseExample1","aria-expanded","false","aria-controls","collapseExample1",1,"btn","btn-primary"],["id","collapseExample1",1,"collapse"],[1,"card","card-body","mt-4"],[1,"form-label"],["type","text","id","nome-projeto","onfocus","focused(this)","onfocusout","defocused(this)",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-end","mt-4"],["type","button","name","button","data-bs-toggle","collapse","data-bs-target","#collapseExample1","aria-expanded","false","aria-controls","collapseExample1",1,"btn","btn-light","m-0"],["type","submit","name","button","data-bs-toggle","collapse","data-bs-target","#collapseExample1","aria-expanded","false","aria-controls","collapseExample1",1,"btn","bg-gradient-primary","m-0","ms-2",3,"click"],[1,"accordion-1"],[1,"row"],[1,"col-md-10","mx-auto"],["id","accordionRental",1,"accordion"],[1,"accordion-item","mb-3"],["id","headingOne",1,"accordion-header"],["type","button","data-bs-toggle","collapse","aria-expanded","false","aria-controls","collapseOne",1,"accordion-button","border-bottom","font-weight-bold","collapsed"],["aria-hidden","true",1,"collapse-close","fa","fa-plus","text-xs","pt-1","position-absolute","end-0","me-3"],["aria-hidden","true",1,"collapse-open","fa","fa-minus","text-xs","pt-1","position-absolute","end-0","me-3"],["aria-labelledby","headingOne","data-bs-parent","#accordionRental",1,"accordion-collapse","collapse",3,"id"],[1,"accordion-body","text-sm","opacity-8"],["type","button","name","button","data-bs-toggle","collapse","aria-expanded","false","aria-controls","collapseOne",1,"btn","btn-light","m-0",3,"click"],["type","submit","name","button","data-bs-toggle","collapse","aria-expanded","false","aria-controls","collapseOne",1,"btn","bg-gradient-primary","m-0","ms-2",3,"click"]],template:function(r,s){r&1&&(_(0,"div",0)(1,"nav",1)(2,"div",2)(3,"a",3),$(4,"i",4),b(),_(5,"a",5),F(6," Controle financeiro "),b(),_(7,"a",5),$(8,"span",6),b()()(),_(9,"div",7)(10,"ul",8)(11,"li",9)(12,"a",10),Z("click",function(){return s.mudarRendaDespesa("renda")}),F(13," Renda "),b()(),_(14,"li",9)(15,"a",11),Z("click",function(){return s.mudarRendaDespesa("despesa")}),F(16," Despesa "),b()()(),_(17,"button",12),F(18," Nova Categoria "),b()(),_(19,"div",13)(20,"div",14)(21,"label",15),F(22,"Nome da categoria"),b(),_(23,"input",16),En("ngModelChange",function(o){return Cn(s.inputCategoria,o)||(s.inputCategoria=o),o}),b(),_(24,"div",17)(25,"button",18),F(26,"Cancelar"),b(),_(27,"button",19),Z("click",function(){return s.criarCategoria()}),F(28,"Salvar"),b()()()(),_(29,"div",14)(30,"div",20)(31,"div",2),si(32,E$,19,6,"div",21,Mc),b()()()()),r&2&&(w(3),H("routerLink",Gn(6,C$)),w(9),ce("corBotao",s.corBotao),w(3),ce("corBotao",!s.corBotao),w(8),wn("ngModel",s.inputCategoria),w(9),ai(s.listaCategorias))},dependencies:[is,os,ss,as,rl,Ta],styles:[".corBotao[_ngcontent-%COMP%]{background-color:#fff;color:#000;border-radius:1rem}"]});let t=e;return t})();function S$(t,e){t&1&&(_(0,"span"),F(1," Entrar "),b())}function x$(t,e){t&1&&(_(0,"span"),$(1,"span",32),F(2," Loading... "),b())}var wP=(()=>{let e=class e{constructor(n,r){this.formBuilder=n,this.authService=r,this.initRequest=!1}ngOnInit(){this.inicializarFormulario()}inicializarFormulario(){this.loginUsuario=this.formBuilder.group({email:["",[er.required,er.email]],senha:["",[er.required]]})}submitForm(){this.initRequest=!0,this.authService.login(this.loginUsuario.value.email,this.loginUsuario.value.senha).then(n=>{console.log(n),this.initRequest=!1})}};e.\u0275fac=function(r){return new(r||e)(g(Wc),g(l_))},e.\u0275cmp=ne({type:e,selectors:[["app-login"]],standalone:!0,features:[se],decls:47,vars:4,consts:[["confirmacao","ngForm"],[1,"main-content","mt-0","ps"],[1,"page-header","align-items-start","min-vh-50","pt-7","pb-9","m-3","border-radius-lg",2,"background-image","url('./assets/img/finance.jpeg')"],[1,"mask","bg-gradient-dark","opacity-6"],[1,"container"],[1,"row","justify-content-center"],[1,"col-lg-5","text-center","mx-auto"],[1,"text-white","mb-2","mt-5"],[1,"text-lead","text-white"],[1,"row","mt-lg-n10","mt-md-n11","mt-n10","justify-content-center"],[1,"col-xl-4","col-lg-5","col-md-7","mx-auto"],[1,"card","mt-5"],[1,"card-header","pb-0","text-start"],[1,"font-weight-bolder"],[1,"mb-0"],[1,"card-body"],["role","form",1,"text-start",3,"ngSubmit","formGroup"],[1,"mb-3"],["type","text","placeholder","Email ou Matr\xEDcula","aria-label","Email ou Matr\xEDcula","formControlName","email",1,"form-control"],["type","password","placeholder","Senha","aria-label","Senha","formControlName","senha",1,"form-control"],[1,"form-check","form-switch"],["type","checkbox","id","rememberMe","checked","",1,"form-check-input"],["for","rememberMe",1,"form-check-label"],[1,"text-center"],["type","submit",1,"btn","btn-lg","btn-primary","btn-lg","w-100","mt-4","mb-0",3,"disabled"],[1,"card-footer","text-center","pt-0","px-lg-2","px-1"],[1,"mb-4","text-sm","mx-auto"],["href","javascript:;",1,"text-primary","font-weight-bold"],[1,"ps__rail-x",2,"left","0px","bottom","0px"],["tabindex","0",1,"ps__thumb-x",2,"left","0px","width","0px"],[1,"ps__rail-y",2,"top","0px","right","0px"],["tabindex","0",1,"ps__thumb-y",2,"top","0px","height","0px"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(r,s){if(r&1){let a=ft();_(0,"main",1)(1,"div",2),$(2,"span",3),_(3,"div",4)(4,"div",5)(5,"div",6)(6,"h1",7),F(7,"Bem-vindo!"),b(),_(8,"p",8),F(9,"Controle Financeiro."),b()()()()(),_(10,"div",4)(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12)(15,"h3",13),F(16,"Informa\xE7\xF5es de login"),b(),_(17,"p",14),F(18,"Informe suas credenciais para acessar."),b()(),_(19,"div",15)(20,"form",16,0),Z("ngSubmit",function(){return ve(a),ye(s.submitForm())}),_(22,"label"),F(23,"Email"),b(),_(24,"div",17),$(25,"input",18),b(),_(26,"label"),F(27,"Senha"),b(),_(28,"div",17),$(29,"input",19),b(),_(30,"div",20),$(31,"input",21),_(32,"label",22),F(33,"Lembrar-me"),b()(),_(34,"div",23)(35,"button",24),Se(36,S$,2,0,"span")(37,x$,3,0,"span"),b()()()(),_(38,"div",25)(39,"p",26),F(40," N\xE3o tem conta? "),_(41,"a",27),F(42,"Cadastre-se"),b()()()()()()(),_(43,"div",28),$(44,"div",29),b(),_(45,"div",30),$(46,"div",31),b()()}r&2&&(w(20),H("formGroup",s.loginUsuario),w(15),H("disabled",s.initRequest),w(),Pe(36,s.initRequest?-1:36),w(),Pe(37,s.initRequest?37:-1))},dependencies:[os,qg,ss,as,Vg,Ta,Uh,qh,tP,o_,a_]});let t=e;return t})();var CP=[{path:"login",component:wP},{path:"",component:bP,children:[{path:"",component:c_},{path:"",component:rE}]},{path:"adicionar-despesa",component:rE},{path:"adicionar-renda",component:vP},{path:"editar-cateforias",component:yP},{path:"editar-projetos",component:JN}];var T$="@",I$=(()=>{let e=class e{constructor(n,r,s,a,o){this.doc=n,this.delegate=r,this.zone=s,this.animationType=a,this.moduleImpl=o,this._rendererFactoryPromise=null,this.scheduler=Ne(gM,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-FVFFNLTY.mjs")).catch(r=>{throw new Dc(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:s})=>{this._engine=r(this.animationType,this.doc,this.scheduler);let a=new s(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(n,r){let s=this.delegate.createRenderer(n,r);if(s.\u0275type===0)return s;typeof s.throwOnSyntheticProps=="boolean"&&(s.throwOnSyntheticProps=!1);let a=new sE(s);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let l=o.createRenderer(n,r);a.use(l)}).catch(o=>{a.use(s)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};e.\u0275fac=function(r){Ac()},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let t=e;return t})(),sE=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let i of this.replay)i(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,i){return this.delegate.createElement(e,i)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,i){this.delegate.appendChild(e,i)}insertBefore(e,i,n,r){this.delegate.insertBefore(e,i,n,r)}removeChild(e,i,n){this.delegate.removeChild(e,i,n)}selectRootElement(e,i){return this.delegate.selectRootElement(e,i)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,i,n,r){this.delegate.setAttribute(e,i,n,r)}removeAttribute(e,i,n){this.delegate.removeAttribute(e,i,n)}addClass(e,i){this.delegate.addClass(e,i)}removeClass(e,i){this.delegate.removeClass(e,i)}setStyle(e,i,n,r){this.delegate.setStyle(e,i,n,r)}removeStyle(e,i,n){this.delegate.removeStyle(e,i,n)}setProperty(e,i,n){this.shouldReplay(i)&&this.replay.push(r=>r.setProperty(e,i,n)),this.delegate.setProperty(e,i,n)}setValue(e,i){this.delegate.setValue(e,i)}listen(e,i,n){return this.shouldReplay(i)&&this.replay.push(r=>r.listen(e,i,n)),this.delegate.listen(e,i,n)}shouldReplay(e){return this.replay!==null&&e.startsWith(T$)}};function aE(t="animations"){return bM("NgAsyncAnimations"),ig([{provide:_M,useFactory:(e,i,n)=>new I$(e,i,n,t),deps:[He,xM,re]},{provide:qi,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var EP={firebaseConfig:{apiKey:"AIzaSyBCd4iTj0n0BU93lqZDPuEHMh8mWgkEGRw",authDomain:"gestao-financeira-36985.firebaseapp.com",projectId:"gestao-financeira-36985",storageBucket:"gestao-financeira-36985.appspot.com",messagingSenderId:"1032977955413",appId:"1:1032977955413:web:aa43ef115ec71e576872dc",measurementId:"G-NVL2HJXQ8B"}};var LL=fw(rL(),1);var D_="5",BL="v",VL="s",jL="r",zL="f",UL=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,qL="ls",HL="p",$E="ac",WL="websocket",GL="long_polling";var YE=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,i){i==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),oi(i))}get(e){let i=this.domStorage_.getItem(this.prefixedName_(e));return i==null?null:mg(i)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var QE=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,i){i==null?delete this.cache_[e]:this.cache_[e]=i}get(e){return Yn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var KL=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new YE(e)}}catch{}return new QE},yl=KL("localStorage"),XE=KL("sessionStorage");var od=new Ca("@firebase/database"),$L=function(){let t=1;return function(){return t++}}(),YL=function(t){let e=UM(t),i=new zM;i.update(e);let n=i.digest();return ug.encodeByteArray(n)},jf=function(...t){let e="";for(let i=0;i<t.length;i++){let n=t[i];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?e+=jf.apply(null,n):typeof n=="object"?e+=oi(n):e+=n,e+=" "}return e},wl=null,sL=!0,QL=function(t,e){B(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(od.logLevel=Qn.VERBOSE,wl=od.log.bind(od),e&&XE.set("logging_enabled",!0)):typeof t=="function"?wl=t:(wl=null,XE.remove("logging_enabled"))},Ei=function(...t){if(sL===!0&&(sL=!1,wl===null&&XE.get("logging_enabled")===!0&&QL(!0)),wl){let e=jf.apply(null,t);wl(e)}},zf=function(t){return function(...e){Ei(t,...e)}},ZE=function(...t){let e="FIREBASE INTERNAL ERROR: "+jf(...t);od.error(e)},ms=function(...t){let e=`FIREBASE FATAL ERROR: ${jf(...t)}`;throw od.error(e),new Error(e)},Hi=function(...t){let e="FIREBASE WARNING: "+jf(...t);od.warn(e)},P7=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Hi("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},J_=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},F7=function(t){if(ns()||document.readyState==="complete")t();else{let e=!1,i=function(){if(!document.body){setTimeout(i,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&i()}),window.attachEvent("onload",i))}},ja="[MIN_NAME]",Qs="[MAX_NAME]",El=function(t,e){if(t===e)return 0;if(t===ja||e===Qs)return-1;if(e===ja||t===Qs)return 1;{let i=aL(t),n=aL(e);return i!==null?n!==null?i-n===0?t.length-e.length:i-n:-1:n!==null?1:t<e?-1:1}},L7=function(t,e){return t===e?0:t<e?-1:1},gf=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+oi(e))},ZS=function(t){if(typeof t!="object"||t===null)return oi(t);let e=[];for(let n in t)e.push(n);e.sort();let i="{";for(let n=0;n<e.length;n++)n!==0&&(i+=","),i+=oi(e[n]),i+=":",i+=ZS(t[e[n]]);return i+="}",i},XL=function(t,e){let i=t.length;if(i<=e)return[t];let n=[];for(let r=0;r<i;r+=e)r+e>i?n.push(t.substring(r,i)):n.push(t.substring(r,r+e));return n};function Si(t,e){for(let i in t)t.hasOwnProperty(i)&&e(i,t[i])}var ZL=function(t){B(!J_(t),"Invalid JSON number");let e=11,i=52,n=(1<<e-1)-1,r,s,a,o,l;t===0?(s=0,a=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-n)?(o=Math.min(Math.floor(Math.log(t)/Math.LN2),n),s=o+n,a=Math.round(t*Math.pow(2,i-o)-Math.pow(2,i))):(s=0,a=Math.round(t/Math.pow(2,1-n-i))));let c=[];for(l=i;l;l-=1)c.push(a%2?1:0),a=Math.floor(a/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();let d=c.join(""),u="";for(l=0;l<64;l+=8){let h=parseInt(d.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),u=u+h}return u.toLowerCase()},B7=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},V7=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function j7(t,e){let i="Unknown Error";t==="too_big"?i="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?i="Client doesn't have permission to access the desired data.":t==="unavailable"&&(i="The service is unavailable");let n=new Error(t+" at "+e._path.toString()+": "+i);return n.code=t.toUpperCase(),n}var z7=new RegExp("^-?(0*)\\d{1,10}$"),U7=-2147483648,q7=2147483647,aL=function(t){if(z7.test(t)){let e=Number(t);if(e>=U7&&e<=q7)return e}return null},gd=function(t){try{t()}catch(e){setTimeout(()=>{let i=e.stack||"";throw Hi("Exception was thrown by user callback.",i),e},Math.floor(0))}},H7=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},yf=function(t,e){let i=setTimeout(t,e);return typeof i=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(i):typeof i=="object"&&i.unref&&i.unref(),i};var k_=class{constructor(e,i,n,r,s=!1,a="",o=!1,l=!1){this.secure=i,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=a,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=yl.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&yl.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",i=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${i}`}};function W7(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function JL(t,e,i){B(typeof e=="string","typeof type must == string"),B(typeof i=="object","typeof params must == object");let n;if(e===WL)n=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===GL)n=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);W7(t)&&(i.ns=t.namespace);let r=[];return Si(i,(s,a)=>{r.push(s+"="+a)}),n+r.join("&")}var JE=class{constructor(){this.counters_={}}incrementCounter(e,i=1){Yn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=i}get(){return NM(this.counters_)}};var zE={},UE={};function JS(t){let e=t.toString();return zE[e]||(zE[e]=new JE),zE[e]}function G7(t,e){let i=t.toString();return UE[i]||(UE[i]=e()),UE[i]}var ex="";function tx(t){ex=t}var K7=16384,$7=45e3,xf=null;typeof MozWebSocket<"u"?xf=MozWebSocket:typeof WebSocket<"u"&&(xf=WebSocket);function Y7(t){xf=t}var sd=(()=>{class t{constructor(i,n,r,s,a,o,l){this.connId=i,this.applicationId=r,this.appCheckToken=s,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=zf(this.connId),this.stats_=JS(n),this.connURL=t.connectionURL_(n,o,l,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(i,n,r,s,a){let o={};return o[BL]=D_,!ns()&&typeof location<"u"&&location.hostname&&UL.test(location.hostname)&&(o[jL]=zL),n&&(o[VL]=n),r&&(o[qL]=r),s&&(o[$E]=s),a&&(o[HL]=a),JL(i,WL,o)}open(i,n){this.onDisconnect=n,this.onMessage=i,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,yl.set("previous_websocket_failure",!0);try{let r;if(ns()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${D_}/${ex}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let a=process.env,o=this.connURL.indexOf("wss://")===0?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;o&&(r.proxy={origin:o})}this.mySock=new xf(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let i=!1;if(typeof navigator<"u"&&navigator.userAgent){let n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(i=!0)}return!i&&xf!==null&&!t.forceDisallow_}static previouslyFailed(){return yl.isInMemoryStorage||yl.get("previous_websocket_failure")===!0}markConnectionHealthy(){yl.remove("previous_websocket_failure")}appendFrame_(i){if(this.frames.push(i),this.frames.length===this.totalFrames){let n=this.frames.join("");this.frames=null;let r=mg(n);this.onMessage(r)}}handleNewFrameCount_(i){this.totalFrames=i,this.frames=[]}extractFrameCount_(i){if(B(this.frames===null,"We already have a frame buffer"),i.length<=6){let n=Number(i);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),i}handleIncomingFrame(i){if(this.mySock===null)return;let n=i.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{let r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(i){this.resetKeepAlive();let n=oi(i);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=XL(n,K7);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor($7))}sendString_(i){try{this.mySock.send(i)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t})(),oL="@firebase/database",lL="1.0.4";var eS=class{constructor(e,i){this.appName_=e,this.appCheckProvider=i,this.appCheck=i?.getImmediate({optional:!0}),this.appCheck||i?.get().then(n=>this.appCheck=n)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((i,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(i,n):i(null)},0)})}addTokenChangeListener(e){var i;(i=this.appCheckProvider)===null||i===void 0||i.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){Hi(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var tS=class{constructor(e,i,n){this.appName_=e,this.firebaseOptions_=i,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(i=>i&&i.code==="auth/token-not-initialized"?(Ei("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(i)):new Promise((i,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(i,n):i(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(i=>i.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(i=>i.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Hi(e)}},wf=(()=>{class t{constructor(i){this.accessToken=i}getToken(i){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(i){i(this.accessToken)}removeTokenChangeListener(i){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),iS=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,i){this.closeAfterResponse=e,this.onClose=i,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,i){for(this.pendingResponses[e]=i;this.pendingResponses[this.currentResponseNum];){let n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<n.length;++r)n[r]&&gd(()=>{this.onMessage_(n[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var cL="start",Q7="close",X7="pLPCommand",Z7="pRTLPCB",e2="id",t2="pw",i2="ser",J7="cb",eY="seg",tY="ts",iY="d",nY="dframe",n2=1870,r2=30,rY=n2-r2,sY=25e3,aY=3e4,Tf=class t{constructor(e,i,n,r,s,a,o){this.connId=e,this.repoInfo=i,this.applicationId=n,this.appCheckToken=r,this.authToken=s,this.transportSessionId=a,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=zf(e),this.stats_=JS(i),this.urlFn=l=>(this.appCheckToken&&(l[$E]=this.appCheckToken),JL(i,GL,l))}open(e,i){this.curSegmentNum=0,this.onDisconnect_=i,this.myPacketOrderer=new iS(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(aY)),F7(()=>{if(this.isClosed_)return;this.scriptTagHolder=new nS((...s)=>{let[a,o,l,c,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===cL)this.id=o,this.password=l;else if(a===Q7)o?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(o,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...s)=>{let[a,o]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(a,o)},()=>{this.onClosed_()},this.urlFn);let n={};n[cL]="t",n[i2]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[J7]=this.scriptTagHolder.uniqueCallbackIdentifier),n[BL]=D_,this.transportSessionId&&(n[VL]=this.transportSessionId),this.lastSessionId&&(n[qL]=this.lastSessionId),this.applicationId&&(n[HL]=this.applicationId),this.appCheckToken&&(n[$E]=this.appCheckToken),typeof location<"u"&&location.hostname&&UL.test(location.hostname)&&(n[jL]=zL);let r=this.urlFn(n);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return ns()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!B7()&&!V7()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let i=oi(e);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let n=OM(i),r=XL(n,rY);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,i){if(ns())return;this.myDisconnFrame=document.createElement("iframe");let n={};n[nY]="t",n[e2]=e,n[t2]=i,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let i=oi(e).length;this.bytesReceived+=i,this.stats_.incrementCounter("bytes_received",i)}},nS=class t{constructor(e,i,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ns())this.commandCB=e,this.onMessageCB=i;else{this.uniqueCallbackIdentifier=$L(),window[X7+this.uniqueCallbackIdentifier]=e,window[Z7+this.uniqueCallbackIdentifier]=i,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";</script>');let a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(o){Ei("frame writing exception"),o.stack&&Ei(o.stack),Ei(o)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ei("No IE domain setting required")}catch{let n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,i){for(this.myID=e,this.myPW=i,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[e2]=this.myID,e[t2]=this.myPW,e[i2]=this.currentSerial;let i=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+r2+n.length<=n2;){let a=this.pendingSegs.shift();n=n+"&"+eY+r+"="+a.seg+"&"+tY+r+"="+a.ts+"&"+iY+r+"="+a.d,r++}return i=i+n,this.addLongPollTag_(i,this.currentSerial),!0}else return!1}enqueueSegment(e,i,n){this.pendingSegs.push({seg:e,ts:i,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,i){this.outstandingRequests.add(i);let n=()=>{this.outstandingRequests.delete(i),this.newRequest_()},r=setTimeout(n,Math.floor(sY)),s=()=>{clearTimeout(r),n()};this.addTag(e,s)}addTag(e,i){ns()?this.doNodeLongPoll(e,i):setTimeout(()=>{try{if(!this.sendNewPolls)return;let n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){let r=n.readyState;(!r||r==="loaded"||r==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),i())},n.onerror=()=>{Ei("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}};var s2=(()=>{class t{constructor(i){this.initTransports_(i)}static get ALL_TRANSPORTS(){return[Tf,sd]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(i){let n=sd&&sd.isAvailable(),r=n&&!sd.previouslyFailed();if(i.webSocketOnly&&(n||Hi("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[sd];else{let s=this.transports_=[];for(let a of t.ALL_TRANSPORTS)a&&a.isAvailable()&&s.push(a);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),oY=6e4,lY=5e3,cY=10*1024,dY=100*1024,qE="t",dL="d",uY="s",uL="r",hY="e",hL="o",fL="a",mL="n",pL="p",fY="h",rS=class{constructor(e,i,n,r,s,a,o,l,c,d){this.id=e,this.repoInfo_=i,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=a,this.onReady_=o,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=zf("c:"+this.id+":"),this.transportManager_=new s2(i),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let i=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(i,n)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=yf(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>dY?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>cY?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return i=>{e===this.conn_?this.onConnectionLost_(i):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return i=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(i):e===this.secondaryConn_?this.onSecondaryMessageReceived_(i):this.log_("message on old connection"))}}sendRequest(e){let i={t:"d",d:e};this.sendData_(i)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(qE in e){let i=e[qE];i===fL?this.upgradeIfSecondaryHealthy_():i===uL?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):i===hL&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let i=gf("t",e),n=gf("d",e);if(i==="c")this.onSecondaryControl_(n);else if(i==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+i)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:pL,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:fL,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:mL,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let i=gf("t",e),n=gf("d",e);i==="c"?this.onControl_(n):i==="d"&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let i=gf(qE,e);if(dL in e){let n=e[dL];if(i===fY){let r=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(i===mL){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else i===uY?this.onConnectionShutdown_(n):i===uL?this.onReset_(n):i===hY?ZE("Server Error: "+n):i===hL?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ZE("Unknown control packet command: "+i)}}onHandshake_(e){let i=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,i),D_!==n&&Hi("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let i=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(i,n),yf(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(oY))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,i){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(i,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):yf(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(lY))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:pL,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(yl.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var A_=class{put(e,i,n,r){}merge(e,i,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,i,n){}onDisconnectMerge(e,i,n){}onDisconnectCancel(e,i){}reportStats(e){}};var R_=class{constructor(e){this.allowedEvents_=e,this.listeners_={},B(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...i){if(Array.isArray(this.listeners_[e])){let n=[...this.listeners_[e]];for(let r=0;r<n.length;r++)n[r].callback.apply(n[r].context,i)}}on(e,i,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:i,context:n});let r=this.getInitialEvent(e);r&&i.apply(n,r)}off(e,i,n){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===i&&(!n||n===r[s].context)){r.splice(s,1);return}}validateEventType_(e){B(this.allowedEvents_.find(i=>i===e),"Unknown event: "+e)}};var M_=class t extends R_{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!xw()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return B(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var gL=32,_L=768,rt=class{constructor(e,i){if(i===void 0){this.pieces_=e.split("/");let n=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=i}toString(){let e="";for(let i=this.pieceNum_;i<this.pieces_.length;i++)this.pieces_[i]!==""&&(e+="/"+this.pieces_[i]);return e||"/"}};function nt(){return new rt("")}function Fe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function za(t){return t.pieces_.length-t.pieceNum_}function gt(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new rt(t.pieces_,e)}function ix(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function mY(t){let e="";for(let i=t.pieceNum_;i<t.pieces_.length;i++)t.pieces_[i]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[i])));return e||"/"}function If(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function a2(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let i=t.pieceNum_;i<t.pieces_.length-1;i++)e.push(t.pieces_[i]);return new rt(e,0)}function Mt(t,e){let i=[];for(let n=t.pieceNum_;n<t.pieces_.length;n++)i.push(t.pieces_[n]);if(e instanceof rt)for(let n=e.pieceNum_;n<e.pieces_.length;n++)i.push(e.pieces_[n]);else{let n=e.split("/");for(let r=0;r<n.length;r++)n[r].length>0&&i.push(n[r])}return new rt(i,0)}function Le(t){return t.pieceNum_>=t.pieces_.length}function ln(t,e){let i=Fe(t),n=Fe(e);if(i===null)return e;if(i===n)return ln(gt(t),gt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function pY(t,e){let i=If(t,0),n=If(e,0);for(let r=0;r<i.length&&r<n.length;r++){let s=El(i[r],n[r]);if(s!==0)return s}return i.length===n.length?0:i.length<n.length?-1:1}function nx(t,e){if(za(t)!==za(e))return!1;for(let i=t.pieceNum_,n=e.pieceNum_;i<=t.pieces_.length;i++,n++)if(t.pieces_[i]!==e.pieces_[n])return!1;return!0}function sr(t,e){let i=t.pieceNum_,n=e.pieceNum_;if(za(t)>za(e))return!1;for(;i<t.pieces_.length;){if(t.pieces_[i]!==e.pieces_[n])return!1;++i,++n}return!0}var sS=class{constructor(e,i){this.errorPrefix_=i,this.parts_=If(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=vh(this.parts_[n]);o2(this)}};function gY(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=vh(e),o2(t)}function _Y(t){let e=t.parts_.pop();t.byteLength_-=vh(e),t.parts_.length>0&&(t.byteLength_-=1)}function o2(t){if(t.byteLength_>_L)throw new Error(t.errorPrefix_+"has a key path longer than "+_L+" bytes ("+t.byteLength_+").");if(t.parts_.length>gL)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+gL+") or object contains a cycle "+vl(t))}function vl(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var aS=class t extends R_{constructor(){super(["visible"]);let e,i;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(i="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(i="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(i="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(i="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,i&&document.addEventListener(i,()=>{let n=!document[e];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}static getInstance(){return new t}getInitialEvent(e){return B(e==="visible","Unknown event type: "+e),[this.visible_]}};var _f=1e3,bY=60*5*1e3,bL=30*1e3,vY=1.3,yY=3e4,wY="server_kill",vL=3,rx=(()=>{class t extends A_{constructor(i,n,r,s,a,o,l,c){if(super(),this.repoInfo_=i,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=a,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=zf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=_f,this.maxReconnectDelay_=bY,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!ns())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");aS.getInstance().on("visible",this.onVisible_,this),i.host.indexOf("fblocal")===-1&&M_.getInstance().on("online",this.onOnline_,this)}sendRequest(i,n,r){let s=++this.requestNumber_,a={r:s,a:i,b:n};this.log_(oi(a)),B(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),r&&(this.requestCBHash_[s]=r)}get(i){this.initConnection_();let n=new wi,s={action:"g",request:{p:i._path.toString(),q:i._queryObject},onComplete:o=>{let l=o.d;o.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let a=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(a),n.promise}listen(i,n,r,s){this.initConnection_();let a=i._queryIdentifier,o=i._path.toString();this.log_("Listen called for "+o+" "+a),this.listens.has(o)||this.listens.set(o,new Map),B(i._queryParams.isDefault()||!i._queryParams.loadsAllData(),"listen() called for non-default but complete query"),B(!this.listens.get(o).has(a),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:n,query:i,tag:r};this.listens.get(o).set(a,l),this.connected_&&this.sendListen_(l)}sendGet_(i){let n=this.outstandingGets_[i];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[i],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(i){let n=i.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);let a={p:r},o="q";i.tag&&(a.q=n._queryObject,a.t=i.tag),a.h=i.hashFn(),this.sendRequest(o,a,l=>{let c=l.d,d=l.s;t.warnOnListenWarnings_(c,n),(this.listens.get(r)&&this.listens.get(r).get(s))===i&&(this.log_("listen response",l),d!=="ok"&&this.removeListen_(r,s),i.onComplete&&i.onComplete(d,c))})}static warnOnListenWarnings_(i,n){if(i&&typeof i=="object"&&Yn(i,"w")){let r=wa(i,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',a=n._path.toString();Hi(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(i){this.authToken_=i,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(i)}reduceReconnectDelayIfAdminCredential_(i){(i&&i.length===40||VM(i))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=bL)}refreshAppCheckToken(i){this.appCheckToken_=i,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let i=this.authToken_,n=BM(i)?"auth":"gauth",r={cred:i};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{let a=s.s,o=s.d||"error";this.authToken_===i&&(a==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},i=>{let n=i.s,r=i.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(i,n){let r=i._path.toString(),s=i._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),B(i._queryParams.isDefault()||!i._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,i._queryObject,n)}sendUnlisten_(i,n,r,s){this.log_("Unlisten on "+i+" for "+n);let a={p:i},o="n";s&&(a.q=r,a.t=s),this.sendRequest(o,a)}onDisconnectPut(i,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",i,n,r):this.onDisconnectRequestQueue_.push({pathString:i,action:"o",data:n,onComplete:r})}onDisconnectMerge(i,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",i,n,r):this.onDisconnectRequestQueue_.push({pathString:i,action:"om",data:n,onComplete:r})}onDisconnectCancel(i,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",i,null,n):this.onDisconnectRequestQueue_.push({pathString:i,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(i,n,r,s){let a={p:n,d:r};this.log_("onDisconnect "+i,a),this.sendRequest(i,a,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(i,n,r,s){this.putInternal("p",i,n,r,s)}merge(i,n,r,s){this.putInternal("m",i,n,r,s)}putInternal(i,n,r,s,a){this.initConnection_();let o={p:n,d:r};a!==void 0&&(o.h=a),this.outstandingPuts_.push({action:i,request:o,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(i){let n=this.outstandingPuts_[i].action,r=this.outstandingPuts_[i].request,s=this.outstandingPuts_[i].onComplete;this.outstandingPuts_[i].queued=this.connected_,this.sendRequest(n,r,a=>{this.log_(n+" response",a),delete this.outstandingPuts_[i],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(a.s,a.d)})}reportStats(i){if(this.connected_){let n={c:i};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){let a=r.d;this.log_("reportStats","Error sending stats: "+a)}})}}onDataMessage_(i){if("r"in i){this.log_("from server: "+oi(i));let n=i.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(i.b))}else{if("error"in i)throw"A server-side error has occurred: "+i.error;"a"in i&&this.onDataPush_(i.a,i.b)}}onDataPush_(i,n){this.log_("handleServerMessage",i,n),i==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):i==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):i==="c"?this.onListenRevoked_(n.p,n.q):i==="ac"?this.onAuthRevoked_(n.s,n.d):i==="apc"?this.onAppCheckRevoked_(n.s,n.d):i==="sd"?this.onSecurityDebugPacket_(n):ZE("Unrecognized action received from server: "+oi(i)+`
Are you using the latest client?`)}onReady_(i,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(i),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(i){B(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(i))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(i){i&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=_f,this.realtime_||this.scheduleConnect_(0)),this.visible_=i}onOnline_(i){i?(this.log_("Browser went online."),this.reconnectDelay_=_f,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>yY&&(this.reconnectDelay_=_f),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let i=new Date().getTime()-this.lastConnectionAttemptTime_,n=Math.max(0,this.reconnectDelay_-i);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*vY)}this.onConnectStatus_(!1)}establishConnection_(){return y(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let i=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,a=this.lastSessionId,o=!1,l=null,c=function(){l?l.close():(o=!0,r())},d=function(h){B(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(h)};this.realtime_={close:c,sendRequest:d};let u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Ei("getToken() completed but was canceled"):(Ei("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,l=new rS(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,i,n,r,p=>{Hi(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(wY)},a))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Hi(h),c())}}})}interrupt(i){Ei("Interrupting connection for reason: "+i),this.interruptReasons_[i]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(i){Ei("Resuming connection for reason: "+i),delete this.interruptReasons_[i],pg(this.interruptReasons_)&&(this.reconnectDelay_=_f,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(i){let n=i-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let i=0;i<this.outstandingPuts_.length;i++){let n=this.outstandingPuts_[i];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[i],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(i,n){let r;n?r=n.map(a=>ZS(a)).join("$"):r="default";let s=this.removeListen_(i,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(i,n){let r=new rt(i).toString(),s;if(this.listens.has(r)){let a=this.listens.get(r);s=a.get(n),a.delete(n),a.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(i,n){Ei("Auth token revoked: "+i+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(i==="invalid_token"||i==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=vL&&(this.reconnectDelay_=bL,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(i,n){Ei("App check token revoked: "+i+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(i==="invalid_token"||i==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=vL&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(i){this.securityDebugCallback_?this.securityDebugCallback_(i):"msg"in i&&console.log("FIREBASE: "+i.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let i of this.listens.values())for(let n of i.values())this.sendListen_(n);for(let i=0;i<this.outstandingPuts_.length;i++)this.outstandingPuts_[i]&&this.sendPut_(i);for(;this.onDisconnectRequestQueue_.length;){let i=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(i.action,i.pathString,i.data,i.onComplete)}for(let i=0;i<this.outstandingGets_.length;i++)this.outstandingGets_[i]&&this.sendGet_(i)}sendConnectStats_(){let i={},n="js";ns()&&(this.repoInfo_.nodeAdmin?n="admin_node":n="node"),i["sdk."+n+"."+ex.replace(/\./g,"-")]=1,xw()?i["framework.cordova"]=1:PM()&&(i["framework.reactnative"]=1),this.reportStats(i)}shouldReconnect_(){let i=M_.getInstance().currentlyOnline();return pg(this.interruptReasons_)&&i}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),Ve=class t{constructor(e,i){this.name=e,this.node=i}static Wrap(e,i){return new t(e,i)}};var ld=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,i){let n=new Ve(ja,e),r=new Ve(ja,i);return this.compare(n,r)!==0}minPost(){return Ve.MIN}};var I_,O_=class extends ld{static get __EMPTY_NODE(){return I_}static set __EMPTY_NODE(e){I_=e}compare(e,i){return El(e.name,i.name)}isDefinedOn(e){throw Nc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,i){return!1}minPost(){return Ve.MIN}maxPost(){return new Ve(Qs,I_)}makePost(e,i){return B(typeof e=="string","KeyIndex indexValue must always be a string."),new Ve(e,I_)}toString(){return".key"}},fs=new O_;var ad=class{constructor(e,i,n,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=i?n(e.key,i):1,r&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),i;if(this.resultGenerator_?i=this.resultGenerator_(e.key,e.value):i={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return i}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Rr=(()=>{class t{constructor(i,n,r,s,a){this.key=i,this.value=n,this.color=r??t.RED,this.left=s??ar.EMPTY_NODE,this.right=a??ar.EMPTY_NODE}copy(i,n,r,s,a){return new t(i??this.key,n??this.value,r??this.color,s??this.left,a??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(i){return this.left.inorderTraversal(i)||!!i(this.key,this.value)||this.right.inorderTraversal(i)}reverseTraversal(i){return this.right.reverseTraversal(i)||i(this.key,this.value)||this.left.reverseTraversal(i)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(i,n,r){let s=this,a=r(i,s.key);return a<0?s=s.copy(null,null,null,s.left.insert(i,n,r),null):a===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(i,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ar.EMPTY_NODE;let i=this;return!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.removeMin_(),null),i.fixUp_()}remove(i,n){let r,s;if(r=this,n(i,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(i,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(i,r.key)===0){if(r.right.isEmpty())return ar.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(i,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let i=this;return i.right.isRed_()&&!i.left.isRed_()&&(i=i.rotateLeft_()),i.left.isRed_()&&i.left.left.isRed_()&&(i=i.rotateRight_()),i.left.isRed_()&&i.right.isRed_()&&(i=i.colorFlip_()),i}moveRedLeft_(){let i=this.colorFlip_();return i.right.left.isRed_()&&(i=i.copy(null,null,null,null,i.right.rotateRight_()),i=i.rotateLeft_(),i=i.colorFlip_()),i}moveRedRight_(){let i=this.colorFlip_();return i.left.left.isRed_()&&(i=i.rotateRight_(),i=i.colorFlip_()),i}rotateLeft_(){let i=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,i,null)}rotateRight_(){let i=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,i)}colorFlip_(){let i=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,i,n)}checkMaxDepth_(){let i=this.check_();return Math.pow(2,i)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let i=this.left.check_();if(i!==this.right.check_())throw new Error("Black depths differ");return i+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),oS=class{copy(e,i,n,r,s){return this}insert(e,i,n){return new Rr(e,i,null)}remove(e,i){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},ar=class t{constructor(e,i=t.EMPTY_NODE){this.comparator_=e,this.root_=i}insert(e,i){return new t(this.comparator_,this.root_.insert(e,i,this.comparator_).copy(null,null,Rr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Rr.BLACK,null,null))}get(e){let i,n=this.root_;for(;!n.isEmpty();){if(i=this.comparator_(e,n.key),i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}getPredecessorKey(e){let i,n=this.root_,r=null;for(;!n.isEmpty();)if(i=this.comparator_(e,n.key),i===0){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else i<0?n=n.left:i>0&&(r=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ad(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,i){return new ad(this.root_,e,this.comparator_,!1,i)}getReverseIteratorFrom(e,i){return new ad(this.root_,e,this.comparator_,!0,i)}getReverseIterator(e){return new ad(this.root_,null,this.comparator_,!0,e)}};ar.EMPTY_NODE=new oS;function CY(t,e){return El(t.name,e.name)}function sx(t,e){return El(t,e)}var lS;function EY(t){lS=t}var l2=function(t){return typeof t=="number"?"number:"+ZL(t):"string:"+t},c2=function(t){if(t.isLeafNode()){let e=t.val();B(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Yn(e,".sv"),"Priority must be a string or number.")}else B(t===lS||t.isEmpty(),"priority of unexpected type.");B(t===lS||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var yL,cd=(()=>{class t{constructor(i,n=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=i,this.priorityNode_=n,this.lazyHash_=null,B(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),c2(this.priorityNode_)}static set __childrenNodeConstructor(i){yL=i}static get __childrenNodeConstructor(){return yL}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(i){return new t(this.value_,i)}getImmediateChild(i){return i===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(i){return Le(i)?this:Fe(i)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(i,n){return null}updateImmediateChild(i,n){return i===".priority"?this.updatePriority(n):n.isEmpty()&&i!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(i,n).updatePriority(this.priorityNode_)}updateChild(i,n){let r=Fe(i);return r===null?n:n.isEmpty()&&r!==".priority"?this:(B(r!==".priority"||za(i)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(gt(i),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(i,n){return!1}val(i){return i&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let i="";this.priorityNode_.isEmpty()||(i+="priority:"+l2(this.priorityNode_.val())+":");let n=typeof this.value_;i+=n+":",n==="number"?i+=ZL(this.value_):i+=this.value_,this.lazyHash_=YL(i)}return this.lazyHash_}getValue(){return this.value_}compareTo(i){return i===t.__childrenNodeConstructor.EMPTY_NODE?1:i instanceof t.__childrenNodeConstructor?-1:(B(i.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(i))}compareToLeafNode_(i){let n=typeof i.value_,r=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return B(s>=0,"Unknown leaf type: "+n),B(a>=0,"Unknown leaf type: "+r),s===a?r==="object"?0:this.value_<i.value_?-1:this.value_===i.value_?0:1:a-s}withIndex(){return this}isIndexed(){return!0}equals(i){if(i===this)return!0;if(i.isLeafNode()){let n=i;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),d2,u2;function SY(t){d2=t}function xY(t){u2=t}var cS=class extends ld{compare(e,i){let n=e.node.getPriority(),r=i.node.getPriority(),s=n.compareTo(r);return s===0?El(e.name,i.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,i){return!e.getPriority().equals(i.getPriority())}minPost(){return Ve.MIN}maxPost(){return new Ve(Qs,new cd("[PRIORITY-POST]",u2))}makePost(e,i){let n=d2(e);return new Ve(i,new cd("[PRIORITY-POST]",n))}toString(){return".priority"}},Ct=new cS;var TY=Math.log(2),dS=class{constructor(e){let i=s=>parseInt(Math.log(s)/TY,10),n=s=>parseInt(Array(s+1).join("1"),2);this.count=i(e+1),this.current_=this.count-1;let r=n(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},N_=function(t,e,i,n){t.sort(e);let r=function(l,c){let d=c-l,u,h;if(d===0)return null;if(d===1)return u=t[l],h=i?i(u):u,new Rr(h,u.node,Rr.BLACK,null,null);{let f=parseInt(d/2,10)+l,p=r(l,f),v=r(f+1,c);return u=t[f],h=i?i(u):u,new Rr(h,u.node,Rr.BLACK,p,v)}},s=function(l){let c=null,d=null,u=t.length,h=function(p,v){let E=u-p,k=u;u-=p;let I=r(E+1,k),P=t[E],L=i?i(P):P;f(new Rr(L,P.node,v,null,I))},f=function(p){c?(c.left=p,c=p):(d=p,c=p)};for(let p=0;p<l.count;++p){let v=l.nextBitIsOne(),E=Math.pow(2,l.count-(p+1));v?h(E,Rr.BLACK):(h(E,Rr.BLACK),h(E,Rr.RED))}return d},a=new dS(t.length),o=s(a);return new ar(n||e,o)};var HE,rd={},dd=class t{constructor(e,i){this.indexes_=e,this.indexSet_=i}static get Default(){return B(rd&&Ct,"ChildrenNode.ts has not been loaded"),HE=HE||new t({".priority":rd},{".priority":Ct}),HE}get(e){let i=wa(this.indexes_,e);if(!i)throw new Error("No index defined for "+e);return i instanceof ar?i:null}hasIndex(e){return Yn(this.indexSet_,e.toString())}addIndex(e,i){B(e!==fs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let n=[],r=!1,s=i.getIterator(Ve.Wrap),a=s.getNext();for(;a;)r=r||e.isDefinedOn(a.node),n.push(a),a=s.getNext();let o;r?o=N_(n,e.getCompare()):o=rd;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let d=Object.assign({},this.indexes_);return d[l]=o,new t(d,c)}addToIndexes(e,i){let n=bh(this.indexes_,(r,s)=>{let a=wa(this.indexSet_,s);if(B(a,"Missing index implementation for "+s),r===rd)if(a.isDefinedOn(e.node)){let o=[],l=i.getIterator(Ve.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&o.push(c),c=l.getNext();return o.push(e),N_(o,a.getCompare())}else return rd;else{let o=i.get(e.name),l=r;return o&&(l=l.remove(new Ve(e.name,o))),l.insert(e,e.node)}});return new t(n,this.indexSet_)}removeFromIndexes(e,i){let n=bh(this.indexes_,r=>{if(r===rd)return r;{let s=i.get(e.name);return s?r.remove(new Ve(e.name,s)):r}});return new t(n,this.indexSet_)}};var bf,Ae=(()=>{class t{constructor(i,n,r){this.children_=i,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&c2(this.priorityNode_),this.children_.isEmpty()&&B(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return bf||(bf=new t(new ar(sx),null,dd.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||bf}updatePriority(i){return this.children_.isEmpty()?this:new t(this.children_,i,this.indexMap_)}getImmediateChild(i){if(i===".priority")return this.getPriority();{let n=this.children_.get(i);return n===null?bf:n}}getChild(i){let n=Fe(i);return n===null?this:this.getImmediateChild(n).getChild(gt(i))}hasChild(i){return this.children_.get(i)!==null}updateImmediateChild(i,n){if(B(n,"We should always be passing snapshot nodes"),i===".priority")return this.updatePriority(n);{let r=new Ve(i,n),s,a;n.isEmpty()?(s=this.children_.remove(i),a=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(i,n),a=this.indexMap_.addToIndexes(r,this.children_));let o=s.isEmpty()?bf:this.priorityNode_;return new t(s,o,a)}}updateChild(i,n){let r=Fe(i);if(r===null)return n;{B(Fe(i)!==".priority"||za(i)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild(gt(i),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(i){if(this.isEmpty())return null;let n={},r=0,s=0,a=!0;if(this.forEachChild(Ct,(o,l)=>{n[o]=l.val(i),r++,a&&t.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):a=!1}),!i&&a&&s<2*r){let o=[];for(let l in n)o[l]=n[l];return o}else return i&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let i="";this.getPriority().isEmpty()||(i+="priority:"+l2(this.getPriority().val())+":"),this.forEachChild(Ct,(n,r)=>{let s=r.hash();s!==""&&(i+=":"+n+":"+s)}),this.lazyHash_=i===""?"":YL(i)}return this.lazyHash_}getPredecessorChildName(i,n,r){let s=this.resolveIndex_(r);if(s){let a=s.getPredecessorKey(new Ve(i,n));return a?a.name:null}else return this.children_.getPredecessorKey(i)}getFirstChildName(i){let n=this.resolveIndex_(i);if(n){let r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(i){let n=this.getFirstChildName(i);return n?new Ve(n,this.children_.get(n)):null}getLastChildName(i){let n=this.resolveIndex_(i);if(n){let r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(i){let n=this.getLastChildName(i);return n?new Ve(n,this.children_.get(n)):null}forEachChild(i,n){let r=this.resolveIndex_(i);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(i){return this.getIteratorFrom(i.minPost(),i)}getIteratorFrom(i,n){let r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(i,s=>s);{let s=this.children_.getIteratorFrom(i.name,Ve.Wrap),a=s.peek();for(;a!=null&&n.compare(a,i)<0;)s.getNext(),a=s.peek();return s}}getReverseIterator(i){return this.getReverseIteratorFrom(i.maxPost(),i)}getReverseIteratorFrom(i,n){let r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(i,s=>s);{let s=this.children_.getReverseIteratorFrom(i.name,Ve.Wrap),a=s.peek();for(;a!=null&&n.compare(a,i)>0;)s.getNext(),a=s.peek();return s}}compareTo(i){return this.isEmpty()?i.isEmpty()?0:-1:i.isLeafNode()||i.isEmpty()?1:i===Uf?-1:0}withIndex(i){if(i===fs||this.indexMap_.hasIndex(i))return this;{let n=this.indexMap_.addIndex(i,this.children_);return new t(this.children_,this.priorityNode_,n)}}isIndexed(i){return i===fs||this.indexMap_.hasIndex(i)}equals(i){if(i===this)return!0;if(i.isLeafNode())return!1;{let n=i;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){let r=this.getIterator(Ct),s=n.getIterator(Ct),a=r.getNext(),o=s.getNext();for(;a&&o;){if(a.name!==o.name||!a.node.equals(o.node))return!1;a=r.getNext(),o=s.getNext()}return a===null&&o===null}else return!1;else return!1}}resolveIndex_(i){return i===fs?null:this.indexMap_.get(i.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),uS=class extends Ae{constructor(){super(new ar(sx),Ae.EMPTY_NODE,dd.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ae.EMPTY_NODE}isEmpty(){return!1}},Uf=new uS;Object.defineProperties(Ve,{MIN:{value:new Ve(ja,Ae.EMPTY_NODE)},MAX:{value:new Ve(Qs,Uf)}});O_.__EMPTY_NODE=Ae.EMPTY_NODE;cd.__childrenNodeConstructor=Ae;EY(Uf);xY(Uf);var IY=!0;function Ft(t,e=null){if(t===null)return Ae.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),B(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let i=t;return new cd(i,Ft(e))}if(!(t instanceof Array)&&IY){let i=[],n=!1;if(Si(t,(a,o)=>{if(a.substring(0,1)!=="."){let l=Ft(o);l.isEmpty()||(n=n||!l.getPriority().isEmpty(),i.push(new Ve(a,l)))}}),i.length===0)return Ae.EMPTY_NODE;let s=N_(i,CY,a=>a.name,sx);if(n){let a=N_(i,Ct.getCompare());return new Ae(s,Ft(e),new dd({".priority":a},{".priority":Ct}))}else return new Ae(s,Ft(e),dd.Default)}else{let i=Ae.EMPTY_NODE;return Si(t,(n,r)=>{if(Yn(t,n)&&n.substring(0,1)!=="."){let s=Ft(r);(s.isLeafNode()||!s.isEmpty())&&(i=i.updateImmediateChild(n,s))}}),i.updatePriority(Ft(e))}}SY(Ft);var Df=class extends ld{constructor(e){super(),this.indexPath_=e,B(!Le(e)&&Fe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,i){let n=this.extractChild(e.node),r=this.extractChild(i.node),s=n.compareTo(r);return s===0?El(e.name,i.name):s}makePost(e,i){let n=Ft(e),r=Ae.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ve(i,r)}maxPost(){let e=Ae.EMPTY_NODE.updateChild(this.indexPath_,Uf);return new Ve(Qs,e)}toString(){return If(this.indexPath_,0).join("/")}};var hS=class extends ld{compare(e,i){let n=e.node.compareTo(i.node);return n===0?El(e.name,i.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,i){return!e.equals(i)}minPost(){return Ve.MIN}maxPost(){return Ve.MAX}makePost(e,i){let n=Ft(e);return new Ve(i,n)}toString(){return".value"}},ax=new hS;function h2(t){return{type:"value",snapshotNode:t}}function ud(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function kf(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Af(t,e,i){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:i}}function DY(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Rf=class{constructor(e){this.index_=e}updateChild(e,i,n,r,s,a){B(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let o=e.getImmediateChild(i);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()||(a!=null&&(n.isEmpty()?e.hasChild(i)?a.trackChildChange(kf(i,o)):B(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(ud(i,n)):a.trackChildChange(Af(i,n,o))),e.isLeafNode()&&n.isEmpty())?e:e.updateImmediateChild(i,n).withIndex(this.index_)}updateFullNode(e,i,n){return n!=null&&(e.isLeafNode()||e.forEachChild(Ct,(r,s)=>{i.hasChild(r)||n.trackChildChange(kf(r,s))}),i.isLeafNode()||i.forEachChild(Ct,(r,s)=>{if(e.hasChild(r)){let a=e.getImmediateChild(r);a.equals(s)||n.trackChildChange(Af(r,s,a))}else n.trackChildChange(ud(r,s))})),i.withIndex(this.index_)}updatePriority(e,i){return e.isEmpty()?Ae.EMPTY_NODE:e.updatePriority(i)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var P_=class t{constructor(e){this.indexedFilter_=new Rf(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let i=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return i&&n}updateChild(e,i,n,r,s,a){return this.matches(new Ve(i,n))||(n=Ae.EMPTY_NODE),this.indexedFilter_.updateChild(e,i,n,r,s,a)}updateFullNode(e,i,n){i.isLeafNode()&&(i=Ae.EMPTY_NODE);let r=i.withIndex(this.index_);r=r.updatePriority(Ae.EMPTY_NODE);let s=this;return i.forEachChild(Ct,(a,o)=>{s.matches(new Ve(a,o))||(r=r.updateImmediateChild(a,Ae.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,i){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let i=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),i)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let i=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),i)}else return e.getIndex().maxPost()}};var fS=class{constructor(e){this.withinDirectionalStart=i=>this.reverse_?this.withinEndPost(i):this.withinStartPost(i),this.withinDirectionalEnd=i=>this.reverse_?this.withinStartPost(i):this.withinEndPost(i),this.withinStartPost=i=>{let n=this.index_.compare(this.rangedFilter_.getStartPost(),i);return this.startIsInclusive_?n<=0:n<0},this.withinEndPost=i=>{let n=this.index_.compare(i,this.rangedFilter_.getEndPost());return this.endIsInclusive_?n<=0:n<0},this.rangedFilter_=new P_(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,i,n,r,s,a){return this.rangedFilter_.matches(new Ve(i,n))||(n=Ae.EMPTY_NODE),e.getImmediateChild(i).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,i,n,r,s,a):this.fullLimitUpdateChild_(e,i,n,s,a)}updateFullNode(e,i,n){let r;if(i.isLeafNode()||i.isEmpty())r=Ae.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<i.numChildren()&&i.isIndexed(this.index_)){r=Ae.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=i.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=i.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;s.hasNext()&&a<this.limit_;){let o=s.getNext();if(this.withinDirectionalStart(o))if(this.withinDirectionalEnd(o))r=r.updateImmediateChild(o.name,o.node),a++;else break;else continue}}else{r=i.withIndex(this.index_),r=r.updatePriority(Ae.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let a=0;for(;s.hasNext();){let o=s.getNext();a<this.limit_&&this.withinDirectionalStart(o)&&this.withinDirectionalEnd(o)?a++:r=r.updateImmediateChild(o.name,Ae.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,i){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,i,n,r,s){let a;if(this.reverse_){let u=this.index_.getCompare();a=(h,f)=>u(f,h)}else a=this.index_.getCompare();let o=e;B(o.numChildren()===this.limit_,"");let l=new Ve(i,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(o.hasChild(i)){let u=o.getImmediateChild(i),h=r.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===i||o.hasChild(h.name));)h=r.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:a(h,l);if(d&&!n.isEmpty()&&f>=0)return s?.trackChildChange(Af(i,n,u)),o.updateImmediateChild(i,n);{s?.trackChildChange(kf(i,u));let v=o.updateImmediateChild(i,Ae.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(ud(h.name,h.node)),v.updateImmediateChild(h.name,h.node)):v}}else return n.isEmpty()?e:d&&a(c,l)>=0?(s!=null&&(s.trackChildChange(kf(c.name,c.node)),s.trackChildChange(ud(i,n))),o.updateImmediateChild(i,n).updateImmediateChild(c.name,Ae.EMPTY_NODE)):e}};var Mf=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ct}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return B(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return B(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ja}hasEnd(){return this.endSet_}getIndexEndValue(){return B(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return B(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Qs}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return B(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ct}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function kY(t){return t.loadsAllData()?new Rf(t.getIndex()):t.hasLimit()?new fS(t):new P_(t)}function AY(t,e){let i=t.copy();return i.limitSet_=!0,i.limit_=e,i.viewFrom_="l",i}function RY(t,e){let i=t.copy();return i.limitSet_=!0,i.limit_=e,i.viewFrom_="r",i}function mS(t,e,i){let n=t.copy();return n.startSet_=!0,e===void 0&&(e=null),n.indexStartValue_=e,i!=null?(n.startNameSet_=!0,n.indexStartName_=i):(n.startNameSet_=!1,n.indexStartName_=""),n}function MY(t,e,i){let n;return t.index_===fs||i?n=mS(t,e,i):n=mS(t,e,Qs),n.startAfterSet_=!0,n}function pS(t,e,i){let n=t.copy();return n.endSet_=!0,e===void 0&&(e=null),n.indexEndValue_=e,i!==void 0?(n.endNameSet_=!0,n.indexEndName_=i):(n.endNameSet_=!1,n.indexEndName_=""),n}function OY(t,e,i){let n;return t.index_===fs||i?n=pS(t,e,i):n=pS(t,e,ja),n.endBeforeSet_=!0,n}function eb(t,e){let i=t.copy();return i.index_=e,i}function wL(t){let e={};if(t.isDefault())return e;let i;if(t.index_===Ct?i="$priority":t.index_===ax?i="$value":t.index_===fs?i="$key":(B(t.index_ instanceof Df,"Unrecognized index type!"),i=t.index_.toString()),e.orderBy=oi(i),t.startSet_){let n=t.startAfterSet_?"startAfter":"startAt";e[n]=oi(t.indexStartValue_),t.startNameSet_&&(e[n]+=","+oi(t.indexStartName_))}if(t.endSet_){let n=t.endBeforeSet_?"endBefore":"endAt";e[n]=oi(t.indexEndValue_),t.endNameSet_&&(e[n]+=","+oi(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function CL(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let i=t.viewFrom_;i===""&&(t.isViewFromLeft()?i="l":i="r"),e.vf=i}return t.index_!==Ct&&(e.i=t.index_.toString()),e}var gS=class t extends A_{constructor(e,i,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=i,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=zf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,i){return i!==void 0?"tag$"+i:(B(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,i,n,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let a=t.getListenId_(e,n),o={};this.listens_[a]=o;let l=wL(e._queryParams);this.restRequest_(s+".json",l,(c,d)=>{let u=d;if(c===404&&(u=null,c=null),c===null&&this.onDataUpdate_(s,u,!1,n),wa(this.listens_,a)===o){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",r(h,null)}})}unlisten(e,i){let n=t.getListenId_(e,i);delete this.listens_[n]}get(e){let i=wL(e._queryParams),n=e._path.toString(),r=new wi;return this.restRequest_(n+".json",i,(s,a)=>{let o=a;s===404&&(o=null,s=null),s===null?(this.onDataUpdate_(n,o,!1,null),r.resolve(o)):r.reject(new Error(o))}),r.promise}refreshAuthToken(e){}restRequest_(e,i={},n){return i.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(i.auth=r.accessToken),s&&s.token&&(i.ac=s.token);let a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+jM(i);this.log_("Sending REST request for "+a);let o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&o.readyState===4){this.log_("REST Response for "+a+" received. status:",o.status,"response:",o.responseText);let l=null;if(o.status>=200&&o.status<300){try{l=mg(o.responseText)}catch{Hi("Failed to parse JSON response for "+a+": "+o.responseText)}n(null,l)}else o.status!==401&&o.status!==404&&Hi("Got unsuccessful REST response for "+a+" Status: "+o.status),n(o.status);n=null}},o.open("GET",a,!0),o.send()})}};var _S=class{constructor(){this.rootNode_=Ae.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,i){this.rootNode_=this.rootNode_.updateChild(e,i)}};function F_(){return{value:null,children:new Map}}function _d(t,e,i){if(Le(e))t.value=i,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,i);else{let n=Fe(e);t.children.has(n)||t.children.set(n,F_());let r=t.children.get(n);e=gt(e),_d(r,e,i)}}function bS(t,e){if(Le(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let i=t.value;return t.value=null,i.forEachChild(Ct,(n,r)=>{_d(t,new rt(n),r)}),bS(t,e)}}else if(t.children.size>0){let i=Fe(e);return e=gt(e),t.children.has(i)&&bS(t.children.get(i),e)&&t.children.delete(i),t.children.size===0}else return!0}function vS(t,e,i){t.value!==null?i(e,t.value):NY(t,(n,r)=>{let s=new rt(e.toString()+"/"+n);vS(r,s,i)})}function NY(t,e){t.children.forEach((i,n)=>{e(n,i)})}var yS=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),i=Object.assign({},e);return this.last_&&Si(this.last_,(n,r)=>{i[n]=i[n]-r}),this.last_=e,i}};var EL=10*1e3,PY=30*1e3,FY=5*60*1e3,wS=class{constructor(e,i){this.server_=i,this.statsToReport_={},this.statsListener_=new yS(e);let n=EL+(PY-EL)*Math.random();yf(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){let e=this.statsListener_.get(),i={},n=!1;Si(e,(r,s)=>{s>0&&Yn(this.statsToReport_,r)&&(i[r]=s,n=!0)}),n&&this.server_.reportStats(i),yf(this.reportStats_.bind(this),Math.floor(Math.random()*2*FY))}};var hs=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(hs||{});function ox(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function lx(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function cx(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var CS=class t{constructor(e,i,n){this.path=e,this.affectedTree=i,this.revert=n,this.type=hs.ACK_USER_WRITE,this.source=ox()}operationForChild(e){if(Le(this.path)){if(this.affectedTree.value!=null)return B(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let i=this.affectedTree.subtree(new rt(e));return new t(nt(),i,this.revert)}}else return B(Fe(this.path)===e,"operationForChild called for unrelated child."),new t(gt(this.path),this.affectedTree,this.revert)}};var L_=class t{constructor(e,i){this.source=e,this.path=i,this.type=hs.LISTEN_COMPLETE}operationForChild(e){return Le(this.path)?new t(this.source,nt()):new t(this.source,gt(this.path))}};var hd=class t{constructor(e,i,n){this.source=e,this.path=i,this.snap=n,this.type=hs.OVERWRITE}operationForChild(e){return Le(this.path)?new t(this.source,nt(),this.snap.getImmediateChild(e)):new t(this.source,gt(this.path),this.snap)}};var Of=class t{constructor(e,i,n){this.source=e,this.path=i,this.children=n,this.type=hs.MERGE}operationForChild(e){if(Le(this.path)){let i=this.children.subtree(new rt(e));return i.isEmpty()?null:i.value?new hd(this.source,nt(),i.value):new t(this.source,nt(),i)}else return B(Fe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,gt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var ps=class{constructor(e,i,n){this.node_=e,this.fullyInitialized_=i,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Le(e))return this.isFullyInitialized()&&!this.filtered_;let i=Fe(e);return this.isCompleteForChild(i)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var ES=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function LY(t,e,i,n){let r=[],s=[];return e.forEach(a=>{a.type==="child_changed"&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&s.push(DY(a.childName,a.snapshotNode))}),vf(t,r,"child_removed",e,n,i),vf(t,r,"child_added",e,n,i),vf(t,r,"child_moved",s,n,i),vf(t,r,"child_changed",e,n,i),vf(t,r,"value",e,n,i),r}function vf(t,e,i,n,r,s){let a=n.filter(o=>o.type===i);a.sort((o,l)=>VY(t,o,l)),a.forEach(o=>{let l=BY(t,o,s);r.forEach(c=>{c.respondsTo(o.type)&&e.push(c.createEvent(l,t.query_))})})}function BY(t,e,i){return e.type==="value"||e.type==="child_removed"||(e.prevName=i.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function VY(t,e,i){if(e.childName==null||i.childName==null)throw Nc("Should only compare child_ events.");let n=new Ve(e.childName,e.snapshotNode),r=new Ve(i.childName,i.snapshotNode);return t.index_.compare(n,r)}function tb(t,e){return{eventCache:t,serverCache:e}}function Cf(t,e,i,n){return tb(new ps(e,i,n),t.serverCache)}function f2(t,e,i,n){return tb(t.eventCache,new ps(e,i,n))}function B_(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Cl(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var WE,jY=()=>(WE||(WE=new ar(L7)),WE),cn=class t{constructor(e,i=jY()){this.value=e,this.children=i}static fromObject(e){let i=new t(null);return Si(e,(n,r)=>{i=i.set(new rt(n),r)}),i}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,i){if(this.value!=null&&i(this.value))return{path:nt(),value:this.value};if(Le(e))return null;{let n=Fe(e),r=this.children.get(n);if(r!==null){let s=r.findRootMostMatchingPathAndValue(gt(e),i);return s!=null?{path:Mt(new rt(n),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Le(e))return this;{let i=Fe(e),n=this.children.get(i);return n!==null?n.subtree(gt(e)):new t(null)}}set(e,i){if(Le(e))return new t(i,this.children);{let n=Fe(e),s=(this.children.get(n)||new t(null)).set(gt(e),i),a=this.children.insert(n,s);return new t(this.value,a)}}remove(e){if(Le(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let i=Fe(e),n=this.children.get(i);if(n){let r=n.remove(gt(e)),s;return r.isEmpty()?s=this.children.remove(i):s=this.children.insert(i,r),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(Le(e))return this.value;{let i=Fe(e),n=this.children.get(i);return n?n.get(gt(e)):null}}setTree(e,i){if(Le(e))return i;{let n=Fe(e),s=(this.children.get(n)||new t(null)).setTree(gt(e),i),a;return s.isEmpty()?a=this.children.remove(n):a=this.children.insert(n,s),new t(this.value,a)}}fold(e){return this.fold_(nt(),e)}fold_(e,i){let n={};return this.children.inorderTraversal((r,s)=>{n[r]=s.fold_(Mt(e,r),i)}),i(e,this.value,n)}findOnPath(e,i){return this.findOnPath_(e,nt(),i)}findOnPath_(e,i,n){let r=this.value?n(i,this.value):!1;if(r)return r;if(Le(e))return null;{let s=Fe(e),a=this.children.get(s);return a?a.findOnPath_(gt(e),Mt(i,s),n):null}}foreachOnPath(e,i){return this.foreachOnPath_(e,nt(),i)}foreachOnPath_(e,i,n){if(Le(e))return this;{this.value&&n(i,this.value);let r=Fe(e),s=this.children.get(r);return s?s.foreachOnPath_(gt(e),Mt(i,r),n):new t(null)}}foreach(e){this.foreach_(nt(),e)}foreach_(e,i){this.children.inorderTraversal((n,r)=>{r.foreach_(Mt(e,n),i)}),this.value&&i(e,this.value)}foreachChild(e){this.children.inorderTraversal((i,n)=>{n.value&&e(i,n.value)})}};var Mr=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new cn(null))}};function Ef(t,e,i){if(Le(e))return new Mr(new cn(i));{let n=t.writeTree_.findRootMostValueAndPath(e);if(n!=null){let r=n.path,s=n.value,a=ln(r,e);return s=s.updateChild(a,i),new Mr(t.writeTree_.set(r,s))}else{let r=new cn(i),s=t.writeTree_.setTree(e,r);return new Mr(s)}}}function SS(t,e,i){let n=t;return Si(i,(r,s)=>{n=Ef(n,Mt(e,r),s)}),n}function SL(t,e){if(Le(e))return Mr.empty();{let i=t.writeTree_.setTree(e,new cn(null));return new Mr(i)}}function xS(t,e){return Sl(t,e)!=null}function Sl(t,e){let i=t.writeTree_.findRootMostValueAndPath(e);return i!=null?t.writeTree_.get(i.path).getChild(ln(i.path,e)):null}function xL(t){let e=[],i=t.writeTree_.value;return i!=null?i.isLeafNode()||i.forEachChild(Ct,(n,r)=>{e.push(new Ve(n,r))}):t.writeTree_.children.inorderTraversal((n,r)=>{r.value!=null&&e.push(new Ve(n,r.value))}),e}function Ba(t,e){if(Le(e))return t;{let i=Sl(t,e);return i!=null?new Mr(new cn(i)):new Mr(t.writeTree_.subtree(e))}}function TS(t){return t.writeTree_.isEmpty()}function fd(t,e){return m2(nt(),t.writeTree_,e)}function m2(t,e,i){if(e.value!=null)return i.updateChild(t,e.value);{let n=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(B(s.value!==null,"Priority writes must always be leaf nodes"),n=s.value):i=m2(Mt(t,r),s,i)}),!i.getChild(t).isEmpty()&&n!==null&&(i=i.updateChild(Mt(t,".priority"),n)),i}}function ib(t,e){return b2(e,t)}function zY(t,e,i,n,r){B(n>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:i,writeId:n,visible:r}),r&&(t.visibleWrites=Ef(t.visibleWrites,e,i)),t.lastWriteId=n}function UY(t,e,i,n){B(n>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:i,writeId:n,visible:!0}),t.visibleWrites=SS(t.visibleWrites,e,i),t.lastWriteId=n}function qY(t,e){for(let i=0;i<t.allWrites.length;i++){let n=t.allWrites[i];if(n.writeId===e)return n}return null}function HY(t,e){let i=t.allWrites.findIndex(o=>o.writeId===e);B(i>=0,"removeWrite called with nonexistent writeId.");let n=t.allWrites[i];t.allWrites.splice(i,1);let r=n.visible,s=!1,a=t.allWrites.length-1;for(;r&&a>=0;){let o=t.allWrites[a];o.visible&&(a>=i&&WY(o,n.path)?r=!1:sr(n.path,o.path)&&(s=!0)),a--}if(r){if(s)return GY(t),!0;if(n.snap)t.visibleWrites=SL(t.visibleWrites,n.path);else{let o=n.children;Si(o,l=>{t.visibleWrites=SL(t.visibleWrites,Mt(n.path,l))})}return!0}else return!1}function WY(t,e){if(t.snap)return sr(t.path,e);for(let i in t.children)if(t.children.hasOwnProperty(i)&&sr(Mt(t.path,i),e))return!0;return!1}function GY(t){t.visibleWrites=p2(t.allWrites,KY,nt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function KY(t){return t.visible}function p2(t,e,i){let n=Mr.empty();for(let r=0;r<t.length;++r){let s=t[r];if(e(s)){let a=s.path,o;if(s.snap)sr(i,a)?(o=ln(i,a),n=Ef(n,o,s.snap)):sr(a,i)&&(o=ln(a,i),n=Ef(n,nt(),s.snap.getChild(o)));else if(s.children){if(sr(i,a))o=ln(i,a),n=SS(n,o,s.children);else if(sr(a,i))if(o=ln(a,i),Le(o))n=SS(n,nt(),s.children);else{let l=wa(s.children,Fe(o));if(l){let c=l.getChild(gt(o));n=Ef(n,nt(),c)}}}else throw Nc("WriteRecord should have .snap or .children")}}return n}function g2(t,e,i,n,r){if(!n&&!r){let s=Sl(t.visibleWrites,e);if(s!=null)return s;{let a=Ba(t.visibleWrites,e);if(TS(a))return i;if(i==null&&!xS(a,nt()))return null;{let o=i||Ae.EMPTY_NODE;return fd(a,o)}}}else{let s=Ba(t.visibleWrites,e);if(!r&&TS(s))return i;if(!r&&i==null&&!xS(s,nt()))return null;{let a=function(c){return(c.visible||r)&&(!n||!~n.indexOf(c.writeId))&&(sr(c.path,e)||sr(e,c.path))},o=p2(t.allWrites,a,e),l=i||Ae.EMPTY_NODE;return fd(o,l)}}}function $Y(t,e,i){let n=Ae.EMPTY_NODE,r=Sl(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Ct,(s,a)=>{n=n.updateImmediateChild(s,a)}),n;if(i){let s=Ba(t.visibleWrites,e);return i.forEachChild(Ct,(a,o)=>{let l=fd(Ba(s,new rt(a)),o);n=n.updateImmediateChild(a,l)}),xL(s).forEach(a=>{n=n.updateImmediateChild(a.name,a.node)}),n}else{let s=Ba(t.visibleWrites,e);return xL(s).forEach(a=>{n=n.updateImmediateChild(a.name,a.node)}),n}}function YY(t,e,i,n,r){B(n||r,"Either existingEventSnap or existingServerSnap must exist");let s=Mt(e,i);if(xS(t.visibleWrites,s))return null;{let a=Ba(t.visibleWrites,s);return TS(a)?r.getChild(i):fd(a,r.getChild(i))}}function QY(t,e,i,n){let r=Mt(e,i),s=Sl(t.visibleWrites,r);if(s!=null)return s;if(n.isCompleteForChild(i)){let a=Ba(t.visibleWrites,r);return fd(a,n.getNode().getImmediateChild(i))}else return null}function XY(t,e){return Sl(t.visibleWrites,e)}function ZY(t,e,i,n,r,s,a){let o,l=Ba(t.visibleWrites,e),c=Sl(l,nt());if(c!=null)o=c;else if(i!=null)o=fd(l,i);else return[];if(o=o.withIndex(a),!o.isEmpty()&&!o.isLeafNode()){let d=[],u=a.getCompare(),h=s?o.getReverseIteratorFrom(n,a):o.getIteratorFrom(n,a),f=h.getNext();for(;f&&d.length<r;)u(f,n)!==0&&d.push(f),f=h.getNext();return d}else return[]}function JY(){return{visibleWrites:Mr.empty(),allWrites:[],lastWriteId:-1}}function V_(t,e,i,n){return g2(t.writeTree,t.treePath,e,i,n)}function dx(t,e){return $Y(t.writeTree,t.treePath,e)}function TL(t,e,i,n){return YY(t.writeTree,t.treePath,e,i,n)}function j_(t,e){return XY(t.writeTree,Mt(t.treePath,e))}function eQ(t,e,i,n,r,s){return ZY(t.writeTree,t.treePath,e,i,n,r,s)}function ux(t,e,i){return QY(t.writeTree,t.treePath,e,i)}function _2(t,e){return b2(Mt(t.treePath,e),t.writeTree)}function b2(t,e){return{treePath:t,writeTree:e}}var IS=class{constructor(){this.changeMap=new Map}trackChildChange(e){let i=e.type,n=e.childName;B(i==="child_added"||i==="child_changed"||i==="child_removed","Only child changes supported for tracking"),B(n!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(n);if(r){let s=r.type;if(i==="child_added"&&s==="child_removed")this.changeMap.set(n,Af(n,e.snapshotNode,r.snapshotNode));else if(i==="child_removed"&&s==="child_added")this.changeMap.delete(n);else if(i==="child_removed"&&s==="child_changed")this.changeMap.set(n,kf(n,r.oldSnap));else if(i==="child_changed"&&s==="child_added")this.changeMap.set(n,ud(n,e.snapshotNode));else if(i==="child_changed"&&s==="child_changed")this.changeMap.set(n,Af(n,e.snapshotNode,r.oldSnap));else throw Nc("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}};var DS=class{getCompleteChild(e){return null}getChildAfterChild(e,i,n){return null}},v2=new DS,Nf=class{constructor(e,i,n=null){this.writes_=e,this.viewCache_=i,this.optCompleteServerCache_=n}getCompleteChild(e){let i=this.viewCache_.eventCache;if(i.isCompleteForChild(e))return i.getNode().getImmediateChild(e);{let n=this.optCompleteServerCache_!=null?new ps(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ux(this.writes_,e,n)}}getChildAfterChild(e,i,n){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Cl(this.viewCache_),s=eQ(this.writes_,r,i,1,n,e);return s.length===0?null:s[0]}};function tQ(t){return{filter:t}}function iQ(t,e){B(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),B(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function nQ(t,e,i,n,r){let s=new IS,a,o;if(i.type===hs.OVERWRITE){let c=i;c.source.fromUser?a=kS(t,e,c.path,c.snap,n,r,s):(B(c.source.fromServer,"Unknown source."),o=c.source.tagged||e.serverCache.isFiltered()&&!Le(c.path),a=z_(t,e,c.path,c.snap,n,r,o,s))}else if(i.type===hs.MERGE){let c=i;c.source.fromUser?a=sQ(t,e,c.path,c.children,n,r,s):(B(c.source.fromServer,"Unknown source."),o=c.source.tagged||e.serverCache.isFiltered(),a=AS(t,e,c.path,c.children,n,r,o,s))}else if(i.type===hs.ACK_USER_WRITE){let c=i;c.revert?a=lQ(t,e,c.path,n,r,s):a=aQ(t,e,c.path,c.affectedTree,n,r,s)}else if(i.type===hs.LISTEN_COMPLETE)a=oQ(t,e,i.path,n,s);else throw Nc("Unknown operation type: "+i.type);let l=s.getChanges();return rQ(e,a,l),{viewCache:a,changes:l}}function rQ(t,e,i){let n=e.eventCache;if(n.isFullyInitialized()){let r=n.getNode().isLeafNode()||n.getNode().isEmpty(),s=B_(t);(i.length>0||!t.eventCache.isFullyInitialized()||r&&!n.getNode().equals(s)||!n.getNode().getPriority().equals(s.getPriority()))&&i.push(h2(B_(e)))}}function y2(t,e,i,n,r,s){let a=e.eventCache;if(j_(n,i)!=null)return e;{let o,l;if(Le(i))if(B(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Cl(e),d=c instanceof Ae?c:Ae.EMPTY_NODE,u=dx(n,d);o=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let c=V_(n,Cl(e));o=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=Fe(i);if(c===".priority"){B(za(i)===1,"Can't have a priority with additional path components");let d=a.getNode();l=e.serverCache.getNode();let u=TL(n,i,d,l);u!=null?o=t.filter.updatePriority(d,u):o=a.getNode()}else{let d=gt(i),u;if(a.isCompleteForChild(c)){l=e.serverCache.getNode();let h=TL(n,i,a.getNode(),l);h!=null?u=a.getNode().getImmediateChild(c).updateChild(d,h):u=a.getNode().getImmediateChild(c)}else u=ux(n,c,e.serverCache);u!=null?o=t.filter.updateChild(a.getNode(),c,u,d,r,s):o=a.getNode()}}return Cf(e,o,a.isFullyInitialized()||Le(i),t.filter.filtersNodes())}}function z_(t,e,i,n,r,s,a,o){let l=e.serverCache,c,d=a?t.filter:t.filter.getIndexedFilter();if(Le(i))c=d.updateFullNode(l.getNode(),n,null);else if(d.filtersNodes()&&!l.isFiltered()){let f=l.getNode().updateChild(i,n);c=d.updateFullNode(l.getNode(),f,null)}else{let f=Fe(i);if(!l.isCompleteForPath(i)&&za(i)>1)return e;let p=gt(i),E=l.getNode().getImmediateChild(f).updateChild(p,n);f===".priority"?c=d.updatePriority(l.getNode(),E):c=d.updateChild(l.getNode(),f,E,p,v2,null)}let u=f2(e,c,l.isFullyInitialized()||Le(i),d.filtersNodes()),h=new Nf(r,u,s);return y2(t,u,i,r,h,o)}function kS(t,e,i,n,r,s,a){let o=e.eventCache,l,c,d=new Nf(r,e,s);if(Le(i))c=t.filter.updateFullNode(e.eventCache.getNode(),n,a),l=Cf(e,c,!0,t.filter.filtersNodes());else{let u=Fe(i);if(u===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),n),l=Cf(e,c,o.isFullyInitialized(),o.isFiltered());else{let h=gt(i),f=o.getNode().getImmediateChild(u),p;if(Le(h))p=n;else{let v=d.getCompleteChild(u);v!=null?ix(h)===".priority"&&v.getChild(a2(h)).isEmpty()?p=v:p=v.updateChild(h,n):p=Ae.EMPTY_NODE}if(f.equals(p))l=e;else{let v=t.filter.updateChild(o.getNode(),u,p,h,d,a);l=Cf(e,v,o.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function IL(t,e){return t.eventCache.isCompleteForChild(e)}function sQ(t,e,i,n,r,s,a){let o=e;return n.foreach((l,c)=>{let d=Mt(i,l);IL(e,Fe(d))&&(o=kS(t,o,d,c,r,s,a))}),n.foreach((l,c)=>{let d=Mt(i,l);IL(e,Fe(d))||(o=kS(t,o,d,c,r,s,a))}),o}function DL(t,e,i){return i.foreach((n,r)=>{e=e.updateChild(n,r)}),e}function AS(t,e,i,n,r,s,a,o){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;Le(i)?c=n:c=new cn(null).setTree(i,n);let d=e.serverCache.getNode();return c.children.inorderTraversal((u,h)=>{if(d.hasChild(u)){let f=e.serverCache.getNode().getImmediateChild(u),p=DL(t,f,h);l=z_(t,l,new rt(u),p,r,s,a,o)}}),c.children.inorderTraversal((u,h)=>{let f=!e.serverCache.isCompleteForChild(u)&&h.value===null;if(!d.hasChild(u)&&!f){let p=e.serverCache.getNode().getImmediateChild(u),v=DL(t,p,h);l=z_(t,l,new rt(u),v,r,s,a,o)}}),l}function aQ(t,e,i,n,r,s,a){if(j_(r,i)!=null)return e;let o=e.serverCache.isFiltered(),l=e.serverCache;if(n.value!=null){if(Le(i)&&l.isFullyInitialized()||l.isCompleteForPath(i))return z_(t,e,i,l.getNode().getChild(i),r,s,o,a);if(Le(i)){let c=new cn(null);return l.getNode().forEachChild(fs,(d,u)=>{c=c.set(new rt(d),u)}),AS(t,e,i,c,r,s,o,a)}else return e}else{let c=new cn(null);return n.foreach((d,u)=>{let h=Mt(i,d);l.isCompleteForPath(h)&&(c=c.set(d,l.getNode().getChild(h)))}),AS(t,e,i,c,r,s,o,a)}}function oQ(t,e,i,n,r){let s=e.serverCache,a=f2(e,s.getNode(),s.isFullyInitialized()||Le(i),s.isFiltered());return y2(t,a,i,n,v2,r)}function lQ(t,e,i,n,r,s){let a;if(j_(n,i)!=null)return e;{let o=new Nf(n,e,r),l=e.eventCache.getNode(),c;if(Le(i)||Fe(i)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=V_(n,Cl(e));else{let u=e.serverCache.getNode();B(u instanceof Ae,"serverChildren would be complete if leaf node"),d=dx(n,u)}d=d,c=t.filter.updateFullNode(l,d,s)}else{let d=Fe(i),u=ux(n,d,e.serverCache);u==null&&e.serverCache.isCompleteForChild(d)&&(u=l.getImmediateChild(d)),u!=null?c=t.filter.updateChild(l,d,u,gt(i),o,s):e.eventCache.getNode().hasChild(d)?c=t.filter.updateChild(l,d,Ae.EMPTY_NODE,gt(i),o,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=V_(n,Cl(e)),a.isLeafNode()&&(c=t.filter.updateFullNode(c,a,s)))}return a=e.serverCache.isFullyInitialized()||j_(n,nt())!=null,Cf(e,c,a,t.filter.filtersNodes())}}var RS=class{constructor(e,i){this.query_=e,this.eventRegistrations_=[];let n=this.query_._queryParams,r=new Rf(n.getIndex()),s=kY(n);this.processor_=tQ(s);let a=i.serverCache,o=i.eventCache,l=r.updateFullNode(Ae.EMPTY_NODE,a.getNode(),null),c=s.updateFullNode(Ae.EMPTY_NODE,o.getNode(),null),d=new ps(l,a.isFullyInitialized(),r.filtersNodes()),u=new ps(c,o.isFullyInitialized(),s.filtersNodes());this.viewCache_=tb(u,d),this.eventGenerator_=new ES(this.query_)}get query(){return this.query_}};function cQ(t){return t.viewCache_.serverCache.getNode()}function dQ(t){return B_(t.viewCache_)}function uQ(t,e){let i=Cl(t.viewCache_);return i&&(t.query._queryParams.loadsAllData()||!Le(e)&&!i.getImmediateChild(Fe(e)).isEmpty())?i.getChild(e):null}function kL(t){return t.eventRegistrations_.length===0}function hQ(t,e){t.eventRegistrations_.push(e)}function AL(t,e,i){let n=[];if(i){B(e==null,"A cancel should cancel all event registrations.");let r=t.query._path;t.eventRegistrations_.forEach(s=>{let a=s.createCancelEvent(i,r);a&&n.push(a)})}if(e){let r=[];for(let s=0;s<t.eventRegistrations_.length;++s){let a=t.eventRegistrations_[s];if(!a.matches(e))r.push(a);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return n}function RL(t,e,i,n){e.type===hs.MERGE&&e.source.queryId!==null&&(B(Cl(t.viewCache_),"We should always have a full cache before handling merges"),B(B_(t.viewCache_),"Missing event cache, even though we have a server cache"));let r=t.viewCache_,s=nQ(t.processor_,r,e,i,n);return iQ(t.processor_,s.viewCache),B(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,w2(t,s.changes,s.viewCache.eventCache.getNode(),null)}function fQ(t,e){let i=t.viewCache_.eventCache,n=[];return i.getNode().isLeafNode()||i.getNode().forEachChild(Ct,(s,a)=>{n.push(ud(s,a))}),i.isFullyInitialized()&&n.push(h2(i.getNode())),w2(t,n,i.getNode(),e)}function w2(t,e,i,n){let r=n?[n]:t.eventRegistrations_;return LY(t.eventGenerator_,e,i,r)}var U_,q_=class{constructor(){this.views=new Map}};function mQ(t){B(!U_,"__referenceConstructor has already been defined"),U_=t}function pQ(){return B(U_,"Reference.ts has not been loaded"),U_}function gQ(t){return t.views.size===0}function hx(t,e,i,n){let r=e.source.queryId;if(r!==null){let s=t.views.get(r);return B(s!=null,"SyncTree gave us an op for an invalid query."),RL(s,e,i,n)}else{let s=[];for(let a of t.views.values())s=s.concat(RL(a,e,i,n));return s}}function C2(t,e,i,n,r){let s=e._queryIdentifier,a=t.views.get(s);if(!a){let o=V_(i,r?n:null),l=!1;o?l=!0:n instanceof Ae?(o=dx(i,n),l=!1):(o=Ae.EMPTY_NODE,l=!1);let c=tb(new ps(o,l,!1),new ps(n,r,!1));return new RS(e,c)}return a}function _Q(t,e,i,n,r,s){let a=C2(t,e,n,r,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),hQ(a,i),fQ(a,i)}function bQ(t,e,i,n){let r=e._queryIdentifier,s=[],a=[],o=Ua(t);if(r==="default")for(let[l,c]of t.views.entries())a=a.concat(AL(c,i,n)),kL(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{let l=t.views.get(r);l&&(a=a.concat(AL(l,i,n)),kL(l)&&(t.views.delete(r),l.query._queryParams.loadsAllData()||s.push(l.query)))}return o&&!Ua(t)&&s.push(new(pQ())(e._repo,e._path)),{removed:s,events:a}}function E2(t){let e=[];for(let i of t.views.values())i.query._queryParams.loadsAllData()||e.push(i);return e}function Va(t,e){let i=null;for(let n of t.views.values())i=i||uQ(n,e);return i}function S2(t,e){if(e._queryParams.loadsAllData())return nb(t);{let n=e._queryIdentifier;return t.views.get(n)}}function x2(t,e){return S2(t,e)!=null}function Ua(t){return nb(t)!=null}function nb(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var H_;function vQ(t){B(!H_,"__referenceConstructor has already been defined"),H_=t}function yQ(){return B(H_,"Reference.ts has not been loaded"),H_}var wQ=1,W_=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new cn(null),this.pendingWriteTree_=JY(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function fx(t,e,i,n,r){return zY(t.pendingWriteTree_,e,i,n,r),r?bd(t,new hd(ox(),e,i)):[]}function CQ(t,e,i,n){UY(t.pendingWriteTree_,e,i,n);let r=cn.fromObject(i);return bd(t,new Of(ox(),e,r))}function La(t,e,i=!1){let n=qY(t.pendingWriteTree_,e);if(HY(t.pendingWriteTree_,e)){let s=new cn(null);return n.snap!=null?s=s.set(nt(),!0):Si(n.children,a=>{s=s.set(new rt(a),!0)}),bd(t,new CS(n.path,s,i))}else return[]}function qf(t,e,i){return bd(t,new hd(lx(),e,i))}function EQ(t,e,i){let n=cn.fromObject(i);return bd(t,new Of(lx(),e,n))}function SQ(t,e){return bd(t,new L_(lx(),e))}function xQ(t,e,i){let n=mx(t,i);if(n){let r=px(n),s=r.path,a=r.queryId,o=ln(s,e),l=new L_(cx(a),o);return gx(t,s,l)}else return[]}function G_(t,e,i,n,r=!1){let s=e._path,a=t.syncPointTree_.get(s),o=[];if(a&&(e._queryIdentifier==="default"||x2(a,e))){let l=bQ(a,e,i,n);gQ(a)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=l.removed;if(o=l.events,!r){let d=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(s,(h,f)=>Ua(f));if(d&&!u){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=DQ(h);for(let p=0;p<f.length;++p){let v=f[p],E=v.query,k=k2(t,v);t.listenProvider_.startListening(Sf(E),Pf(t,E),k.hashFn,k.onComplete)}}}!u&&c.length>0&&!n&&(d?t.listenProvider_.stopListening(Sf(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(sb(h));t.listenProvider_.stopListening(Sf(h),f)}))}kQ(t,c)}return o}function T2(t,e,i,n){let r=mx(t,n);if(r!=null){let s=px(r),a=s.path,o=s.queryId,l=ln(a,e),c=new hd(cx(o),l,i);return gx(t,a,c)}else return[]}function TQ(t,e,i,n){let r=mx(t,n);if(r){let s=px(r),a=s.path,o=s.queryId,l=ln(a,e),c=cn.fromObject(i),d=new Of(cx(o),l,c);return gx(t,a,d)}else return[]}function MS(t,e,i,n=!1){let r=e._path,s=null,a=!1;t.syncPointTree_.foreachOnPath(r,(h,f)=>{let p=ln(h,r);s=s||Va(f,p),a=a||Ua(f)});let o=t.syncPointTree_.get(r);o?(a=a||Ua(o),s=s||Va(o,nt())):(o=new q_,t.syncPointTree_=t.syncPointTree_.set(r,o));let l;s!=null?l=!0:(l=!1,s=Ae.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((f,p)=>{let v=Va(p,nt());v&&(s=s.updateImmediateChild(f,v))}));let c=x2(o,e);if(!c&&!e._queryParams.loadsAllData()){let h=sb(e);B(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=AQ();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let d=ib(t.pendingWriteTree_,r),u=_Q(o,e,i,d,s,l);if(!c&&!a&&!n){let h=S2(o,e);u=u.concat(RQ(t,e,h))}return u}function rb(t,e,i){let r=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(a,o)=>{let l=ln(a,e),c=Va(o,l);if(c)return c});return g2(r,e,s,i,!0)}function IQ(t,e){let i=e._path,n=null;t.syncPointTree_.foreachOnPath(i,(c,d)=>{let u=ln(c,i);n=n||Va(d,u)});let r=t.syncPointTree_.get(i);r?n=n||Va(r,nt()):(r=new q_,t.syncPointTree_=t.syncPointTree_.set(i,r));let s=n!=null,a=s?new ps(n,!0,!1):null,o=ib(t.pendingWriteTree_,e._path),l=C2(r,e,o,s?a.getNode():Ae.EMPTY_NODE,s);return dQ(l)}function bd(t,e){return I2(e,t.syncPointTree_,null,ib(t.pendingWriteTree_,nt()))}function I2(t,e,i,n){if(Le(t.path))return D2(t,e,i,n);{let r=e.get(nt());i==null&&r!=null&&(i=Va(r,nt()));let s=[],a=Fe(t.path),o=t.operationForChild(a),l=e.children.get(a);if(l&&o){let c=i?i.getImmediateChild(a):null,d=_2(n,a);s=s.concat(I2(o,l,c,d))}return r&&(s=s.concat(hx(r,t,n,i))),s}}function D2(t,e,i,n){let r=e.get(nt());i==null&&r!=null&&(i=Va(r,nt()));let s=[];return e.children.inorderTraversal((a,o)=>{let l=i?i.getImmediateChild(a):null,c=_2(n,a),d=t.operationForChild(a);d&&(s=s.concat(D2(d,o,l,c)))}),r&&(s=s.concat(hx(r,t,n,i))),s}function k2(t,e){let i=e.query,n=Pf(t,i);return{hashFn:()=>(cQ(e)||Ae.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return n?xQ(t,i._path,n):SQ(t,i._path);{let s=j7(r,i);return G_(t,i,null,s)}}}}function Pf(t,e){let i=sb(e);return t.queryToTagMap.get(i)}function sb(t){return t._path.toString()+"$"+t._queryIdentifier}function mx(t,e){return t.tagToQueryMap.get(e)}function px(t){let e=t.indexOf("$");return B(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new rt(t.substr(0,e))}}function gx(t,e,i){let n=t.syncPointTree_.get(e);B(n,"Missing sync point for query tag that we're tracking");let r=ib(t.pendingWriteTree_,e);return hx(n,i,r,null)}function DQ(t){return t.fold((e,i,n)=>{if(i&&Ua(i))return[nb(i)];{let r=[];return i&&(r=E2(i)),Si(n,(s,a)=>{r=r.concat(a)}),r}})}function Sf(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(yQ())(t._repo,t._path):t}function kQ(t,e){for(let i=0;i<e.length;++i){let n=e[i];if(!n._queryParams.loadsAllData()){let r=sb(n),s=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(s)}}}function AQ(){return wQ++}function RQ(t,e,i){let n=e._path,r=Pf(t,e),s=k2(t,i),a=t.listenProvider_.startListening(Sf(e),r,s.hashFn,s.onComplete),o=t.syncPointTree_.subtree(n);if(r)B(!Ua(o.value),"If we're adding a query, it shouldn't be shadowed");else{let l=o.fold((c,d,u)=>{if(!Le(c)&&d&&Ua(d))return[nb(d).query];{let h=[];return d&&(h=h.concat(E2(d).map(f=>f.query))),Si(u,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<l.length;++c){let d=l[c];t.listenProvider_.stopListening(Sf(d),Pf(t,d))}}return a}var OS=class t{constructor(e){this.node_=e}getImmediateChild(e){let i=this.node_.getImmediateChild(e);return new t(i)}node(){return this.node_}},NS=class t{constructor(e,i){this.syncTree_=e,this.path_=i}getImmediateChild(e){let i=Mt(this.path_,e);return new t(this.syncTree_,i)}node(){return rb(this.syncTree_,this.path_)}},MQ=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},ML=function(t,e,i){if(!t||typeof t!="object")return t;if(B(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return OQ(t[".sv"],e,i);if(typeof t[".sv"]=="object")return NQ(t[".sv"],e);B(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},OQ=function(t,e,i){switch(t){case"timestamp":return i.timestamp;default:B(!1,"Unexpected server value: "+t)}},NQ=function(t,e,i){t.hasOwnProperty("increment")||B(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let n=t.increment;typeof n!="number"&&B(!1,"Unexpected increment value: "+n);let r=e.node();if(B(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return n;let a=r.getValue();return typeof a!="number"?n:a+n},A2=function(t,e,i,n){return bx(e,new NS(i,t),n)},_x=function(t,e,i){return bx(t,new OS(e),i)};function bx(t,e,i){let n=t.getPriority().val(),r=ML(n,e.getImmediateChild(".priority"),i),s;if(t.isLeafNode()){let a=t,o=ML(a.getValue(),e,i);return o!==a.getValue()||r!==a.getPriority().val()?new cd(o,Ft(r)):t}else{let a=t;return s=a,r!==a.getPriority().val()&&(s=s.updatePriority(new cd(r))),a.forEachChild(Ct,(o,l)=>{let c=bx(l,e.getImmediateChild(o),i);c!==l&&(s=s.updateImmediateChild(o,c))}),s}}var Ff=class{constructor(e="",i=null,n={children:{},childCount:0}){this.name=e,this.parent=i,this.node=n}};function ab(t,e){let i=e instanceof rt?e:new rt(e),n=t,r=Fe(i);for(;r!==null;){let s=wa(n.node.children,r)||{children:{},childCount:0};n=new Ff(r,n,s),i=gt(i),r=Fe(i)}return n}function xl(t){return t.node.value}function vx(t,e){t.node.value=e,PS(t)}function R2(t){return t.node.childCount>0}function PQ(t){return xl(t)===void 0&&!R2(t)}function ob(t,e){Si(t.node.children,(i,n)=>{e(new Ff(i,t,n))})}function M2(t,e,i,n){i&&!n&&e(t),ob(t,r=>{M2(r,e,!0,n)}),i&&n&&e(t)}function FQ(t,e,i){let n=i?t:t.parent;for(;n!==null;){if(e(n))return!0;n=n.parent}return!1}function Hf(t){return new rt(t.parent===null?t.name:Hf(t.parent)+"/"+t.name)}function PS(t){t.parent!==null&&LQ(t.parent,t.name,t)}function LQ(t,e,i){let n=PQ(i),r=Yn(t.node.children,e);n&&r?(delete t.node.children[e],t.node.childCount--,PS(t)):!n&&!r&&(t.node.children[e]=i.node,t.node.childCount++,PS(t))}var BQ=/[\[\].#$\/\u0000-\u001F\u007F]/,VQ=/[\[\].#$\u0000-\u001F\u007F]/,GE=10*1024*1024,lb=function(t){return typeof t=="string"&&t.length!==0&&!BQ.test(t)},O2=function(t){return typeof t=="string"&&t.length!==0&&!VQ.test(t)},jQ=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),O2(t)},Lf=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!J_(t)||t&&typeof t=="object"&&Yn(t,".sv")},gs=function(t,e,i,n){n&&e===void 0||Wf(Sn(t,"value"),e,i)},Wf=function(t,e,i){let n=i instanceof rt?new sS(i,t):i;if(e===void 0)throw new Error(t+"contains undefined "+vl(n));if(typeof e=="function")throw new Error(t+"contains a function "+vl(n)+" with contents = "+e.toString());if(J_(e))throw new Error(t+"contains "+e.toString()+" "+vl(n));if(typeof e=="string"&&e.length>GE/3&&vh(e)>GE)throw new Error(t+"contains a string greater than "+GE+" utf8 bytes "+vl(n)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(Si(e,(a,o)=>{if(a===".value")r=!0;else if(a!==".priority"&&a!==".sv"&&(s=!0,!lb(a)))throw new Error(t+" contains an invalid key ("+a+") "+vl(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);gY(n,a),Wf(t,o,n),_Y(n)}),r&&s)throw new Error(t+' contains ".value" child '+vl(n)+" in addition to actual children.")}},zQ=function(t,e){let i,n;for(i=0;i<e.length;i++){n=e[i];let s=If(n);for(let a=0;a<s.length;a++)if(!(s[a]===".priority"&&a===s.length-1)){if(!lb(s[a]))throw new Error(t+"contains an invalid key ("+s[a]+") in path "+n.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(pY);let r=null;for(i=0;i<e.length;i++){if(n=e[i],r!==null&&sr(r,n))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+n.toString());r=n}},N2=function(t,e,i,n){if(n&&e===void 0)return;let r=Sn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");let s=[];Si(e,(a,o)=>{let l=new rt(a);if(Wf(r,o,Mt(i,l)),ix(l)===".priority"&&!Lf(o))throw new Error(r+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),zQ(r,s)},yx=function(t,e,i){if(!(i&&e===void 0)){if(J_(e))throw new Error(Sn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Lf(e))throw new Error(Sn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Gf=function(t,e,i,n){if(!(n&&i===void 0)&&!lb(i))throw new Error(Sn(t,e)+'was an invalid key = "'+i+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},vd=function(t,e,i,n){if(!(n&&i===void 0)&&!O2(i))throw new Error(Sn(t,e)+'was an invalid path = "'+i+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},UQ=function(t,e,i,n){i&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),vd(t,e,i,n)},Nn=function(t,e){if(Fe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},P2=function(t,e){let i=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!lb(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||i.length!==0&&!jQ(i))throw new Error(Sn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var FS=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function cb(t,e){let i=null;for(let n=0;n<e.length;n++){let r=e[n],s=r.getPath();i!==null&&!nx(s,i.path)&&(t.eventLists_.push(i),i=null),i===null&&(i={events:[],path:s}),i.events.push(r)}i&&t.eventLists_.push(i)}function F2(t,e,i){cb(t,i),L2(t,n=>nx(n,e))}function Pn(t,e,i){cb(t,i),L2(t,n=>sr(n,e)||sr(e,n))}function L2(t,e){t.recursionDepth_++;let i=!0;for(let n=0;n<t.eventLists_.length;n++){let r=t.eventLists_[n];if(r){let s=r.path;e(s)?(qQ(t.eventLists_[n]),t.eventLists_[n]=null):i=!1}}i&&(t.eventLists_=[]),t.recursionDepth_--}function qQ(t){for(let e=0;e<t.events.length;e++){let i=t.events[e];if(i!==null){t.events[e]=null;let n=i.getEventRunner();wl&&Ei("event: "+i.toString()),gd(n)}}}var B2="repo_interrupt",HQ=25,LS=class{constructor(e,i,n,r){this.repoInfo_=e,this.forceRestClient_=i,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new FS,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=F_(),this.transactionQueueTree_=new Ff,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function WQ(t,e,i){if(t.stats_=JS(t.repoInfo_),t.forceRestClient_||H7())t.server_=new gS(t.repoInfo_,(n,r,s,a)=>{OL(t,n,r,s,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>NL(t,!0),0);else{if(typeof i<"u"&&i!==null){if(typeof i!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{oi(i)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}t.persistentConnection_=new rx(t.repoInfo_,e,(n,r,s,a)=>{OL(t,n,r,s,a)},n=>{NL(t,n)},n=>{GQ(t,n)},t.authTokenProvider_,t.appCheckProvider_,i),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(n=>{t.server_.refreshAuthToken(n)}),t.appCheckProvider_.addTokenChangeListener(n=>{t.server_.refreshAppCheckToken(n.token)}),t.statsReporter_=G7(t.repoInfo_,()=>new wS(t.stats_,t.server_)),t.infoData_=new _S,t.infoSyncTree_=new W_({startListening:(n,r,s,a)=>{let o=[],l=t.infoData_.getNode(n._path);return l.isEmpty()||(o=qf(t.infoSyncTree_,n._path,l),setTimeout(()=>{a("ok")},0)),o},stopListening:()=>{}}),wx(t,"connected",!1),t.serverSyncTree_=new W_({startListening:(n,r,s,a)=>(t.server_.listen(n,s,r,(o,l)=>{let c=a(o,l);Pn(t.eventQueue_,n._path,c)}),[]),stopListening:(n,r)=>{t.server_.unlisten(n,r)}})}function V2(t){let i=t.infoData_.getNode(new rt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+i}function Kf(t){return MQ({timestamp:V2(t)})}function OL(t,e,i,n,r){t.dataUpdateCount++;let s=new rt(e);i=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,i):i;let a=[];if(r)if(n){let l=bh(i,c=>Ft(c));a=TQ(t.serverSyncTree_,s,l,r)}else{let l=Ft(i);a=T2(t.serverSyncTree_,s,l,r)}else if(n){let l=bh(i,c=>Ft(c));a=EQ(t.serverSyncTree_,s,l)}else{let l=Ft(i);a=qf(t.serverSyncTree_,s,l)}let o=s;a.length>0&&(o=md(t,s)),Pn(t.eventQueue_,o,a)}function NL(t,e){wx(t,"connected",e),e===!1&&YQ(t)}function GQ(t,e){Si(e,(i,n)=>{wx(t,i,n)})}function wx(t,e,i){let n=new rt("/.info/"+e),r=Ft(i);t.infoData_.updateSnapshot(n,r);let s=qf(t.infoSyncTree_,n,r);Pn(t.eventQueue_,n,s)}function db(t){return t.nextWriteId_++}function KQ(t,e,i){let n=IQ(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(r=>{let s=Ft(r).withIndex(e._queryParams.getIndex());MS(t.serverSyncTree_,e,i,!0);let a;if(e._queryParams.loadsAllData())a=qf(t.serverSyncTree_,e._path,s);else{let o=Pf(t.serverSyncTree_,e);a=T2(t.serverSyncTree_,e._path,s,o)}return Pn(t.eventQueue_,e._path,a),G_(t.serverSyncTree_,e,i,null,!0),s},r=>(yd(t,"get for query "+oi(e)+" failed: "+r),Promise.reject(new Error(r))))}function Cx(t,e,i,n,r){yd(t,"set",{path:e.toString(),value:i,priority:n});let s=Kf(t),a=Ft(i,n),o=rb(t.serverSyncTree_,e),l=_x(a,o,s),c=db(t),d=fx(t.serverSyncTree_,e,l,c,!0);cb(t.eventQueue_,d),t.server_.put(e.toString(),a.val(!0),(h,f)=>{let p=h==="ok";p||Hi("set at "+e+" failed: "+h);let v=La(t.serverSyncTree_,c,!p);Pn(t.eventQueue_,e,v),qa(t,r,h,f)});let u=Sx(t,e);md(t,u),Pn(t.eventQueue_,u,[])}function $Q(t,e,i,n){yd(t,"update",{path:e.toString(),value:i});let r=!0,s=Kf(t),a={};if(Si(i,(o,l)=>{r=!1,a[o]=A2(Mt(e,o),Ft(l),t.serverSyncTree_,s)}),r)Ei("update() called with empty data.  Don't do anything."),qa(t,n,"ok",void 0);else{let o=db(t),l=CQ(t.serverSyncTree_,e,a,o);cb(t.eventQueue_,l),t.server_.merge(e.toString(),i,(c,d)=>{let u=c==="ok";u||Hi("update at "+e+" failed: "+c);let h=La(t.serverSyncTree_,o,!u),f=h.length>0?md(t,e):e;Pn(t.eventQueue_,f,h),qa(t,n,c,d)}),Si(i,c=>{let d=Sx(t,Mt(e,c));md(t,d)}),Pn(t.eventQueue_,e,[])}}function YQ(t){yd(t,"onDisconnectEvents");let e=Kf(t),i=F_();vS(t.onDisconnect_,nt(),(r,s)=>{let a=A2(r,s,t.serverSyncTree_,e);_d(i,r,a)});let n=[];vS(i,nt(),(r,s)=>{n=n.concat(qf(t.serverSyncTree_,r,s));let a=Sx(t,r);md(t,a)}),t.onDisconnect_=F_(),Pn(t.eventQueue_,nt(),n)}function QQ(t,e,i){t.server_.onDisconnectCancel(e.toString(),(n,r)=>{n==="ok"&&bS(t.onDisconnect_,e),qa(t,i,n,r)})}function PL(t,e,i,n){let r=Ft(i);t.server_.onDisconnectPut(e.toString(),r.val(!0),(s,a)=>{s==="ok"&&_d(t.onDisconnect_,e,r),qa(t,n,s,a)})}function XQ(t,e,i,n,r){let s=Ft(i,n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(a,o)=>{a==="ok"&&_d(t.onDisconnect_,e,s),qa(t,r,a,o)})}function ZQ(t,e,i,n){if(pg(i)){Ei("onDisconnect().update() called with empty data.  Don't do anything."),qa(t,n,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),i,(r,s)=>{r==="ok"&&Si(i,(a,o)=>{let l=Ft(o);_d(t.onDisconnect_,Mt(e,a),l)}),qa(t,n,r,s)})}function JQ(t,e,i){let n;Fe(e._path)===".info"?n=MS(t.infoSyncTree_,e,i):n=MS(t.serverSyncTree_,e,i),F2(t.eventQueue_,e._path,n)}function BS(t,e,i){let n;Fe(e._path)===".info"?n=G_(t.infoSyncTree_,e,i):n=G_(t.serverSyncTree_,e,i),F2(t.eventQueue_,e._path,n)}function j2(t){t.persistentConnection_&&t.persistentConnection_.interrupt(B2)}function eX(t){t.persistentConnection_&&t.persistentConnection_.resume(B2)}function yd(t,...e){let i="";t.persistentConnection_&&(i=t.persistentConnection_.id+":"),Ei(i,...e)}function qa(t,e,i,n){e&&gd(()=>{if(i==="ok")e(null);else{let r=(i||"error").toUpperCase(),s=r;n&&(s+=": "+n);let a=new Error(s);a.code=r,e(a)}})}function tX(t,e,i,n,r,s){yd(t,"transaction on "+e);let a={path:e,update:i,onComplete:n,status:null,order:$L(),applyLocally:s,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},o=Ex(t,e,void 0);a.currentInputSnapshot=o;let l=a.update(o.val());if(l===void 0)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{Wf("transaction failed: Data returned ",l,a.path),a.status=0;let c=ab(t.transactionQueueTree_,e),d=xl(c)||[];d.push(a),vx(c,d);let u;typeof l=="object"&&l!==null&&Yn(l,".priority")?(u=wa(l,".priority"),B(Lf(u),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):u=(rb(t.serverSyncTree_,e)||Ae.EMPTY_NODE).getPriority().val();let h=Kf(t),f=Ft(l,u),p=_x(f,o,h);a.currentOutputSnapshotRaw=f,a.currentOutputSnapshotResolved=p,a.currentWriteId=db(t);let v=fx(t.serverSyncTree_,e,p,a.currentWriteId,a.applyLocally);Pn(t.eventQueue_,e,v),ub(t,t.transactionQueueTree_)}}function Ex(t,e,i){return rb(t.serverSyncTree_,e,i)||Ae.EMPTY_NODE}function ub(t,e=t.transactionQueueTree_){if(e||hb(t,e),xl(e)){let i=U2(t,e);B(i.length>0,"Sending zero length transaction queue"),i.every(r=>r.status===0)&&iX(t,Hf(e),i)}else R2(e)&&ob(e,i=>{ub(t,i)})}function iX(t,e,i){let n=i.map(c=>c.currentWriteId),r=Ex(t,e,n),s=r,a=r.hash();for(let c=0;c<i.length;c++){let d=i[c];B(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let u=ln(e,d.path);s=s.updateChild(u,d.currentOutputSnapshotRaw)}let o=s.val(!0),l=e;t.server_.put(l.toString(),o,c=>{yd(t,"transaction put response",{path:l.toString(),status:c});let d=[];if(c==="ok"){let u=[];for(let h=0;h<i.length;h++)i[h].status=2,d=d.concat(La(t.serverSyncTree_,i[h].currentWriteId)),i[h].onComplete&&u.push(()=>i[h].onComplete(null,!0,i[h].currentOutputSnapshotResolved)),i[h].unwatcher();hb(t,ab(t.transactionQueueTree_,e)),ub(t,t.transactionQueueTree_),Pn(t.eventQueue_,e,d);for(let h=0;h<u.length;h++)gd(u[h])}else{if(c==="datastale")for(let u=0;u<i.length;u++)i[u].status===3?i[u].status=4:i[u].status=0;else{Hi("transaction at "+l.toString()+" failed: "+c);for(let u=0;u<i.length;u++)i[u].status=4,i[u].abortReason=c}md(t,e)}},a)}function md(t,e){let i=z2(t,e),n=Hf(i),r=U2(t,i);return nX(t,r,n),n}function nX(t,e,i){if(e.length===0)return;let n=[],r=[],a=e.filter(o=>o.status===0).map(o=>o.currentWriteId);for(let o=0;o<e.length;o++){let l=e[o],c=ln(i,l.path),d=!1,u;if(B(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)d=!0,u=l.abortReason,r=r.concat(La(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=HQ)d=!0,u="maxretry",r=r.concat(La(t.serverSyncTree_,l.currentWriteId,!0));else{let h=Ex(t,l.path,a);l.currentInputSnapshot=h;let f=e[o].update(h.val());if(f!==void 0){Wf("transaction failed: Data returned ",f,l.path);let p=Ft(f);typeof f=="object"&&f!=null&&Yn(f,".priority")||(p=p.updatePriority(h.getPriority()));let E=l.currentWriteId,k=Kf(t),I=_x(p,h,k);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=I,l.currentWriteId=db(t),a.splice(a.indexOf(E),1),r=r.concat(fx(t.serverSyncTree_,l.path,I,l.currentWriteId,l.applyLocally)),r=r.concat(La(t.serverSyncTree_,E,!0))}else d=!0,u="nodata",r=r.concat(La(t.serverSyncTree_,l.currentWriteId,!0))}Pn(t.eventQueue_,i,r),r=[],d&&(e[o].status=2,function(h){setTimeout(h,Math.floor(0))}(e[o].unwatcher),e[o].onComplete&&(u==="nodata"?n.push(()=>e[o].onComplete(null,!1,e[o].currentInputSnapshot)):n.push(()=>e[o].onComplete(new Error(u),!1,null))))}hb(t,t.transactionQueueTree_);for(let o=0;o<n.length;o++)gd(n[o]);ub(t,t.transactionQueueTree_)}function z2(t,e){let i,n=t.transactionQueueTree_;for(i=Fe(e);i!==null&&xl(n)===void 0;)n=ab(n,i),e=gt(e),i=Fe(e);return n}function U2(t,e){let i=[];return q2(t,e,i),i.sort((n,r)=>n.order-r.order),i}function q2(t,e,i){let n=xl(e);if(n)for(let r=0;r<n.length;r++)i.push(n[r]);ob(e,r=>{q2(t,r,i)})}function hb(t,e){let i=xl(e);if(i){let n=0;for(let r=0;r<i.length;r++)i[r].status!==2&&(i[n]=i[r],n++);i.length=n,vx(e,i.length>0?i:void 0)}ob(e,n=>{hb(t,n)})}function Sx(t,e){let i=Hf(z2(t,e)),n=ab(t.transactionQueueTree_,e);return FQ(n,r=>{KE(t,r)}),KE(t,n),M2(n,r=>{KE(t,r)}),i}function KE(t,e){let i=xl(e);if(i){let n=[],r=[],s=-1;for(let a=0;a<i.length;a++)i[a].status===3||(i[a].status===1?(B(s===a-1,"All SENT items should be at beginning of queue."),s=a,i[a].status=3,i[a].abortReason="set"):(B(i[a].status===0,"Unexpected transaction status in abort"),i[a].unwatcher(),r=r.concat(La(t.serverSyncTree_,i[a].currentWriteId,!0)),i[a].onComplete&&n.push(i[a].onComplete.bind(null,new Error("set"),!1,null))));s===-1?vx(e,void 0):i.length=s+1,Pn(t.eventQueue_,Hf(e),r);for(let a=0;a<n.length;a++)gd(n[a])}}function rX(t){let e="",i=t.split("/");for(let n=0;n<i.length;n++)if(i[n].length>0){let r=i[n];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function sX(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let i of t.split("&")){if(i.length===0)continue;let n=i.split("=");n.length===2?e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):Hi(`Invalid query segment '${i}' in query '${t}'`)}return e}var VS=function(t,e){let i=aX(t),n=i.namespace;i.domain==="firebase.com"&&ms(i.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&i.domain!=="localhost"&&ms("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),i.secure||P7();let r=i.scheme==="ws"||i.scheme==="wss";return{repoInfo:new k_(i.host,i.secure,n,r,e,"",n!==i.subdomain),path:new rt(i.pathString)}},aX=function(t){let e="",i="",n="",r="",s="",a=!0,o="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(o=t.substring(0,c-1),t=t.substring(c+2));let d=t.indexOf("/");d===-1&&(d=t.length);let u=t.indexOf("?");u===-1&&(u=t.length),e=t.substring(0,Math.min(d,u)),d<u&&(r=rX(t.substring(d,u)));let h=sX(t.substring(Math.min(t.length,u)));c=e.indexOf(":"),c>=0?(a=o==="https"||o==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")i="localhost";else if(f.split(".").length<=2)i=f;else{let p=e.indexOf(".");n=e.substring(0,p).toLowerCase(),i=e.substring(p+1),s=n}"ns"in h&&(s=h.ns)}return{host:e,port:l,domain:i,subdomain:n,secure:a,scheme:o,pathString:r,namespace:s}};var FL="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",oX=function(){let t=0,e=[];return function(i){let n=i===t;t=i;let r,s=new Array(8);for(r=7;r>=0;r--)s[r]=FL.charAt(i%64),i=Math.floor(i/64);B(i===0,"Cannot push at time == 0");let a=s.join("");if(n){for(r=11;r>=0&&e[r]===63;r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)a+=FL.charAt(e[r]);return B(a.length===20,"nextPushId: Length should be 20."),a}}();var K_=class{constructor(e,i,n,r){this.eventType=e,this.eventRegistration=i,this.snapshot=n,this.prevName=r}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+oi(this.snapshot.exportVal())}},$_=class{constructor(e,i,n){this.eventRegistration=e,this.error=i,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Bf=class{constructor(e,i){this.snapshotCallback=e,this.cancelCallback=i}onValue(e,i){this.snapshotCallback.call(null,e,i)}onCancel(e){return B(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Y_=class{constructor(e,i){this._repo=e,this._path=i}cancel(){let e=new wi;return QQ(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Nn("OnDisconnect.remove",this._path);let e=new wi;return PL(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Nn("OnDisconnect.set",this._path),gs("OnDisconnect.set",e,this._path,!1);let i=new wi;return PL(this._repo,this._path,e,i.wrapCallback(()=>{})),i.promise}setWithPriority(e,i){Nn("OnDisconnect.setWithPriority",this._path),gs("OnDisconnect.setWithPriority",e,this._path,!1),yx("OnDisconnect.setWithPriority",i,!1);let n=new wi;return XQ(this._repo,this._path,e,i,n.wrapCallback(()=>{})),n.promise}update(e){Nn("OnDisconnect.update",this._path),N2("OnDisconnect.update",e,this._path,!1);let i=new wi;return ZQ(this._repo,this._path,e,i.wrapCallback(()=>{})),i.promise}};var dn=class t{constructor(e,i,n,r){this._repo=e,this._path=i,this._queryParams=n,this._orderByCalled=r}get key(){return Le(this._path)?null:ix(this._path)}get ref(){return new Fn(this._repo,this._path)}get _queryIdentifier(){let e=CL(this._queryParams),i=ZS(e);return i==="{}"?"default":i}get _queryObject(){return CL(this._queryParams)}isEqual(e){if(e=We(e),!(e instanceof t))return!1;let i=this._repo===e._repo,n=nx(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return i&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+mY(this._path)}};function fb(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Wa(t){let e=null,i=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(i=t.getIndexEndValue()),t.getIndex()===fs){let n="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ja)throw new Error(n);if(typeof e!="string")throw new Error(r)}if(t.hasEnd()){if(t.getIndexEndName()!==Qs)throw new Error(n);if(typeof i!="string")throw new Error(r)}}else if(t.getIndex()===Ct){if(e!=null&&!Lf(e)||i!=null&&!Lf(i))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(B(t.getIndex()instanceof Df||t.getIndex()===ax,"unknown index type."),e!=null&&typeof e=="object"||i!=null&&typeof i=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function mb(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Fn=class t extends dn{constructor(e,i){super(e,i,new Mf,!1)}get parent(){let e=a2(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},pd=class t{constructor(e,i,n){this._node=e,this.ref=i,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let i=new rt(e),n=Ha(this.ref,e);return new t(this._node.getChild(i),n,Ct)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,r)=>e(new t(r,Ha(this.ref,n),Ct)))}hasChild(e){let i=new rt(e);return!this._node.getChild(i).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function xx(t,e){return t=We(t),t._checkNotDeleted("ref"),e!==void 0?Ha(t._root,e):t._root}function Tx(t,e){t=We(t),t._checkNotDeleted("refFromURL");let i=VS(e,t._repo.repoInfo_.nodeAdmin);P2("refFromURL",i);let n=i.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&n.host!==t._repo.repoInfo_.host&&ms("refFromURL: Host name does not match the current database: (found "+n.host+" but expected "+t._repo.repoInfo_.host+")"),xx(t,i.path.toString())}function Ha(t,e){return t=We(t),Fe(t._path)===null?UQ("child","path",e,!1):vd("child","path",e,!1),new Fn(t._repo,Mt(t._path,e))}function H2(t,e){t=We(t),Nn("push",t._path),gs("push",e,t._path,!0);let i=V2(t._repo),n=oX(i),r=Ha(t,n),s=Ha(t,n),a;return e!=null?a=pb(s,e).then(()=>s):a=Promise.resolve(s),r.then=a.then.bind(a),r.catch=a.then.bind(a,void 0),r}function W2(t){return Nn("remove",t._path),pb(t,null)}function pb(t,e){t=We(t),Nn("set",t._path),gs("set",e,t._path,!1);let i=new wi;return Cx(t._repo,t._path,e,null,i.wrapCallback(()=>{})),i.promise}function G2(t,e){t=We(t),Nn("setPriority",t._path),yx("setPriority",e,!1);let i=new wi;return Cx(t._repo,Mt(t._path,".priority"),e,null,i.wrapCallback(()=>{})),i.promise}function K2(t,e,i){if(Nn("setWithPriority",t._path),gs("setWithPriority",e,t._path,!1),yx("setWithPriority",i,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let n=new wi;return Cx(t._repo,t._path,e,i,n.wrapCallback(()=>{})),n.promise}function $2(t,e){N2("update",e,t._path,!1);let i=new wi;return $Q(t._repo,t._path,e,i.wrapCallback(()=>{})),i.promise}function Y2(t){t=We(t);let e=new Bf(()=>{}),i=new Vf(e);return KQ(t._repo,t,i).then(n=>new pd(n,new Fn(t._repo,t._path),t._queryParams.getIndex()))}var Vf=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,i){let n=i._queryParams.getIndex();return new K_("value",this,new pd(e.snapshotNode,new Fn(i._repo,i._path),n))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,i){return this.callbackContext.hasCancelCallback?new $_(this,e,i):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Q_=class t{constructor(e,i){this.eventType=e,this.callbackContext=i}respondsTo(e){let i=e==="children_added"?"child_added":e;return i=i==="children_removed"?"child_removed":i,this.eventType===i}createCancelEvent(e,i){return this.callbackContext.hasCancelCallback?new $_(this,e,i):null}createEvent(e,i){B(e.childName!=null,"Child events should have a childName.");let n=Ha(new Fn(i._repo,i._path),e.childName),r=i._queryParams.getIndex();return new K_(e.type,this,new pd(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function $f(t,e,i,n,r){let s;if(typeof n=="object"&&(s=void 0,r=n),typeof n=="function"&&(s=n),r&&r.onlyOnce){let l=i,c=(d,u)=>{BS(t._repo,t,o),l(d,u)};c.userCallback=i.userCallback,c.context=i.context,i=c}let a=new Bf(i,s||void 0),o=e==="value"?new Vf(a):new Q_(e,a);return JQ(t._repo,t,o),()=>BS(t._repo,t,o)}function gb(t,e,i,n){return $f(t,"value",e,i,n)}function Ix(t,e,i,n){return $f(t,"child_added",e,i,n)}function Dx(t,e,i,n){return $f(t,"child_changed",e,i,n)}function kx(t,e,i,n){return $f(t,"child_moved",e,i,n)}function Ax(t,e,i,n){return $f(t,"child_removed",e,i,n)}function Rx(t,e,i){let n=null,r=i?new Bf(i):null;e==="value"?n=new Vf(r):e&&(n=new Q_(e,r)),BS(t._repo,t,n)}var Ln=class{},X_=class extends Ln{constructor(e,i){super(),this._value=e,this._key=i,this.type="endAt"}_apply(e){gs("endAt",this._value,e._path,!0);let i=pS(e._queryParams,this._value,this._key);if(mb(i),Wa(i),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new dn(e._repo,e._path,i,e._orderByCalled)}};function Q2(t,e){return Gf("endAt","key",e,!0),new X_(t,e)}var jS=class extends Ln{constructor(e,i){super(),this._value=e,this._key=i,this.type="endBefore"}_apply(e){gs("endBefore",this._value,e._path,!1);let i=OY(e._queryParams,this._value,this._key);if(mb(i),Wa(i),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new dn(e._repo,e._path,i,e._orderByCalled)}};function X2(t,e){return Gf("endBefore","key",e,!0),new jS(t,e)}var Z_=class extends Ln{constructor(e,i){super(),this._value=e,this._key=i,this.type="startAt"}_apply(e){gs("startAt",this._value,e._path,!0);let i=mS(e._queryParams,this._value,this._key);if(mb(i),Wa(i),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new dn(e._repo,e._path,i,e._orderByCalled)}};function Z2(t=null,e){return Gf("startAt","key",e,!0),new Z_(t,e)}var zS=class extends Ln{constructor(e,i){super(),this._value=e,this._key=i,this.type="startAfter"}_apply(e){gs("startAfter",this._value,e._path,!1);let i=MY(e._queryParams,this._value,this._key);if(mb(i),Wa(i),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new dn(e._repo,e._path,i,e._orderByCalled)}};function J2(t,e){return Gf("startAfter","key",e,!0),new zS(t,e)}var US=class extends Ln{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new dn(e._repo,e._path,AY(e._queryParams,this._limit),e._orderByCalled)}};function eB(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new US(t)}var qS=class extends Ln{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new dn(e._repo,e._path,RY(e._queryParams,this._limit),e._orderByCalled)}};function tB(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new qS(t)}var HS=class extends Ln{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){fb(e,"orderByChild");let i=new rt(this._path);if(Le(i))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let n=new Df(i),r=eb(e._queryParams,n);return Wa(r),new dn(e._repo,e._path,r,!0)}};function iB(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return vd("orderByChild","path",t,!1),new HS(t)}var WS=class extends Ln{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){fb(e,"orderByKey");let i=eb(e._queryParams,fs);return Wa(i),new dn(e._repo,e._path,i,!0)}};function nB(){return new WS}var GS=class extends Ln{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){fb(e,"orderByPriority");let i=eb(e._queryParams,Ct);return Wa(i),new dn(e._repo,e._path,i,!0)}};function rB(){return new GS}var KS=class extends Ln{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){fb(e,"orderByValue");let i=eb(e._queryParams,ax);return Wa(i),new dn(e._repo,e._path,i,!0)}};function sB(){return new KS}var $S=class extends Ln{constructor(e,i){super(),this._value=e,this._key=i,this.type="equalTo"}_apply(e){if(gs("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new X_(this._value,this._key)._apply(new Z_(this._value,this._key)._apply(e))}};function aB(t,e){return Gf("equalTo","key",e,!0),new $S(t,e)}function or(t,...e){let i=We(t);for(let n of e)i=n._apply(i);return i}mQ(Fn);vQ(Fn);var lX="FIREBASE_DATABASE_EMULATOR_HOST",YS={},cX=!1;function dX(t,e,i,n){t.repoInfo_=new k_(`${e}:${i}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),n&&(t.authTokenProvider_=n)}function Mx(t,e,i,n,r){let s=n||t.options.databaseURL;s===void 0&&(t.options.projectId||ms("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ei("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a=VS(s,r),o=a.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[lX]),c?(l=!0,s=`http://${c}?ns=${o.namespace}`,a=VS(s,r),o=a.repoInfo):l=!a.repoInfo.secure;let d=r&&l?new wf(wf.OWNER):new tS(t.name,t.options,e);P2("Invalid Firebase Database URL",a),Le(a.path)||ms("Database URL must point to the root of a Firebase Database (not including a child path).");let u=hX(o,t,d,new eS(t.name,i));return new QS(u,t)}function uX(t,e){let i=YS[e];(!i||i[t.key]!==t)&&ms(`Database ${e}(${t.repoInfo_}) has already been deleted.`),j2(t),delete i[t.key]}function hX(t,e,i,n){let r=YS[e.name];r||(r={},YS[e.name]=r);let s=r[t.toURLString()];return s&&ms("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new LS(t,cX,i,n),r[t.toURLString()]=s,s}var QS=class{constructor(e,i){this._repoInternal=e,this.app=i,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(WQ(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Fn(this._repo,nt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(uX(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ms("Cannot call "+e+" on a deleted database.")}};function oB(){s2.IS_TRANSPORT_INITIALIZED&&Hi("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function lB(){oB(),Tf.forceDisallow()}function cB(){oB(),sd.forceDisallow(),Tf.forceAllow()}function dB(t,e,i,n={}){t=We(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&ms("Cannot call useEmulator() after instance has already been initialized.");let r=t._repoInternal,s;if(r.repoInfo_.nodeAdmin)n.mockUserToken&&ms('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new wf(wf.OWNER);else if(n.mockUserToken){let a=typeof n.mockUserToken=="string"?n.mockUserToken:hg(n.mockUserToken,t.app.options.projectId);s=new wf(a)}dX(r,e,i,s)}function uB(t){t=We(t),t._checkNotDeleted("goOffline"),j2(t._repo)}function hB(t){t=We(t),t._checkNotDeleted("goOnline"),eX(t._repo)}function fB(t,e){QL(t,e)}function fX(t){tx(_g),Xo(new Rn("database",(e,{instanceIdentifier:i})=>{let n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Mx(n,r,s,i)},"PUBLIC").setMultipleInstances(!0)),sn(oL,lL,t),sn(oL,lL,"esm2017")}var mX={".sv":"timestamp"};function mB(){return mX}function pB(t){return{".sv":{increment:t}}}var XS=class{constructor(e,i){this.committed=e,this.snapshot=i}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function gB(t,e,i){var n;if(t=We(t),Nn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let r=(n=i?.applyLocally)!==null&&n!==void 0?n:!0,s=new wi,a=(l,c,d)=>{let u=null;l?s.reject(l):(u=new pd(d,new Fn(t._repo,t._path),Ct),s.resolve(new XS(c,u)))},o=gb(t,()=>{});return tX(t._repo,t._path,e,a,o,r),s.promise}rx.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};rx.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Y7(LL.default.Client);fX("node");var pX="@firebase/database-compat",gX="1.0.4";var _X=new Ca("@firebase/database-compat"),_B=function(t){let e="FIREBASE WARNING: "+t;_X.warn(e)};var bX=function(t,e,i,n){if(!(n&&i===void 0)&&typeof i!="boolean")throw new Error(Sn(t,e)+"must be a boolean.")},vX=function(t,e,i){if(!(i&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Sn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var Ox=class{constructor(e){this._delegate=e}cancel(e){we("OnDisconnect.cancel",0,1,arguments.length),bi("OnDisconnect.cancel","onComplete",e,!0);let i=this._delegate.cancel();return e&&i.then(()=>e(null),n=>e(n)),i}remove(e){we("OnDisconnect.remove",0,1,arguments.length),bi("OnDisconnect.remove","onComplete",e,!0);let i=this._delegate.remove();return e&&i.then(()=>e(null),n=>e(n)),i}set(e,i){we("OnDisconnect.set",1,2,arguments.length),bi("OnDisconnect.set","onComplete",i,!0);let n=this._delegate.set(e);return i&&n.then(()=>i(null),r=>i(r)),n}setWithPriority(e,i,n){we("OnDisconnect.setWithPriority",2,3,arguments.length),bi("OnDisconnect.setWithPriority","onComplete",n,!0);let r=this._delegate.setWithPriority(e,i);return n&&r.then(()=>n(null),s=>n(s)),r}update(e,i){if(we("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let r={};for(let s=0;s<e.length;++s)r[""+s]=e[s];e=r,_B("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}bi("OnDisconnect.update","onComplete",i,!0);let n=this._delegate.update(e);return i&&n.then(()=>i(null),r=>i(r)),n}};var Nx=class{constructor(e,i){this.committed=e,this.snapshot=i}toJSON(){return we("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Tl=class t{constructor(e,i){this._database=e,this._delegate=i}val(){return we("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return we("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return we("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return we("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return we("DataSnapshot.child",0,1,arguments.length),e=String(e),vd("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return we("DataSnapshot.hasChild",1,1,arguments.length),vd("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return we("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return we("DataSnapshot.forEach",1,1,arguments.length),bi("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(i=>e(new t(this._database,i)))}hasChildren(){return we("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return we("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return we("DataSnapshot.ref",0,0,arguments.length),new Xs(this._database,this._delegate.ref)}get ref(){return this.getRef()}},_b=class t{constructor(e,i){this.database=e,this._delegate=i}on(e,i,n,r){var s;we("Query.on",2,4,arguments.length),bi("Query.on","callback",i,!1);let a=t.getCancelAndContextArgs_("Query.on",n,r),o=(c,d)=>{i.call(a.context,new Tl(this.database,c),d)};o.userCallback=i,o.context=a.context;let l=(s=a.cancel)===null||s===void 0?void 0:s.bind(a.context);switch(e){case"value":return gb(this._delegate,o,l),i;case"child_added":return Ix(this._delegate,o,l),i;case"child_removed":return Ax(this._delegate,o,l),i;case"child_changed":return Dx(this._delegate,o,l),i;case"child_moved":return kx(this._delegate,o,l),i;default:throw new Error(Sn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,i,n){if(we("Query.off",0,3,arguments.length),vX("Query.off",e,!0),bi("Query.off","callback",i,!0),Dw("Query.off","context",n,!0),i){let r=()=>{};r.userCallback=i,r.context=n,Rx(this._delegate,e,r)}else Rx(this._delegate,e)}get(){return Y2(this._delegate).then(e=>new Tl(this.database,e))}once(e,i,n,r){we("Query.once",1,4,arguments.length),bi("Query.once","callback",i,!0);let s=t.getCancelAndContextArgs_("Query.once",n,r),a=new wi,o=(c,d)=>{let u=new Tl(this.database,c);i&&i.call(s.context,u,d),a.resolve(u)};o.userCallback=i,o.context=s.context;let l=c=>{s.cancel&&s.cancel.call(s.context,c),a.reject(c)};switch(e){case"value":gb(this._delegate,o,l,{onlyOnce:!0});break;case"child_added":Ix(this._delegate,o,l,{onlyOnce:!0});break;case"child_removed":Ax(this._delegate,o,l,{onlyOnce:!0});break;case"child_changed":Dx(this._delegate,o,l,{onlyOnce:!0});break;case"child_moved":kx(this._delegate,o,l,{onlyOnce:!0});break;default:throw new Error(Sn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return a.promise}limitToFirst(e){return we("Query.limitToFirst",1,1,arguments.length),new t(this.database,or(this._delegate,eB(e)))}limitToLast(e){return we("Query.limitToLast",1,1,arguments.length),new t(this.database,or(this._delegate,tB(e)))}orderByChild(e){return we("Query.orderByChild",1,1,arguments.length),new t(this.database,or(this._delegate,iB(e)))}orderByKey(){return we("Query.orderByKey",0,0,arguments.length),new t(this.database,or(this._delegate,nB()))}orderByPriority(){return we("Query.orderByPriority",0,0,arguments.length),new t(this.database,or(this._delegate,rB()))}orderByValue(){return we("Query.orderByValue",0,0,arguments.length),new t(this.database,or(this._delegate,sB()))}startAt(e=null,i){return we("Query.startAt",0,2,arguments.length),new t(this.database,or(this._delegate,Z2(e,i)))}startAfter(e=null,i){return we("Query.startAfter",0,2,arguments.length),new t(this.database,or(this._delegate,J2(e,i)))}endAt(e=null,i){return we("Query.endAt",0,2,arguments.length),new t(this.database,or(this._delegate,Q2(e,i)))}endBefore(e=null,i){return we("Query.endBefore",0,2,arguments.length),new t(this.database,or(this._delegate,X2(e,i)))}equalTo(e,i){return we("Query.equalTo",1,2,arguments.length),new t(this.database,or(this._delegate,aB(e,i)))}toString(){return we("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return we("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(we("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let i="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(i)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,i,n){let r={cancel:void 0,context:void 0};if(i&&n)r.cancel=i,bi(e,"cancel",r.cancel,!0),r.context=n,Dw(e,"context",r.context,!0);else if(i)if(typeof i=="object"&&i!==null)r.context=i;else if(typeof i=="function")r.cancel=i;else throw new Error(Sn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return r}get ref(){return new Xs(this.database,new Fn(this._delegate._repo,this._delegate._path))}},Xs=class t extends _b{constructor(e,i){super(e,new dn(i._repo,i._path,new Mf,!1)),this.database=e,this._delegate=i}getKey(){return we("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return we("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Ha(this._delegate,e))}getParent(){we("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return we("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,i){we("Reference.set",1,2,arguments.length),bi("Reference.set","onComplete",i,!0);let n=pb(this._delegate,e);return i&&n.then(()=>i(null),r=>i(r)),n}update(e,i){if(we("Reference.update",1,2,arguments.length),Array.isArray(e)){let r={};for(let s=0;s<e.length;++s)r[""+s]=e[s];e=r,_B("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Nn("Reference.update",this._delegate._path),bi("Reference.update","onComplete",i,!0);let n=$2(this._delegate,e);return i&&n.then(()=>i(null),r=>i(r)),n}setWithPriority(e,i,n){we("Reference.setWithPriority",2,3,arguments.length),bi("Reference.setWithPriority","onComplete",n,!0);let r=K2(this._delegate,e,i);return n&&r.then(()=>n(null),s=>n(s)),r}remove(e){we("Reference.remove",0,1,arguments.length),bi("Reference.remove","onComplete",e,!0);let i=W2(this._delegate);return e&&i.then(()=>e(null),n=>e(n)),i}transaction(e,i,n){we("Reference.transaction",1,3,arguments.length),bi("Reference.transaction","transactionUpdate",e,!1),bi("Reference.transaction","onComplete",i,!0),bX("Reference.transaction","applyLocally",n,!0);let r=gB(this._delegate,e,{applyLocally:n}).then(s=>new Nx(s.committed,new Tl(this.database,s.snapshot)));return i&&r.then(s=>i(null,s.committed,s.snapshot),s=>i(s,!1,null)),r}setPriority(e,i){we("Reference.setPriority",1,2,arguments.length),bi("Reference.setPriority","onComplete",i,!0);let n=G2(this._delegate,e);return i&&n.then(()=>i(null),r=>i(r)),n}push(e,i){we("Reference.push",0,2,arguments.length),bi("Reference.push","onComplete",i,!0);let n=H2(this._delegate,e),r=n.then(a=>new t(this.database,a));i&&r.then(()=>i(null),a=>i(a));let s=new t(this.database,n);return s.then=r.then.bind(r),s.catch=r.catch.bind(r,void 0),s}onDisconnect(){return Nn("Reference.onDisconnect",this._delegate._path),new Ox(new Y_(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Il=class{constructor(e,i){this._delegate=e,this.app=i,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:lB,forceLongPolling:cB}}useEmulator(e,i,n={}){dB(this._delegate,e,i,n)}ref(e){if(we("database.ref",0,1,arguments.length),e instanceof Xs){let i=Tx(this._delegate,e.toString());return new Xs(this,i)}else{let i=xx(this._delegate,e);return new Xs(this,i)}}refFromURL(e){we("database.refFromURL",1,1,arguments.length);let n=Tx(this._delegate,e);return new Xs(this,n)}goOffline(){return we("database.goOffline",0,0,arguments.length),uB(this._delegate)}goOnline(){return we("database.goOnline",0,0,arguments.length),hB(this._delegate)}};Il.ServerValue={TIMESTAMP:mB(),increment:t=>pB(t)};function yX({app:t,url:e,version:i,customAuthImpl:n,customAppCheckImpl:r,namespace:s,nodeAdmin:a=!1}){tx(i);let o=new kw("database-standalone"),l=new gg("auth-internal",o);l.setComponent(new Rn("auth-internal",()=>n,"PRIVATE"));let c;return r&&(c=new gg("app-check-internal",o),c.setComponent(new Rn("app-check-internal",()=>r,"PRIVATE"))),{instance:new Il(Mx(t,l,c,e,a),t),namespace:s}}var wX=Object.freeze({__proto__:null,initStandalone:yX});var CX=Il.ServerValue;function EX(t){t.INTERNAL.registerComponent(new Rn("database-compat",(e,{instanceIdentifier:i})=>{let n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:i});return new Il(r,n)},"PUBLIC").setServiceProps({Reference:Xs,Query:_b,Database:Il,DataSnapshot:Tl,enableLogging:fB,INTERNAL:wX,ServerValue:CX}).setMultipleInstances(!0)),t.registerVersion(pX,gX,"node")}EX(vi);function Yf(t,e,i="on",n=Cc){return new ni(r=>{let s=null;return s=t[i](e,(a,o)=>{n.schedule(()=>{r.next({snapshot:a,prevKey:o})}),i==="once"&&n.schedule(()=>r.complete())},a=>{n.schedule(()=>r.error(a))}),i==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(Ie(r=>{let{snapshot:s,prevKey:a}=r,o=null;return s.exists()&&(o=s.key),{type:e,payload:s,prevKey:a,key:o}}),tg())}function SX(t){return typeof t=="string"}function xX(t){return typeof t.exportVal=="function"}function CB(t){return t==null}function EB(t){return typeof t.set=="function"}function bB(t,e){return EB(e)?e:t.ref(e)}function SB(t,e){if(SX(t))return e.stringCase();if(EB(t))return e.firebaseCase();if(xX(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function xB(t){return(CB(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function TB(t,e,i){e=xB(e);let n=e.map(r=>Yf(t,r,"on",i));return fi(...n)}function TX(t,e,i){let n=TB(t,e).pipe(Go((r,s)=>[...r,s],[]));return DX(t,n,i)}function IX(t,e){return Yf(t,"value","on",e).pipe(Ie(i=>{let n;return i.payload.forEach(r=>(n=r.key,!1)),{data:i,lastKeyToLoad:n}}))}function DX(t,e,i){return IX(t,i).pipe(hM(e),Ie(([r,s])=>{let a=r.lastKeyToLoad,o=s.map(l=>l.key);return{actions:s,lastKeyToLoad:a,loadedKeys:o}}),uM(r=>r.loadedKeys.indexOf(r.lastKeyToLoad)===-1),Ie(r=>r.actions))}function vB(t,e){return function(n,r){return SB(n,{stringCase:()=>t.child(n)[e](r),firebaseCase:()=>n[e](r),snapshotCase:()=>n.ref[e](r)})}}function kX(t){return function(i){return i?SB(i,{stringCase:()=>t.child(i).remove(),firebaseCase:()=>i.remove(),snapshotCase:()=>i.ref.remove()}):t.remove()}}function AX(t,e,i){return Yf(t,"value","once",i).pipe(pi(n=>{let r=[et(n)];return e.forEach(s=>r.push(Yf(t,s,"on",i))),fi(...r).pipe(Go(MX,[]))}),Sr())}function IB(t,e){let i=t.length;for(let n=0;n<i;n++)if(t[n].payload.key===e)return n;return-1}function RX(t,e){if(CB(e))return 0;{let i=IB(t,e);return i===-1?t.length:i+1}}function MX(t,e){let{payload:i,prevKey:n,key:r}=e,s=IB(t,r),a=RX(t,n);switch(e.type){case"value":if(e.payload?.exists()){let o=null;e.payload.forEach(l=>{let c={payload:l,type:"value",prevKey:o,key:l.key};return o=l.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==n&&(t=t.filter(l=>l.payload.key!==i.key),t.splice(a,0,e));else{if(n==null)return[e,...t];t=t.slice(),t.splice(a,0,e)}return t;case"child_removed":return t.filter(o=>o.payload.key!==i.key);case"child_changed":return t.map(o=>o.payload.key===r?e:o);case"child_moved":if(s>-1){let o=t.splice(s,1)[0];return t=t.slice(),t.splice(a,0,o),t}return t;default:return t}}function yB(t,e,i){return e=xB(e),AX(t,e,i)}function OX(t,e){let i=e.schedulers.outsideAngular,n=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:vB(n,"update"),set:vB(n,"set"),push:r=>n.push(r),remove:kX(n),snapshotChanges(r){return yB(t,r,i).pipe(Yt)},stateChanges(r){return TB(t,r,i).pipe(Yt)},auditTrail(r){return TX(t,r,i).pipe(Yt)},valueChanges(r,s){return yB(t,r,i).pipe(Ie(o=>o.map(l=>s&&s.idField?tn(Me({},l.payload.val()),{[s.idField]:l.key}):l.payload.val())),Yt)}}}function wB(t,e){return function(){return Yf(t,"value","on",e)}}function NX(t,e){return{query:t,snapshotChanges(){return wB(t,e.schedulers.outsideAngular)().pipe(Yt)},update(i){return t.ref.update(i)},set(i){return t.ref.set(i)},remove(){return t.ref.remove()},valueChanges(){return wB(t,e.schedulers.outsideAngular)().pipe(Yt,Ie(n=>n.payload.exists()?n.payload.val():null))}}}var PX=new K("angularfire2.realtimeDatabaseURL"),FX=new K("angularfire2.database.use-emulator"),LX=(()=>{class t{schedulers;database;constructor(i,n,r,s,a,o,l,c,d,u,h,f,p,v,E){this.schedulers=o;let k=l,I=cl(i,a,n);c&&sf(I,a,d,h,f,p,u,v),this.database=Jc(`${I.name}.database.${r}`,"AngularFireDatabase",I.name,()=>{let P=a.runOutsideAngular(()=>I.database(r||void 0));return k&&P.useEmulator(...k),P},[k])}list(i,n){let r=this.schedulers.ngZone.runOutsideAngular(()=>bB(this.database,i)),s=r;return n&&(s=n(r)),OX(s,this)}object(i){let n=this.schedulers.ngZone.runOutsideAngular(()=>bB(this.database,i));return NX(n,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(n){return new(n||t)(C(Oa),C(Na,8),C(PX,8),C(nn),C(re),C(ll),C(FX,8),C(dl,8),C(Zh,8),C(Jh,8),C(ef,8),C(tf,8),C(nf,8),C(rf,8),C(Ys,8))};static \u0275prov=ee({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),DB=(()=>{class t{constructor(){vi.registerVersion("angularfire",rr.full,"rtdb-compat")}static \u0275fac=function(n){return new(n||t)};static \u0275mod=X({type:t});static \u0275inj=Q({providers:[LX]})}return t})();import{inspect as $ae,TextEncoder as Yae,TextDecoder as Qae}from"util";import{randomBytes as Xae}from"crypto";var BX=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Nr={},q,iT=iT||{},Te=BX||self;function Rb(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function cm(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function VX(t){return Object.prototype.hasOwnProperty.call(t,Px)&&t[Px]||(t[Px]=++jX)}var Px="closure_uid_"+(1e9*Math.random()>>>0),jX=0;function zX(t,e,i){return t.call.apply(t.bind,arguments)}function UX(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function Wi(t,e,i){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Wi=zX:Wi=UX,Wi.apply(null,arguments)}function bb(t,e){var i=Array.prototype.slice.call(arguments,1);return function(){var n=i.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function Ti(t,e){function i(){}i.prototype=e.prototype,t.$=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.ac=function(n,r,s){for(var a=Array(arguments.length-2),o=2;o<arguments.length;o++)a[o-2]=arguments[o];return e.prototype[r].apply(n,a)}}function Ga(){this.s=this.s,this.o=this.o}var qX=0;Ga.prototype.s=!1;Ga.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),qX!=0)&&VX(this)};Ga.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var zB=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let i=0;i<t.length;i++)if(i in t&&t[i]===e)return i;return-1};function nT(t){let e=t.length;if(0<e){let i=Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}return[]}function kB(t,e){for(let i=1;i<arguments.length;i++){let n=arguments[i];if(Rb(n)){let r=t.length||0,s=n.length||0;t.length=r+s;for(let a=0;a<s;a++)t[r+a]=n[a]}else t.push(n)}}function Gi(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Gi.prototype.h=function(){this.defaultPrevented=!0};var HX=function(){if(!Te.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let i=()=>{};Te.addEventListener("test",i,e),Te.removeEventListener("test",i,e)}catch{}return t}();function tm(t){return/^[\s\xa0]*$/.test(t)}function Mb(){var t=Te.navigator;return t&&(t=t.userAgent)?t:""}function _s(t){return Mb().indexOf(t)!=-1}function rT(t){return rT[" "](t),t}rT[" "]=function(){};function WX(t,e){var i=OZ;return Object.prototype.hasOwnProperty.call(i,t)?i[t]:i[t]=e(t)}var GX=_s("Opera"),Sd=_s("Trident")||_s("MSIE"),UB=_s("Edge"),jx=UB||Sd,qB=_s("Gecko")&&!(Mb().toLowerCase().indexOf("webkit")!=-1&&!_s("Edge"))&&!(_s("Trident")||_s("MSIE"))&&!_s("Edge"),KX=Mb().toLowerCase().indexOf("webkit")!=-1&&!_s("Edge");function HB(){var t=Te.document;return t?t.documentMode:void 0}var zx;e:{if(vb="",yb=function(){var t=Mb();if(qB)return/rv:([^\);]+)(\)|;)/.exec(t);if(UB)return/Edge\/([\d\.]+)/.exec(t);if(Sd)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(KX)return/WebKit\/(\S+)/.exec(t);if(GX)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),yb&&(vb=yb?yb[1]:""),Sd&&(wb=HB(),wb!=null&&wb>parseFloat(vb))){zx=String(wb);break e}zx=vb}var vb,yb,wb,Ux;Te.document&&Sd?(Fx=HB(),Ux=Fx||parseInt(zx,10)||void 0):Ux=void 0;var Fx,$X=Ux;function im(t,e){if(Gi.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var i=this.type=t.type,n=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(qB){e:{try{rT(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else i=="mouseover"?e=t.fromElement:i=="mouseout"&&(e=t.toElement);this.relatedTarget=e,n?(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:YX[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&im.$.h.call(this)}}Ti(im,Gi);var YX={2:"touch",3:"pen",4:"mouse"};im.prototype.h=function(){im.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var dm="closure_listenable_"+(1e6*Math.random()|0),QX=0;function XX(t,e,i,n,r){this.listener=t,this.proxy=null,this.src=e,this.type=i,this.capture=!!n,this.la=r,this.key=++QX,this.fa=this.ia=!1}function Ob(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function sT(t,e,i){for(let n in t)e.call(i,t[n],n,t)}function ZX(t,e){for(let i in t)e.call(void 0,t[i],i,t)}function WB(t){let e={};for(let i in t)e[i]=t[i];return e}var AB="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function GB(t,e){let i,n;for(let r=1;r<arguments.length;r++){n=arguments[r];for(i in n)t[i]=n[i];for(let s=0;s<AB.length;s++)i=AB[s],Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}}function Nb(t){this.src=t,this.g={},this.h=0}Nb.prototype.add=function(t,e,i,n,r){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var a=Hx(t,e,n,r);return-1<a?(e=t[a],i||(e.ia=!1)):(e=new XX(e,this.src,s,!!n,r),e.ia=i,t.push(e)),e};function qx(t,e){var i=e.type;if(i in t.g){var n=t.g[i],r=zB(n,e),s;(s=0<=r)&&Array.prototype.splice.call(n,r,1),s&&(Ob(e),t.g[i].length==0&&(delete t.g[i],t.h--))}}function Hx(t,e,i,n){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!i&&s.la==n)return r}return-1}var aT="closure_lm_"+(1e6*Math.random()|0),Lx={};function KB(t,e,i,n,r){if(n&&n.once)return YB(t,e,i,n,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)KB(t,e[s],i,n,r);return null}return i=cT(i),t&&t[dm]?t.O(e,i,cm(n)?!!n.capture:!!n,r):$B(t,e,i,!1,n,r)}function $B(t,e,i,n,r,s){if(!e)throw Error("Invalid event type");var a=cm(r)?!!r.capture:!!r,o=lT(t);if(o||(t[aT]=o=new Nb(t)),i=o.add(e,i,n,a,s),i.proxy)return i;if(n=JX(),i.proxy=n,n.src=t,n.listener=i,t.addEventListener)HX||(r=a),r===void 0&&(r=!1),t.addEventListener(e.toString(),n,r);else if(t.attachEvent)t.attachEvent(XB(e.toString()),n);else if(t.addListener&&t.removeListener)t.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return i}function JX(){function t(i){return e.call(t.src,t.listener,i)}let e=eZ;return t}function YB(t,e,i,n,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)YB(t,e[s],i,n,r);return null}return i=cT(i),t&&t[dm]?t.P(e,i,cm(n)?!!n.capture:!!n,r):$B(t,e,i,!0,n,r)}function QB(t,e,i,n,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)QB(t,e[s],i,n,r);else n=cm(n)?!!n.capture:!!n,i=cT(i),t&&t[dm]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],i=Hx(s,i,n,r),-1<i&&(Ob(s[i]),Array.prototype.splice.call(s,i,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=lT(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Hx(e,i,n,r)),(i=-1<t?e[t]:null)&&oT(i))}function oT(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[dm])qx(e.i,t);else{var i=t.type,n=t.proxy;e.removeEventListener?e.removeEventListener(i,n,t.capture):e.detachEvent?e.detachEvent(XB(i),n):e.addListener&&e.removeListener&&e.removeListener(n),(i=lT(e))?(qx(i,t),i.h==0&&(i.src=null,e[aT]=null)):Ob(t)}}}function XB(t){return t in Lx?Lx[t]:Lx[t]="on"+t}function eZ(t,e){if(t.fa)t=!0;else{e=new im(e,this);var i=t.listener,n=t.la||t.src;t.ia&&oT(t),t=i.call(n,e)}return t}function lT(t){return t=t[aT],t instanceof Nb?t:null}var Bx="__closure_events_fn_"+(1e9*Math.random()>>>0);function cT(t){return typeof t=="function"?t:(t[Bx]||(t[Bx]=function(e){return t.handleEvent(e)}),t[Bx])}function xi(){Ga.call(this),this.i=new Nb(this),this.S=this,this.J=null}Ti(xi,Ga);xi.prototype[dm]=!0;xi.prototype.removeEventListener=function(t,e,i,n){QB(this,t,e,i,n)};function Li(t,e){var i,n=t.J;if(n)for(i=[];n;n=n.J)i.push(n);if(t=t.S,n=e.type||e,typeof e=="string")e=new Gi(e,t);else if(e instanceof Gi)e.target=e.target||t;else{var r=e;e=new Gi(n,t),GB(e,r)}if(r=!0,i)for(var s=i.length-1;0<=s;s--){var a=e.g=i[s];r=Cb(a,n,!0,e)&&r}if(a=e.g=t,r=Cb(a,n,!0,e)&&r,r=Cb(a,n,!1,e)&&r,i)for(s=0;s<i.length;s++)a=e.g=i[s],r=Cb(a,n,!1,e)&&r}xi.prototype.N=function(){if(xi.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var i=t.g[e],n=0;n<i.length;n++)Ob(i[n]);delete t.g[e],t.h--}}this.J=null};xi.prototype.O=function(t,e,i,n){return this.i.add(String(t),e,!1,i,n)};xi.prototype.P=function(t,e,i,n){return this.i.add(String(t),e,!0,i,n)};function Cb(t,e,i,n){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==i){var o=a.listener,l=a.la||a.src;a.ia&&qx(t.i,a),r=o.call(l,n)!==!1&&r}}return r&&!n.defaultPrevented}var dT=Te.JSON.stringify,Wx=class{constructor(e,i){this.i=e,this.j=i,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function tZ(){var t=uT;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Gx=class{constructor(){this.h=this.g=null}add(e,i){let n=ZB.get();n.set(e,i),this.h?this.h.next=n:this.g=n,this.h=n}},ZB=new Wx(()=>new Kx,t=>t.reset()),Kx=class{constructor(){this.next=this.g=this.h=null}set(e,i){this.h=e,this.g=i,this.next=null}reset(){this.next=this.g=this.h=null}};function iZ(t){var e=1;t=t.split(":");let i=[];for(;0<e&&t.length;)i.push(t.shift()),e--;return t.length&&i.push(t.join(":")),i}function nZ(t){Te.setTimeout(()=>{throw t},0)}var nm,rm=!1,uT=new Gx,JB=()=>{let t=Te.Promise.resolve(void 0);nm=()=>{t.then(rZ)}},rZ=()=>{for(var t;t=tZ();){try{t.h.call(t.g)}catch(i){nZ(i)}var e=ZB;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}rm=!1};function Pb(t,e){xi.call(this),this.h=t||1,this.g=e||Te,this.j=Wi(this.qb,this),this.l=Date.now()}Ti(Pb,xi);q=Pb.prototype;q.ga=!1;q.T=null;q.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Li(this,"tick"),this.ga&&(hT(this),this.start()))}};q.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function hT(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}q.N=function(){Pb.$.N.call(this),hT(this),delete this.g};function fT(t,e,i){if(typeof t=="function")i&&(t=Wi(t,i));else if(t&&typeof t.handleEvent=="function")t=Wi(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Te.setTimeout(t,e||0)}function eV(t){t.g=fT(()=>{t.g=null,t.i&&(t.i=!1,eV(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var $x=class extends Ga{constructor(e,i){super(),this.m=e,this.j=i,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:eV(this)}N(){super.N(),this.g&&(Te.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function sm(t){Ga.call(this),this.h=t,this.g={}}Ti(sm,Ga);var RB=[];function tV(t,e,i,n){Array.isArray(i)||(i&&(RB[0]=i.toString()),i=RB);for(var r=0;r<i.length;r++){var s=KB(e,i[r],n||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function iV(t){sT(t.g,function(e,i){this.g.hasOwnProperty(i)&&oT(e)},t),t.g={}}sm.prototype.N=function(){sm.$.N.call(this),iV(this)};sm.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Fb(){this.g=!0}Fb.prototype.Ea=function(){this.g=!1};function sZ(t,e,i,n,r,s){t.info(function(){if(t.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");a=2<=u.length&&u[1]=="type"?a+(d+"="+c+"&"):a+(d+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+n+") [attempt "+r+"]: "+e+`
`+i+`
`+a})}function aZ(t,e,i,n,r,s,a){t.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+r+"]: "+e+`
`+i+`
`+s+" "+a})}function Cd(t,e,i,n){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+lZ(t,i)+(n?" "+n:"")})}function oZ(t,e){t.info(function(){return"TIMEOUT: "+e})}Fb.prototype.info=function(){};function lZ(t,e){if(!t.g)return e;if(!e)return null;try{var i=JSON.parse(e);if(i){for(t=0;t<i.length;t++)if(Array.isArray(i[t])){var n=i[t];if(!(2>n.length)){var r=n[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<r.length;a++)r[a]=""}}}}return dT(i)}catch{return e}}var Rl={},MB=null;function Lb(){return MB=MB||new xi}Rl.Ta="serverreachability";function nV(t){Gi.call(this,Rl.Ta,t)}Ti(nV,Gi);function am(t){let e=Lb();Li(e,new nV(e))}Rl.STAT_EVENT="statevent";function rV(t,e){Gi.call(this,Rl.STAT_EVENT,t),this.stat=e}Ti(rV,Gi);function un(t){let e=Lb();Li(e,new rV(e,t))}Rl.Ua="timingevent";function sV(t,e){Gi.call(this,Rl.Ua,t),this.size=e}Ti(sV,Gi);function um(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Te.setTimeout(function(){t()},e)}var Bb={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},aV={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function mT(){}mT.prototype.h=null;function OB(t){return t.h||(t.h=t.i())}function oV(){}var hm={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function pT(){Gi.call(this,"d")}Ti(pT,Gi);function gT(){Gi.call(this,"c")}Ti(gT,Gi);var Yx;function Vb(){}Ti(Vb,mT);Vb.prototype.g=function(){return new XMLHttpRequest};Vb.prototype.i=function(){return{}};Yx=new Vb;function fm(t,e,i,n){this.l=t,this.j=e,this.m=i,this.W=n||1,this.U=new sm(this),this.P=cZ,t=jx?125:void 0,this.V=new Pb(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new lV}function lV(){this.i=null,this.g="",this.h=!1}var cZ=45e3,cV={},Qx={};q=fm.prototype;q.setTimeout=function(t){this.P=t};function Xx(t,e,i){t.L=1,t.A=zb(Js(e)),t.u=i,t.S=!0,dV(t,null)}function dV(t,e){t.G=Date.now(),mm(t),t.B=Js(t.A);var i=t.B,n=t.W;Array.isArray(n)||(n=[String(n)]),bV(i.i,"t",n),t.o=0,i=t.l.J,t.h=new lV,t.g=VV(t.l,i?e:null,!t.u),0<t.O&&(t.M=new $x(Wi(t.Pa,t,t.g),t.O)),tV(t.U,t.g,"readystatechange",t.nb),e=t.I?WB(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),am(),sZ(t.j,t.v,t.B,t.m,t.W,t.u)}q.nb=function(t){t=t.target;let e=this.M;e&&bs(t)==3?e.l():this.Pa(t)};q.Pa=function(t){try{if(t==this.g)e:{let d=bs(this.g);var e=this.g.Ia();let u=this.g.da();if(!(3>d)&&(d!=3||jx||this.g&&(this.h.h||this.g.ja()||LB(this.g)))){this.J||d!=4||e==7||(e==8||0>=u?am(3):am(2)),jb(this);var i=this.g.da();this.ca=i;t:if(uV(this)){var n=LB(this.g);t="";var r=n.length,s=bs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Dl(this),em(this);var a="";break t}this.h.i=new Te.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(n[e],{stream:s&&e==r-1});n.length=0,this.h.g+=t,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=i==200,aZ(this.j,this.v,this.B,this.m,this.W,d,i),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,l=this.g;if((o=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!tm(o)){var c=o;break t}}c=null}if(i=c)Cd(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Zx(this,i);else{this.i=!1,this.s=3,un(12),Dl(this),em(this);break e}}this.S?(hV(this,d,a),jx&&this.i&&d==3&&(tV(this.U,this.V,"tick",this.mb),this.V.start())):(Cd(this.j,this.m,a,null),Zx(this,a)),d==4&&Dl(this),this.i&&!this.J&&(d==4?PV(this.l,this):(this.i=!1,mm(this)))}else AZ(this.g),i==400&&0<a.indexOf("Unknown SID")?(this.s=3,un(12)):(this.s=0,un(13)),Dl(this),em(this)}}}catch{}finally{}};function uV(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function hV(t,e,i){let n=!0,r;for(;!t.J&&t.o<i.length;)if(r=dZ(t,i),r==Qx){e==4&&(t.s=4,un(14),n=!1),Cd(t.j,t.m,null,"[Incomplete Response]");break}else if(r==cV){t.s=4,un(15),Cd(t.j,t.m,i,"[Invalid Chunk]"),n=!1;break}else Cd(t.j,t.m,r,null),Zx(t,r);uV(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||i.length!=0||t.h.h||(t.s=1,un(16),n=!1),t.i=t.i&&n,n?0<i.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+i.length),CT(e),e.M=!0,un(11))):(Cd(t.j,t.m,i,"[Invalid Chunked Response]"),Dl(t),em(t))}q.mb=function(){if(this.g){var t=bs(this.g),e=this.g.ja();this.o<e.length&&(jb(this),hV(this,t,e),this.i&&t!=4&&mm(this))}};function dZ(t,e){var i=t.o,n=e.indexOf(`
`,i);return n==-1?Qx:(i=Number(e.substring(i,n)),isNaN(i)?cV:(n+=1,n+i>e.length?Qx:(e=e.slice(n,n+i),t.o=n+i,e)))}q.cancel=function(){this.J=!0,Dl(this)};function mm(t){t.Y=Date.now()+t.P,fV(t,t.P)}function fV(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=um(Wi(t.lb,t),e)}function jb(t){t.C&&(Te.clearTimeout(t.C),t.C=null)}q.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(oZ(this.j,this.B),this.L!=2&&(am(),un(17)),Dl(this),this.s=2,em(this)):fV(this,this.Y-t)};function em(t){t.l.H==0||t.J||PV(t.l,t)}function Dl(t){jb(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,hT(t.V),iV(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Zx(t,e){try{var i=t.l;if(i.H!=0&&(i.g==t||Jx(i.i,t))){if(!t.K&&Jx(i.i,t)&&i.H==3){try{var n=i.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&n.length==3){var r=n;if(r[0]==0){e:if(!i.u){if(i.g)if(i.g.G+3e3<t.G)Ib(i),Hb(i);else break e;wT(i),un(18)}}else i.Fa=r[1],0<i.Fa-i.V&&37500>r[2]&&i.G&&i.A==0&&!i.v&&(i.v=um(Wi(i.ib,i),6e3));if(1>=wV(i.i)&&i.oa){try{i.oa()}catch{}i.oa=void 0}}else kl(i,11)}else if((t.K||i.g==t)&&Ib(i),!tm(e))for(r=i.Ja.g.parse(e),e=0;e<r.length;e++){let c=r[e];if(i.V=c[0],c=c[1],i.H==2)if(c[0]=="c"){i.K=c[1],i.pa=c[2];let d=c[3];d!=null&&(i.ra=d,i.l.info("VER="+i.ra));let u=c[4];u!=null&&(i.Ga=u,i.l.info("SVER="+i.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(n=1.5*h,i.L=n,i.l.info("backChannelRequestTimeoutMs_="+n)),n=i;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=n.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(_T(s,s.h),s.h=null))}if(n.F){let v=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(n.Da=v,It(n.I,n.F,v))}}i.H=3,i.h&&i.h.Ba(),i.ca&&(i.S=Date.now()-t.G,i.l.info("Handshake RTT: "+i.S+"ms")),n=i;var a=t;if(n.wa=BV(n,n.J?n.pa:null,n.Y),a.K){CV(n.i,a);var o=a,l=n.L;l&&o.setTimeout(l),o.C&&(jb(o),mm(o)),n.g=a}else OV(n);0<i.j.length&&Wb(i)}else c[0]!="stop"&&c[0]!="close"||kl(i,7);else i.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?kl(i,7):yT(i):c[0]!="noop"&&i.h&&i.h.Aa(c),i.A=0)}}am(4)}catch{}}function uZ(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Rb(t)){for(var e=[],i=t.length,n=0;n<i;n++)e.push(t[n]);return e}e=[],i=0;for(n in t)e[i++]=t[n];return e}function hZ(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Rb(t)||typeof t=="string"){var e=[];t=t.length;for(var i=0;i<t;i++)e.push(i);return e}e=[],i=0;for(let n in t)e[i++]=n;return e}}}function mV(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Rb(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var i=hZ(t),n=uZ(t),r=n.length,s=0;s<r;s++)e.call(void 0,n[s],i&&i[s],t)}var pV=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fZ(t,e){if(t){t=t.split("&");for(var i=0;i<t.length;i++){var n=t[i].indexOf("="),r=null;if(0<=n){var s=t[i].substring(0,n);r=t[i].substring(n+1)}else s=t[i];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function Al(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Al){this.h=t.h,xb(this,t.j),this.s=t.s,this.g=t.g,Tb(this,t.m),this.l=t.l;var e=t.i,i=new om;i.i=e.i,e.g&&(i.g=new Map(e.g),i.h=e.h),NB(this,i),this.o=t.o}else t&&(e=String(t).match(pV))?(this.h=!1,xb(this,e[1]||"",!0),this.s=Zf(e[2]||""),this.g=Zf(e[3]||"",!0),Tb(this,e[4]),this.l=Zf(e[5]||"",!0),NB(this,e[6]||"",!0),this.o=Zf(e[7]||"")):(this.h=!1,this.i=new om(null,this.h))}Al.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Jf(e,PB,!0),":");var i=this.g;return(i||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Jf(e,PB,!0),"@"),t.push(encodeURIComponent(String(i)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i=this.m,i!=null&&t.push(":",String(i))),(i=this.l)&&(this.g&&i.charAt(0)!="/"&&t.push("/"),t.push(Jf(i,i.charAt(0)=="/"?gZ:pZ,!0))),(i=this.i.toString())&&t.push("?",i),(i=this.o)&&t.push("#",Jf(i,bZ)),t.join("")};function Js(t){return new Al(t)}function xb(t,e,i){t.j=i?Zf(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Tb(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function NB(t,e,i){e instanceof om?(t.i=e,vZ(t.i,t.h)):(i||(e=Jf(e,_Z)),t.i=new om(e,t.h))}function It(t,e,i){t.i.set(e,i)}function zb(t){return It(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Zf(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Jf(t,e,i){return typeof t=="string"?(t=encodeURI(t).replace(e,mZ),i&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function mZ(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var PB=/[#\/\?@]/g,pZ=/[#\?:]/g,gZ=/[#\?]/g,_Z=/[#\?@]/g,bZ=/#/g;function om(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ka(t){t.g||(t.g=new Map,t.h=0,t.i&&fZ(t.i,function(e,i){t.add(decodeURIComponent(e.replace(/\+/g," ")),i)}))}q=om.prototype;q.add=function(t,e){Ka(this),this.i=null,t=xd(this,t);var i=this.g.get(t);return i||this.g.set(t,i=[]),i.push(e),this.h+=1,this};function gV(t,e){Ka(t),e=xd(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function _V(t,e){return Ka(t),e=xd(t,e),t.g.has(e)}q.forEach=function(t,e){Ka(this),this.g.forEach(function(i,n){i.forEach(function(r){t.call(e,r,n,this)},this)},this)};q.ta=function(){Ka(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),i=[];for(let n=0;n<e.length;n++){let r=t[n];for(let s=0;s<r.length;s++)i.push(e[n])}return i};q.Z=function(t){Ka(this);let e=[];if(typeof t=="string")_V(this,t)&&(e=e.concat(this.g.get(xd(this,t))));else{t=Array.from(this.g.values());for(let i=0;i<t.length;i++)e=e.concat(t[i])}return e};q.set=function(t,e){return Ka(this),this.i=null,t=xd(this,t),_V(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};q.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function bV(t,e,i){gV(t,e),0<i.length&&(t.i=null,t.g.set(xd(t,e),nT(i)),t.h+=i.length)}q.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var i=0;i<e.length;i++){var n=e[i];let s=encodeURIComponent(String(n)),a=this.Z(n);for(n=0;n<a.length;n++){var r=s;a[n]!==""&&(r+="="+encodeURIComponent(String(a[n]))),t.push(r)}}return this.i=t.join("&")};function xd(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function vZ(t,e){e&&!t.j&&(Ka(t),t.i=null,t.g.forEach(function(i,n){var r=n.toLowerCase();n!=r&&(gV(this,n),bV(this,r,i))},t)),t.j=e}var yZ=class{constructor(t,e){this.g=t,this.map=e}};function vV(t){this.l=t||wZ,Te.PerformanceNavigationTiming?(t=Te.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Te.g&&Te.g.Ka&&Te.g.Ka()&&Te.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var wZ=10;function yV(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function wV(t){return t.h?1:t.g?t.g.size:0}function Jx(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function _T(t,e){t.g?t.g.add(e):t.h=e}function CV(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}vV.prototype.cancel=function(){if(this.i=EV(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function EV(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let i of t.g.values())e=e.concat(i.F);return e}return nT(t.i)}var CZ=class{stringify(t){return Te.JSON.stringify(t,void 0)}parse(t){return Te.JSON.parse(t,void 0)}};function EZ(){this.g=new CZ}function SZ(t,e,i){let n=i||"";try{mV(t,function(r,s){let a=r;cm(r)&&(a=dT(r)),e.push(n+s+"="+encodeURIComponent(a))})}catch(r){throw e.push(n+"type="+encodeURIComponent("_badmap")),r}}function xZ(t,e){let i=new Fb;if(Te.Image){let n=new Image;n.onload=bb(Eb,i,n,"TestLoadImage: loaded",!0,e),n.onerror=bb(Eb,i,n,"TestLoadImage: error",!1,e),n.onabort=bb(Eb,i,n,"TestLoadImage: abort",!1,e),n.ontimeout=bb(Eb,i,n,"TestLoadImage: timeout",!1,e),Te.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=t}else e(!1)}function Eb(t,e,i,n,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(n)}catch{}}function pm(t){this.l=t.ec||null,this.j=t.ob||!1}Ti(pm,mT);pm.prototype.g=function(){return new Ub(this.l,this.j)};pm.prototype.i=function(t){return function(){return t}}({});function Ub(t,e){xi.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=bT,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ti(Ub,xi);var bT=0;q=Ub.prototype;q.open=function(t,e){if(this.readyState!=bT)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,lm(this)};q.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Te).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};q.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gm(this)),this.readyState=bT};q.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,lm(this)),this.g&&(this.readyState=3,lm(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Te.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;SV(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function SV(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}q.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?gm(this):lm(this),this.readyState==3&&SV(this)}};q.Za=function(t){this.g&&(this.response=this.responseText=t,gm(this))};q.Ya=function(t){this.g&&(this.response=t,gm(this))};q.ka=function(){this.g&&gm(this)};function gm(t){t.readyState=4,t.l=null,t.j=null,t.A=null,lm(t)}q.setRequestHeader=function(t,e){this.v.append(t,e)};q.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};q.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var i=e.next();!i.done;)i=i.value,t.push(i[0]+": "+i[1]),i=e.next();return t.join(`\r
`)};function lm(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Ub.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var TZ=Te.JSON.parse;function Ut(t){xi.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=xV,this.L=this.M=!1}Ti(Ut,xi);var xV="",IZ=/^https?$/i,DZ=["POST","PUT"];q=Ut.prototype;q.Oa=function(t){this.M=t};q.ha=function(t,e,i,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Yx.g(),this.C=this.u?OB(this.u):OB(Yx),this.g.onreadystatechange=Wi(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){FB(this,s);return}if(t=i||"",i=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var r in n)i.set(r,n[r]);else if(typeof n.keys=="function"&&typeof n.get=="function")for(let s of n.keys())i.set(s,n.get(s));else throw Error("Unknown input type for opt_headers: "+String(n));n=Array.from(i.keys()).find(s=>s.toLowerCase()=="content-type"),r=Te.FormData&&t instanceof Te.FormData,!(0<=zB(DZ,e))||n||r||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,a]of i)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{DV(this),0<this.B&&((this.L=kZ(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Wi(this.ua,this)):this.A=fT(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){FB(this,s)}};function kZ(t){return Sd&&typeof t.timeout=="number"&&t.ontimeout!==void 0}q.ua=function(){typeof iT<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Li(this,"timeout"),this.abort(8))};function FB(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,TV(t),qb(t)}function TV(t){t.F||(t.F=!0,Li(t,"complete"),Li(t,"error"))}q.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Li(this,"complete"),Li(this,"abort"),qb(this))};q.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),qb(this,!0)),Ut.$.N.call(this)};q.La=function(){this.s||(this.G||this.v||this.l?IV(this):this.kb())};q.kb=function(){IV(this)};function IV(t){if(t.h&&typeof iT<"u"&&(!t.C[1]||bs(t)!=4||t.da()!=2)){if(t.v&&bs(t)==4)fT(t.La,0,t);else if(Li(t,"readystatechange"),bs(t)==4){t.h=!1;try{let a=t.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var i;if(!(i=e)){var n;if(n=a===0){var r=String(t.I).match(pV)[1]||null;!r&&Te.self&&Te.self.location&&(r=Te.self.location.protocol.slice(0,-1)),n=!IZ.test(r?r.toLowerCase():"")}i=n}if(i)Li(t,"complete"),Li(t,"success");else{t.m=6;try{var s=2<bs(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",TV(t)}}finally{qb(t)}}}}function qb(t,e){if(t.g){DV(t);let i=t.g,n=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Li(t,"ready");try{i.onreadystatechange=n}catch{}}}function DV(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Te.clearTimeout(t.A),t.A=null)}q.isActive=function(){return!!this.g};function bs(t){return t.g?t.g.readyState:0}q.da=function(){try{return 2<bs(this)?this.g.status:-1}catch{return-1}};q.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};q.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),TZ(e)}};function LB(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case xV:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function AZ(t){let e={};t=(t.g&&2<=bs(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let n=0;n<t.length;n++){if(tm(t[n]))continue;var i=iZ(t[n]);let r=i[0];if(i=i[1],typeof i!="string")continue;i=i.trim();let s=e[r]||[];e[r]=s,s.push(i)}ZX(e,function(n){return n.join(", ")})}q.Ia=function(){return this.m};q.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function kV(t){let e="";return sT(t,function(i,n){e+=n,e+=":",e+=i,e+=`\r
`}),e}function vT(t,e,i){e:{for(n in i){var n=!1;break e}n=!0}n||(i=kV(i),typeof t=="string"?i!=null&&encodeURIComponent(String(i)):It(t,e,i))}function Qf(t,e,i){return i&&i.internalChannelParams&&i.internalChannelParams[t]||e}function AV(t){this.Ga=0,this.j=[],this.l=new Fb,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Qf("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Qf("baseRetryDelayMs",5e3,t),this.hb=Qf("retryDelaySeedMs",1e4,t),this.eb=Qf("forwardChannelMaxRetries",2,t),this.xa=Qf("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new vV(t&&t.concurrentRequestLimit),this.Ja=new EZ,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}q=AV.prototype;q.ra=8;q.H=1;function yT(t){if(RV(t),t.H==3){var e=t.W++,i=Js(t.I);if(It(i,"SID",t.K),It(i,"RID",e),It(i,"TYPE","terminate"),_m(t,i),e=new fm(t,t.l,e),e.L=2,e.A=zb(Js(i)),i=!1,Te.navigator&&Te.navigator.sendBeacon)try{i=Te.navigator.sendBeacon(e.A.toString(),"")}catch{}!i&&Te.Image&&(new Image().src=e.A,i=!0),i||(e.g=VV(e.l,null),e.g.ha(e.A)),e.G=Date.now(),mm(e)}LV(t)}function Hb(t){t.g&&(CT(t),t.g.cancel(),t.g=null)}function RV(t){Hb(t),t.u&&(Te.clearTimeout(t.u),t.u=null),Ib(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Te.clearTimeout(t.m),t.m=null)}function Wb(t){if(!yV(t.i)&&!t.m){t.m=!0;var e=t.Na;nm||JB(),rm||(nm(),rm=!0),uT.add(e,t),t.C=0}}function RZ(t,e){return wV(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=um(Wi(t.Na,t,e),FV(t,t.C)),t.C++,!0)}q.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let r=new fm(this,this.l,t),s=this.s;if(this.U&&(s?(s=WB(s),GB(s,this.U)):s=this.U),this.o!==null||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,i=0;i<this.j.length;i++){t:{var n=this.j[i];if("__data__"in n.map&&(n=n.map.__data__,typeof n=="string")){n=n.length;break t}n=void 0}if(n===void 0)break;if(e+=n,4096<e){e=i;break e}if(e===4096||i===this.j.length-1){e=i+1;break e}}e=1e3}else e=1e3;e=MV(this,r,e),i=Js(this.I),It(i,"RID",t),It(i,"CVER",22),this.F&&It(i,"X-HTTP-Session-Id",this.F),_m(this,i),s&&(this.O?e="headers="+encodeURIComponent(String(kV(s)))+"&"+e:this.o&&vT(i,this.o,s)),_T(this.i,r),this.bb&&It(i,"TYPE","init"),this.P?(It(i,"$req",e),It(i,"SID","null"),r.aa=!0,Xx(r,i,null)):Xx(r,i,e),this.H=2}}else this.H==3&&(t?BB(this,t):this.j.length==0||yV(this.i)||BB(this))};function BB(t,e){var i;e?i=e.m:i=t.W++;let n=Js(t.I);It(n,"SID",t.K),It(n,"RID",i),It(n,"AID",t.V),_m(t,n),t.o&&t.s&&vT(n,t.o,t.s),i=new fm(t,t.l,i,t.C+1),t.o===null&&(i.I=t.s),e&&(t.j=e.F.concat(t.j)),e=MV(t,i,1e3),i.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),_T(t.i,i),Xx(i,n,e)}function _m(t,e){t.na&&sT(t.na,function(i,n){It(e,n,i)}),t.h&&mV({},function(i,n){It(e,n,i)})}function MV(t,e,i){i=Math.min(t.j.length,i);var n=t.h?Wi(t.h.Va,t.h,t):null;e:{var r=t.j;let s=-1;for(;;){let a=["count="+i];s==-1?0<i?(s=r[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let o=!0;for(let l=0;l<i;l++){let c=r[l].g,d=r[l].map;if(c-=s,0>c)s=Math.max(0,r[l].g-100),o=!1;else try{SZ(d,a,"req"+c+"_")}catch{n&&n(d)}}if(o){n=a.join("&");break e}}}return t=t.j.splice(0,i),e.F=t,n}function OV(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;nm||JB(),rm||(nm(),rm=!0),uT.add(e,t),t.A=0}}function wT(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=um(Wi(t.Ma,t),FV(t,t.A)),t.A++,!0)}q.Ma=function(){if(this.u=null,NV(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=um(Wi(this.jb,this),t)}};q.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,un(10),Hb(this),NV(this))};function CT(t){t.B!=null&&(Te.clearTimeout(t.B),t.B=null)}function NV(t){t.g=new fm(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Js(t.wa);It(e,"RID","rpc"),It(e,"SID",t.K),It(e,"AID",t.V),It(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&It(e,"TO",t.qa),It(e,"TYPE","xmlhttp"),_m(t,e),t.o&&t.s&&vT(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var i=t.g;t=t.pa,i.L=1,i.A=zb(Js(e)),i.u=null,i.S=!0,dV(i,t)}q.ib=function(){this.v!=null&&(this.v=null,Hb(this),wT(this),un(19))};function Ib(t){t.v!=null&&(Te.clearTimeout(t.v),t.v=null)}function PV(t,e){var i=null;if(t.g==e){Ib(t),CT(t),t.g=null;var n=2}else if(Jx(t.i,e))i=e.F,CV(t.i,e),n=1;else return;if(t.H!=0){if(e.i)if(n==1){i=e.u?e.u.length:0,e=Date.now()-e.G;var r=t.C;n=Lb(),Li(n,new sV(n,i)),Wb(t)}else OV(t);else if(r=e.s,r==3||r==0&&0<e.ca||!(n==1&&RZ(t,e)||n==2&&wT(t)))switch(i&&0<i.length&&(e=t.i,e.i=e.i.concat(i)),r){case 1:kl(t,5);break;case 4:kl(t,10);break;case 3:kl(t,6);break;default:kl(t,2)}}}function FV(t,e){let i=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(i*=2),i*e}function kl(t,e){if(t.l.info("Error code "+e),e==2){var i=null;t.h&&(i=null);var n=Wi(t.pb,t);i||(i=new Al("//www.google.com/images/cleardot.gif"),Te.location&&Te.location.protocol=="http"||xb(i,"https"),zb(i)),xZ(i.toString(),n)}else un(2);t.H=0,t.h&&t.h.za(e),LV(t),RV(t)}q.pb=function(t){t?(this.l.info("Successfully pinged google.com"),un(2)):(this.l.info("Failed to ping google.com"),un(1))};function LV(t){if(t.H=0,t.ma=[],t.h){let e=EV(t.i);(e.length!=0||t.j.length!=0)&&(kB(t.ma,e),kB(t.ma,t.j),t.i.i.length=0,nT(t.j),t.j.length=0),t.h.ya()}}function BV(t,e,i){var n=i instanceof Al?Js(i):new Al(i);if(n.g!="")e&&(n.g=e+"."+n.g),Tb(n,n.m);else{var r=Te.location;n=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Al(null);n&&xb(s,n),e&&(s.g=e),r&&Tb(s,r),i&&(s.l=i),n=s}return i=t.F,e=t.Da,i&&e&&It(n,i,e),It(n,"VER",t.ra),_m(t,n),n}function VV(t,e,i){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new Ut(new pm({ob:i})):new Ut(t.va),e.Oa(t.J),e}q.isActive=function(){return!!this.h&&this.h.isActive(this)};function jV(){}q=jV.prototype;q.Ba=function(){};q.Aa=function(){};q.za=function(){};q.ya=function(){};q.isActive=function(){return!0};q.Va=function(){};function Db(){if(Sd&&!(10<=Number($X)))throw Error("Environmental error: no available transport.")}Db.prototype.g=function(t,e){return new Bn(t,e)};function Bn(t,e){xi.call(this),this.g=new AV(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!tm(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!tm(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Td(this)}Ti(Bn,xi);Bn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,i=this.h||void 0;un(0),t.Y=e,t.na=i||{},t.G=t.aa,t.I=BV(t,null,t.Y),Wb(t)};Bn.prototype.close=function(){yT(this.g)};Bn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var i={};i.__data__=t,t=i}else this.v&&(i={},i.__data__=dT(t),t=i);e.j.push(new yZ(e.fb++,t)),e.H==3&&Wb(e)};Bn.prototype.N=function(){this.g.h=null,delete this.j,yT(this.g),delete this.g,Bn.$.N.call(this)};function zV(t){pT.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let i in e){t=i;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ti(zV,pT);function UV(){gT.call(this),this.status=1}Ti(UV,gT);function Td(t){this.g=t}Ti(Td,jV);Td.prototype.Ba=function(){Li(this.g,"a")};Td.prototype.Aa=function(t){Li(this.g,new zV(t))};Td.prototype.za=function(t){Li(this.g,new UV)};Td.prototype.ya=function(){Li(this.g,"b")};function MZ(){this.blockSize=-1}function Or(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Ti(Or,MZ);Or.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Vx(t,e,i){i||(i=0);var n=Array(16);if(typeof e=="string")for(var r=0;16>r;++r)n[r]=e.charCodeAt(i++)|e.charCodeAt(i++)<<8|e.charCodeAt(i++)<<16|e.charCodeAt(i++)<<24;else for(r=0;16>r;++r)n[r]=e[i++]|e[i++]<<8|e[i++]<<16|e[i++]<<24;e=t.g[0],i=t.g[1],r=t.g[2];var s=t.g[3],a=e+(s^i&(r^s))+n[0]+3614090360&4294967295;e=i+(a<<7&4294967295|a>>>25),a=s+(r^e&(i^r))+n[1]+3905402710&4294967295,s=e+(a<<12&4294967295|a>>>20),a=r+(i^s&(e^i))+n[2]+606105819&4294967295,r=s+(a<<17&4294967295|a>>>15),a=i+(e^r&(s^e))+n[3]+3250441966&4294967295,i=r+(a<<22&4294967295|a>>>10),a=e+(s^i&(r^s))+n[4]+4118548399&4294967295,e=i+(a<<7&4294967295|a>>>25),a=s+(r^e&(i^r))+n[5]+1200080426&4294967295,s=e+(a<<12&4294967295|a>>>20),a=r+(i^s&(e^i))+n[6]+2821735955&4294967295,r=s+(a<<17&4294967295|a>>>15),a=i+(e^r&(s^e))+n[7]+4249261313&4294967295,i=r+(a<<22&4294967295|a>>>10),a=e+(s^i&(r^s))+n[8]+1770035416&4294967295,e=i+(a<<7&4294967295|a>>>25),a=s+(r^e&(i^r))+n[9]+2336552879&4294967295,s=e+(a<<12&4294967295|a>>>20),a=r+(i^s&(e^i))+n[10]+4294925233&4294967295,r=s+(a<<17&4294967295|a>>>15),a=i+(e^r&(s^e))+n[11]+2304563134&4294967295,i=r+(a<<22&4294967295|a>>>10),a=e+(s^i&(r^s))+n[12]+1804603682&4294967295,e=i+(a<<7&4294967295|a>>>25),a=s+(r^e&(i^r))+n[13]+4254626195&4294967295,s=e+(a<<12&4294967295|a>>>20),a=r+(i^s&(e^i))+n[14]+2792965006&4294967295,r=s+(a<<17&4294967295|a>>>15),a=i+(e^r&(s^e))+n[15]+1236535329&4294967295,i=r+(a<<22&4294967295|a>>>10),a=e+(r^s&(i^r))+n[1]+4129170786&4294967295,e=i+(a<<5&4294967295|a>>>27),a=s+(i^r&(e^i))+n[6]+3225465664&4294967295,s=e+(a<<9&4294967295|a>>>23),a=r+(e^i&(s^e))+n[11]+643717713&4294967295,r=s+(a<<14&4294967295|a>>>18),a=i+(s^e&(r^s))+n[0]+3921069994&4294967295,i=r+(a<<20&4294967295|a>>>12),a=e+(r^s&(i^r))+n[5]+3593408605&4294967295,e=i+(a<<5&4294967295|a>>>27),a=s+(i^r&(e^i))+n[10]+38016083&4294967295,s=e+(a<<9&4294967295|a>>>23),a=r+(e^i&(s^e))+n[15]+3634488961&4294967295,r=s+(a<<14&4294967295|a>>>18),a=i+(s^e&(r^s))+n[4]+3889429448&4294967295,i=r+(a<<20&4294967295|a>>>12),a=e+(r^s&(i^r))+n[9]+568446438&4294967295,e=i+(a<<5&4294967295|a>>>27),a=s+(i^r&(e^i))+n[14]+3275163606&4294967295,s=e+(a<<9&4294967295|a>>>23),a=r+(e^i&(s^e))+n[3]+4107603335&4294967295,r=s+(a<<14&4294967295|a>>>18),a=i+(s^e&(r^s))+n[8]+1163531501&4294967295,i=r+(a<<20&4294967295|a>>>12),a=e+(r^s&(i^r))+n[13]+2850285829&4294967295,e=i+(a<<5&4294967295|a>>>27),a=s+(i^r&(e^i))+n[2]+4243563512&4294967295,s=e+(a<<9&4294967295|a>>>23),a=r+(e^i&(s^e))+n[7]+1735328473&4294967295,r=s+(a<<14&4294967295|a>>>18),a=i+(s^e&(r^s))+n[12]+2368359562&4294967295,i=r+(a<<20&4294967295|a>>>12),a=e+(i^r^s)+n[5]+4294588738&4294967295,e=i+(a<<4&4294967295|a>>>28),a=s+(e^i^r)+n[8]+2272392833&4294967295,s=e+(a<<11&4294967295|a>>>21),a=r+(s^e^i)+n[11]+1839030562&4294967295,r=s+(a<<16&4294967295|a>>>16),a=i+(r^s^e)+n[14]+4259657740&4294967295,i=r+(a<<23&4294967295|a>>>9),a=e+(i^r^s)+n[1]+2763975236&4294967295,e=i+(a<<4&4294967295|a>>>28),a=s+(e^i^r)+n[4]+1272893353&4294967295,s=e+(a<<11&4294967295|a>>>21),a=r+(s^e^i)+n[7]+4139469664&4294967295,r=s+(a<<16&4294967295|a>>>16),a=i+(r^s^e)+n[10]+3200236656&4294967295,i=r+(a<<23&4294967295|a>>>9),a=e+(i^r^s)+n[13]+681279174&4294967295,e=i+(a<<4&4294967295|a>>>28),a=s+(e^i^r)+n[0]+3936430074&4294967295,s=e+(a<<11&4294967295|a>>>21),a=r+(s^e^i)+n[3]+3572445317&4294967295,r=s+(a<<16&4294967295|a>>>16),a=i+(r^s^e)+n[6]+76029189&4294967295,i=r+(a<<23&4294967295|a>>>9),a=e+(i^r^s)+n[9]+3654602809&4294967295,e=i+(a<<4&4294967295|a>>>28),a=s+(e^i^r)+n[12]+3873151461&4294967295,s=e+(a<<11&4294967295|a>>>21),a=r+(s^e^i)+n[15]+530742520&4294967295,r=s+(a<<16&4294967295|a>>>16),a=i+(r^s^e)+n[2]+3299628645&4294967295,i=r+(a<<23&4294967295|a>>>9),a=e+(r^(i|~s))+n[0]+4096336452&4294967295,e=i+(a<<6&4294967295|a>>>26),a=s+(i^(e|~r))+n[7]+1126891415&4294967295,s=e+(a<<10&4294967295|a>>>22),a=r+(e^(s|~i))+n[14]+2878612391&4294967295,r=s+(a<<15&4294967295|a>>>17),a=i+(s^(r|~e))+n[5]+4237533241&4294967295,i=r+(a<<21&4294967295|a>>>11),a=e+(r^(i|~s))+n[12]+1700485571&4294967295,e=i+(a<<6&4294967295|a>>>26),a=s+(i^(e|~r))+n[3]+2399980690&4294967295,s=e+(a<<10&4294967295|a>>>22),a=r+(e^(s|~i))+n[10]+4293915773&4294967295,r=s+(a<<15&4294967295|a>>>17),a=i+(s^(r|~e))+n[1]+2240044497&4294967295,i=r+(a<<21&4294967295|a>>>11),a=e+(r^(i|~s))+n[8]+1873313359&4294967295,e=i+(a<<6&4294967295|a>>>26),a=s+(i^(e|~r))+n[15]+4264355552&4294967295,s=e+(a<<10&4294967295|a>>>22),a=r+(e^(s|~i))+n[6]+2734768916&4294967295,r=s+(a<<15&4294967295|a>>>17),a=i+(s^(r|~e))+n[13]+1309151649&4294967295,i=r+(a<<21&4294967295|a>>>11),a=e+(r^(i|~s))+n[4]+4149444226&4294967295,e=i+(a<<6&4294967295|a>>>26),a=s+(i^(e|~r))+n[11]+3174756917&4294967295,s=e+(a<<10&4294967295|a>>>22),a=r+(e^(s|~i))+n[2]+718787259&4294967295,r=s+(a<<15&4294967295|a>>>17),a=i+(s^(r|~e))+n[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}Or.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var i=e-this.blockSize,n=this.m,r=this.h,s=0;s<e;){if(r==0)for(;s<=i;)Vx(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(n[r++]=t.charCodeAt(s++),r==this.blockSize){Vx(this,n),r=0;break}}else for(;s<e;)if(n[r++]=t[s++],r==this.blockSize){Vx(this,n),r=0;break}}this.h=r,this.i+=e};Or.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var i=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=i&255,i/=256;for(this.j(t),t=Array(16),e=i=0;4>e;++e)for(var n=0;32>n;n+=8)t[i++]=this.g[e]>>>n&255;return t};function ct(t,e){this.h=e;for(var i=[],n=!0,r=t.length-1;0<=r;r--){var s=t[r]|0;n&&s==e||(i[r]=s,n=!1)}this.g=i}var OZ={};function ET(t){return-128<=t&&128>t?WX(t,function(e){return new ct([e|0],0>e?-1:0)}):new ct([t|0],0>t?-1:0)}function vs(t){if(isNaN(t)||!isFinite(t))return Ed;if(0>t)return Fi(vs(-t));for(var e=[],i=1,n=0;t>=i;n++)e[n]=t/i|0,i*=eT;return new ct(e,0)}function qV(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Fi(qV(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=vs(Math.pow(e,8)),n=Ed,r=0;r<t.length;r+=8){var s=Math.min(8,t.length-r),a=parseInt(t.substring(r,r+s),e);8>s?(s=vs(Math.pow(e,s)),n=n.R(s).add(vs(a))):(n=n.R(i),n=n.add(vs(a)))}return n}var eT=4294967296,Ed=ET(0),tT=ET(1),VB=ET(16777216);q=ct.prototype;q.ea=function(){if(lr(this))return-Fi(this).ea();for(var t=0,e=1,i=0;i<this.g.length;i++){var n=this.D(i);t+=(0<=n?n:eT+n)*e,e*=eT}return t};q.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Zs(this))return"0";if(lr(this))return"-"+Fi(this).toString(t);for(var e=vs(Math.pow(t,6)),i=this,n="";;){var r=Ab(i,e).g;i=kb(i,r.R(e));var s=((0<i.g.length?i.g[0]:i.h)>>>0).toString(t);if(i=r,Zs(i))return s+n;for(;6>s.length;)s="0"+s;n=s+n}};q.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Zs(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function lr(t){return t.h==-1}q.X=function(t){return t=kb(this,t),lr(t)?-1:Zs(t)?0:1};function Fi(t){for(var e=t.g.length,i=[],n=0;n<e;n++)i[n]=~t.g[n];return new ct(i,~t.h).add(tT)}q.abs=function(){return lr(this)?Fi(this):this};q.add=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0,r=0;r<=e;r++){var s=n+(this.D(r)&65535)+(t.D(r)&65535),a=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);n=a>>>16,s&=65535,a&=65535,i[r]=a<<16|s}return new ct(i,i[i.length-1]&-2147483648?-1:0)};function kb(t,e){return t.add(Fi(e))}q.R=function(t){if(Zs(this)||Zs(t))return Ed;if(lr(this))return lr(t)?Fi(this).R(Fi(t)):Fi(Fi(this).R(t));if(lr(t))return Fi(this.R(Fi(t)));if(0>this.X(VB)&&0>t.X(VB))return vs(this.ea()*t.ea());for(var e=this.g.length+t.g.length,i=[],n=0;n<2*e;n++)i[n]=0;for(n=0;n<this.g.length;n++)for(var r=0;r<t.g.length;r++){var s=this.D(n)>>>16,a=this.D(n)&65535,o=t.D(r)>>>16,l=t.D(r)&65535;i[2*n+2*r]+=a*l,Sb(i,2*n+2*r),i[2*n+2*r+1]+=s*l,Sb(i,2*n+2*r+1),i[2*n+2*r+1]+=a*o,Sb(i,2*n+2*r+1),i[2*n+2*r+2]+=s*o,Sb(i,2*n+2*r+2)}for(n=0;n<e;n++)i[n]=i[2*n+1]<<16|i[2*n];for(n=e;n<2*e;n++)i[n]=0;return new ct(i,0)};function Sb(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Xf(t,e){this.g=t,this.h=e}function Ab(t,e){if(Zs(e))throw Error("division by zero");if(Zs(t))return new Xf(Ed,Ed);if(lr(t))return e=Ab(Fi(t),e),new Xf(Fi(e.g),Fi(e.h));if(lr(e))return e=Ab(t,Fi(e)),new Xf(Fi(e.g),e.h);if(30<t.g.length){if(lr(t)||lr(e))throw Error("slowDivide_ only works with positive integers.");for(var i=tT,n=e;0>=n.X(t);)i=jB(i),n=jB(n);var r=wd(i,1),s=wd(n,1);for(n=wd(n,2),i=wd(i,2);!Zs(n);){var a=s.add(n);0>=a.X(t)&&(r=r.add(i),s=a),n=wd(n,1),i=wd(i,1)}return e=kb(t,r.R(e)),new Xf(r,e)}for(r=Ed;0<=t.X(e);){for(i=Math.max(1,Math.floor(t.ea()/e.ea())),n=Math.ceil(Math.log(i)/Math.LN2),n=48>=n?1:Math.pow(2,n-48),s=vs(i),a=s.R(e);lr(a)||0<a.X(t);)i-=n,s=vs(i),a=s.R(e);Zs(s)&&(s=tT),r=r.add(s),t=kb(t,a)}return new Xf(r,t)}q.gb=function(t){return Ab(this,t).h};q.and=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)&t.D(n);return new ct(i,this.h&t.h)};q.or=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)|t.D(n);return new ct(i,this.h|t.h)};q.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)^t.D(n);return new ct(i,this.h^t.h)};function jB(t){for(var e=t.g.length+1,i=[],n=0;n<e;n++)i[n]=t.D(n)<<1|t.D(n-1)>>>31;return new ct(i,t.h)}function wd(t,e){var i=e>>5;e%=32;for(var n=t.g.length-i,r=[],s=0;s<n;s++)r[s]=0<e?t.D(s+i)>>>e|t.D(s+i+1)<<32-e:t.D(s+i);return new ct(r,t.h)}Db.prototype.createWebChannel=Db.prototype.g;Bn.prototype.send=Bn.prototype.u;Bn.prototype.open=Bn.prototype.m;Bn.prototype.close=Bn.prototype.close;Bb.NO_ERROR=0;Bb.TIMEOUT=8;Bb.HTTP_ERROR=6;aV.COMPLETE="complete";oV.EventType=hm;hm.OPEN="a";hm.CLOSE="b";hm.ERROR="c";hm.MESSAGE="d";xi.prototype.listen=xi.prototype.O;Ut.prototype.listenOnce=Ut.prototype.P;Ut.prototype.getLastError=Ut.prototype.Sa;Ut.prototype.getLastErrorCode=Ut.prototype.Ia;Ut.prototype.getStatus=Ut.prototype.da;Ut.prototype.getResponseJson=Ut.prototype.Wa;Ut.prototype.getResponseText=Ut.prototype.ja;Ut.prototype.send=Ut.prototype.ha;Ut.prototype.setWithCredentials=Ut.prototype.Oa;Or.prototype.digest=Or.prototype.l;Or.prototype.reset=Or.prototype.reset;Or.prototype.update=Or.prototype.j;ct.prototype.add=ct.prototype.add;ct.prototype.multiply=ct.prototype.R;ct.prototype.modulo=ct.prototype.gb;ct.prototype.compare=ct.prototype.X;ct.prototype.toNumber=ct.prototype.ea;ct.prototype.toString=ct.prototype.toString;ct.prototype.getBits=ct.prototype.D;ct.fromNumber=vs;ct.fromString=qV;var gSe=Nr.createWebChannelTransport=function(){return new Db},_Se=Nr.getStatEventTarget=function(){return Lb()},bSe=Nr.ErrorCode=Bb,vSe=Nr.EventType=aV,ySe=Nr.Event=Rl,wSe=Nr.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},CSe=Nr.FetchXmlHttpFactory=pm,ESe=Nr.WebChannel=oV,SSe=Nr.XhrIo=Ut,HV=Nr.Md5=Or,Ml=Nr.Integer=ct;var Zl=fw(bU(),1),Aq=fw(bD(),1);var vU="@firebase/firestore",yU="4.5.1";var ui=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ui.UNAUTHENTICATED=new ui(null);ui.GOOGLE_CREDENTIALS=new ui("google-credentials-uid");ui.FIRST_PARTY=new ui("first-party-uid");ui.MOCK_USER=new ui("mock-user");var Zae="10.10.0";var Ku=Zae;function Jae(t){Ku=t}function eoe(t){return $ae(t,{depth:100})}var ko=new Ca("@firebase/firestore");function wu(){return ko.logLevel}function Rq(t){ko.setLogLevel(t)}function N(t,...e){if(ko.logLevel<=Qn.DEBUG){let i=e.map(QA);ko.debug(`Firestore (${Ku}): ${t}`,...i)}}function Lt(t,...e){if(ko.logLevel<=Qn.ERROR){let i=e.map(QA);ko.error(`Firestore (${Ku}): ${t}`,...i)}}function wr(t,...e){if(ko.logLevel<=Qn.WARN){let i=e.map(QA);ko.warn(`Firestore (${Ku}): ${t}`,...i)}}function QA(t){if(typeof t=="string")return t;try{return eoe(t)}catch{return t}}function Y(t="Unexpected state"){let e=`FIRESTORE (${Ku}) INTERNAL ASSERTION FAILED: `+t;throw Lt(e),new Error(e)}function oe(t,e){t||Y()}function Mq(t,e){t||Y()}function U(t,e){return t}var T={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},D=class extends FM{constructor(e,i){super(e,i),this.code=e,this.message=i,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Zt=class{constructor(){this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}};var Zy=class{constructor(e,i){this.user=i,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},X1=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,i){e.enqueueRetryable(()=>i(ui.UNAUTHENTICATED))}shutdown(){}},Z1=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,i){this.changeListener=i,e.enqueueRetryable(()=>i(this.token.user))}shutdown(){this.changeListener=null}},J1=class{constructor(e){this.authProvider=e,this.currentUser=ui.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,i){let n=this.tokenCounter,r=l=>this.tokenCounter!==n?(n=this.tokenCounter,i(l)):Promise.resolve(),s=new Zt;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),s.resolve(),s=new Zt,e.enqueueRetryable(()=>r(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(()=>y(this,null,function*(){yield l.promise,yield r(this.currentUser)}))},o=l=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.tokenListener),a()};this.authProvider.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){let l=this.authProvider.getImmediate({optional:!0});l?o(l):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Zt)}},0),a()}getToken(){let e=this.tokenCounter,i=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(i).then(n=>this.tokenCounter!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(oe(typeof n.accessToken=="string"),new Zy(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.tokenListener)}getUser(){let e=this.auth&&this.auth.getUid();return oe(e===null||typeof e=="string"),new ui(e)}},ek=class{constructor(e,i,n){this.sessionIndex=e,this.iamToken=i,this.authTokenFactory=n,this.type="FirstParty",this.user=ui.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}},tk=class{constructor(e,i,n){this.sessionIndex=e,this.iamToken=i,this.authTokenFactory=n}getToken(){return Promise.resolve(new ek(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,i){e.enqueueRetryable(()=>i(ui.FIRST_PARTY))}shutdown(){}invalidateToken(){}},ik=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},nk=class{constructor(e){this.appCheckProvider=e,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(e,i){let n=s=>{s.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.latestAppCheckToken;return this.latestAppCheckToken=s.token,N("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?i(s.token):Promise.resolve()};this.tokenListener=s=>{e.enqueueRetryable(()=>n(s))};let r=s=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.appCheckProvider.getImmediate({optional:!0});s?r(s):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(i=>i?(oe(typeof i.token=="string"),this.latestAppCheckToken=i.token,new ik(i.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.tokenListener)}};function toe(t){if(!t)return new X1;switch(t.type){case"firstParty":return new tk(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new D(T.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function ioe(t){return Xae(t)}var Jy=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=Math.floor(256/e.length)*e.length,n="",r=20;for(;n.length<r;){let s=ioe(40);for(let a=0;a<s.length;++a)n.length<r&&s[a]<i&&(n+=e.charAt(s[a]%e.length))}return n}};function Re(t,e){return t<e?-1:t>e?1:0}function Jl(t,e,i){return t.length!==e.length?!1:t.every((n,r)=>i(n,e[r]))}function Oq(t){return t+"\0"}var wU=-62135596800,CU=1e6,Bt=class t{constructor(e,i){if(this.seconds=e,this.nanoseconds=i,i<0)throw new D(T.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(i>=1e9)throw new D(T.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(e<wU)throw new D(T.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(T.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let i=Math.floor(e/1e3),n=Math.floor((e-i*1e3)*CU);return new t(i,n)}toDate(){return new Date(this.toMillis())}toMillis(){return this.seconds*1e3+this.nanoseconds/CU}_compareTo(e){return this.seconds===e.seconds?Re(this.nanoseconds,e.nanoseconds):Re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-wU,i=String(e).padStart(12,"0"),n=String(this.nanoseconds).padStart(9,"0");return i+"."+n}};var pe=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Bt(0,0))}static max(){return new t(new Bt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return this.timestamp.seconds*1e6+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var EU="__name__",e0=class t{constructor(e,i,n){i===void 0?i=0:i>e.length&&Y(),n===void 0?n=e.length-i:n>e.length-i&&Y(),this.segments=e,this.offset=i,this.len=n}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let i=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(n=>{i.push(n)}):i.push(e),this.construct(i)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}forEach(e){for(let i=this.offset,n=this.limit();i<n;i++)e(this.segments[i])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,i){let n=Math.min(e.length,i.length);for(let r=0;r<n;r++){let s=e.get(r),a=i.get(r);if(s<a)return-1;if(s>a)return 1}return e.length<i.length?-1:e.length>i.length?1:0}},Qe=class t extends e0{construct(e,i,n){return new t(e,i,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let i=[];for(let n of e){if(n.indexOf("//")>=0)throw new D(T.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);i.push(...n.split("/").filter(r=>r.length>0))}return new t(i)}static emptyPath(){return new t([])}},noe=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ei=class t extends e0{construct(e,i,n){return new t(e,i,n)}static isValidIdentifier(e){return noe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===EU}static keyField(){return new t([EU])}static fromServerFormat(e){let i=[],n="",r=0,s=()=>{if(n.length===0)throw new D(T.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);i.push(n),n=""},a=!1;for(;r<e.length;){let o=e[r];if(o==="\\"){if(r+1===e.length)throw new D(T.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(!(l==="\\"||l==="."||l==="`"))throw new D(T.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,r+=2}else o==="`"?(a=!a,r++):o==="."&&!a?(s(),r++):(n+=o,r++)}if(s(),a)throw new D(T.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(i)}static emptyPath(){return new t([])}};var z=class t{constructor(e){this.path=e}static fromPath(e){return new t(Qe.fromString(e))}static fromName(e){return new t(Qe.fromString(e).popFirst(5))}static empty(){return new t(Qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,i){return Qe.comparator(e.path,i.path)}static isDocumentKey(e){return e.length%2===0}static fromSegments(e){return new t(new Qe(e.slice()))}};var Au=-1,roe=0,rk=(()=>{class t{constructor(i,n,r,s){this.indexId=i,this.collectionGroup=n,this.fields=r,this.indexState=s}}return t.UNKNOWN_ID=-1,t})();function XA(t){return t.fields.find(e=>e.kind===2)}function ec(t){return t.fields.filter(e=>e.kind!==2)}function soe(t){let e=ec(t);return e.length===0?0:e[e.length-1].kind}function aoe(t){return`id=${t.indexId}|cg=${t.collectionGroup}|f=${t.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`}var Iu=class{constructor(e,i){this.fieldPath=e,this.kind=i}};var up=class t{constructor(e,i){this.sequenceNumber=e,this.offset=i}static empty(){return new t(roe,Cr.min())}};function Nq(t,e){let i=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,r=pe.fromTimestamp(n===1e9?new Bt(i+1,0):new Bt(i,n));return new Cr(r,z.empty(),e)}function Pq(t){return new Cr(t.readTime,t.key,Au)}var Cr=class t{constructor(e,i,n){this.readTime=e,this.documentKey=i,this.largestBatchId=n}static min(){return new t(pe.min(),z.empty(),Au)}static max(){return new t(pe.max(),z.empty(),Au)}};function ZA(t,e){let i=t.readTime.compareTo(e.readTime);return i!==0||(i=z.comparator(t.documentKey,e.documentKey),i!==0)?i:Re(t.largestBatchId,e.largestBatchId)}var Fq="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",t0=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function jo(t){return y(this,null,function*(){if(t.code===T.FAILED_PRECONDITION&&t.message===Fq)N("LocalStore","Unexpectedly lost primary lease");else throw t})}var S=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(i=>{this.isDone=!0,this.result=i,this.nextCallback&&this.nextCallback(i)},i=>{this.isDone=!0,this.error=i,this.catchCallback&&this.catchCallback(i)})}catch(e){return this.next(void 0,e)}next(e,i){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(e,this.result):new t((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(i,s).next(n,r)}})}toPromise(){return new Promise((e,i)=>{this.next(e,i)})}wrapUserFunction(e){try{let i=e();return i instanceof t?i:t.resolve(i)}catch(i){return t.reject(i)}}wrapSuccess(e,i){return e?this.wrapUserFunction(()=>e(i)):t.resolve(i)}wrapFailure(e,i){return e?this.wrapUserFunction(()=>e(i)):t.reject(i)}static resolve(e){return new t((i,n)=>{i(e)})}static reject(e){return new t((i,n)=>{n(e)})}static waitFor(e){return new t((i,n)=>{let r=0,s=0,a=!1;e.forEach(o=>{++r,o.next(()=>{++s,a&&s===r&&i()},l=>n(l))}),a=!0,s===r&&i()})}static or(e){let i=t.resolve(!1);for(let n of e)i=i.next(r=>r?t.resolve(r):n());return i}static forEach(e,i){let n=[];return e.forEach((r,s)=>{n.push(i.call(this,r,s))}),this.waitFor(n)}static mapArray(e,i){return new t((n,r)=>{let s=e.length,a=new Array(s),o=0;for(let l=0;l<s;l++){let c=l;i(e[c]).next(d=>{a[c]=d,++o,o===s&&n(a)},d=>r(d))}})}static doWhile(e,i){return new t((n,r)=>{let s=()=>{e()===!0?i().next(()=>{s()},r):n()};s()})}};var Un="SimpleDb",ooe=3,i0=class t{constructor(e,i){this.action=e,this.transaction=i,this.aborted=!1,this.completionDeferred=new Zt,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{i.error?this.completionDeferred.reject(new Xl(e,i.error)):this.completionDeferred.resolve()},this.transaction.onerror=n=>{let r=JA(n.target.error);this.completionDeferred.reject(new Xl(e,r))}}static open(e,i,n,r){try{return new t(i,e.transaction(r,n))}catch(s){throw new Xl(i,s)}}get completionPromise(){return this.completionDeferred.promise}abort(e){e&&this.completionDeferred.reject(e),this.aborted||(N(Un,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let e=this.transaction;!this.aborted&&typeof e.commit=="function"&&e.commit()}store(e){let i=this.transaction.objectStore(e);return new ak(i)}},da=class t{constructor(e,i,n){this.name=e,this.version=i,this.schemaConverter=n,t.getIOSVersion(_h())===12.2&&Lt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return N(Un,"Removing database:",e),Hl(window.indexedDB.deleteDatabase(e)).toPromise()}static isAvailable(){if(!fg())return!1;if(t.isMockPersistence())return!0;let e=_h(),i=t.getIOSVersion(e),n=0<i&&i<10,r=t.getAndroidVersion(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static isMockPersistence(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.USE_MOCK_PERSISTENCE)==="YES"}static getStore(e,i){return e.store(i)}static getIOSVersion(e){let i=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=i?i[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static getAndroidVersion(e){let i=e.match(/Android ([\d.]+)/i),n=i?i[1].split(".").slice(0,2).join("."):"-1";return Number(n)}ensureDb(e){return y(this,null,function*(){return this.db||(N(Un,"Opening database:",this.name),this.db=yield new Promise((i,n)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{let a=s.target.result;i(a)},r.onblocked=()=>{n(new Xl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{let a=s.target.error;a.name==="VersionError"?n(new D(T.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?n(new D(T.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):n(new Xl(e,a))},r.onupgradeneeded=s=>{N(Un,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let a=s.target.result;this.schemaConverter.createOrUpgrade(a,r.transaction,s.oldVersion,this.version).next(()=>{N(Un,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=i=>this.versionchangelistener(i)),this.db})}setVersionChangeListener(e){this.versionchangelistener=e,this.db&&(this.db.onversionchange=i=>e(i))}runTransaction(e,i,n,r){return y(this,null,function*(){let s=i==="readonly",a=0;for(;;){++a;try{this.db=yield this.ensureDb(e);let o=i0.open(this.db,e,s?"readonly":"readwrite",n),l=r(o).next(c=>(o.maybeCommit(),c)).catch(c=>(o.abort(c),S.reject(c))).toPromise();return l.catch(()=>{}),yield o.completionPromise,l}catch(o){let l=o,c=l.name!=="FirebaseError"&&a<ooe;if(N(Un,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}})}close(){this.db&&this.db.close(),this.db=void 0}},sk=class{constructor(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(e){this.dbCursor=e}done(){this.shouldStop=!0}skip(e){this.nextKey=e}delete(){return Hl(this.dbCursor.delete())}},Xl=class extends D{constructor(e,i){super(T.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${i}`),this.name="IndexedDbTransactionError"}};function zo(t){return t.name==="IndexedDbTransactionError"}var ak=class{constructor(e){this.store=e}put(e,i){let n;return i!==void 0?(N(Un,"PUT",this.store.name,e,i),n=this.store.put(i,e)):(N(Un,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Hl(n)}add(e){N(Un,"ADD",this.store.name,e,e);let i=this.store.add(e);return Hl(i)}get(e){let i=this.store.get(e);return Hl(i).next(n=>(n===void 0&&(n=null),N(Un,"GET",this.store.name,e,n),n))}delete(e){N(Un,"DELETE",this.store.name,e);let i=this.store.delete(e);return Hl(i)}count(){N(Un,"COUNT",this.store.name);let e=this.store.count();return Hl(e)}loadAll(e,i){let n=this.options(e,i),r=n.index?this.store.index(n.index):this.store;if(typeof r.getAll=="function"){let s=r.getAll(n.range);return new S((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}})}else{let s=this.cursor(n),a=[];return this.iterateCursor(s,(o,l)=>{a.push(l)}).next(()=>a)}}loadFirst(e,i){let n=this.store.getAll(e,i===null?void 0:i);return new S((r,s)=>{n.onerror=a=>{s(a.target.error)},n.onsuccess=a=>{r(a.target.result)}})}deleteAll(e,i){N(Un,"DELETE ALL",this.store.name);let n=this.options(e,i);n.keysOnly=!1;let r=this.cursor(n);return this.iterateCursor(r,(s,a,o)=>o.delete())}iterate(e,i){let n;i?n=e:(n={},i=e);let r=this.cursor(n);return this.iterateCursor(r,i)}iterateSerial(e){let i=this.cursor({});return new S((n,r)=>{i.onerror=s=>{let a=JA(s.target.error);r(a)},i.onsuccess=s=>{let a=s.target.result;if(!a){n();return}e(a.primaryKey,a.value).next(o=>{o?a.continue():n()})}})}iterateCursor(e,i){let n=[];return new S((r,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{let o=a.target.result;if(!o){r();return}let l=new sk(o),c=i(o.primaryKey,o.value,l);if(c instanceof S){let d=c.catch(u=>(l.done(),S.reject(u)));n.push(d)}l.isDone?r():l.skipToKey===null?o.continue():o.continue(l.skipToKey)}}).next(()=>S.waitFor(n))}options(e,i){let n;return e!==void 0&&(typeof e=="string"?n=e:i=e),{index:n,range:i}}cursor(e){let i="next";if(e.reverse&&(i="prev"),e.index){let n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,i):n.openCursor(e.range,i)}else return this.store.openCursor(e.range,i)}};function Hl(t){return new S((e,i)=>{t.onsuccess=n=>{let r=n.target.result;e(r)},t.onerror=n=>{let r=JA(n.target.error);i(r)}})}var SU=!1;function JA(t){let e=da.getIOSVersion(_h());if(e>=12.2&&e<13){let i="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(i)>=0){let n=new D("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${i}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return SU||(SU=!0,setTimeout(()=>{throw n},0)),n}}return t}var sp="IndexBackfiller",loe=15*1e3,coe=60*1e3,doe=50,ok=class{constructor(e,i){this.asyncQueue=e,this.backfiller=i,this.task=null}start(){this.schedule(loe)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}schedule(e){N(sp,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>y(this,null,function*(){this.task=null;try{let i=yield this.backfiller.backfill();N(sp,`Documents written: ${i}`)}catch(i){zo(i)?N(sp,"Ignoring IndexedDB error during index backfill: ",i):yield jo(i)}yield this.schedule(coe)}))}},lk=class{constructor(e,i){this.localStore=e,this.persistence=i}backfill(){return y(this,arguments,function*(e=doe){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",i=>this.writeIndexEntries(i,e))})}writeIndexEntries(e,i){let n=new Set,r=i,s=!0;return S.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a===null||n.has(a))s=!1;else return N(sp,`Processing collection: ${a}`),this.writeEntriesForCollectionGroup(e,a,r).next(o=>{r-=o,n.add(a)})})).next(()=>i-r)}writeEntriesForCollectionGroup(e,i,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,i).next(r=>this.localStore.localDocuments.getNextDocuments(e,i,r,n).next(s=>{let a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.getNewOffset(r,s)).next(o=>(N(sp,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,i,o))).next(()=>a.size)}))}getNewOffset(e,i){let n=e;return i.changes.forEach((r,s)=>{let a=Pq(s);ZA(a,n)>0&&(n=a)}),new Cr(n.readTime,n.documentKey,Math.max(i.batchId,e.largestBatchId))}};var qn=(()=>{class t{constructor(i,n){this.previousValue=i,n&&(n.sequenceNumberHandler=r=>this.setPreviousValue(r),this.writeNewSequenceNumber=r=>n.writeSequenceNumber(r))}setPreviousValue(i){return this.previousValue=Math.max(i,this.previousValue),this.previousValue}next(){let i=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(i),i}}t.INVALID=-1;return t})(),Du="",ck="",Lq="",Bq="";function gn(t){let e="";for(let i=0;i<t.length;i++)e.length>0&&(e=xU(e)),e=uoe(t.get(i),e);return xU(e)}function uoe(t,e){let i=e,n=t.length;for(let r=0;r<n;r++){let s=t.charAt(r);switch(s){case"\0":i+=Du+Lq;break;case Du:i+=Du+Bq;break;default:i+=s}}return i}function xU(t){return t+Du+ck}function Ls(t){let e=t.length;if(oe(e>=2),e===2)return oe(t.charAt(0)===Du&&t.charAt(1)===ck),Qe.emptyPath();let i=e-2,n=[],r="";for(let s=0;s<e;){let a=t.indexOf(Du,s);switch((a<0||a>i)&&Y(),t.charAt(a+1)){case ck:let l=t.substring(s,a),c;r.length===0?c=l:(r+=l,c=r,r=""),n.push(c);break;case Lq:r+=t.substring(s,a),r+="\0";break;case Bq:r+=t.substring(s,a+1);break;default:Y()}s=a+2}return new Qe(n)}var Wl="remoteDocuments";var Fp="owner",mu="owner",Lp="mutationQueues",hoe="userId",qr="mutations",Vq="batchId",Yl="userMutationsIndex",jq=["userId","batchId"];function foe(t){return[t]}function Gy(t,e){return[t,gn(e)]}function zq(t,e,i){return[t,gn(e),i]}var moe={},$u="documentMutations",H0="remoteDocumentsV14",poe=["prefixPath","collectionGroup","readTime","documentId"],Ky="documentKeyIndex",goe=["prefixPath","collectionGroup","documentId"],Uq="collectionGroupIndex",_oe=["collectionGroup","readTime","prefixPath","documentId"],Bp="remoteDocumentGlobal",dk="remoteDocumentGlobalKey",Yu="targets",boe="targetId",qq="queryTargetsIndex",voe=["canonicalId","targetId"],Qu="targetDocuments",yoe=["targetId","path"],eR="documentTargetsIndex",woe=["path","targetId"],n0="targetGlobalKey",fc="targetGlobal",hp="collectionParents",Coe=["collectionId","parent"],Ru="clientMetadata",Eoe="clientId",W0="bundles",Soe="bundleId",G0="namedQueries",xoe="name",tR="indexConfiguration",Toe="indexId",uk="collectionGroupIndex",Ioe="collectionGroup",iR="indexState",Doe=["indexId","uid"],Hq="sequenceNumberIndex",koe=["uid","sequenceNumber"],nR="indexEntries",Aoe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Wq="documentKeyIndex",Roe=["indexId","uid","orderedDocumentKey"],K0="documentOverlays",Moe=["userId","collectionPath","documentId"],hk="collectionPathOverlayIndex",Ooe=["userId","collectionPath","largestBatchId"],Gq="collectionGroupOverlayIndex",Noe=["userId","collectionGroup","largestBatchId"],Poe=[Lp,qr,$u,Wl,Yu,Fp,fc,Qu],Foe=Poe,Loe=[...Foe,Ru],Boe=[...Loe,Bp],Voe=[...Boe,hp],Kq=[...Voe,W0,G0],joe=[...Kq,K0],$q=[Lp,qr,$u,H0,Yu,Fp,fc,Qu,Ru,Bp,hp,W0,G0,K0],Yq=$q,zoe=[...Yq,tR,iR,nR];function Uoe(t){if(t===15)return zoe;if(t===14)return Yq;if(t===13)return $q;if(t===12)return joe;if(t===11)return Kq;Y()}var fp=class extends t0{constructor(e,i){super(),this.simpleDbTransaction=e,this.currentSequenceNumber=i}};function Mi(t,e){let i=U(t);return da.getStore(i.simpleDbTransaction,e)}function TU(t){let e=0;for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&e++;return e}function mc(t,e){for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&e(i,t[i])}function Qq(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Dt=class t{constructor(e,i){this.comparator=e,this.root=i||ap.EMPTY}insert(e,i){return new t(this.comparator,this.root.insert(e,i,this.comparator).copy(null,null,ap.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ap.BLACK,null,null))}get(e){let i=this.root;for(;!i.isEmpty();){let n=this.comparator(e,i.key);if(n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}indexOf(e){let i=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return i+n.left.size;r<0?n=n.left:(i+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((i,n)=>(e(i,n),!1))}toString(){let e=[];return this.inorderTraversal((i,n)=>(e.push(`${i}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xu(this.root,e,this.comparator,!1)}getReverseIterator(){return new xu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xu(this.root,e,this.comparator,!0)}},xu=class{constructor(e,i,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=i?n(e.key,i):1,i&&r&&(s*=-1),s<0)this.isReverse?e=e.left:e=e.right;else if(s===0){this.nodeStack.push(e);break}else this.nodeStack.push(e),this.isReverse?e=e.right:e=e.left}getNext(){let e=this.nodeStack.pop(),i={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return i}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ap=(()=>{class t{constructor(i,n,r,s,a){this.key=i,this.value=n,this.color=r??t.RED,this.left=s??t.EMPTY,this.right=a??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(i,n,r,s,a){return new t(i??this.key,n??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(i){return this.left.inorderTraversal(i)||i(this.key,this.value)||this.right.inorderTraversal(i)}reverseTraversal(i){return this.right.reverseTraversal(i)||i(this.key,this.value)||this.left.reverseTraversal(i)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(i,n,r){let s=this,a=r(i,s.key);return a<0?s=s.copy(null,null,null,s.left.insert(i,n,r),null):a===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(i,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let i=this;return!i.left.isRed()&&!i.left.left.isRed()&&(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.removeMin(),null),i.fixUp()}remove(i,n){let r,s=this;if(n(i,s.key)<0)!s.left.isEmpty()&&!s.left.isRed()&&!s.left.left.isRed()&&(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(i,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),!s.right.isEmpty()&&!s.right.isRed()&&!s.right.left.isRed()&&(s=s.moveRedRight()),n(i,s.key)===0){if(s.right.isEmpty())return t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(i,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let i=this;return i.right.isRed()&&!i.left.isRed()&&(i=i.rotateLeft()),i.left.isRed()&&i.left.left.isRed()&&(i=i.rotateRight()),i.left.isRed()&&i.right.isRed()&&(i=i.colorFlip()),i}moveRedLeft(){let i=this.colorFlip();return i.right.left.isRed()&&(i=i.copy(null,null,null,null,i.right.rotateRight()),i=i.rotateLeft(),i=i.colorFlip()),i}moveRedRight(){let i=this.colorFlip();return i.left.left.isRed()&&(i=i.rotateRight(),i=i.colorFlip()),i}rotateLeft(){let i=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,i,null)}rotateRight(){let i=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,i)}colorFlip(){let i=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,i,n)}checkMaxDepth(){let i=this.check();return Math.pow(2,i)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();let i=this.left.check();if(i!==this.right.check())throw Y();return i+(this.isRed()?0:1)}}return t.EMPTY=null,t.RED=!0,t.BLACK=!1,t})(),fk=class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(e,i,n,r,s){return this}insert(e,i,n){return new ap(e,i)}remove(e,i){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};ap.EMPTY=new fk;var bt=class t{constructor(e){this.comparator=e,this.data=new Dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((i,n)=>(e(i),!1))}forEachInRange(e,i){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;i(r.key)}}forEachWhile(e,i){let n;for(i!==void 0?n=this.data.getIteratorFrom(i):n=this.data.getIterator();n.hasNext();){let r=n.getNext();if(!e(r.key))return}}firstAfterOrEqual(e){let i=this.data.getIteratorFrom(e);return i.hasNext()?i.getNext().key:null}getIterator(){return new r0(this.data.getIterator())}getIteratorFrom(e){return new r0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let i=this;return i.size<e.size&&(i=e,e=this),e.forEach(n=>{i=i.add(n)}),i}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let i=this.data.getIterator(),n=e.data.getIterator();for(;i.hasNext();){let r=i.getNext().key,s=n.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(i=>{e.push(i)}),e}toString(){let e=[];return this.forEach(i=>e.push(i)),"SortedSet("+e.toString()+")"}copy(e){let i=new t(this.comparator);return i.data=e,i}},r0=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function qoe(t,e,i,n,r){let s=t.getIterator(),a=e.getIterator(),o=pu(s),l=pu(a);for(;o||l;){let c=!1,d=!1;if(o&&l){let u=i(o,l);u<0?d=!0:u>0&&(c=!0)}else o!=null?d=!0:c=!0;c?(n(l),l=pu(a)):d?(r(o),o=pu(s)):(o=pu(s),l=pu(a))}}function pu(t){return t.hasNext()?t.getNext():void 0}var Hn=class t{constructor(e){this.fields=e,e.sort(ei.comparator)}static empty(){return new t([])}unionWith(e){let i=new bt(ei.comparator);for(let n of this.fields)i=i.add(n);for(let n of e)i=i.add(n);return new t(i.toArray())}covers(e){for(let i of this.fields)if(i.isPrefixOf(e))return!0;return!1}isEqual(e){return Jl(this.fields,e.fields,(i,n)=>i.isEqual(n))}};function Hoe(t){return Buffer.from(t,"base64").toString("binary")}function Woe(t){return Buffer.from(t,"binary").toString("base64")}function Xq(){return!0}var Ri=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let i=Hoe(e);return new t(i)}static fromUint8Array(e){let i=Goe(e);return new t(i)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return Woe(this.binaryString)}toUint8Array(){return Koe(this.binaryString)}approximateByteSize(){return this.binaryString.length*2}compareTo(e){return Re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ri.EMPTY_BYTE_STRING=new Ri("");function Goe(t){let e="";for(let i=0;i<t.length;++i)e+=String.fromCharCode(t[i]);return e}function Koe(t){let e=new Uint8Array(t.length);for(let i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e}var $oe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ao(t){if(oe(!!t),typeof t=="string"){let e=0,i=$oe.exec(t);if(oe(!!i),i[1]){let s=i[1];s=(s+"000000000").substr(0,9),e=Number(s)}let n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}else{let e=Wt(t.seconds),i=Wt(t.nanos);return{seconds:e,nanos:i}}}function Wt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ro(t){return typeof t=="string"?Ri.fromBase64String(t):Ri.fromUint8Array(t)}var Zq="server_timestamp",Jq="__type__",e5="__previous_value__",t5="__local_write_time__";function $0(t){var e,i;return((i=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Jq])===null||i===void 0?void 0:i.stringValue)===Zq}function Yoe(t,e){let i={fields:{[Jq]:{stringValue:Zq},[t5]:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&$0(e)&&(e=rR(e)),e&&(i.fields[e5]=e),{mapValue:i}}function rR(t){let e=t.mapValue.fields[e5];return $0(e)?rR(e):e}function mp(t){let e=Ao(t.mapValue.fields[t5].timestampValue);return new Bt(e.seconds,e.nanos)}var mk=class{constructor(e,i,n,r,s,a,o,l,c){this.databaseId=e,this.appId=i,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}},IU="(default)",Mo=class t{constructor(e,i){this.projectId=e,this.database=i||IU}static empty(){return new t("","")}get isDefaultDatabase(){return this.database===IU}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};function Qoe(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new D(T.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mo(t.options.projectId,e)}var Do=-1;function Vp(t){return t==null}function pp(t){return t===0&&1/t===-1/0}function i5(t){return typeof t=="number"&&Number.isInteger(t)&&!pp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var n5="__max__",To={mapValue:{fields:{__type__:{stringValue:n5}}}},$y={nullValue:"NULL_VALUE"};function tc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$0(t)?4:r5(t)?9007199254740991:10:Y()}function Hr(t,e){if(t===e)return!0;let i=tc(t),n=tc(e);if(i!==n)return!1;switch(i){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return mp(t).isEqual(mp(e));case 3:return Xoe(t,e);case 5:return t.stringValue===e.stringValue;case 6:return Joe(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return Zoe(t,e);case 2:return ele(t,e);case 9:return Jl(t.arrayValue.values||[],e.arrayValue.values||[],Hr);case 10:return tle(t,e);case 9007199254740991:return!0;default:return Y()}}function Xoe(t,e){if(typeof t.timestampValue=="string"&&typeof e.timestampValue=="string"&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;let i=Ao(t.timestampValue),n=Ao(e.timestampValue);return i.seconds===n.seconds&&i.nanos===n.nanos}function Zoe(t,e){return Wt(t.geoPointValue.latitude)===Wt(e.geoPointValue.latitude)&&Wt(t.geoPointValue.longitude)===Wt(e.geoPointValue.longitude)}function Joe(t,e){return Ro(t.bytesValue).isEqual(Ro(e.bytesValue))}function ele(t,e){if("integerValue"in t&&"integerValue"in e)return Wt(t.integerValue)===Wt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){let i=Wt(t.doubleValue),n=Wt(e.doubleValue);return i===n?pp(i)===pp(n):isNaN(i)&&isNaN(n)}return!1}function tle(t,e){let i=t.mapValue.fields||{},n=e.mapValue.fields||{};if(TU(i)!==TU(n))return!1;for(let r in i)if(i.hasOwnProperty(r)&&(n[r]===void 0||!Hr(i[r],n[r])))return!1;return!0}function gp(t,e){return(t.values||[]).find(i=>Hr(i,e))!==void 0}function Oo(t,e){if(t===e)return 0;let i=tc(t),n=tc(e);if(i!==n)return Re(i,n);switch(i){case 0:case 9007199254740991:return 0;case 1:return Re(t.booleanValue,e.booleanValue);case 2:return ile(t,e);case 3:return DU(t.timestampValue,e.timestampValue);case 4:return DU(mp(t),mp(e));case 5:return Re(t.stringValue,e.stringValue);case 6:return sle(t.bytesValue,e.bytesValue);case 7:return nle(t.referenceValue,e.referenceValue);case 8:return rle(t.geoPointValue,e.geoPointValue);case 9:return ale(t.arrayValue,e.arrayValue);case 10:return ole(t.mapValue,e.mapValue);default:throw Y()}}function ile(t,e){let i=Wt(t.integerValue||t.doubleValue),n=Wt(e.integerValue||e.doubleValue);return i<n?-1:i>n?1:i===n?0:isNaN(i)?isNaN(n)?0:-1:1}function DU(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Re(t,e);let i=Ao(t),n=Ao(e),r=Re(i.seconds,n.seconds);return r!==0?r:Re(i.nanos,n.nanos)}function nle(t,e){let i=t.split("/"),n=e.split("/");for(let r=0;r<i.length&&r<n.length;r++){let s=Re(i[r],n[r]);if(s!==0)return s}return Re(i.length,n.length)}function rle(t,e){let i=Re(Wt(t.latitude),Wt(e.latitude));return i!==0?i:Re(Wt(t.longitude),Wt(e.longitude))}function sle(t,e){let i=Ro(t),n=Ro(e);return i.compareTo(n)}function ale(t,e){let i=t.values||[],n=e.values||[];for(let r=0;r<i.length&&r<n.length;++r){let s=Oo(i[r],n[r]);if(s)return s}return Re(i.length,n.length)}function ole(t,e){if(t===To.mapValue&&e===To.mapValue)return 0;if(t===To.mapValue)return 1;if(e===To.mapValue)return-1;let i=t.fields||{},n=Object.keys(i),r=e.fields||{},s=Object.keys(r);n.sort(),s.sort();for(let a=0;a<n.length&&a<s.length;++a){let o=Re(n[a],s[a]);if(o!==0)return o;let l=Oo(i[n[a]],r[s[a]]);if(l!==0)return l}return Re(n.length,s.length)}function Mu(t){return sR(t)}function sR(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?cle(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?lle(t.bytesValue):"referenceValue"in t?ule(t.referenceValue):"geoPointValue"in t?dle(t.geoPointValue):"arrayValue"in t?fle(t.arrayValue):"mapValue"in t?hle(t.mapValue):Y()}function lle(t){return Ro(t).toBase64()}function cle(t){let e=Ao(t);return`time(${e.seconds},${e.nanos})`}function dle(t){return`geo(${t.latitude},${t.longitude})`}function ule(t){return z.fromName(t).toString()}function hle(t){let e=Object.keys(t.fields||{}).sort(),i="{",n=!0;for(let r of e)n?n=!1:i+=",",i+=`${r}:${sR(t.fields[r])}`;return i+"}"}function fle(t){let e="[",i=!0;for(let n of t.values||[])i?i=!1:e+=",",e+=sR(n);return e+"]"}function ic(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function pk(t){return!!t&&"integerValue"in t}function mle(t){return!!t&&"doubleValue"in t}function ple(t){return pk(t)||mle(t)}function _p(t){return!!t&&"arrayValue"in t}function kU(t){return!!t&&"nullValue"in t}function AU(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yy(t){return!!t&&"mapValue"in t}function op(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return mc(t.mapValue.fields,(i,n)=>e.mapValue.fields[i]=op(n)),e}else if(t.arrayValue){let e={arrayValue:{values:[]}};for(let i=0;i<(t.arrayValue.values||[]).length;++i)e.arrayValue.values[i]=op(t.arrayValue.values[i]);return e}else return Object.assign({},t)}function r5(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===n5}function gle(t){return"nullValue"in t?$y:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ic(Mo.empty(),z.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:Y()}function _le(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ic(Mo.empty(),z.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?To:Y()}function RU(t,e){let i=Oo(t.value,e.value);return i!==0?i:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function MU(t,e){let i=Oo(t.value,e.value);return i!==0?i:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Zi=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let i=this.value;for(let n=0;n<e.length-1;++n)if(i=(i.mapValue.fields||{})[e.get(n)],!Yy(i))return null;return i=(i.mapValue.fields||{})[e.lastSegment()],i||null}}set(e,i){let n=this.getFieldsMap(e.popLast());n[e.lastSegment()]=op(i)}setAll(e){let i=ei.emptyPath(),n={},r=[];e.forEach((a,o)=>{if(!i.isImmediateParentOf(o)){let l=this.getFieldsMap(i);this.applyChanges(l,n,r),n={},r=[],i=o.popLast()}a?n[o.lastSegment()]=op(a):r.push(o.lastSegment())});let s=this.getFieldsMap(i);this.applyChanges(s,n,r)}delete(e){let i=this.field(e.popLast());Yy(i)&&i.mapValue.fields&&delete i.mapValue.fields[e.lastSegment()]}isEqual(e){return Hr(this.value,e.value)}getFieldsMap(e){let i=this.value;i.mapValue.fields||(i.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=i.mapValue.fields[e.get(n)];(!Yy(r)||!r.mapValue.fields)&&(r={mapValue:{fields:{}}},i.mapValue.fields[e.get(n)]=r),i=r}return i.mapValue.fields}applyChanges(e,i,n){mc(i,(r,s)=>e[r]=s);for(let r of n)delete e[r]}clone(){return new t(op(this.value))}};function s5(t){let e=[];return mc(t.fields,(i,n)=>{let r=new ei([i]);if(Yy(n)){let a=s5(n.mapValue).fields;if(a.length===0)e.push(r);else for(let o of a)e.push(r.child(o))}else e.push(r)}),new Hn(e)}var di=class t{constructor(e,i,n,r,s,a,o){this.key=e,this.documentType=i,this.version=n,this.readTime=r,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new t(e,0,pe.min(),pe.min(),pe.min(),Zi.empty(),0)}static newFoundDocument(e,i,n,r){return new t(e,1,i,pe.min(),n,r,0)}static newNoDocument(e,i){return new t(e,2,i,pe.min(),pe.min(),Zi.empty(),0)}static newUnknownDocument(e,i){return new t(e,3,i,pe.min(),pe.min(),Zi.empty(),2)}convertToFoundDocument(e,i){return this.createTime.isEqual(pe.min())&&(this.documentType===2||this.documentType===0)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=i,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};function ble(t,e,i){let n=e.data.field(t),r=i.data.field(t);return n!==null&&r!==null?Oo(n,r):Y()}var zs=class{constructor(e,i){this.position=e,this.inclusive=i}};function a5(t,e,i){let n=0;for(let r=0;r<t.position.length;r++){let s=e[r],a=t.position[r];if(s.field.isKeyField())n=z.comparator(z.fromName(a.referenceValue),i.key);else{let o=i.data.field(s.field);n=Oo(a,o)}if(s.dir==="desc"&&(n=n*-1),n!==0)break}return n}function vle(t,e,i){let n=a5(t,e,i);return t.inclusive?n>=0:n>0}function yle(t,e,i){let n=a5(t,e,i);return t.inclusive?n<=0:n<0}function OU(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let i=0;i<t.position.length;i++){let n=t.position[i],r=e.position[i];if(!Hr(n,r))return!1}return!0}var nc=class{constructor(e,i="asc"){this.field=e,this.dir=i}};function wle(t){return t.field.canonicalString()+t.dir}function Cle(t){return`${t.field.canonicalString()} (${t.dir})`}function Ele(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var s0=class{},$e=class t extends s0{constructor(e,i,n){super(),this.field=e,this.op=i,this.value=n}static create(e,i,n){return e.isKeyField()?i==="in"||i==="not-in"?this.createKeyFieldInFilter(e,i,n):new bk(e,i,n):i==="array-contains"?new wk(e,n):i==="in"?new a0(e,n):i==="not-in"?new Ck(e,n):i==="array-contains-any"?new Ek(e,n):new t(e,i,n)}static createKeyFieldInFilter(e,i,n){return i==="in"?new vk(e,n):new yk(e,n)}matches(e){let i=e.data.field(this.field);return this.op==="!="?i!==null&&this.matchesComparison(Oo(i,this.value)):i!==null&&tc(this.value)===tc(i)&&this.matchesComparison(Oo(i,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},dt=class t extends s0{constructor(e,i){super(),this.filters=e,this.op=i,this.memoizedFlattenedFilters=null}static create(e,i){return new t(e,i)}matches(e){return Ou(this)?this.filters.find(i=>!i.matches(e))===void 0:this.filters.find(i=>i.matches(e))!==void 0}getFlattenedFilters(){return this.memoizedFlattenedFilters!==null?this.memoizedFlattenedFilters:(this.memoizedFlattenedFilters=this.filters.reduce((e,i)=>e.concat(i.getFlattenedFilters()),[]),this.memoizedFlattenedFilters)}getFilters(){return Object.assign([],this.filters)}};function Ou(t){return t.op==="and"}function gk(t){return t.op==="or"}function aR(t){return o5(t)&&Ou(t)}function o5(t){for(let e of t.filters)if(e instanceof dt)return!1;return!0}function _k(t){if(t instanceof $e)return t.field.canonicalString()+t.op.toString()+Mu(t.value);if(aR(t))return t.filters.map(e=>_k(e)).join(",");{let e=t.filters.map(i=>_k(i)).join(",");return`${t.op}(${e})`}}function l5(t,e){if(t instanceof $e)return Sle(t,e);if(t instanceof dt)return xle(t,e);Y()}function Sle(t,e){return e instanceof $e&&t.op===e.op&&t.field.isEqual(e.field)&&Hr(t.value,e.value)}function xle(t,e){return e instanceof dt&&t.op===e.op&&t.filters.length===e.filters.length?t.filters.reduce((n,r,s)=>n&&l5(r,e.filters[s]),!0):!1}function c5(t,e){let i=t.filters.concat(e);return dt.create(i,t.op)}function d5(t){return t instanceof $e?Ile(t):t instanceof dt?Tle(t):"Filter"}function Tle(t){return t.op.toString()+" {"+t.getFilters().map(d5).join(" ,")+"}"}function Ile(t){return`${t.field.canonicalString()} ${t.op} ${Mu(t.value)}`}var bk=class extends $e{constructor(e,i,n){super(e,i,n),this.key=z.fromName(n.referenceValue)}matches(e){let i=z.comparator(e.key,this.key);return this.matchesComparison(i)}},vk=class extends $e{constructor(e,i){super(e,"in",i),this.keys=u5("in",i)}matches(e){return this.keys.some(i=>i.isEqual(e.key))}},yk=class extends $e{constructor(e,i){super(e,"not-in",i),this.keys=u5("not-in",i)}matches(e){return!this.keys.some(i=>i.isEqual(e.key))}};function u5(t,e){var i;return(((i=e.arrayValue)===null||i===void 0?void 0:i.values)||[]).map(n=>z.fromName(n.referenceValue))}var wk=class extends $e{constructor(e,i){super(e,"array-contains",i)}matches(e){let i=e.data.field(this.field);return _p(i)&&gp(i.arrayValue,this.value)}},a0=class extends $e{constructor(e,i){super(e,"in",i)}matches(e){let i=e.data.field(this.field);return i!==null&&gp(this.value.arrayValue,i)}},Ck=class extends $e{constructor(e,i){super(e,"not-in",i)}matches(e){if(gp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let i=e.data.field(this.field);return i!==null&&!gp(this.value.arrayValue,i)}},Ek=class extends $e{constructor(e,i){super(e,"array-contains-any",i)}matches(e){let i=e.data.field(this.field);return!_p(i)||!i.arrayValue.values?!1:i.arrayValue.values.some(n=>gp(this.value.arrayValue,n))}};var Sk=class{constructor(e,i=null,n=[],r=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=i,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=a,this.endAt=o,this.memoizedCanonicalId=null}};function xk(t,e=null,i=[],n=[],r=null,s=null,a=null){return new Sk(t,e,i,n,r,s,a)}function rc(t){let e=U(t);if(e.memoizedCanonicalId===null){let i=e.path.canonicalString();e.collectionGroup!==null&&(i+="|cg:"+e.collectionGroup),i+="|f:",i+=e.filters.map(n=>_k(n)).join(","),i+="|ob:",i+=e.orderBy.map(n=>wle(n)).join(","),Vp(e.limit)||(i+="|l:",i+=e.limit),e.startAt&&(i+="|lb:",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(n=>Mu(n)).join(",")),e.endAt&&(i+="|ub:",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(n=>Mu(n)).join(",")),e.memoizedCanonicalId=i}return e.memoizedCanonicalId}function Dle(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(i=>d5(i)).join(", ")}]`),Vp(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(i=>Cle(i)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(i=>Mu(i)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(i=>Mu(i)).join(",")),`Target(${e})`}function jp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<t.orderBy.length;i++)if(!Ele(t.orderBy[i],e.orderBy[i]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(!l5(t.filters[i],e.filters[i]))return!1;return t.collectionGroup!==e.collectionGroup||!t.path.isEqual(e.path)||!OU(t.startAt,e.startAt)?!1:OU(t.endAt,e.endAt)}function o0(t){return z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Y0(t,e){return t.filters.filter(i=>i instanceof $e&&i.field.isEqual(e))}function kle(t,e){let i=XA(e);if(i===void 0)return null;for(let n of Y0(t,i.fieldPath))switch(n.op){case"array-contains-any":return n.value.arrayValue.values||[];case"array-contains":return[n.value]}return null}function Ale(t,e){let i=new Map;for(let n of ec(e))for(let r of Y0(t,n.fieldPath))switch(r.op){case"==":case"in":i.set(n.fieldPath.canonicalString(),r.value);break;case"not-in":case"!=":return i.set(n.fieldPath.canonicalString(),r.value),Array.from(i.values())}return null}function Rle(t,e){let i=[],n=!0;for(let r of ec(e)){let s=r.kind===0?h5(t,r.fieldPath,t.startAt):f5(t,r.fieldPath,t.startAt);i.push(s.value),n&&(n=s.inclusive)}return new zs(i,n)}function Mle(t,e){let i=[],n=!0;for(let r of ec(e)){let s=r.kind===0?f5(t,r.fieldPath,t.endAt):h5(t,r.fieldPath,t.endAt);i.push(s.value),n&&(n=s.inclusive)}return new zs(i,n)}function h5(t,e,i){let n=$y,r=!0;for(let s of Y0(t,e)){let a=$y,o=!0;switch(s.op){case"<":case"<=":a=gle(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=$y;break}RU({value:n,inclusive:r},{value:a,inclusive:o})<0&&(n=a,r=o)}if(i!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=i.position[s];RU({value:n,inclusive:r},{value:o,inclusive:i.inclusive})<0&&(n=o,r=i.inclusive);break}}return{value:n,inclusive:r}}function f5(t,e,i){let n=To,r=!0;for(let s of Y0(t,e)){let a=To,o=!0;switch(s.op){case">=":case">":a=_le(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=To;break}MU({value:n,inclusive:r},{value:a,inclusive:o})>0&&(n=a,r=o)}if(i!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=i.position[s];MU({value:n,inclusive:r},{value:o,inclusive:i.inclusive})>0&&(n=o,r=i.inclusive);break}}return{value:n,inclusive:r}}function Ole(t){let e=new bt(ei.comparator),i=!1;for(let n of t.filters)for(let r of n.getFlattenedFilters())r.field.isKeyField()||(r.op==="array-contains"||r.op==="array-contains-any"?i=!0:e=e.add(r.field));for(let n of t.orderBy)n.field.isKeyField()||(e=e.add(n.field));return e.size+(i?1:0)}function Nle(t){return t.limit!==null}var Wr=class{constructor(e,i=null,n=[],r=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=i,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}};function m5(t,e,i,n,r,s,a,o){return new Wr(t,e,i,n,r,s,a,o)}function Xu(t){return new Wr(t)}function Ple(t,e){return new Wr(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}function NU(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Fle(t){let e=new bt(ei.comparator);return t.filters.forEach(i=>{i.getFlattenedFilters().forEach(r=>{r.isInequality()&&(e=e.add(r.field))})}),e}function Lle(t){return new Wr(Qe.emptyPath(),t)}function Ble(t){return z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function oR(t){return t.collectionGroup!==null}function Nu(t){let e=U(t);if(e.memoizedNormalizedOrderBy===null){e.memoizedNormalizedOrderBy=[];let i=new Set;for(let s of e.explicitOrderBy)e.memoizedNormalizedOrderBy.push(s),i.add(s.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";Fle(e).forEach(s=>{!i.has(s.canonicalString())&&!s.isKeyField()&&e.memoizedNormalizedOrderBy.push(new nc(s,n))}),i.has(ei.keyField().canonicalString())||e.memoizedNormalizedOrderBy.push(new nc(ei.keyField(),n))}return e.memoizedNormalizedOrderBy}function _n(t){let e=U(t);return e.memoizedTarget||(e.memoizedTarget=Vle(e,Nu(t))),e.memoizedTarget}function Vle(t,e){if(t.limitType==="F")return xk(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new nc(r.field,s)});let i=t.endAt?new zs(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new zs(t.startAt.position,t.startAt.inclusive):null;return xk(t.path,t.collectionGroup,e,t.filters,t.limit,i,n)}}function lR(t,e){let i=t.filters.concat([e]);return new Wr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),i,t.limit,t.limitType,t.startAt,t.endAt)}function jle(t,e){let i=t.explicitOrderBy.concat([e]);return new Wr(t.path,t.collectionGroup,i,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}function l0(t,e,i){return new Wr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,i,t.startAt,t.endAt)}function zle(t,e){return new Wr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function Ule(t,e){return new Wr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function zp(t,e){return jp(_n(t),_n(e))&&t.limitType===e.limitType}function p5(t){return`${rc(_n(t))}|lt:${t.limitType}`}function Cu(t){return`Query(target=${Dle(_n(t))}; limitType=${t.limitType})`}function Up(t,e){return e.isFoundDocument()&&qle(t,e)&&Hle(t,e)&&Wle(t,e)&&Gle(t,e)}function qle(t,e){let i=e.key.path;return t.collectionGroup!==null?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):z.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}function Hle(t,e){for(let i of Nu(t))if(!i.field.isKeyField()&&e.data.field(i.field)===null)return!1;return!0}function Wle(t,e){for(let i of t.filters)if(!i.matches(e))return!1;return!0}function Gle(t,e){return!(t.startAt&&!yle(t.startAt,Nu(t),e)||t.endAt&&!vle(t.endAt,Nu(t),e))}function g5(t){return t.collectionGroup||(t.path.length%2===1?t.path.lastSegment():t.path.get(t.path.length-2))}function _5(t){return(e,i)=>{let n=!1;for(let r of Nu(t)){let s=Kle(r,e,i);if(s!==0)return s;n=n||r.field.isKeyField()}return 0}}function Kle(t,e,i){let n=t.field.isKeyField()?z.comparator(e.key,i.key):ble(t.field,e,i);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Y()}}var Us=class{constructor(e,i){this.mapKeyFn=e,this.equalsFn=i,this.inner={},this.innerSize=0}get(e){let i=this.mapKeyFn(e),n=this.inner[i];if(n!==void 0){for(let[r,s]of n)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,i){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0){this.inner[n]=[[e,i]],this.innerSize++;return}for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e)){r[s]=[e,i];return}r.push([e,i]),this.innerSize++}delete(e){let i=this.mapKeyFn(e),n=this.inner[i];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[i]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){mc(this.inner,(i,n)=>{for(let[r,s]of n)e(r,s)})}isEmpty(){return Qq(this.inner)}size(){return this.innerSize}};var $le=new Dt(z.comparator);function Dn(){return $le}var b5=new Dt(z.comparator);function np(...t){let e=b5;for(let i of t)e=e.insert(i.key,i);return e}function Yle(){return bp()}function v5(t){let e=b5;return t.forEach((i,n)=>e=e.insert(i,n.overlayedDocument)),e}function Bs(){return bp()}function y5(){return bp()}function bp(){return new Us(t=>t.toString(),(t,e)=>t.isEqual(e))}var Qle=new Dt(z.comparator);function Xle(){return Qle}var Zle=new bt(z.comparator);function Oe(...t){let e=Zle;for(let i of t)e=e.add(i);return e}var Jle=new bt(Re);function cR(){return Jle}function w5(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pp(e)?"-0":e}}function C5(t){return{integerValue:""+t}}function E5(t,e){return i5(e)?C5(e):w5(t,e)}var Pu=class{constructor(){this._=void 0}};function ece(t,e,i){return t instanceof No?Yoe(i,e):t instanceof ua?x5(t,e):t instanceof ha?T5(t,e):nce(t,e)}function tce(t,e,i){return t instanceof ua?x5(t,e):t instanceof ha?T5(t,e):i}function S5(t,e){return t instanceof Po?ple(e)?e:{integerValue:0}:null}function ice(t,e){return t instanceof ua&&e instanceof ua||t instanceof ha&&e instanceof ha?Jl(t.elements,e.elements,Hr):t instanceof Po&&e instanceof Po?Hr(t.operand,e.operand):t instanceof No&&e instanceof No}var No=class extends Pu{},ua=class extends Pu{constructor(e){super(),this.elements=e}};function x5(t,e){let i=I5(e);for(let n of t.elements)i.some(r=>Hr(r,n))||i.push(n);return{arrayValue:{values:i}}}var ha=class extends Pu{constructor(e){super(),this.elements=e}};function T5(t,e){let i=I5(e);for(let n of t.elements)i=i.filter(r=>!Hr(r,n));return{arrayValue:{values:i}}}var Po=class extends Pu{constructor(e,i){super(),this.serializer=e,this.operand=i}};function nce(t,e){let i=S5(t,e),n=PU(i)+PU(t.operand);return pk(i)&&pk(t.operand)?C5(n):w5(t.serializer,n)}function PU(t){return Wt(t.integerValue||t.doubleValue)}function I5(t){return _p(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var sc=class{constructor(e,i){this.field=e,this.transform=i}};function rce(t,e){return t.field.isEqual(e.field)&&ice(t.transform,e.transform)}function sce(t,e){return t===void 0&&e===void 0?!0:t&&e?Jl(t,e,(i,n)=>rce(i,n)):!1}var Tk=class{constructor(e,i){this.version=e,this.transformResults=i}},Ht=class t{constructor(e,i){this.updateTime=e,this.exists=i}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Q0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists!==void 0?t.exists===e.isFoundDocument():!0}var Fu=class{};function D5(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Lo(t.key,Ht.none()):new Fo(t.key,t.data,Ht.none());{let i=t.data,n=Zi.empty(),r=new bt(ei.comparator);for(let s of e.fields)if(!r.has(s)){let a=i.field(s);a===null&&s.length>1&&(s=s.popLast(),a=i.field(s)),a===null?n.delete(s):n.set(s,a),r=r.add(s)}return new Gr(t.key,n,new Hn(r.toArray()),Ht.none())}}function ace(t,e,i){t instanceof Fo?lce(t,e,i):t instanceof Gr?dce(t,e,i):hce(t,e,i)}function lp(t,e,i,n){return t instanceof Fo?cce(t,e,i,n):t instanceof Gr?uce(t,e,i,n):fce(t,e,i)}function oce(t,e){let i=null;for(let n of t.fieldTransforms){let r=e.data.field(n.field),s=S5(n.transform,r||null);s!=null&&(i===null&&(i=Zi.empty()),i.set(n.field,s))}return i||null}function FU(t,e){return t.type!==e.type||!t.key.isEqual(e.key)||!t.precondition.isEqual(e.precondition)||!sce(t.fieldTransforms,e.fieldTransforms)?!1:t.type===0?t.value.isEqual(e.value):t.type===1?t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask):!0}var Fo=class extends Fu{constructor(e,i,n,r=[]){super(),this.key=e,this.value=i,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}};function lce(t,e,i){let n=t.value.clone(),r=A5(t.fieldTransforms,e,i.transformResults);n.setAll(r),e.convertToFoundDocument(i.version,n).setHasCommittedMutations()}function cce(t,e,i,n){if(!Q0(t.precondition,e))return i;let r=t.value.clone(),s=R5(t.fieldTransforms,n,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}var Gr=class extends Fu{constructor(e,i,n,r,s=[]){super(),this.key=e,this.data=i,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function dce(t,e,i){if(!Q0(t.precondition,e)){e.convertToUnknownDocument(i.version);return}let n=A5(t.fieldTransforms,e,i.transformResults),r=e.data;r.setAll(k5(t)),r.setAll(n),e.convertToFoundDocument(i.version,r).setHasCommittedMutations()}function uce(t,e,i,n){if(!Q0(t.precondition,e))return i;let r=R5(t.fieldTransforms,n,e),s=e.data;return s.setAll(k5(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),i===null?null:i.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map(a=>a.field))}function k5(t){let e=new Map;return t.fieldMask.fields.forEach(i=>{if(!i.isEmpty()){let n=t.data.field(i);e.set(i,n)}}),e}function A5(t,e,i){let n=new Map;oe(t.length===i.length);for(let r=0;r<i.length;r++){let s=t[r],a=s.transform,o=e.data.field(s.field);n.set(s.field,tce(a,o,i[r]))}return n}function R5(t,e,i){let n=new Map;for(let r of t){let s=r.transform,a=i.data.field(r.field);n.set(r.field,ece(s,a,e))}return n}var Lo=class extends Fu{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};function hce(t,e,i){e.convertToNoDocument(i.version).setHasCommittedMutations()}function fce(t,e,i){return Q0(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):i}var vp=class extends Fu{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var yp=class{constructor(e,i,n,r){this.batchId=e,this.localWriteTime=i,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,i){let n=i.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];if(s.key.isEqual(e.key)){let a=n[r];ace(s,e,a)}}}applyToLocalView(e,i){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(i=lp(n,e,i,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(i=lp(n,e,i,this.localWriteTime));return i}applyToLocalDocumentSet(e,i){let n=y5();return this.mutations.forEach(r=>{let s=e.get(r.key),a=s.overlayedDocument,o=this.applyToLocalView(a,s.mutatedFields);o=i.has(r.key)?null:o;let l=D5(a,o);l!==null&&n.set(r.key,l),a.isValidDocument()||a.convertToNoDocument(pe.min())}),n}keys(){return this.mutations.reduce((e,i)=>e.add(i.key),Oe())}isEqual(e){return this.batchId===e.batchId&&Jl(this.mutations,e.mutations,(i,n)=>FU(i,n))&&Jl(this.baseMutations,e.baseMutations,(i,n)=>FU(i,n))}},Ik=class t{constructor(e,i,n,r){this.batch=e,this.commitVersion=i,this.mutationResults=n,this.docVersions=r}static from(e,i,n){oe(e.mutations.length===n.length);let r=Xle(),s=e.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,n[a].version);return new t(e,i,n,r)}};var wp=class{constructor(e,i){this.largestBatchId=e,this.mutation=i}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Dk=class{constructor(e,i){this.count=e,this.unchangedNames=i}};var Ai=function(t){return t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS",t}(Ai||{});function M5(t){switch(t){case T.OK:return Y();case T.CANCELLED:case T.UNKNOWN:case T.DEADLINE_EXCEEDED:case T.RESOURCE_EXHAUSTED:case T.INTERNAL:case T.UNAVAILABLE:case T.UNAUTHENTICATED:return!1;case T.INVALID_ARGUMENT:case T.NOT_FOUND:case T.ALREADY_EXISTS:case T.PERMISSION_DENIED:case T.FAILED_PRECONDITION:case T.ABORTED:case T.OUT_OF_RANGE:case T.UNIMPLEMENTED:case T.DATA_LOSS:return!0;default:return Y()}}function mce(t){return M5(t)&&t!==T.ABORTED}function Qy(t){if(t===void 0)return Lt("GRPC error has no .code"),T.UNKNOWN;switch(t){case Ai.OK:return T.OK;case Ai.CANCELLED:return T.CANCELLED;case Ai.UNKNOWN:return T.UNKNOWN;case Ai.DEADLINE_EXCEEDED:return T.DEADLINE_EXCEEDED;case Ai.RESOURCE_EXHAUSTED:return T.RESOURCE_EXHAUSTED;case Ai.INTERNAL:return T.INTERNAL;case Ai.UNAVAILABLE:return T.UNAVAILABLE;case Ai.UNAUTHENTICATED:return T.UNAUTHENTICATED;case Ai.INVALID_ARGUMENT:return T.INVALID_ARGUMENT;case Ai.NOT_FOUND:return T.NOT_FOUND;case Ai.ALREADY_EXISTS:return T.ALREADY_EXISTS;case Ai.PERMISSION_DENIED:return T.PERMISSION_DENIED;case Ai.FAILED_PRECONDITION:return T.FAILED_PRECONDITION;case Ai.ABORTED:return T.ABORTED;case Ai.OUT_OF_RANGE:return T.OUT_OF_RANGE;case Ai.UNIMPLEMENTED:return T.UNIMPLEMENTED;case Ai.DATA_LOSS:return T.DATA_LOSS;default:return Y()}}var kk=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var U1=null;function O5(){return new Yae}function pce(){return new Qae("utf-8")}var gce=new Ml([4294967295,4294967295],0);function LU(t){let e=O5().encode(t),i=new HV;return i.update(e),new Uint8Array(i.digest())}function BU(t){let e=new DataView(t.buffer),i=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0),a=new Ml([i,n],0),o=new Ml([r,s],0);return[a,o]}var Ak=class t{constructor(e,i,n){if(this.bitmap=e,this.padding=i,this.hashCount=n,i<0||i>=8)throw new Ql(`Invalid padding: ${i}`);if(n<0)throw new Ql(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ql(`Invalid hash count: ${n}`);if(e.length===0&&i!==0)throw new Ql(`Invalid padding when bitmap length is 0: ${i}`);this.bitCount=e.length*8-i,this.bitCountInInteger=Ml.fromNumber(this.bitCount)}getBitIndex(e,i,n){let r=e.add(i.multiply(Ml.fromNumber(n)));return r.compare(gce)===1&&(r=new Ml([r.getBits(0),r.getBits(1)],0)),r.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){let i=this.bitmap[Math.floor(e/8)],n=e%8;return(i&1<<n)!==0}mightContain(e){if(this.bitCount===0)return!1;let i=LU(e),[n,r]=BU(i);for(let s=0;s<this.hashCount;s++){let a=this.getBitIndex(n,r,s);if(!this.isBitSet(a))return!1}return!0}static create(e,i,n){let r=e%8===0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new t(s,r,i);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.bitCount===0)return;let i=LU(e),[n,r]=BU(i);for(let s=0;s<this.hashCount;s++){let a=this.getBitIndex(n,r,s);this.setBit(a)}}setBit(e){let i=Math.floor(e/8),n=e%8;this.bitmap[i]|=1<<n}},Ql=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Cp=class t{constructor(e,i,n,r,s){this.snapshotVersion=e,this.targetChanges=i,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,i,n){let r=new Map;return r.set(e,Ep.createSynthesizedTargetChangeForCurrentChange(e,i,n)),new t(pe.min(),r,new Dt(Re),Dn(),Oe())}},Ep=class t{constructor(e,i,n,r,s){this.resumeToken=e,this.current=i,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,i,n){return new t(n,i,Oe(),Oe(),Oe())}};var ku=class{constructor(e,i,n,r){this.updatedTargetIds=e,this.removedTargetIds=i,this.key=n,this.newDoc=r}},c0=class{constructor(e,i){this.targetId=e,this.existenceFilter=i}},d0=class{constructor(e,i,n=Ri.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=i,this.resumeToken=n,this.cause=r}},u0=class{constructor(){this.pendingResponses=0,this.documentChanges=jU(),this._resumeToken=Ri.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return this.pendingResponses!==0}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=Oe(),i=Oe(),n=Oe();return this.documentChanges.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:i=i.add(r);break;case 1:n=n.add(r);break;default:Y()}}),new Ep(this._resumeToken,this._current,e,i,n)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=jU()}addDocumentChange(e,i){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,i)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,oe(this.pendingResponses>=0)}markCurrent(){this._hasPendingChanges=!0,this._current=!0}},_ce="WatchChangeAggregator",Rk=class{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=Dn(),this.pendingDocumentTargetMapping=VU(),this.pendingTargetResets=new Dt(Re)}handleDocumentChange(e){for(let i of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(i,e.newDoc):this.removeDocumentFromTarget(i,e.key,e.newDoc);for(let i of e.removedTargetIds)this.removeDocumentFromTarget(i,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,i=>{let n=this.ensureTargetState(i);switch(e.state){case 0:this.isActiveTarget(i)&&n.updateResumeToken(e.resumeToken);break;case 1:n.recordTargetResponse(),n.isPending||n.clearPendingChanges(),n.updateResumeToken(e.resumeToken);break;case 2:n.recordTargetResponse(),n.isPending||this.removeTarget(i);break;case 3:this.isActiveTarget(i)&&(n.markCurrent(),n.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(i)&&(this.resetTarget(i),n.updateResumeToken(e.resumeToken));break;default:Y()}})}forEachTarget(e,i){e.targetIds.length>0?e.targetIds.forEach(i):this.targetStates.forEach((n,r)=>{this.isActiveTarget(r)&&i(r)})}handleExistenceFilter(e){let i=e.targetId,n=e.existenceFilter.count,r=this.targetDataForActiveTarget(i);if(r){let s=r.target;if(o0(s))if(n===0){let a=new z(s.path);this.removeDocumentFromTarget(i,a,di.newNoDocument(a,pe.min()))}else oe(n===1);else{let a=this.getCurrentDocumentCountForTarget(i);if(a!==n){let o=this.parseBloomFilter(e),l=o?this.applyBloomFilter(o,e,a):1;if(l!==0){this.resetTarget(i);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(i,c)}U1?.notifyOnExistenceFilterMismatch(bce(a,e.existenceFilter,this.metadataProvider.getDatabaseId(),o,l))}}}}parseBloomFilter(e){let i=e.existenceFilter.unchangedNames;if(!i||!i.bits)return null;let{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=i,a;try{a=Ro(n).toUint8Array()}catch(l){if(l instanceof kk)return wr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}let o;try{o=new Ak(a,r,s)}catch(l){return l instanceof Ql?wr("BloomFilter error: ",l):wr("Applying bloom filter failed: ",l),null}return o.bitCount===0?null:o}applyBloomFilter(e,i,n){let r=i.existenceFilter.count,s=this.filterRemovedDocuments(e,i.targetId);return r===n-s?0:2}filterRemovedDocuments(e,i){let n=this.metadataProvider.getRemoteKeysForTarget(i),r=0;return n.forEach(s=>{let a=this.metadataProvider.getDatabaseId(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.removeDocumentFromTarget(i,s,null),r++)}),r}createRemoteEvent(e){let i=new Map;this.targetStates.forEach((s,a)=>{let o=this.targetDataForActiveTarget(a);if(o){if(s.current&&o0(o.target)){let l=new z(o.target.path);this.pendingDocumentUpdates.get(l)===null&&!this.targetContainsDocument(a,l)&&this.removeDocumentFromTarget(a,l,di.newNoDocument(l,e))}s.hasPendingChanges&&(i.set(a,s.toTargetChange()),s.clearPendingChanges())}});let n=Oe();this.pendingDocumentTargetMapping.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{let c=this.targetDataForActiveTarget(l);return c&&c.purpose!=="TargetPurposeLimboResolution"?(o=!1,!1):!0}),o&&(n=n.add(s))}),this.pendingDocumentUpdates.forEach((s,a)=>a.setReadTime(e));let r=new Cp(e,i,this.pendingTargetResets,this.pendingDocumentUpdates,n);return this.pendingDocumentUpdates=Dn(),this.pendingDocumentTargetMapping=VU(),this.pendingTargetResets=new Dt(Re),r}addDocumentToTarget(e,i){if(!this.isActiveTarget(e))return;let n=this.targetContainsDocument(e,i.key)?2:0;this.ensureTargetState(e).addDocumentChange(i.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(i.key,i),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(i.key,this.ensureDocumentTargetMapping(i.key).add(e))}removeDocumentFromTarget(e,i,n){if(!this.isActiveTarget(e))return;let r=this.ensureTargetState(e);this.targetContainsDocument(e,i)?r.addDocumentChange(i,1):r.removeDocumentChange(i),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(i,this.ensureDocumentTargetMapping(i).delete(e)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(i,n))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let n=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let i=this.targetStates.get(e);return i||(i=new u0,this.targetStates.set(e,i)),i}ensureDocumentTargetMapping(e){let i=this.pendingDocumentTargetMapping.get(e);return i||(i=new bt(Re),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,i)),i}isActiveTarget(e){let i=this.targetDataForActiveTarget(e)!==null;return i||N(_ce,"Detected inactive target",e),i}targetDataForActiveTarget(e){let i=this.targetStates.get(e);return i&&i.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new u0),this.metadataProvider.getRemoteKeysForTarget(e).forEach(n=>{this.removeDocumentFromTarget(e,n,null)})}targetContainsDocument(e,i){return this.metadataProvider.getRemoteKeysForTarget(e).has(i)}};function VU(){return new Dt(z.comparator)}function jU(){return new Dt(z.comparator)}function bce(t,e,i,n,r){var s,a,o,l,c,d;let u={localCacheCount:t,existenceFilterCount:e.count,databaseId:i.database,projectId:i.projectId},h=e.unchangedNames;return h&&(u.bloomFilter={applied:r===0,hashCount:(s=h?.hashCount)!==null&&s!==void 0?s:0,bitmapLength:(l=(o=(a=h?.bits)===null||a===void 0?void 0:a.bitmap)===null||o===void 0?void 0:o.length)!==null&&l!==void 0?l:0,padding:(d=(c=h?.bits)===null||c===void 0?void 0:c.padding)!==null&&d!==void 0?d:0,mightContain:f=>{var p;return(p=n?.mightContain(f))!==null&&p!==void 0?p:!1}}),u}var vce=(()=>{let t={};return t.asc="ASCENDING",t.desc="DESCENDING",t})(),yce=(()=>{let t={};return t["<"]="LESS_THAN",t["<="]="LESS_THAN_OR_EQUAL",t[">"]="GREATER_THAN",t[">="]="GREATER_THAN_OR_EQUAL",t["=="]="EQUAL",t["!="]="NOT_EQUAL",t["array-contains"]="ARRAY_CONTAINS",t.in="IN",t["not-in"]="NOT_IN",t["array-contains-any"]="ARRAY_CONTAINS_ANY",t})(),wce=(()=>{let t={};return t.and="AND",t.or="OR",t})();var Mk=class{constructor(e,i){this.databaseId=e,this.useProto3Json=i}};function Cce(t){let e=t.code===void 0?T.UNKNOWN:Qy(t.code);return new D(e,t.message||"")}function Ok(t,e){return t.useProto3Json||Vp(e)?e:{value:e}}function Ece(t){let e;return typeof t=="object"?e=t.value:e=t,Vp(e)?null:e}function Lu(t,e){if(t.useProto3Json){let n=new Date(e.seconds*1e3).toISOString().replace(/\.\d*/,"").replace("Z",""),r=("000000000"+e.nanoseconds).slice(-9);return`${n}.${r}Z`}else return{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sce(t){let e=Ao(t);return new Bt(e.seconds,e.nanos)}function N5(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function xce(t,e){return t.useProto3Json?(oe(e===void 0||typeof e=="string"),Ri.fromBase64String(e||"")):(oe(e===void 0||e instanceof Uint8Array),Ri.fromUint8Array(e||new Uint8Array))}function Tce(t,e){return Lu(t,e.toTimestamp())}function Jt(t){return oe(!!t),pe.fromTimestamp(Sce(t))}function dR(t,e){return Nk(t,e).canonicalString()}function Nk(t,e){let i=Ice(t).child("documents");return e===void 0?i:i.child(e)}function P5(t){let e=Qe.fromString(t);return oe(W5(e)),e}function Sp(t,e){return dR(t.databaseId,e.path)}function Vs(t,e){let i=P5(e);if(i.get(1)!==t.databaseId.projectId)throw new D(T.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+i.get(1)+" vs "+t.databaseId.projectId);if(i.get(3)!==t.databaseId.database)throw new D(T.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+i.get(3)+" vs "+t.databaseId.database);return new z(B5(i))}function F5(t,e){return dR(t.databaseId,e)}function L5(t){let e=P5(t);return e.length===4?Qe.emptyPath():B5(e)}function Pk(t){return new Qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ice(t){return new Qe(["projects",t.projectId,"databases",t.database])}function B5(t){return oe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function zU(t,e,i){return{name:Sp(t,e),fields:i.value.mapValue.fields}}function Dce(t,e){return{name:Sp(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Lu(t,e.version.toTimestamp()),createTime:Lu(t,e.createTime.toTimestamp())}}function V5(t,e,i){let n=Vs(t,e.name),r=Jt(e.updateTime),s=e.createTime?Jt(e.createTime):pe.min(),a=new Zi({mapValue:{fields:e.fields}}),o=di.newFoundDocument(n,r,s,a);return i&&o.setHasCommittedMutations(),i?o.setHasCommittedMutations():o}function kce(t,e){oe(!!e.found),e.found.name,e.found.updateTime;let i=Vs(t,e.found.name),n=Jt(e.found.updateTime),r=e.found.createTime?Jt(e.found.createTime):pe.min(),s=new Zi({mapValue:{fields:e.found.fields}});return di.newFoundDocument(i,n,r,s)}function Ace(t,e){oe(!!e.missing),oe(!!e.readTime);let i=Vs(t,e.missing),n=Jt(e.readTime);return di.newNoDocument(i,n)}function Rce(t,e){return"found"in e?kce(t,e):"missing"in e?Ace(t,e):Y()}function Mce(t,e){let i;if("targetChange"in e){e.targetChange;let n=Oce(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=xce(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&Cce(a);i=new d0(n,r,s,o||null)}else if("documentChange"in e){e.documentChange;let n=e.documentChange;n.document,n.document.name,n.document.updateTime;let r=Vs(t,n.document.name),s=Jt(n.document.updateTime),a=n.document.createTime?Jt(n.document.createTime):pe.min(),o=new Zi({mapValue:{fields:n.document.fields}}),l=di.newFoundDocument(r,s,a,o),c=n.targetIds||[],d=n.removedTargetIds||[];i=new ku(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;let n=e.documentDelete;n.document;let r=Vs(t,n.document),s=n.readTime?Jt(n.readTime):pe.min(),a=di.newNoDocument(r,s),o=n.removedTargetIds||[];i=new ku([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;let n=e.documentRemove;n.document;let r=Vs(t,n.document),s=n.removedTargetIds||[];i=new ku([],s,r,null)}else if("filter"in e){e.filter;let n=e.filter;n.targetId;let{count:r=0,unchangedNames:s}=n,a=new Dk(r,s),o=n.targetId;i=new c0(o,a)}else return Y();return i}function Oce(t){return t==="NO_CHANGE"?0:t==="ADD"?1:t==="REMOVE"?2:t==="CURRENT"?3:t==="RESET"?4:Y()}function Nce(t){if(!("targetChange"in t))return pe.min();let e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?pe.min():Jt(e.readTime)}function xp(t,e){let i;if(e instanceof Fo)i={update:zU(t,e.key,e.value)};else if(e instanceof Lo)i={delete:Sp(t,e.key)};else if(e instanceof Gr)i={update:zU(t,e.key,e.data),updateMask:fde(e.fieldMask)};else if(e instanceof vp)i={verify:Sp(t,e.key)};else return Y();return e.fieldTransforms.length>0&&(i.updateTransforms=e.fieldTransforms.map(n=>Vce(t,n))),e.precondition.isNone||(i.currentDocument=Pce(t,e.precondition)),i}function Fk(t,e){let i=e.currentDocument?Fce(e.currentDocument):Ht.none(),n=e.updateTransforms?e.updateTransforms.map(r=>jce(t,r)):[];if(e.update){e.update.name;let r=Vs(t,e.update.name),s=new Zi({mapValue:{fields:e.update.fields}});if(e.updateMask){let a=mde(e.updateMask);return new Gr(r,s,a,i,n)}else return new Fo(r,s,i,n)}else if(e.delete){let r=Vs(t,e.delete);return new Lo(r,i)}else if(e.verify){let r=Vs(t,e.verify);return new vp(r,i)}else return Y()}function Pce(t,e){return e.updateTime!==void 0?{updateTime:Tce(t,e.updateTime)}:e.exists!==void 0?{exists:e.exists}:Y()}function Fce(t){return t.updateTime!==void 0?Ht.updateTime(Jt(t.updateTime)):t.exists!==void 0?Ht.exists(t.exists):Ht.none()}function Lce(t,e){let i=t.updateTime?Jt(t.updateTime):Jt(e);return i.isEqual(pe.min())&&(i=Jt(e)),new Tk(i,t.transformResults||[])}function Bce(t,e){return t&&t.length>0?(oe(e!==void 0),t.map(i=>Lce(i,e))):[]}function Vce(t,e){let i=e.transform;if(i instanceof No)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(i instanceof ua)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:i.elements}};if(i instanceof ha)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:i.elements}};if(i instanceof Po)return{fieldPath:e.field.canonicalString(),increment:i.operand};throw Y()}function jce(t,e){let i=null;if("setToServerValue"in e)oe(e.setToServerValue==="REQUEST_TIME"),i=new No;else if("appendMissingElements"in e){let r=e.appendMissingElements.values||[];i=new ua(r)}else if("removeAllFromArray"in e){let r=e.removeAllFromArray.values||[];i=new ha(r)}else"increment"in e?i=new Po(t,e.increment):Y();let n=ei.fromServerFormat(e.fieldPath);return new sc(n,i)}function j5(t,e){return{documents:[F5(t,e.path)]}}function zce(t){let e=t.documents.length;oe(e===1);let i=t.documents[0];return _n(Xu(L5(i)))}function z5(t,e){let i={structuredQuery:{}},n=e.path,r;e.collectionGroup!==null?(r=n,i.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),i.structuredQuery.from=[{collectionId:n.lastSegment()}]),i.parent=F5(t,r);let s=Gce(e.filters);s&&(i.structuredQuery.where=s);let a=$ce(e.orderBy);a&&(i.structuredQuery.orderBy=a);let o=Ok(t,e.limit);return o!==null&&(i.structuredQuery.limit=o),e.startAt&&(i.structuredQuery.startAt=Qce(e.startAt)),e.endAt&&(i.structuredQuery.endAt=Xce(e.endAt)),{queryTarget:i,parent:r}}function U5(t){let e=L5(t.parent),i=t.structuredQuery,n=i.from?i.from.length:0,r=null;if(n>0){oe(n===1);let d=i.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let s=[];i.where&&(s=Kce(i.where));let a=[];i.orderBy&&(a=Yce(i.orderBy));let o=null;i.limit&&(o=Ece(i.limit));let l=null;i.startAt&&(l=Zce(i.startAt));let c=null;return i.endAt&&(c=Jce(i.endAt)),m5(e,r,a,s,o,"F",l,c)}function Uce(t){return _n(U5(t))}function qce(t,e){let i=Hce(e.purpose);return i==null?null:{"goog-listen-tags":i}}function Hce(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y()}}function Wce(t,e){let i,n=e.target;if(o0(n)?i={documents:j5(t,n)}:i={query:z5(t,n).queryTarget},i.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){i.resumeToken=N5(t,e.resumeToken);let r=Ok(t,e.expectedCount);r!==null&&(i.expectedCount=r)}else if(e.snapshotVersion.compareTo(pe.min())>0){i.readTime=Lu(t,e.snapshotVersion.toTimestamp());let r=Ok(t,e.expectedCount);r!==null&&(i.expectedCount=r)}return i}function Gce(t){if(t.length!==0)return H5(dt.create(t,"and"))}function Kce(t){let e=q5(t);return e instanceof dt&&aR(e)?e.getFilters():[e]}function q5(t){return t.unaryFilter!==void 0?dde(t):t.fieldFilter!==void 0?ude(t):t.compositeFilter!==void 0?hde(t):Y()}function $ce(t){if(t.length!==0)return t.map(e=>ade(e))}function Yce(t){return t.map(e=>ode(e))}function Qce(t){return{before:t.inclusive,values:t.position}}function Xce(t){return{before:!t.inclusive,values:t.position}}function Zce(t){let e=!!t.before,i=t.values||[];return new zs(i,e)}function Jce(t){let e=!t.before,i=t.values||[];return new zs(i,e)}function ede(t){return vce[t]}function tde(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function ide(t){return yce[t]}function nde(t){return wce[t]}function rde(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Y();default:return Y()}}function sde(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Y()}}function Eu(t){return{fieldPath:t.canonicalString()}}function Tu(t){return ei.fromServerFormat(t.fieldPath)}function ade(t){return{field:Eu(t.field),direction:ede(t.dir)}}function ode(t){return new nc(Tu(t.field),tde(t.direction))}function H5(t){return t instanceof $e?cde(t):t instanceof dt?lde(t):Y()}function lde(t){let e=t.getFilters().map(i=>H5(i));return e.length===1?e[0]:{compositeFilter:{op:nde(t.op),filters:e}}}function cde(t){if(t.op==="=="){if(AU(t.value))return{unaryFilter:{field:Eu(t.field),op:"IS_NAN"}};if(kU(t.value))return{unaryFilter:{field:Eu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(AU(t.value))return{unaryFilter:{field:Eu(t.field),op:"IS_NOT_NAN"}};if(kU(t.value))return{unaryFilter:{field:Eu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Eu(t.field),op:ide(t.op),value:t.value}}}function dde(t){switch(t.unaryFilter.op){case"IS_NAN":let e=Tu(t.unaryFilter.field);return $e.create(e,"==",{doubleValue:NaN});case"IS_NULL":let i=Tu(t.unaryFilter.field);return $e.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let n=Tu(t.unaryFilter.field);return $e.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let r=Tu(t.unaryFilter.field);return $e.create(r,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Y();default:return Y()}}function ude(t){return $e.create(Tu(t.fieldFilter.field),rde(t.fieldFilter.op),t.fieldFilter.value)}function hde(t){return dt.create(t.compositeFilter.filters.map(e=>q5(e)),sde(t.compositeFilter.op))}function fde(t){let e=[];return t.fields.forEach(i=>e.push(i.canonicalString())),{fieldPaths:e}}function mde(t){let e=t.fieldPaths||[];return new Hn(e.map(i=>ei.fromServerFormat(i)))}function W5(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Bu=class t{constructor(e,i,n,r,s=pe.min(),a=pe.min(),o=Ri.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=i,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,i){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,i,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var h0=class{constructor(e){this.remoteSerializer=e}};function pde(t,e){let i;if(e.document)i=V5(t.remoteSerializer,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let n=z.fromSegments(e.noDocument.path),r=oc(e.noDocument.readTime);i=di.newNoDocument(n,r),e.hasCommittedMutations&&i.setHasCommittedMutations()}else if(e.unknownDocument){let n=z.fromSegments(e.unknownDocument.path),r=oc(e.unknownDocument.version);i=di.newUnknownDocument(n,r)}else return Y();return e.readTime&&i.setReadTime(gde(e.readTime)),i}function UU(t,e){let i=e.key,n={prefixPath:i.getCollectionPath().popLast().toArray(),collectionGroup:i.collectionGroup,documentId:i.path.lastSegment(),readTime:X0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=Dce(t.remoteSerializer,e);else if(e.isNoDocument())n.noDocument={path:i.path.toArray(),readTime:ac(e.version)};else if(e.isUnknownDocument())n.unknownDocument={path:i.path.toArray(),version:ac(e.version)};else return Y();return n}function X0(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function gde(t){let e=new Bt(t[0],t[1]);return pe.fromTimestamp(e)}function ac(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function oc(t){let e=new Bt(t.seconds,t.nanoseconds);return pe.fromTimestamp(e)}function _de(t,e,i){let n=i.baseMutations.map(s=>xp(t.remoteSerializer,s)),r=i.mutations.map(s=>xp(t.remoteSerializer,s));return{userId:e,batchId:i.batchId,localWriteTimeMs:i.localWriteTime.toMillis(),baseMutations:n,mutations:r}}function Gl(t,e){let i=(e.baseMutations||[]).map(s=>Fk(t.remoteSerializer,s));for(let s=0;s<e.mutations.length-1;++s){let a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let l=e.mutations[s+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let n=e.mutations.map(s=>Fk(t.remoteSerializer,s)),r=Bt.fromMillis(e.localWriteTimeMs);return new yp(e.batchId,r,i,n)}function rp(t){let e=oc(t.readTime),i=t.lastLimboFreeSnapshotVersion!==void 0?oc(t.lastLimboFreeSnapshotVersion):pe.min(),n;return bde(t.query)?n=zce(t.query):n=Uce(t.query),new Bu(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,i,Ri.fromBase64String(t.resumeToken))}function G5(t,e){let i=ac(e.snapshotVersion),n=ac(e.lastLimboFreeSnapshotVersion),r;o0(e.target)?r=j5(t.remoteSerializer,e.target):r=z5(t.remoteSerializer,e.target).queryTarget;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:rc(e.target),readTime:i,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:r}}function bde(t){return t.documents!==void 0}function vde(t){return{id:t.bundleId,createTime:oc(t.createTime),version:t.version}}function yde(t){return{bundleId:t.id,createTime:ac(Jt(t.createTime)),version:t.version}}function wde(t){return{name:t.name,query:uR(t.bundledQuery),readTime:oc(t.readTime)}}function Cde(t){return{name:t.name,readTime:ac(Jt(t.readTime)),bundledQuery:t.bundledQuery}}function uR(t){let e=U5({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?l0(e,e.limit,"L"):e}function Ede(t){return{name:t.name,query:uR(t.bundledQuery),readTime:Jt(t.readTime)}}function Sde(t){return{id:t.id,version:t.version,createTime:Jt(t.createTime)}}function q1(t,e){return new wp(e.largestBatchId,Fk(t.remoteSerializer,e.overlayMutation))}function xde(t,e,i){let[n,r,s]=K5(e,i.mutation.key);return{userId:e,collectionPath:r,documentId:s,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:xp(t.remoteSerializer,i.mutation)}}function K5(t,e){let i=e.path.lastSegment(),n=gn(e.path.popLast());return[t,n,i]}function Tde(t){return{indexId:t.indexId,collectionGroup:t.collectionGroup,fields:t.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}function Ide(t,e){let i=e?new up(e.sequenceNumber,new Cr(oc(e.readTime),new z(Ls(e.documentKey)),e.largestBatchId)):up.empty(),n=t.fields.map(([r,s])=>new Iu(ei.fromServerFormat(r),s));return new rk(t.indexId,t.collectionGroup,n,i)}function qU(t,e,i,n){return{indexId:t,uid:e,sequenceNumber:i,readTime:ac(n.readTime),documentKey:gn(n.documentKey.path),largestBatchId:n.largestBatchId}}var Lk=class{getBundleMetadata(e,i){return HU(e).get(i).next(n=>{if(n)return vde(n)})}saveBundleMetadata(e,i){return HU(e).put(yde(i))}getNamedQuery(e,i){return WU(e).get(i).next(n=>{if(n)return wde(n)})}saveNamedQuery(e,i){return WU(e).put(Cde(i))}};function HU(t){return Mi(t,W0)}function WU(t){return Mi(t,G0)}var f0=class t{constructor(e,i){this.serializer=e,this.userId=i}static forUser(e,i){let n=i.uid||"";return new t(e,n)}getOverlay(e,i){return Jm(e).get(K5(this.userId,i)).next(n=>n?q1(this.serializer,n):null)}getOverlays(e,i){let n=Bs();return S.forEach(i,r=>this.getOverlay(e,r).next(s=>{s!==null&&n.set(r,s)})).next(()=>n)}saveOverlays(e,i,n){let r=[];return n.forEach((s,a)=>{let o=new wp(i,a);r.push(this.saveOverlay(e,o))}),S.waitFor(r)}removeOverlaysForBatchId(e,i,n){let r=new Set;i.forEach(a=>r.add(gn(a.getCollectionPath())));let s=[];return r.forEach(a=>{let o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,n+1],!1,!0);s.push(Jm(e).deleteAll(hk,o))}),S.waitFor(s)}getOverlaysForCollection(e,i,n){let r=Bs(),s=gn(i),a=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Jm(e).loadAll(hk,a).next(o=>{for(let l of o){let c=q1(this.serializer,l);r.set(c.getKey(),c)}return r})}getOverlaysForCollectionGroup(e,i,n,r){let s=Bs(),a,o=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Jm(e).iterate({index:Gq,range:o},(l,c,d)=>{let u=q1(this.serializer,c);s.size()<r||u.largestBatchId===a?(s.set(u.getKey(),u),a=u.largestBatchId):d.done()}).next(()=>s)}saveOverlay(e,i){return Jm(e).put(xde(this.serializer,this.userId,i))}};function Jm(t){return Mi(t,K0)}var Dde=5,kde=10,Ade=13,GU=15,Rde=20,Mde=25,Ode=30,Nde=37,Pde=45,Fde=50,Lde=55,Bde=60,Vde=2,ca=class{constructor(){}writeIndexValue(e,i){this.writeIndexValueAux(e,i),i.writeInfinity()}writeIndexValueAux(e,i){if("nullValue"in e)this.writeValueTypeLabel(i,Dde);else if("booleanValue"in e)this.writeValueTypeLabel(i,kde),i.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(i,GU),i.writeNumber(Wt(e.integerValue));else if("doubleValue"in e){let n=Wt(e.doubleValue);isNaN(n)?this.writeValueTypeLabel(i,Ade):(this.writeValueTypeLabel(i,GU),pp(n)?i.writeNumber(0):i.writeNumber(n))}else if("timestampValue"in e){let n=e.timestampValue;this.writeValueTypeLabel(i,Rde),typeof n=="string"?i.writeString(n):(i.writeString(`${n.seconds||""}`),i.writeNumber(n.nanos||0))}else if("stringValue"in e)this.writeIndexString(e.stringValue,i),this.writeTruncationMarker(i);else if("bytesValue"in e)this.writeValueTypeLabel(i,Ode),i.writeBytes(Ro(e.bytesValue)),this.writeTruncationMarker(i);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,i);else if("geoPointValue"in e){let n=e.geoPointValue;this.writeValueTypeLabel(i,Pde),i.writeNumber(n.latitude||0),i.writeNumber(n.longitude||0)}else"mapValue"in e?r5(e)?this.writeValueTypeLabel(i,Number.MAX_SAFE_INTEGER):(this.writeIndexMap(e.mapValue,i),this.writeTruncationMarker(i)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,i),this.writeTruncationMarker(i)):Y()}writeIndexString(e,i){this.writeValueTypeLabel(i,Mde),this.writeUnlabeledIndexString(e,i)}writeUnlabeledIndexString(e,i){i.writeString(e)}writeIndexMap(e,i){let n=e.fields||{};this.writeValueTypeLabel(i,Lde);for(let r of Object.keys(n))this.writeIndexString(r,i),this.writeIndexValueAux(n[r],i)}writeIndexArray(e,i){let n=e.values||[];this.writeValueTypeLabel(i,Fde);for(let r of n)this.writeIndexValueAux(r,i)}writeIndexEntityRef(e,i){this.writeValueTypeLabel(i,Nde),z.fromName(e).path.forEach(r=>{this.writeValueTypeLabel(i,Bde),this.writeUnlabeledIndexString(r,i)})}writeValueTypeLabel(e,i){e.writeNumber(i)}writeTruncationMarker(e){e.writeNumber(Vde)}};ca.INSTANCE=new ca;var KU="\uD800",$U="\uDBFF",gu=0,YU=255,QU=1,_u=255,XU=255,ZU=0,jde=64,zde=8,Ude=1024;function qde(t){let e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,t,!1),new Uint8Array(e.buffer)}function Hde(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t=t<<4),t>>6||(e+=2,t=t<<2),t>>7||(e+=1),e}function Wde(t){let e=0;for(let i=0;i<8;++i){let n=Hde(t[i]&255);if(e+=n,n!==8)break}return e}function JU(t){let e=jde-Wde(t);return Math.ceil(e/zde)}var Bk=class{constructor(){this.buffer=new Uint8Array(Ude),this.position=0}writeBytesAscending(e){let i=e[Symbol.iterator](),n=i.next();for(;!n.done;)this.writeByteAscending(n.value),n=i.next();this.writeSeparatorAscending()}writeBytesDescending(e){let i=e[Symbol.iterator](),n=i.next();for(;!n.done;)this.writeByteDescending(n.value),n=i.next();this.writeSeparatorDescending()}writeUtf8Ascending(e){for(let i of e){let n=i.charCodeAt(0);if(n<128)this.writeByteAscending(n);else if(n<2048)this.writeByteAscending(960|n>>>6),this.writeByteAscending(128|63&n);else if(i<KU||$U<i)this.writeByteAscending(480|n>>>12),this.writeByteAscending(128|63&n>>>6),this.writeByteAscending(128|63&n);else{let r=i.codePointAt(0);this.writeByteAscending(240|r>>>18),this.writeByteAscending(128|63&r>>>12),this.writeByteAscending(128|63&r>>>6),this.writeByteAscending(128|63&r)}}this.writeSeparatorAscending()}writeUtf8Descending(e){for(let i of e){let n=i.charCodeAt(0);if(n<128)this.writeByteDescending(n);else if(n<2048)this.writeByteDescending(960|n>>>6),this.writeByteDescending(128|63&n);else if(i<KU||$U<i)this.writeByteDescending(480|n>>>12),this.writeByteDescending(128|63&n>>>6),this.writeByteDescending(128|63&n);else{let r=i.codePointAt(0);this.writeByteDescending(240|r>>>18),this.writeByteDescending(128|63&r>>>12),this.writeByteDescending(128|63&r>>>6),this.writeByteDescending(128|63&r)}}this.writeSeparatorDescending()}writeNumberAscending(e){let i=this.toOrderedBits(e),n=JU(i);this.ensureAvailable(1+n),this.buffer[this.position++]=n&255;for(let r=i.length-n;r<i.length;++r)this.buffer[this.position++]=i[r]&255}writeNumberDescending(e){let i=this.toOrderedBits(e),n=JU(i);this.ensureAvailable(1+n),this.buffer[this.position++]=~(n&255);for(let r=i.length-n;r<i.length;++r)this.buffer[this.position++]=~(i[r]&255)}writeInfinityAscending(){this.writeEscapedByteAscending(_u),this.writeEscapedByteAscending(XU)}writeInfinityDescending(){this.writeEscapedByteDescending(_u),this.writeEscapedByteDescending(XU)}reset(){this.position=0}seed(e){this.ensureAvailable(e.length),this.buffer.set(e,this.position),this.position+=e.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(e){let i=qde(e),n=(i[0]&128)!==0;i[0]^=n?255:128;for(let r=1;r<i.length;++r)i[r]^=n?255:0;return i}writeByteAscending(e){let i=e&255;i===gu?(this.writeEscapedByteAscending(gu),this.writeEscapedByteAscending(YU)):i===_u?(this.writeEscapedByteAscending(_u),this.writeEscapedByteAscending(ZU)):this.writeEscapedByteAscending(i)}writeByteDescending(e){let i=e&255;i===gu?(this.writeEscapedByteDescending(gu),this.writeEscapedByteDescending(YU)):i===_u?(this.writeEscapedByteDescending(_u),this.writeEscapedByteDescending(ZU)):this.writeEscapedByteDescending(e)}writeSeparatorAscending(){this.writeEscapedByteAscending(gu),this.writeEscapedByteAscending(QU)}writeSeparatorDescending(){this.writeEscapedByteDescending(gu),this.writeEscapedByteDescending(QU)}writeEscapedByteAscending(e){this.ensureAvailable(1),this.buffer[this.position++]=e}writeEscapedByteDescending(e){this.ensureAvailable(1),this.buffer[this.position++]=~e}ensureAvailable(e){let i=e+this.position;if(i<=this.buffer.length)return;let n=this.buffer.length*2;n<i&&(n=i);let r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}},Vk=class{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesAscending(e)}writeString(e){this.orderedCode.writeUtf8Ascending(e)}writeNumber(e){this.orderedCode.writeNumberAscending(e)}writeInfinity(){this.orderedCode.writeInfinityAscending()}},jk=class{constructor(e){this.orderedCode=e}writeBytes(e){this.orderedCode.writeBytesDescending(e)}writeString(e){this.orderedCode.writeUtf8Descending(e)}writeNumber(e){this.orderedCode.writeNumberDescending(e)}writeInfinity(){this.orderedCode.writeInfinityDescending()}},Kl=class{constructor(){this.orderedCode=new Bk,this.ascending=new Vk(this.orderedCode),this.descending=new jk(this.orderedCode)}seed(e){this.orderedCode.seed(e)}forKind(e){return e===0?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}};var $l=class t{constructor(e,i,n,r){this.indexId=e,this.documentKey=i,this.arrayValue=n,this.directionalValue=r}successor(){let e=this.directionalValue.length,i=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(i);return n.set(this.directionalValue,0),i!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new t(this.indexId,this.documentKey,this.arrayValue,n)}};function Co(t,e){let i=t.indexId-e.indexId;return i!==0||(i=eq(t.arrayValue,e.arrayValue),i!==0)||(i=eq(t.directionalValue,e.directionalValue),i!==0)?i:z.comparator(t.documentKey,e.documentKey)}function eq(t,e){for(let i=0;i<t.length&&i<e.length;++i){let n=t[i]-e[i];if(n!==0)return n}return t.length-e.length}var m0=class{constructor(e){this.inequalityFilters=new bt((i,n)=>ei.comparator(i.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.orderBys=e.orderBy,this.equalityFilters=[];for(let i of e.filters){let n=i;n.isInequality()?this.inequalityFilters=this.inequalityFilters.add(n):this.equalityFilters.push(n)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(e){if(oe(e.collectionGroup===this.collectionId),this.hasMultipleInequality)return!1;let i=XA(e);if(i!==void 0&&!this.hasMatchingEqualityFilter(i))return!1;let n=ec(e),r=new Set,s=0,a=0;for(;s<n.length&&this.hasMatchingEqualityFilter(n[s]);++s)r=r.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.inequalityFilters.size>0){let o=this.inequalityFilters.getIterator().getNext();if(!r.has(o.field.canonicalString())){let l=n[s];if(!this.matchesFilter(o,l)||!this.matchesOrderBy(this.orderBys[a++],l))return!1}++s}for(;s<n.length;++s){let o=n[s];if(a>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[a++],o))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let e=new bt(ei.comparator),i=[];for(let n of this.equalityFilters){if(n.field.isKeyField())continue;if(n.op==="array-contains"||n.op==="array-contains-any")i.push(new Iu(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),i.push(new Iu(n.field,0))}}for(let n of this.orderBys)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),i.push(new Iu(n.field,n.dir==="asc"?0:1)));return new rk(rk.UNKNOWN_ID,this.collectionId,i,up.empty())}hasMatchingEqualityFilter(e){for(let i of this.equalityFilters)if(this.matchesFilter(i,e))return!0;return!1}matchesFilter(e,i){if(e===void 0||!e.field.isEqual(i.fieldPath))return!1;let n=e.op==="array-contains"||e.op==="array-contains-any";return i.kind===2===n}matchesOrderBy(e,i){return e.field.isEqual(i.fieldPath)?i.kind===0&&e.dir==="asc"||i.kind===1&&e.dir==="desc":!1}};function $5(t){var e,i;if(oe(t instanceof $e||t instanceof dt),t instanceof $e)if(t instanceof a0){let r=((i=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||i===void 0?void 0:i.map(s=>$e.create(t.field,"==",s)))||[];return dt.create(r,"or")}else return t;let n=t.filters.map(r=>$5(r));return dt.create(n,t.op)}function Gde(t){if(t.getFilters().length===0)return[];let e=zk($5(t));return oe(Y5(e)),hR(e)||fR(e)?[e]:e.getFilters()}function hR(t){return t instanceof $e}function fR(t){return t instanceof dt&&aR(t)}function Y5(t){return hR(t)||fR(t)||Kde(t)}function Kde(t){if(t instanceof dt&&gk(t)){for(let e of t.getFilters())if(!hR(e)&&!fR(e))return!1;return!0}return!1}function zk(t){if(oe(t instanceof $e||t instanceof dt),t instanceof $e)return t;if(t.filters.length===1)return zk(t.filters[0]);let e=t.filters.map(n=>zk(n)),i=dt.create(e,t.op);return i=p0(i),Y5(i)?i:(oe(i instanceof dt),oe(Ou(i)),oe(i.filters.length>1),i.filters.reduce((n,r)=>mR(n,r)))}function mR(t,e){oe(t instanceof $e||t instanceof dt),oe(e instanceof $e||e instanceof dt);let i;return t instanceof $e?e instanceof $e?i=$de(t,e):i=tq(t,e):e instanceof $e?i=tq(e,t):i=Yde(t,e),p0(i)}function $de(t,e){return dt.create([t,e],"and")}function Yde(t,e){if(oe(t.filters.length>0&&e.filters.length>0),Ou(t)&&Ou(e))return c5(t,e.getFilters());let i=gk(t)?t:e,n=gk(t)?e:t,r=i.filters.map(s=>mR(s,n));return dt.create(r,"or")}function tq(t,e){if(Ou(e))return c5(e,t.getFilters());{let i=e.filters.map(n=>mR(t,n));return dt.create(i,"or")}}function p0(t){if(oe(t instanceof $e||t instanceof dt),t instanceof $e)return t;let e=t.getFilters();if(e.length===1)return p0(e[0]);if(o5(t))return t;let i=e.map(r=>p0(r)),n=[];return i.forEach(r=>{r instanceof $e?n.push(r):r instanceof dt&&(r.op===t.op?n.push(...r.filters):n.push(r))}),n.length===1?n[0]:dt.create(n,t.op)}var Uk=class{constructor(){this.collectionParentIndex=new Tp}addToCollectionParentIndex(e,i){return this.collectionParentIndex.add(i),S.resolve()}getCollectionParents(e,i){return S.resolve(this.collectionParentIndex.getEntries(i))}addFieldIndex(e,i){return S.resolve()}deleteFieldIndex(e,i){return S.resolve()}deleteAllFieldIndexes(e){return S.resolve()}createTargetIndexes(e,i){return S.resolve()}getDocumentsMatchingTarget(e,i){return S.resolve(null)}getIndexType(e,i){return S.resolve(0)}getFieldIndexes(e,i){return S.resolve([])}getNextCollectionGroupToUpdate(e){return S.resolve(null)}getMinOffset(e,i){return S.resolve(Cr.min())}getMinOffsetFromCollectionGroup(e,i){return S.resolve(Cr.min())}updateCollectionGroup(e,i,n){return S.resolve()}updateIndexEntries(e,i){return S.resolve()}},Tp=class{constructor(){this.index={}}add(e){let i=e.lastSegment(),n=e.popLast(),r=this.index[i]||new bt(Qe.comparator),s=!r.has(n);return this.index[i]=r.add(n),s}has(e){let i=e.lastSegment(),n=e.popLast(),r=this.index[i];return r&&r.has(n)}getEntries(e){return(this.index[e]||new bt(Qe.comparator)).toArray()}};var iq="IndexedDbIndexManager",Uy=new Uint8Array(0),qk=class{constructor(e,i){this.databaseId=i,this.collectionParentsCache=new Tp,this.targetToDnfSubTargets=new Us(n=>rc(n),(n,r)=>jp(n,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,i){if(!this.collectionParentsCache.has(i)){let n=i.lastSegment(),r=i.popLast();e.addOnCommittedListener(()=>{this.collectionParentsCache.add(i)});let s={collectionId:n,parent:gn(r)};return nq(e).put(s)}return S.resolve()}getCollectionParents(e,i){let n=[],r=IDBKeyRange.bound([i,""],[Oq(i),""],!1,!0);return nq(e).loadAll(r).next(s=>{for(let a of s){if(a.collectionId!==i)break;n.push(Ls(a.parent))}return n})}addFieldIndex(e,i){let n=ep(e),r=Tde(i);delete r.indexId;let s=n.add(r);if(i.indexState){let a=vu(e);return s.next(o=>{a.put(qU(o,this.uid,i.indexState.sequenceNumber,i.indexState.offset))})}else return s.next()}deleteFieldIndex(e,i){let n=ep(e),r=vu(e),s=bu(e);return n.delete(i.indexId).next(()=>r.delete(IDBKeyRange.bound([i.indexId],[i.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([i.indexId],[i.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let i=ep(e),n=bu(e),r=vu(e);return i.deleteAll().next(()=>n.deleteAll()).next(()=>r.deleteAll())}createTargetIndexes(e,i){return S.forEach(this.getSubTargets(i),n=>this.getIndexType(e,n).next(r=>{if(r===0||r===1){let a=new m0(n).buildTargetIndex();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,i){let n=bu(e),r=!0,s=new Map;return S.forEach(this.getSubTargets(i),a=>this.getFieldIndex(e,a).next(o=>{r&&(r=!!o),s.set(a,o)})).next(()=>{if(r){let a=Oe(),o=[];return S.forEach(s,(l,c)=>{N(iq,`Using index ${aoe(l)} to execute ${rc(i)}`);let d=kle(c,l),u=Ale(c,l),h=Rle(c,l),f=Mle(c,l),p=this.encodeBound(l,c,h),v=this.encodeBound(l,c,f),E=this.encodeValues(l,c,u),k=this.generateIndexRanges(l.indexId,d,p,h.inclusive,v,f.inclusive,E);return S.forEach(k,I=>n.loadFirst(I,i.limit).next(P=>{P.forEach(L=>{let te=z.fromSegments(L.documentKey);a.has(te)||(a=a.add(te),o.push(te))})}))}).next(()=>o)}else return S.resolve(null)})}getSubTargets(e){let i=this.targetToDnfSubTargets.get(e);return i||(e.filters.length===0?i=[e]:i=Gde(dt.create(e.filters,"and")).map(r=>xk(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.targetToDnfSubTargets.set(e,i),i)}generateIndexRanges(e,i,n,r,s,a,o){let l=(i!=null?i.length:1)*Math.max(n.length,s.length),c=l/(i!=null?i.length:1),d=[];for(let u=0;u<l;++u){let h=i?this.encodeSingleElement(i[u/c]):Uy,f=this.generateLowerBound(e,h,n[u%c],r),p=this.generateUpperBound(e,h,s[u%c],a),v=o.map(E=>this.generateLowerBound(e,h,E,!0));d.push(...this.createRange(f,p,v))}return d}generateLowerBound(e,i,n,r){let s=new $l(e,z.empty(),i,n);return r?s:s.successor()}generateUpperBound(e,i,n,r){let s=new $l(e,z.empty(),i,n);return r?s.successor():s}getFieldIndex(e,i){let n=new m0(i),r=i.collectionGroup!=null?i.collectionGroup:i.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let a=null;for(let o of s)n.servedByIndex(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a})}getIndexType(e,i){let n=2,r=this.getSubTargets(i);return S.forEach(r,s=>this.getFieldIndex(e,s).next(a=>{a?n!==0&&a.fields.length<Ole(s)&&(n=1):n=0})).next(()=>Nle(i)&&r.length>1&&n===2?1:n)}encodeDirectionalElements(e,i){let n=new Kl;for(let r of ec(e)){let s=i.data.field(r.fieldPath);if(s==null)return null;let a=n.forKind(r.kind);ca.INSTANCE.writeIndexValue(s,a)}return n.encodedBytes()}encodeSingleElement(e){let i=new Kl;return ca.INSTANCE.writeIndexValue(e,i.forKind(0)),i.encodedBytes()}encodeDirectionalKey(e,i){let n=new Kl;return ca.INSTANCE.writeIndexValue(ic(this.databaseId,i),n.forKind(soe(e))),n.encodedBytes()}encodeValues(e,i,n){if(n===null)return[];let r=[];r.push(new Kl);let s=0;for(let a of ec(e)){let o=n[s++];for(let l of r)if(this.isInFilter(i,a.fieldPath)&&_p(o))r=this.expandIndexValues(r,a,o);else{let c=l.forKind(a.kind);ca.INSTANCE.writeIndexValue(o,c)}}return this.getEncodedBytes(r)}encodeBound(e,i,n){return this.encodeValues(e,i,n.position)}getEncodedBytes(e){let i=[];for(let n=0;n<e.length;++n)i[n]=e[n].encodedBytes();return i}expandIndexValues(e,i,n){let r=[...e],s=[];for(let a of n.arrayValue.values||[])for(let o of r){let l=new Kl;l.seed(o.encodedBytes()),ca.INSTANCE.writeIndexValue(a,l.forKind(i.kind)),s.push(l)}return s}isInFilter(e,i){return!!e.filters.find(n=>n instanceof $e&&n.field.isEqual(i)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,i){let n=ep(e),r=vu(e);return(i?n.loadAll(uk,IDBKeyRange.bound(i,i)):n.loadAll()).next(s=>{let a=[];return S.forEach(s,o=>r.get([o.indexId,this.uid]).next(l=>{a.push(Ide(o,l))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(i=>i.length===0?null:(i.sort((n,r)=>{let s=n.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:Re(n.collectionGroup,r.collectionGroup)}),i[0].collectionGroup))}updateCollectionGroup(e,i,n){let r=ep(e),s=vu(e);return this.getNextSequenceNumber(e).next(a=>r.loadAll(uk,IDBKeyRange.bound(i,i)).next(o=>S.forEach(o,l=>s.put(qU(l.indexId,this.uid,a,n)))))}updateIndexEntries(e,i){let n=new Map;return S.forEach(i,(r,s)=>{let a=n.get(r.collectionGroup);return(a?S.resolve(a):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(n.set(r.collectionGroup,l),S.forEach(l,c=>this.getExistingIndexEntries(e,r,c).next(d=>{let u=this.computeIndexEntries(s,c);return d.isEqual(u)?S.resolve():this.updateEntries(e,s,c,d,u)}))))})}addIndexEntry(e,i,n,r){return bu(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.encodeDirectionalKey(n,i.key),documentKey:i.key.path.toArray()})}deleteIndexEntry(e,i,n,r){return bu(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.encodeDirectionalKey(n,i.key),i.key.path.toArray()])}getExistingIndexEntries(e,i,n){let r=bu(e),s=new bt(Co);return r.iterate({index:Wq,range:IDBKeyRange.only([n.indexId,this.uid,this.encodeDirectionalKey(n,i)])},(a,o)=>{s=s.add(new $l(n.indexId,i,o.arrayValue,o.directionalValue))}).next(()=>s)}computeIndexEntries(e,i){let n=new bt(Co),r=this.encodeDirectionalElements(i,e);if(r==null)return n;let s=XA(i);if(s!=null){let a=e.data.field(s.fieldPath);if(_p(a))for(let o of a.arrayValue.values||[])n=n.add(new $l(i.indexId,e.key,this.encodeSingleElement(o),r))}else n=n.add(new $l(i.indexId,e.key,Uy,r));return n}updateEntries(e,i,n,r,s){N(iq,"Updating index entries for document '%s'",i.key);let a=[];return qoe(r,s,Co,o=>{a.push(this.addIndexEntry(e,i,n,o))},o=>{a.push(this.deleteIndexEntry(e,i,n,o))}),S.waitFor(a)}getNextSequenceNumber(e){let i=1;return vu(e).iterate({index:Hq,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,a)=>{a.done(),i=s.sequenceNumber+1}).next(()=>i)}createRange(e,i,n){n=n.sort((a,o)=>Co(a,o)).filter((a,o,l)=>!o||Co(a,l[o-1])!==0);let r=[];r.push(e);for(let a of n){let o=Co(a,e),l=Co(a,i);if(o===0)r[0]=e.successor();else if(o>0&&l<0)r.push(a),r.push(a.successor());else if(l>0)break}r.push(i);let s=[];for(let a=0;a<r.length;a+=2){if(this.isRangeMatchable(r[a],r[a+1]))return[];let o=[r[a].indexId,this.uid,r[a].arrayValue,r[a].directionalValue,Uy,[]],l=[r[a+1].indexId,this.uid,r[a+1].arrayValue,r[a+1].directionalValue,Uy,[]];s.push(IDBKeyRange.bound(o,l))}return s}isRangeMatchable(e,i){return Co(e,i)>0}getMinOffsetFromCollectionGroup(e,i){return this.getFieldIndexes(e,i).next(rq)}getMinOffset(e,i){return S.mapArray(this.getSubTargets(i),n=>this.getFieldIndex(e,n).next(r=>r||Y())).next(rq)}};function nq(t){return Mi(t,hp)}function bu(t){return Mi(t,nR)}function ep(t){return Mi(t,tR)}function vu(t){return Mi(t,iR)}function rq(t){oe(t.length!==0);let e=t[0].indexState.offset,i=e.largestBatchId;for(let n=1;n<t.length;n++){let r=t[n].indexState.offset;ZA(r,e)<0&&(e=r),i<r.largestBatchId&&(i=r.largestBatchId)}return new Cr(e.readTime,e.documentKey,i)}function Q5(t,e,i){let n=t.store(qr),r=t.store($u),s=[],a=IDBKeyRange.only(i.batchId),o=0,l=n.iterate({range:a},(d,u,h)=>(o++,h.delete()));s.push(l.next(()=>{oe(o===1)}));let c=[];for(let d of i.mutations){let u=zq(e,d.key.path,i.batchId);s.push(r.delete(u)),c.push(d.key)}return S.waitFor(s).next(()=>c)}function g0(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else if(t.noDocument)e=t.noDocument;else throw Y();return JSON.stringify(e).length}var _0=class t{constructor(e,i,n,r){this.userId=e,this.serializer=i,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}static forUser(e,i,n,r){oe(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,i,n,r)}checkEmpty(e){let i=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Eo(e).iterate({index:Yl,range:n},(r,s,a)=>{i=!1,a.done()}).next(()=>i)}addMutationBatch(e,i,n,r){let s=Su(e),a=Eo(e);return a.add({}).next(o=>{oe(typeof o=="number");let l=new yp(o,i,n,r),c=_de(this.serializer,this.userId,l),d=[],u=new bt((h,f)=>Re(h.canonicalString(),f.canonicalString()));for(let h of r){let f=zq(this.userId,h.key.path,o);u=u.add(h.key.path.popLast()),d.push(a.put(c)),d.push(s.put(f,moe))}return u.forEach(h=>{d.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.documentKeysByBatchId[o]=l.keys()}),S.waitFor(d).next(()=>l)})}lookupMutationBatch(e,i){return Eo(e).get(i).next(n=>n?(oe(n.userId===this.userId),Gl(this.serializer,n)):null)}lookupMutationKeys(e,i){return this.documentKeysByBatchId[i]?S.resolve(this.documentKeysByBatchId[i]):this.lookupMutationBatch(e,i).next(n=>{if(n){let r=n.keys();return this.documentKeysByBatchId[i]=r,r}else return null})}getNextMutationBatchAfterBatchId(e,i){let n=i+1,r=IDBKeyRange.lowerBound([this.userId,n]),s=null;return Eo(e).iterate({index:Yl,range:r},(a,o,l)=>{o.userId===this.userId&&(oe(o.batchId>=n),s=Gl(this.serializer,o)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let i=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=Do;return Eo(e).iterate({index:Yl,range:i,reverse:!0},(r,s,a)=>{n=s.batchId,a.done()}).next(()=>n)}getAllMutationBatches(e){let i=IDBKeyRange.bound([this.userId,Do],[this.userId,Number.POSITIVE_INFINITY]);return Eo(e).loadAll(Yl,i).next(n=>n.map(r=>Gl(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,i){let n=Gy(this.userId,i.path),r=IDBKeyRange.lowerBound(n),s=[];return Su(e).iterate({range:r},(a,o,l)=>{let[c,d,u]=a,h=Ls(d);if(c!==this.userId||!i.path.isEqual(h)){l.done();return}return Eo(e).get(u).next(f=>{if(!f)throw Y();oe(f.userId===this.userId),s.push(Gl(this.serializer,f))})}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,i){let n=new bt(Re),r=[];return i.forEach(s=>{let a=Gy(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=Su(e).iterate({range:o},(c,d,u)=>{let[h,f,p]=c,v=Ls(f);if(h!==this.userId||!s.path.isEqual(v)){u.done();return}n=n.add(p)});r.push(l)}),S.waitFor(r).next(()=>this.lookupMutationBatches(e,n))}getAllMutationBatchesAffectingQuery(e,i){let n=i.path,r=n.length+1,s=Gy(this.userId,n),a=IDBKeyRange.lowerBound(s),o=new bt(Re);return Su(e).iterate({range:a},(l,c,d)=>{let[u,h,f]=l,p=Ls(h);if(u!==this.userId||!n.isPrefixOf(p)){d.done();return}p.length===r&&(o=o.add(f))}).next(()=>this.lookupMutationBatches(e,o))}lookupMutationBatches(e,i){let n=[],r=[];return i.forEach(s=>{r.push(Eo(e).get(s).next(a=>{if(a===null)throw Y();oe(a.userId===this.userId),n.push(Gl(this.serializer,a))}))}),S.waitFor(r).next(()=>n)}removeMutationBatch(e,i){return Q5(e.simpleDbTransaction,this.userId,i).next(n=>(e.addOnCommittedListener(()=>{this.removeCachedMutationKeys(i.batchId)}),S.forEach(n,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}removeCachedMutationKeys(e){delete this.documentKeysByBatchId[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(i=>{if(!i)return S.resolve();let n=IDBKeyRange.lowerBound(foe(this.userId)),r=[];return Su(e).iterate({range:n},(s,a,o)=>{if(s[0]!==this.userId){o.done();return}else{let c=Ls(s[1]);r.push(c)}}).next(()=>{oe(r.length===0)})})}containsKey(e,i){return X5(e,this.userId,i)}getMutationQueueMetadata(e){return Z5(e).get(this.userId).next(i=>i||{userId:this.userId,lastAcknowledgedBatchId:Do,lastStreamToken:""})}};function X5(t,e,i){let n=Gy(e,i.path),r=n[1],s=IDBKeyRange.lowerBound(n),a=!1;return Su(t).iterate({range:s,keysOnly:!0},(o,l,c)=>{let[d,u,h]=o;d===e&&u===r&&(a=!0),c.done()}).next(()=>a)}function Qde(t,e){let i=!1;return Z5(t).iterateSerial(n=>X5(t,n,e).next(r=>(r&&(i=!0),S.resolve(!r)))).next(()=>i)}function Eo(t){return Mi(t,qr)}function Su(t){return Mi(t,$u)}function Z5(t){return Mi(t,Lp)}var H1=2,Vu=class t{constructor(e){this.lastId=e}next(){return this.lastId+=H1,this.lastId}static forTargetCache(){return new t(2-H1)}static forSyncEngine(){return new t(1-H1)}};var Hk=class{constructor(e,i){this.referenceDelegate=e,this.serializer=i}allocateTargetId(e){return this.retrieveMetadata(e).next(i=>{let n=new Vu(i.highestTargetId);return i.highestTargetId=n.next(),this.saveMetadata(e,i).next(()=>i.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.retrieveMetadata(e).next(i=>pe.fromTimestamp(new Bt(i.lastRemoteSnapshotVersion.seconds,i.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.retrieveMetadata(e).next(i=>i.highestListenSequenceNumber)}setTargetsMetadata(e,i,n){return this.retrieveMetadata(e).next(r=>(r.highestListenSequenceNumber=i,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),i>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=i),this.saveMetadata(e,r)))}addTargetData(e,i){return this.saveTargetData(e,i).next(()=>this.retrieveMetadata(e).next(n=>(n.targetCount+=1,this.updateMetadataFromTargetData(i,n),this.saveMetadata(e,n))))}updateTargetData(e,i){return this.saveTargetData(e,i)}removeTargetData(e,i){return this.removeMatchingKeysForTargetId(e,i.targetId).next(()=>yu(e).delete(i.targetId)).next(()=>this.retrieveMetadata(e)).next(n=>(oe(n.targetCount>0),n.targetCount-=1,this.saveMetadata(e,n)))}removeTargets(e,i,n){let r=0,s=[];return yu(e).iterate((a,o)=>{let l=rp(o);l.sequenceNumber<=i&&n.get(l.targetId)===null&&(r++,s.push(this.removeTargetData(e,l)))}).next(()=>S.waitFor(s)).next(()=>r)}forEachTarget(e,i){return yu(e).iterate((n,r)=>{let s=rp(r);i(s)})}retrieveMetadata(e){return sq(e).get(n0).next(i=>(oe(i!==null),i))}saveMetadata(e,i){return sq(e).put(n0,i)}saveTargetData(e,i){return yu(e).put(G5(this.serializer,i))}updateMetadataFromTargetData(e,i){let n=!1;return e.targetId>i.highestTargetId&&(i.highestTargetId=e.targetId,n=!0),e.sequenceNumber>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.retrieveMetadata(e).next(i=>i.targetCount)}getTargetData(e,i){let n=rc(i),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),s=null;return yu(e).iterate({range:r,index:qq},(a,o,l)=>{let c=rp(o);jp(i,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,i,n){let r=[],s=xo(e);return i.forEach(a=>{let o=gn(a.path);r.push(s.put({targetId:n,path:o})),r.push(this.referenceDelegate.addReference(e,n,a))}),S.waitFor(r)}removeMatchingKeys(e,i,n){let r=xo(e);return S.forEach(i,s=>{let a=gn(s.path);return S.waitFor([r.delete([n,a]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,i){let n=xo(e),r=IDBKeyRange.bound([i],[i+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,i){let n=IDBKeyRange.bound([i],[i+1],!1,!0),r=xo(e),s=Oe();return r.iterate({range:n,keysOnly:!0},(a,o,l)=>{let c=Ls(a[1]),d=new z(c);s=s.add(d)}).next(()=>s)}containsKey(e,i){let n=gn(i.path),r=IDBKeyRange.bound([n],[Oq(n)],!1,!0),s=0;return xo(e).iterate({index:eR,keysOnly:!0,range:r},([a,o],l,c)=>{a!==0&&(s++,c.done())}).next(()=>s>0)}getTargetDataForTarget(e,i){return yu(e).get(i).next(n=>n?rp(n):null)}};function yu(t){return Mi(t,Yu)}function sq(t){return Mi(t,fc)}function xo(t){return Mi(t,Qu)}var aq={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qp=-1,J5=40*1024*1024,yr=class t{constructor(e,i,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=i,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};yr.DEFAULT_COLLECTION_PERCENTILE=10;yr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3;yr.DEFAULT=new yr(J5,yr.DEFAULT_COLLECTION_PERCENTILE,yr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);yr.DISABLED=new yr(qp,0,0);var oq="LruGarbageCollector",lq=1*1024*1024,Xde=1*60*1e3,Zde=5*60*1e3;function cq([t,e],[i,n]){let r=Re(t,i);return r===0?Re(e,n):r}var Wk=class{constructor(e){this.maxElements=e,this.buffer=new bt(cq),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let i=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(i);else{let n=this.buffer.last();cq(i,n)<0&&(this.buffer=this.buffer.delete(n).add(i))}}get maxValue(){return this.buffer.last()[0]}},Gk=class{constructor(e,i,n){this.garbageCollector=e,this.asyncQueue=i,this.localStore=n,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==qp&&this.scheduleGC(Xde)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return this.gcTask!==null}scheduleGC(e){N(oq,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>y(this,null,function*(){this.gcTask=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(i){zo(i)?N(oq,"Ignoring IndexedDB error during garbage collection: ",i):yield jo(i)}yield this.scheduleGC(Zde)}))}},Kk=class{constructor(e,i){this.delegate=e,this.params=i}calculateTargetCount(e,i){return this.delegate.getSequenceNumberCount(e).next(n=>Math.floor(i/100*n))}nthSequenceNumber(e,i){if(i===0)return S.resolve(qn.INVALID);let n=new Wk(i);return this.delegate.forEachTarget(e,r=>n.addElement(r.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,r=>n.addElement(r))).next(()=>n.maxValue)}removeTargets(e,i,n){return this.delegate.removeTargets(e,i,n)}removeOrphanedDocuments(e,i){return this.delegate.removeOrphanedDocuments(e,i)}collect(e,i){return this.params.cacheSizeCollectionThreshold===qp?(N("LruGarbageCollector","Garbage collection skipped; disabled"),S.resolve(aq)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aq):this.runGarbageCollection(e,i))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,i){let n,r,s,a,o,l,c,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(u=>(u>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${u}`),r=this.params.maximumSequenceNumbersToCollect):r=u,a=Date.now(),this.nthSequenceNumber(e,r))).next(u=>(n=u,o=Date.now(),this.removeTargets(e,n,i))).next(u=>(s=u,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(u=>{if(c=Date.now(),wu()<=Qn.DEBUG){let h=`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${r} in ${o-a}ms
	Removed ${s} targets in ${l-o}ms
	Removed ${u} documents in ${c-l}ms
Total Duration: ${c-d}ms`;N("LruGarbageCollector",h)}return S.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:u})})}};function Jde(t,e){return new Kk(t,e)}var $k=class{constructor(e,i){this.db=e,this.garbageCollector=Jde(this,i)}getSequenceNumberCount(e){let i=this.orphanedDocumentCount(e);return this.db.getTargetCache().getTargetCount(e).next(r=>i.next(s=>r+s))}orphanedDocumentCount(e){let i=0;return this.forEachOrphanedDocumentSequenceNumber(e,n=>{i++}).next(()=>i)}forEachTarget(e,i){return this.db.getTargetCache().forEachTarget(e,i)}forEachOrphanedDocumentSequenceNumber(e,i){return this.forEachOrphanedDocument(e,(n,r)=>i(r))}addReference(e,i,n){return qy(e,n)}removeReference(e,i,n){return qy(e,n)}removeTargets(e,i,n){return this.db.getTargetCache().removeTargets(e,i,n)}markPotentiallyOrphaned(e,i){return qy(e,i)}isPinned(e,i){return Qde(e,i)}removeOrphanedDocuments(e,i){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[],a=0;return this.forEachOrphanedDocument(e,(l,c)=>{if(c<=i){let d=this.isPinned(e,l).next(u=>{if(!u)return a++,r.getEntry(e,l).next(()=>(r.removeEntry(l,pe.min()),xo(e).delete(eue(l))))});s.push(d)}}).next(()=>S.waitFor(s)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,i){let n=i.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,i){return qy(e,i)}forEachOrphanedDocument(e,i){let n=xo(e),r=qn.INVALID,s;return n.iterate({index:eR},([a,o],{path:l,sequenceNumber:c})=>{a===0?(r!==qn.INVALID&&i(new z(Ls(s)),r),r=c,s=l):r=qn.INVALID}).next(()=>{r!==qn.INVALID&&i(new z(Ls(s)),r)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function eue(t){return[0,gn(t.path)]}function tue(t,e){return{targetId:0,path:gn(t.path),sequenceNumber:e}}function qy(t,e){return xo(t).put(tue(e,t.currentSequenceNumber))}var b0=class{constructor(){this.changes=new Us(e=>e.toString(),(e,i)=>e.isEqual(i)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,i){this.assertNotApplied(),this.changes.set(e,di.newInvalidDocument(e).setReadTime(i))}getEntry(e,i){this.assertNotApplied();let n=this.changes.get(i);return n!==void 0?S.resolve(n):this.getFromCache(e,i)}getEntries(e,i){return this.getAllFromCache(e,i)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Yk=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,i,n){return ql(e).put(n)}removeEntry(e,i,n){return ql(e).delete(iue(i,n))}updateMetadata(e,i){return this.getMetadata(e).next(n=>(n.byteSize+=i,this.setMetadata(e,n)))}getEntry(e,i){let n=di.newInvalidDocument(i);return ql(e).iterate({index:Ky,range:IDBKeyRange.only(tp(i))},(r,s)=>{n=this.maybeDecodeDocument(i,s)}).next(()=>n)}getSizedEntry(e,i){let n={size:0,document:di.newInvalidDocument(i)};return ql(e).iterate({index:Ky,range:IDBKeyRange.only(tp(i))},(r,s)=>{n={document:this.maybeDecodeDocument(i,s),size:g0(s)}}).next(()=>n)}getEntries(e,i){let n=Dn();return this.forEachDbEntry(e,i,(r,s)=>{let a=this.maybeDecodeDocument(r,s);n=n.insert(r,a)}).next(()=>n)}getSizedEntries(e,i){let n=Dn(),r=new Dt(z.comparator);return this.forEachDbEntry(e,i,(s,a)=>{let o=this.maybeDecodeDocument(s,a);n=n.insert(s,o),r=r.insert(s,g0(a))}).next(()=>({documents:n,sizeMap:r}))}forEachDbEntry(e,i,n){if(i.isEmpty())return S.resolve();let r=new bt(hq);i.forEach(l=>r=r.add(l));let s=IDBKeyRange.bound(tp(r.first()),tp(r.last())),a=r.getIterator(),o=a.getNext();return ql(e).iterate({index:Ky,range:s},(l,c,d)=>{let u=z.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;o&&hq(o,u)<0;)n(o,null),o=a.getNext();o&&o.isEqual(u)&&(n(o,c),o=a.hasNext()?a.getNext():null),o?d.skip(tp(o)):d.done()}).next(()=>{for(;o;)n(o,null),o=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,i,n,r,s){let a=i.path,o=[a.popLast().toArray(),a.lastSegment(),X0(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ql(e).loadAll(IDBKeyRange.bound(o,l,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let d=Dn();for(let u of c){let h=this.maybeDecodeDocument(z.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);h.isFoundDocument()&&(Up(i,h)||r.has(h.key))&&(d=d.insert(h.key,h))}return d})}getAllFromCollectionGroup(e,i,n,r){let s=Dn(),a=uq(i,n),o=uq(i,Cr.max());return ql(e).iterate({index:Uq,range:IDBKeyRange.bound(a,o,!0)},(l,c,d)=>{let u=this.maybeDecodeDocument(z.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(u.key,u),s.size===r&&d.done()}).next(()=>s)}newChangeBuffer(e){return new Qk(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(i=>i.byteSize)}getMetadata(e){return dq(e).get(dk).next(i=>(oe(!!i),i))}setMetadata(e,i){return dq(e).put(dk,i)}maybeDecodeDocument(e,i){if(i){let n=pde(this.serializer,i);if(!(n.isNoDocument()&&n.version.isEqual(pe.min())))return n}return di.newInvalidDocument(e)}};function eH(t){return new Yk(t)}var Qk=class extends b0{constructor(e,i){super(),this.documentCache=e,this.trackRemovals=i,this.documentStates=new Us(n=>n.toString(),(n,r)=>n.isEqual(r))}applyChanges(e){let i=[],n=0,r=new bt((s,a)=>Re(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{let o=this.documentStates.get(s);if(i.push(this.documentCache.removeEntry(e,s,o.readTime)),a.isValidDocument()){let l=UU(this.documentCache.serializer,a);r=r.add(s.path.popLast());let c=g0(l);n+=c-o.size,i.push(this.documentCache.addEntry(e,s,l))}else if(n-=o.size,this.trackRemovals){let l=UU(this.documentCache.serializer,a.convertToNoDocument(pe.min()));i.push(this.documentCache.addEntry(e,s,l))}}),r.forEach(s=>{i.push(this.documentCache.indexManager.addToCollectionParentIndex(e,s))}),i.push(this.documentCache.updateMetadata(e,n)),S.waitFor(i)}getFromCache(e,i){return this.documentCache.getSizedEntry(e,i).next(n=>(this.documentStates.set(i,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,i){return this.documentCache.getSizedEntries(e,i).next(({documents:n,sizeMap:r})=>(r.forEach((s,a)=>{this.documentStates.set(s,{size:a,readTime:n.get(s).readTime})}),n))}};function dq(t){return Mi(t,Bp)}function ql(t){return Mi(t,H0)}function tp(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function iue(t,e){let i=t.path.toArray();return[i.slice(0,i.length-2),i[i.length-2],X0(e),i[i.length-1]]}function uq(t,e){let i=e.documentKey.path.toArray();return[t,X0(e.readTime),i.slice(0,i.length-2),i.length>0?i[i.length-1]:""]}function hq(t,e){let i=t.path.toArray(),n=e.path.toArray(),r=0;for(let s=0;s<i.length-2&&s<n.length-2;++s)if(r=Re(i[s],n[s]),r)return r;return r=Re(i.length,n.length),r||(r=Re(i[i.length-2],n[n.length-2]),r)?r:Re(i[i.length-1],n[n.length-1])}var nue=15;var Xk=class{constructor(e,i){this.overlayedDocument=e,this.mutatedFields=i}};var v0=class{constructor(e,i,n,r){this.remoteDocumentCache=e,this.mutationQueue=i,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,i){let n=null;return this.documentOverlayCache.getOverlay(e,i).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,i))).next(r=>(n!==null&&lp(n.mutation,r,Hn.empty(),Bt.now()),r))}getDocuments(e,i){return this.remoteDocumentCache.getEntries(e,i).next(n=>this.getLocalViewOfDocuments(e,n,Oe()).next(()=>n))}getLocalViewOfDocuments(e,i,n=Oe()){let r=Bs();return this.populateOverlays(e,r,i).next(()=>this.computeViews(e,i,r,n).next(s=>{let a=np();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,i){let n=Bs();return this.populateOverlays(e,n,i).next(()=>this.computeViews(e,i,n,Oe()))}populateOverlays(e,i,n){let r=[];return n.forEach(s=>{i.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((a,o)=>{i.set(a,o)})})}computeViews(e,i,n,r){let s=Dn(),a=bp(),o=Yle();return i.forEach((l,c)=>{let d=n.get(c.key);r.has(c.key)&&(d===void 0||d.mutation instanceof Gr)?s=s.insert(c.key,c):d!==void 0?(a.set(c.key,d.mutation.getFieldMask()),lp(d.mutation,c,d.mutation.getFieldMask(),Bt.now())):a.set(c.key,Hn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>a.set(c,d)),i.forEach((c,d)=>{var u;return o.set(c,new Xk(d,(u=a.get(c))!==null&&u!==void 0?u:null))}),o))}recalculateAndSaveOverlays(e,i){let n=bp(),r=new Dt((a,o)=>a-o),s=Oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,i).next(a=>{for(let o of a)o.keys().forEach(l=>{let c=i.get(l);if(c===null)return;let d=n.get(l)||Hn.empty();d=o.applyToLocalView(c,d),n.set(l,d);let u=(r.get(o.batchId)||Oe()).add(l);r=r.insert(o.batchId,u)})}).next(()=>{let a=[],o=r.getReverseIterator();for(;o.hasNext();){let l=o.getNext(),c=l.key,d=l.value,u=y5();d.forEach(h=>{if(!s.has(h)){let f=D5(i.get(h),n.get(h));f!==null&&u.set(h,f),s=s.add(h)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,u))}return S.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,i){return this.remoteDocumentCache.getEntries(e,i).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,i,n,r){return Ble(i)?this.getDocumentsMatchingDocumentQuery(e,i.path):oR(i)?this.getDocumentsMatchingCollectionGroupQuery(e,i,n,r):this.getDocumentsMatchingCollectionQuery(e,i,n,r)}getNextDocuments(e,i,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,i,n,r).next(s=>{let a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,i,n.largestBatchId,r-s.size):S.resolve(Bs()),o=Au,l=s;return a.next(c=>S.forEach(c,(d,u)=>(o<u.largestBatchId&&(o=u.largestBatchId),s.get(d)?S.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{l=l.insert(d,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Oe())).next(d=>({batchId:o,changes:v5(d)})))})}getDocumentsMatchingDocumentQuery(e,i){return this.getDocument(e,new z(i)).next(n=>{let r=np();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,i,n,r){let s=i.collectionGroup,a=np();return this.indexManager.getCollectionParents(e,s).next(o=>S.forEach(o,l=>{let c=Ple(i,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,r).next(d=>{d.forEach((u,h)=>{a=a.insert(u,h)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,i,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,i.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,i,n,s,r))).next(a=>{s.forEach((l,c)=>{let d=c.getKey();a.get(d)===null&&(a=a.insert(d,di.newInvalidDocument(d)))});let o=np();return a.forEach((l,c)=>{let d=s.get(l);d!==void 0&&lp(d.mutation,c,Hn.empty(),Bt.now()),Up(i,c)&&(o=o.insert(l,c))}),o})}};var Zk=class{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,i){return S.resolve(this.bundles.get(i))}saveBundleMetadata(e,i){return this.bundles.set(i.id,Sde(i)),S.resolve()}getNamedQuery(e,i){return S.resolve(this.namedQueries.get(i))}saveNamedQuery(e,i){return this.namedQueries.set(i.name,Ede(i)),S.resolve()}};var Jk=class{constructor(){this.overlays=new Dt(z.comparator),this.overlayByBatchId=new Map}getOverlay(e,i){return S.resolve(this.overlays.get(i))}getOverlays(e,i){let n=Bs();return S.forEach(i,r=>this.getOverlay(e,r).next(s=>{s!==null&&n.set(r,s)})).next(()=>n)}saveOverlays(e,i,n){return n.forEach((r,s)=>{this.saveOverlay(e,i,s)}),S.resolve()}removeOverlaysForBatchId(e,i,n){let r=this.overlayByBatchId.get(n);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.overlayByBatchId.delete(n)),S.resolve()}getOverlaysForCollection(e,i,n){let r=Bs(),s=i.length+1,a=new z(i.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){let c=o.getNext().value,d=c.getKey();if(!i.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>n&&r.set(c.getKey(),c)}return S.resolve(r)}getOverlaysForCollectionGroup(e,i,n,r){let s=new Dt((c,d)=>c-d),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===i&&d.largestBatchId>n){let h=s.get(d.largestBatchId);h===null&&(h=Bs(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}let o=Bs(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>o.set(u,h)),!(o.size()>=r)););return S.resolve(o)}saveOverlay(e,i,n){let r=this.overlays.get(n.key);if(r!==null){let a=this.overlayByBatchId.get(r.largestBatchId).delete(n.key);this.overlayByBatchId.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new wp(i,n));let s=this.overlayByBatchId.get(i);s===void 0&&(s=Oe(),this.overlayByBatchId.set(i,s)),this.overlayByBatchId.set(i,s.add(n.key))}};var Ip=class{constructor(){this.refsByKey=new bt(ci.compareByKey),this.refsByTarget=new bt(ci.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,i){let n=new ci(e,i);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)}addReferences(e,i){e.forEach(n=>this.addReference(n,i))}removeReference(e,i){this.removeRef(new ci(e,i))}removeReferences(e,i){e.forEach(n=>this.removeReference(n,i))}removeReferencesForId(e){let i=new z(new Qe([])),n=new ci(i,e),r=new ci(i,e+1),s=[];return this.refsByTarget.forEachInRange([n,r],a=>{this.removeRef(a),s.push(a.key)}),s}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let i=new z(new Qe([])),n=new ci(i,e),r=new ci(i,e+1),s=Oe();return this.refsByTarget.forEachInRange([n,r],a=>{s=s.add(a.key)}),s}containsKey(e){let i=new ci(e,0),n=this.refsByKey.firstAfterOrEqual(i);return n!==null&&e.isEqual(n.key)}},ci=class{constructor(e,i){this.key=e,this.targetOrBatchId=i}static compareByKey(e,i){return z.comparator(e.key,i.key)||Re(e.targetOrBatchId,i.targetOrBatchId)}static compareByTargetId(e,i){return Re(e.targetOrBatchId,i.targetOrBatchId)||z.comparator(e.key,i.key)}};var eA=class{constructor(e,i){this.indexManager=e,this.referenceDelegate=i,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new bt(ci.compareByKey)}checkEmpty(e){return S.resolve(this.mutationQueue.length===0)}addMutationBatch(e,i,n,r){let s=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new yp(s,i,n,r);this.mutationQueue.push(a);for(let o of r)this.batchesByDocumentKey=this.batchesByDocumentKey.add(new ci(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return S.resolve(a)}lookupMutationBatch(e,i){return S.resolve(this.findMutationBatch(i))}getNextMutationBatchAfterBatchId(e,i){let n=i+1,r=this.indexOfBatchId(n),s=r<0?0:r;return S.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return S.resolve(this.mutationQueue.length===0?Do:this.nextBatchId-1)}getAllMutationBatches(e){return S.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,i){let n=new ci(i,0),r=new ci(i,Number.POSITIVE_INFINITY),s=[];return this.batchesByDocumentKey.forEachInRange([n,r],a=>{let o=this.findMutationBatch(a.targetOrBatchId);s.push(o)}),S.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,i){let n=new bt(Re);return i.forEach(r=>{let s=new ci(r,0),a=new ci(r,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([s,a],o=>{n=n.add(o.targetOrBatchId)})}),S.resolve(this.findMutationBatches(n))}getAllMutationBatchesAffectingQuery(e,i){let n=i.path,r=n.length+1,s=n;z.isDocumentKey(s)||(s=s.child(""));let a=new ci(new z(s),0),o=new bt(Re);return this.batchesByDocumentKey.forEachWhile(l=>{let c=l.key.path;return n.isPrefixOf(c)?(c.length===r&&(o=o.add(l.targetOrBatchId)),!0):!1},a),S.resolve(this.findMutationBatches(o))}findMutationBatches(e){let i=[];return e.forEach(n=>{let r=this.findMutationBatch(n);r!==null&&i.push(r)}),i}removeMutationBatch(e,i){let n=this.indexOfExistingBatchId(i.batchId,"removed");oe(n===0),this.mutationQueue.shift();let r=this.batchesByDocumentKey;return S.forEach(i.mutations,s=>{let a=new ci(s.key,i.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.batchesByDocumentKey=r})}removeCachedMutationKeys(e){}containsKey(e,i){let n=new ci(i,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return S.resolve(i.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,S.resolve()}indexOfExistingBatchId(e,i){return this.indexOfBatchId(e)}indexOfBatchId(e){if(this.mutationQueue.length===0)return 0;let i=this.mutationQueue[0].batchId;return e-i}findMutationBatch(e){let i=this.indexOfBatchId(e);return i<0||i>=this.mutationQueue.length?null:this.mutationQueue[i]}};function rue(){return new Dt(z.comparator)}var tA=class{constructor(e){this.sizer=e,this.docs=rue(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,i){let n=i.key,r=this.docs.get(n),s=r?r.size:0,a=this.sizer(i);return this.docs=this.docs.insert(n,{document:i.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let i=this.docs.get(e);i&&(this.docs=this.docs.remove(e),this.size-=i.size)}getEntry(e,i){let n=this.docs.get(i);return S.resolve(n?n.document.mutableCopy():di.newInvalidDocument(i))}getEntries(e,i){let n=Dn();return i.forEach(r=>{let s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():di.newInvalidDocument(r))}),S.resolve(n)}getDocumentsMatchingQuery(e,i,n,r){let s=Dn(),a=i.path,o=new z(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){let{key:c,value:{document:d}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||ZA(Pq(d),n)<=0||!r.has(d.key)&&!Up(i,d)||(s=s.insert(d.key,d.mutableCopy()))}return S.resolve(s)}getAllFromCollectionGroup(e,i,n,r){Y()}forEachDocumentKey(e,i){return S.forEach(this.docs,n=>i(n))}newChangeBuffer(e){return new iA(this)}getSize(e){return S.resolve(this.size)}};function sue(t){return new tA(t)}var iA=class extends b0{constructor(e){super(),this.documentCache=e}applyChanges(e){let i=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?i.push(this.documentCache.addEntry(e,r)):this.documentCache.removeEntry(n)}),S.waitFor(i)}getFromCache(e,i){return this.documentCache.getEntry(e,i)}getAllFromCache(e,i){return this.documentCache.getEntries(e,i)}};var nA=class{constructor(e){this.persistence=e,this.targets=new Us(i=>rc(i),jp),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Ip,this.targetCount=0,this.targetIdGenerator=Vu.forTargetCache()}forEachTarget(e,i){return this.targets.forEach((n,r)=>i(r)),S.resolve()}getLastRemoteSnapshotVersion(e){return S.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return S.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),S.resolve(this.highestTargetId)}setTargetsMetadata(e,i,n){return n&&(this.lastRemoteSnapshotVersion=n),i>this.highestSequenceNumber&&(this.highestSequenceNumber=i),S.resolve()}saveTargetData(e){this.targets.set(e.target,e);let i=e.targetId;i>this.highestTargetId&&(this.targetIdGenerator=new Vu(i),this.highestTargetId=i),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,i){return this.saveTargetData(i),this.targetCount+=1,S.resolve()}updateTargetData(e,i){return this.saveTargetData(i),S.resolve()}removeTargetData(e,i){return this.targets.delete(i.target),this.references.removeReferencesForId(i.targetId),this.targetCount-=1,S.resolve()}removeTargets(e,i,n){let r=0,s=[];return this.targets.forEach((a,o)=>{o.sequenceNumber<=i&&n.get(o.targetId)===null&&(this.targets.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),S.waitFor(s).next(()=>r)}getTargetCount(e){return S.resolve(this.targetCount)}getTargetData(e,i){let n=this.targets.get(i)||null;return S.resolve(n)}addMatchingKeys(e,i,n){return this.references.addReferences(i,n),S.resolve()}removeMatchingKeys(e,i,n){this.references.removeReferences(i,n);let r=this.persistence.referenceDelegate,s=[];return r&&i.forEach(a=>{s.push(r.markPotentiallyOrphaned(e,a))}),S.waitFor(s)}removeMatchingKeysForTargetId(e,i){return this.references.removeReferencesForId(i),S.resolve()}getMatchingKeysForTargetId(e,i){let n=this.references.referencesForId(i);return S.resolve(n)}containsKey(e,i){return S.resolve(this.references.containsKey(i))}};var aue="MemoryPersistence",y0=class{constructor(e,i){this.mutationQueues={},this.overlays={},this.listenSequence=new qn(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.targetCache=new nA(this);let n=r=>this.referenceDelegate.documentSize(r);this.indexManager=new Uk,this.remoteDocumentCache=sue(n),this.serializer=new h0(i),this.bundleCache=new Zk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let i=this.overlays[e.toKey()];return i||(i=new Jk,this.overlays[e.toKey()]=i),i}getMutationQueue(e,i){let n=this.mutationQueues[e.toKey()];return n||(n=new eA(i,this.referenceDelegate),this.mutationQueues[e.toKey()]=n),n}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,i,n){N(aue,"Starting transaction:",e);let r=new rA(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(r).next(s=>this.referenceDelegate.onTransactionCommitted(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}mutationQueuesContainKey(e,i){return S.or(Object.values(this.mutationQueues).map(n=>()=>n.containsKey(e,i)))}},rA=class extends t0{constructor(e){super(),this.currentSequenceNumber=e}},w0=class t{constructor(e){this.persistence=e,this.localViewReferences=new Ip,this._orphanedDocuments=null}static factory(e){return new t(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw Y()}addReference(e,i,n){return this.localViewReferences.addReference(n,i),this.orphanedDocuments.delete(n.toString()),S.resolve()}removeReference(e,i,n){return this.localViewReferences.removeReference(n,i),this.orphanedDocuments.add(n.toString()),S.resolve()}markPotentiallyOrphaned(e,i){return this.orphanedDocuments.add(i.toString()),S.resolve()}removeTarget(e,i){this.localViewReferences.removeReferencesForId(i.targetId).forEach(s=>this.orphanedDocuments.add(s.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,i.targetId).next(s=>{s.forEach(a=>this.orphanedDocuments.add(a.toString()))}).next(()=>r.removeTargetData(e,i))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return S.forEach(this.orphanedDocuments,r=>{let s=z.fromPath(r);return this.isReferenced(e,s).next(a=>{a||n.removeEntry(s,pe.min())})}).next(()=>(this._orphanedDocuments=null,n.apply(e)))}updateLimboDocument(e,i){return this.isReferenced(e,i).next(n=>{n?this.orphanedDocuments.delete(i.toString()):this.orphanedDocuments.add(i.toString())})}documentSize(e){return 0}isReferenced(e,i){return S.or([()=>S.resolve(this.localViewReferences.containsKey(i)),()=>this.persistence.getTargetCache().containsKey(e,i),()=>this.persistence.mutationQueuesContainKey(e,i)])}};var sA=class{constructor(e){this.serializer=e}createOrUpgrade(e,i,n,r){let s=new i0("createOrUpgrade",i);n<1&&r>=1&&(lue(e),cue(e),fq(e),uue(e));let a=S.resolve();return n<3&&r>=3&&(n!==0&&(mue(e),fq(e)),a=a.next(()=>gue(s))),n<4&&r>=4&&(n!==0&&(a=a.next(()=>due(e,s))),a=a.next(()=>{_ue(e)})),n<5&&r>=5&&(a=a.next(()=>this.removeAcknowledgedMutations(s))),n<6&&r>=6&&(a=a.next(()=>(fue(e),this.addDocumentGlobal(s)))),n<7&&r>=7&&(a=a.next(()=>this.ensureSequenceNumbers(s))),n<8&&r>=8&&(a=a.next(()=>this.createCollectionParentIndex(e,s))),n<9&&r>=9&&(a=a.next(()=>{pue(e)})),n<10&&r>=10&&(a=a.next(()=>this.rewriteCanonicalIds(s))),n<11&&r>=11&&(a=a.next(()=>{bue(e),vue(e)})),n<12&&r>=12&&(a=a.next(()=>{wue(e)})),n<13&&r>=13&&(a=a.next(()=>hue(e)).next(()=>this.rewriteRemoteDocumentCache(e,s)).next(()=>e.deleteObjectStore(Wl))),n<14&&r>=14&&(a=a.next(()=>this.runOverlayMigration(e,s))),n<15&&r>=15&&(a=a.next(()=>yue(e))),a}addDocumentGlobal(e){let i=0;return e.store(Wl).iterate((n,r)=>{i+=g0(r)}).next(()=>{let n={byteSize:i};return e.store(Bp).put(dk,n)})}removeAcknowledgedMutations(e){let i=e.store(Lp),n=e.store(qr);return i.loadAll().next(r=>S.forEach(r,s=>{let a=IDBKeyRange.bound([s.userId,Do],[s.userId,s.lastAcknowledgedBatchId]);return n.loadAll(Yl,a).next(o=>S.forEach(o,l=>{oe(l.userId===s.userId);let c=Gl(this.serializer,l);return Q5(e,s.userId,c).next(()=>{})}))}))}ensureSequenceNumbers(e){let i=e.store(Qu),n=e.store(Wl);return e.store(fc).get(n0).next(s=>{let a=l=>i.put({targetId:0,path:gn(l),sequenceNumber:s.highestListenSequenceNumber}),o=[];return n.iterate((l,c)=>{let d=new Qe(l),u=oue(d);o.push(i.get(u).next(h=>h?S.resolve():a(d)))}).next(()=>S.waitFor(o))})}createCollectionParentIndex(e,i){e.createObjectStore(hp,{keyPath:Coe});let n=i.store(hp),r=new Tp,s=a=>{if(r.add(a)){let o=a.lastSegment(),l=a.popLast();return n.put({collectionId:o,parent:gn(l)})}};return i.store(Wl).iterate({keysOnly:!0},(a,o)=>{let l=new Qe(a);return s(l.popLast())}).next(()=>i.store($u).iterate({keysOnly:!0},([a,o,l],c)=>{let d=Ls(o);return s(d.popLast())}))}rewriteCanonicalIds(e){let i=e.store(Yu);return i.iterate((n,r)=>{let s=rp(r),a=G5(this.serializer,s);return i.put(a)})}rewriteRemoteDocumentCache(e,i){let n=i.store(Wl),r=[];return n.iterate((s,a)=>{let o=i.store(H0),l=Cue(a).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};r.push(o.put(c))}).next(()=>S.waitFor(r))}runOverlayMigration(e,i){let n=i.store(qr),r=eH(this.serializer),s=new y0(w0.factory,this.serializer.remoteSerializer);return n.loadAll().next(a=>{let o=new Map;return a.forEach(l=>{var c;let d=(c=o.get(l.userId))!==null&&c!==void 0?c:Oe();Gl(this.serializer,l).keys().forEach(h=>d=d.add(h)),o.set(l.userId,d)}),S.forEach(o,(l,c)=>{let d=new ui(c),u=f0.forUser(this.serializer,d),h=s.getIndexManager(d),f=_0.forUser(d,this.serializer,h,s.referenceDelegate);return new v0(r,f,u,h).recalculateAndSaveOverlaysForDocumentKeys(new fp(i,qn.INVALID),l).next()})})}};function oue(t){return[0,gn(t)]}function lue(t){t.createObjectStore(Fp)}function cue(t){t.createObjectStore(Lp,{keyPath:hoe}),t.createObjectStore(qr,{keyPath:Vq,autoIncrement:!0}).createIndex(Yl,jq,{unique:!0}),t.createObjectStore($u)}function due(t,e){return e.store(qr).loadAll().next(n=>{t.deleteObjectStore(qr),t.createObjectStore(qr,{keyPath:Vq,autoIncrement:!0}).createIndex(Yl,jq,{unique:!0});let s=e.store(qr),a=n.map(o=>s.put(o));return S.waitFor(a)})}function uue(t){t.createObjectStore(Wl)}function hue(t){let e=t.createObjectStore(H0,{keyPath:poe});e.createIndex(Ky,goe),e.createIndex(Uq,_oe)}function fue(t){t.createObjectStore(Bp)}function fq(t){t.createObjectStore(Qu,{keyPath:yoe}).createIndex(eR,woe,{unique:!0}),t.createObjectStore(Yu,{keyPath:boe}).createIndex(qq,voe,{unique:!0}),t.createObjectStore(fc)}function mue(t){t.deleteObjectStore(Qu),t.deleteObjectStore(Yu),t.deleteObjectStore(fc)}function pue(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}function gue(t){let e=t.store(fc),i={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:pe.min().toTimestamp(),targetCount:0};return e.put(n0,i)}function _ue(t){t.createObjectStore(Ru,{keyPath:Eoe})}function bue(t){t.createObjectStore(W0,{keyPath:Soe})}function vue(t){t.createObjectStore(G0,{keyPath:xoe})}function yue(t){t.createObjectStore(tR,{keyPath:Toe,autoIncrement:!0}).createIndex(uk,Ioe,{unique:!1}),t.createObjectStore(iR,{keyPath:Doe}).createIndex(Hq,koe,{unique:!1}),t.createObjectStore(nR,{keyPath:Aoe}).createIndex(Wq,Roe,{unique:!1})}function wue(t){let e=t.createObjectStore(K0,{keyPath:Moe});e.createIndex(hk,Ooe,{unique:!1}),e.createIndex(Gq,Noe,{unique:!1})}function Cue(t){return t.document?new z(Qe.fromString(t.document.name).popFirst(5)):t.noDocument?z.fromSegments(t.noDocument.path):t.unknownDocument?z.fromSegments(t.unknownDocument.path):Y()}var So="IndexedDbPersistence",W1=30*60*1e3,G1=5e3,Eue=4e3,K1="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Sue="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",xue="firestore_zombie",tH="main",aA=class t{constructor(e,i,n,r,s,a,o,l,c,d,u=nue){if(this.allowTabSynchronization=e,this.persistenceKey=i,this.clientId=n,this.queue=s,this.window=a,this.document=o,this.sequenceNumberSyncer=c,this.forceOwningTab=d,this.schemaVersion=u,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=h=>Promise.resolve(),!t.isAvailable())throw new D(T.UNIMPLEMENTED,Sue);this.referenceDelegate=new $k(this,r),this.dbName=i+tH,this.serializer=new h0(l),this.simpleDb=new da(this.dbName,this.schemaVersion,new sA(this.serializer)),this.targetCache=new Hk(this.referenceDelegate,this.serializer),this.remoteDocumentCache=eH(this.serializer),this.bundleCache=new Lk,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,d===!1&&Lt(So,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new D(T.FAILED_PRECONDITION,K1);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.targetCache.getHighestSequenceNumber(e))}).then(e=>{this.listenSequence=new qn(e,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(e=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(e)))}setPrimaryStateListener(e){return this.primaryStateListener=i=>y(this,null,function*(){if(this.started)return e(i)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.simpleDb.setVersionChangeListener(i=>y(this,null,function*(){i.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(()=>y(this,null,function*(){this.started&&(yield this.updateClientMetadataAndTryBecomePrimary())})))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Hy(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(e).next(n=>{n||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(e)).next(n=>this.isPrimary&&!n?this.releasePrimaryLeaseIfHeld(e).next(()=>!1):n?this.acquireOrExtendPrimaryLease(e).next(()=>!0):!1)).catch(e=>{if(zo(e))return N(So,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return N(So,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.queue.enqueueRetryable(()=>this.primaryStateListener(e)),this.isPrimary=e})}verifyPrimaryLease(e){return ip(e).get(mu).next(n=>S.resolve(this.isLocalClient(n)))}removeClientMetadata(e){return Hy(e).delete(this.clientId)}maybeGarbageCollectMultiClientState(){return y(this,null,function*(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,W1)){this.lastGarbageCollectionTime=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{let n=Mi(i,Ru);return n.loadAll().next(r=>{let s=this.filterActiveClients(r,W1),a=r.filter(o=>s.indexOf(o)===-1);return S.forEach(a,o=>n.delete(o.clientId)).next(()=>a)})}).catch(()=>[]);if(this.webStorage)for(let i of e)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(i.clientId))}})}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",Eue,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(e){return e?e.ownerId===this.clientId:!1}canActAsPrimary(e){return this.forceOwningTab?S.resolve(!0):ip(e).get(mu).next(n=>{if(n!==null&&this.isWithinAge(n.leaseTimestampMs,G1)&&!this.isClientZombied(n.ownerId)){if(this.isLocalClient(n)&&this.networkEnabled)return!0;if(!this.isLocalClient(n)){if(!n.allowTabSynchronization)throw new D(T.FAILED_PRECONDITION,K1);return!1}}return this.networkEnabled&&this.inForeground?!0:Hy(e).loadAll().next(s=>this.filterActiveClients(s,G1).find(o=>{if(this.clientId!==o.clientId){let l=!this.networkEnabled&&o.networkEnabled,c=!this.inForeground&&o.inForeground,d=this.networkEnabled===o.networkEnabled;if(l||c&&d)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&N(So,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return y(this,null,function*(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),yield this.simpleDb.runTransaction("shutdown","readwrite",[Fp,Ru],e=>{let i=new fp(e,qn.INVALID);return this.releasePrimaryLeaseIfHeld(i).next(()=>this.removeClientMetadata(i))}),this.simpleDb.close(),this.removeClientZombiedEntry()})}filterActiveClients(e,i){return e.filter(n=>this.isWithinAge(n.updateTimeMs,i)&&!this.isClientZombied(n.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",e=>Hy(e).loadAll().next(i=>this.filterActiveClients(i,W1).map(n=>n.clientId)))}get started(){return this._started}getMutationQueue(e,i){return _0.forUser(e,this.serializer,i,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new qk(e,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(e){return f0.forUser(this.serializer,e)}getBundleCache(){return this.bundleCache}runTransaction(e,i,n){N(So,"Starting transaction:",e);let r=i==="readonly"?"readonly":"readwrite",s=Uoe(this.schemaVersion),a;return this.simpleDb.runTransaction(e,r,s,o=>(a=new fp(o,this.listenSequence?this.listenSequence.next():qn.INVALID),i==="readwrite-primary"?this.verifyPrimaryLease(a).next(l=>l?!0:this.canActAsPrimary(a)).next(l=>{if(!l)throw Lt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new D(T.FAILED_PRECONDITION,Fq);return n(a)}).next(l=>this.acquireOrExtendPrimaryLease(a).next(()=>l)):this.verifyAllowTabSynchronization(a).next(()=>n(a)))).then(o=>(a.raiseOnCommittedEvent(),o))}verifyAllowTabSynchronization(e){return ip(e).get(mu).next(n=>{if(n!==null&&this.isWithinAge(n.leaseTimestampMs,G1)&&!this.isClientZombied(n.ownerId)&&!this.isLocalClient(n)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!n.allowTabSynchronization))throw new D(T.FAILED_PRECONDITION,K1)})}acquireOrExtendPrimaryLease(e){let i={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ip(e).put(mu,i)}static isAvailable(){return da.isAvailable()}releasePrimaryLeaseIfHeld(e){let i=ip(e);return i.get(mu).next(n=>this.isLocalClient(n)?(N(So,"Releasing primary lease."),i.delete(mu)):S.resolve())}isWithinAge(e,i){let n=Date.now(),r=n-i,s=n;return e<r?!1:e>s?(Lt(`Detected an update time that is in the future: ${e} > ${s}`),!1):!0}attachVisibilityHandler(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground=this.document.visibilityState==="visible")}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.windowUnloadHandler=()=>{this.markClientZombied();let i=/(?:Version|Mobile)\/1[456]/;Tw()&&(navigator.appVersion.match(i)||navigator.userAgent.match(i))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(e){var i;try{let n=((i=this.webStorage)===null||i===void 0?void 0:i.getItem(this.zombiedClientLocalStorageKey(e)))!==null;return N(So,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Lt(So,"Failed to get zombied client id.",n),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){Lt("Failed to set zombie client id.",e)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch{}}zombiedClientLocalStorageKey(e){return`${xue}_${this.persistenceKey}_${e}`}};function ip(t){return Mi(t,Fp)}function Hy(t){return Mi(t,Ru)}function pR(t,e){let i=t.projectId;return t.isDefaultDatabase||(i+="."+t.database),"firestore/"+e+"/"+i+"/"}function Tue(t){return y(this,null,function*(){if(!da.isAvailable())return Promise.resolve();let e=t+tH;yield da.delete(e)})}var gR="LocalStore",Iue=5*60*1e6,Dp=class{constructor(e,i,n,r){this.persistence=e,this.queryEngine=i,this.serializer=r,this.targetDataByTarget=new Dt(Re),this.targetIdByTarget=new Us(s=>rc(s),jp),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(n)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new v0(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",i=>e.collect(i,this.targetDataByTarget))}};function iH(t,e,i,n){return new Dp(t,e,i,n)}function nH(t,e){return y(this,null,function*(){let i=U(t);return yield i.persistence.runTransaction("Handle user change","readonly",r=>{let s;return i.mutationQueue.getAllMutationBatches(r).next(a=>(s=a,i.initializeUserComponents(e),i.mutationQueue.getAllMutationBatches(r))).next(a=>{let o=[],l=[],c=Oe();for(let d of s){o.push(d.batchId);for(let u of d.mutations)c=c.add(u.key)}for(let d of a){l.push(d.batchId);for(let u of d.mutations)c=c.add(u.key)}return i.localDocuments.getDocuments(r,c).next(d=>({affectedDocuments:d,removedBatchIds:o,addedBatchIds:l}))})})})}function Due(t,e){let i=U(t),n=Bt.now(),r=e.reduce((o,l)=>o.add(l.key),Oe()),s,a;return i.persistence.runTransaction("Locally write mutations","readwrite",o=>{let l=Dn(),c=Oe();return i.remoteDocuments.getEntries(o,r).next(d=>{l=d,l.forEach((u,h)=>{h.isValidDocument()||(c=c.add(u))})}).next(()=>i.localDocuments.getOverlayedDocuments(o,l)).next(d=>{s=d;let u=[];for(let h of e){let f=oce(h,s.get(h.key).overlayedDocument);f!=null&&u.push(new Gr(h.key,f,s5(f.value.mapValue),Ht.exists(!0)))}return i.mutationQueue.addMutationBatch(o,n,u,e)}).next(d=>{a=d;let u=d.applyToLocalDocumentSet(s,c);return i.documentOverlayCache.saveOverlays(o,d.batchId,u)})}).then(()=>({batchId:a.batchId,changes:v5(s)}))}function kue(t,e){let i=U(t);return i.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let r=e.batch.keys(),s=i.remoteDocuments.newChangeBuffer({trackRemovals:!0});return Vue(i,n,e,s).next(()=>s.apply(n)).next(()=>i.mutationQueue.performConsistencyCheck(n)).next(()=>i.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,Aue(e))).next(()=>i.localDocuments.getDocuments(n,r))})}function Aue(t){let e=Oe();for(let i=0;i<t.mutationResults.length;++i)t.mutationResults[i].transformResults.length>0&&(e=e.add(t.batch.mutations[i].key));return e}function Rue(t,e){let i=U(t);return i.persistence.runTransaction("Reject batch","readwrite-primary",n=>{let r;return i.mutationQueue.lookupMutationBatch(n,e).next(s=>(oe(s!==null),r=s.keys(),i.mutationQueue.removeMutationBatch(n,s))).next(()=>i.mutationQueue.performConsistencyCheck(n)).next(()=>i.documentOverlayCache.removeOverlaysForBatchId(n,r,e)).next(()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,r)).next(()=>i.localDocuments.getDocuments(n,r))})}function Mue(t){let e=U(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",i=>e.mutationQueue.getHighestUnacknowledgedBatchId(i))}function rH(t){let e=U(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",i=>e.targetCache.getLastRemoteSnapshotVersion(i))}function Oue(t,e){let i=U(t),n=e.snapshotVersion,r=i.targetDataByTarget;return i.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=i.remoteDocuments.newChangeBuffer({trackRemovals:!0});r=i.targetDataByTarget;let o=[];e.targetChanges.forEach((d,u)=>{let h=r.get(u);if(!h)return;o.push(i.targetCache.removeMatchingKeys(s,d.removedDocuments,u).next(()=>i.targetCache.addMatchingKeys(s,d.addedDocuments,u)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(u)!==null?f=f.withResumeToken(Ri.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):d.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(d.resumeToken,n)),r=r.insert(u,f),Nue(h,f,d)&&o.push(i.targetCache.updateTargetData(s,f))});let l=Dn(),c=Oe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(i.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(sH(s,a,e.documentUpdates).next(d=>{l=d.changedDocuments,c=d.existenceChangedKeys})),!n.isEqual(pe.min())){let d=i.targetCache.getLastRemoteSnapshotVersion(s).next(u=>i.targetCache.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(d)}return S.waitFor(o).next(()=>a.apply(s)).next(()=>i.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(i.targetDataByTarget=r,s))}function sH(t,e,i){let n=Oe(),r=Oe();return i.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=Dn();return i.forEach((o,l)=>{let c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(o)),l.isNoDocument()&&l.version.isEqual(pe.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):N(gR,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{changedDocuments:a,existenceChangedKeys:r}})}function Nue(t,e,i){return t.resumeToken.approximateByteSize()===0||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=Iue?!0:i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size>0}function Pue(t,e){return y(this,null,function*(){let i=U(t);try{yield i.persistence.runTransaction("notifyLocalViewChanges","readwrite",n=>S.forEach(e,r=>S.forEach(r.addedKeys,s=>i.persistence.referenceDelegate.addReference(n,r.targetId,s)).next(()=>S.forEach(r.removedKeys,s=>i.persistence.referenceDelegate.removeReference(n,r.targetId,s)))))}catch(n){if(zo(n))N(gR,"Failed to update sequence numbers: "+n);else throw n}for(let n of e){let r=n.targetId;if(!n.fromCache){let s=i.targetDataByTarget.get(r),a=s.snapshotVersion,o=s.withLastLimboFreeSnapshotVersion(a);i.targetDataByTarget=i.targetDataByTarget.insert(r,o)}}})}function Fue(t,e){let i=U(t);return i.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Do),i.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Lue(t,e){let i=U(t);return i.persistence.runTransaction("read document","readonly",n=>i.localDocuments.getDocument(n,e))}function ju(t,e){let i=U(t);return i.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return i.targetCache.getTargetData(n,e).next(s=>s?(r=s,S.resolve(r)):i.targetCache.allocateTargetId(n).next(a=>(r=new Bu(e,a,"TargetPurposeListen",n.currentSequenceNumber),i.targetCache.addTargetData(n,r).next(()=>r))))}).then(n=>{let r=i.targetDataByTarget.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(i.targetDataByTarget=i.targetDataByTarget.insert(n.targetId,n),i.targetIdByTarget.set(e,n.targetId)),n})}function Bue(t,e,i){let n=U(t),r=n.targetIdByTarget.get(i);return r!==void 0?S.resolve(n.targetDataByTarget.get(r)):n.targetCache.getTargetData(e,i)}function zu(t,e,i){return y(this,null,function*(){let n=U(t),r=n.targetDataByTarget.get(e),s=i?"readwrite":"readwrite-primary";try{i||(yield n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,r)))}catch(a){if(zo(a))N(gR,`Failed to update sequence numbers for target ${e}: ${a}`);else throw a}n.targetDataByTarget=n.targetDataByTarget.remove(e),n.targetIdByTarget.delete(r.target)})}function Z0(t,e,i){let n=U(t),r=pe.min(),s=Oe();return n.persistence.runTransaction("Execute query","readwrite",a=>Bue(n,a,_n(e)).next(o=>{if(o)return r=o.lastLimboFreeSnapshotVersion,n.targetCache.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.queryEngine.getDocumentsMatchingQuery(a,e,i?r:pe.min(),i?s:Oe())).next(o=>(lH(n,g5(e),o),{documents:o,remoteKeys:s})))}function Vue(t,e,i,n){let r=i.batch,s=r.keys(),a=S.resolve();return s.forEach(o=>{a=a.next(()=>n.getEntry(e,o)).next(l=>{let c=i.docVersions.get(o);oe(c!==null),l.version.compareTo(c)<0&&(r.applyToRemoteDocument(l,i),l.isValidDocument()&&(l.setReadTime(i.commitVersion),n.addEntry(l)))})}),a.next(()=>t.mutationQueue.removeMutationBatch(e,r))}function jue(t,e){let i=U(t),n=U(i.mutationQueue);return i.persistence.runTransaction("Lookup mutation documents","readonly",r=>n.lookupMutationKeys(r,e).next(s=>s?i.localDocuments.getDocuments(r,s):S.resolve(null)))}function zue(t,e){U(U(t,Dp).mutationQueue).removeCachedMutationKeys(e)}function Uue(t){return U(U(t,Dp).persistence).getActiveClients()}function aH(t,e){let i=U(t),n=U(i.targetCache),r=i.targetDataByTarget.get(e);return r?Promise.resolve(r.target):i.persistence.runTransaction("Get target data","readonly",s=>n.getTargetDataForTarget(s,e).next(a=>a?a.target:null))}function oH(t,e){let i=U(t),n=i.collectionGroupReadTime.get(e)||pe.min();return i.persistence.runTransaction("Get new document changes","readonly",r=>i.remoteDocuments.getAllFromCollectionGroup(r,e,Nq(n,Au),Number.MAX_SAFE_INTEGER)).then(r=>(lH(i,e,r),r))}function lH(t,e,i){let n=t.collectionGroupReadTime.get(e)||pe.min();i.forEach((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.collectionGroupReadTime.set(e,n)}function que(t){return _n(Xu(Qe.fromString(`__bundle__/docs/${t}`)))}function Hue(t,e,i,n){return y(this,null,function*(){let r=U(t),s=Oe(),a=Dn();for(let c of i){let d=e.toDocumentKey(c.metadata.name);c.document&&(s=s.add(d));let u=e.toMutableDocument(c);u.setReadTime(e.toSnapshotVersion(c.metadata.readTime)),a=a.insert(d,u)}let o=r.remoteDocuments.newChangeBuffer({trackRemovals:!0}),l=yield ju(r,que(n));return r.persistence.runTransaction("Apply bundle documents","readwrite",c=>sH(c,o,a).next(d=>(o.apply(c),d)).next(d=>r.targetCache.removeMatchingKeysForTargetId(c,l.targetId).next(()=>r.targetCache.addMatchingKeys(c,s,l.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(c,d.changedDocuments,d.existenceChangedKeys)).next(()=>d.changedDocuments)))})}function Wue(t,e){let i=U(t),n=Jt(e.createTime);return i.persistence.runTransaction("hasNewerBundle","readonly",r=>i.bundleCache.getBundleMetadata(r,e.id)).then(r=>!!r&&r.createTime.compareTo(n)>=0)}function Gue(t,e){let i=U(t);return i.persistence.runTransaction("Save bundle","readwrite",n=>i.bundleCache.saveBundleMetadata(n,e))}function Kue(t,e){let i=U(t);return i.persistence.runTransaction("Get named query","readonly",n=>i.bundleCache.getNamedQuery(n,e))}function $ue(n,r){return y(this,arguments,function*(t,e,i=Oe()){let s=yield ju(t,_n(uR(e.bundledQuery))),a=U(t);return a.persistence.runTransaction("Save named query","readwrite",o=>{let l=Jt(e.readTime);if(s.snapshotVersion.compareTo(l)>=0)return a.bundleCache.saveNamedQuery(o,e);let c=s.withResumeToken(Ri.EMPTY_BYTE_STRING,l);return a.targetDataByTarget=a.targetDataByTarget.insert(c.targetId,c),a.targetCache.updateTargetData(o,c).next(()=>a.targetCache.removeMatchingKeysForTargetId(o,s.targetId)).next(()=>a.targetCache.addMatchingKeys(o,i,s.targetId)).next(()=>a.bundleCache.saveNamedQuery(o,e))})})}var oA=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Yue=100;function Que(){return Tw()?8:da.getAndroidVersion(_h())>0?6:4}var C0=class{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=Yue,this.relativeIndexReadCostPerDocument=Que()}initialize(e,i){this.localDocumentsView=e,this.indexManager=i,this.initialized=!0}getDocumentsMatchingQuery(e,i,n,r){let s={result:null};return this.performQueryUsingIndex(e,i).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.performQueryUsingRemoteKeys(e,i,r,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new oA;return this.executeFullCollectionScan(e,i,a).next(o=>{if(s.result=o,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,i,a,o.size)})}).next(()=>s.result)}createCacheIndexes(e,i,n,r){return n.documentReadCount<this.indexAutoCreationMinCollectionSize?(wu()<=Qn.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",Cu(i),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),S.resolve()):(wu()<=Qn.DEBUG&&N("QueryEngine","Query:",Cu(i),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.relativeIndexReadCostPerDocument*r?(wu()<=Qn.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",Cu(i),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_n(i))):S.resolve())}performQueryUsingIndex(e,i){if(NU(i))return S.resolve(null);let n=_n(i);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(i.limit!==null&&r===1&&(i=l0(i,null,"F"),n=_n(i)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{let a=Oe(...s);return this.localDocumentsView.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{let c=this.applyQuery(i,o);return this.needsRefill(i,c,a,l.readTime)?this.performQueryUsingIndex(e,l0(i,null,"F")):this.appendRemainingResults(e,c,i,l)}))})))}performQueryUsingRemoteKeys(e,i,n,r){return NU(i)||r.isEqual(pe.min())?S.resolve(null):this.localDocumentsView.getDocuments(e,n).next(s=>{let a=this.applyQuery(i,s);return this.needsRefill(i,a,n,r)?S.resolve(null):(wu()<=Qn.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Cu(i)),this.appendRemainingResults(e,a,i,Nq(r,Au)).next(o=>o))})}applyQuery(e,i){let n=new bt(_5(e));return i.forEach((r,s)=>{Up(e,s)&&(n=n.add(s))}),n}needsRefill(e,i,n,r){if(e.limit===null)return!1;if(n.size!==i.size)return!0;let s=e.limitType==="F"?i.last():i.first();return s?s.hasPendingWrites||s.version.compareTo(r)>0:!1}executeFullCollectionScan(e,i,n){return wu()<=Qn.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",Cu(i)),this.localDocumentsView.getDocumentsMatchingQuery(e,i,Cr.min(),n)}appendRemainingResults(e,i,n,r){return this.localDocumentsView.getDocumentsMatchingQuery(e,n,r).next(s=>(i.forEach(a=>{s=s.insert(a.key,a)}),s))}};var cH="firestore_clients";function mq(t,e){return`${cH}_${t}_${e}`}var dH="firestore_mutations";function pq(t,e,i){let n=`${dH}_${t}_${i}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}var uH="firestore_targets";function $1(t,e){return`${uH}_${t}_${e}`}var Xue="firestore_online_state";function Zue(t){return`${Xue}_${t}`}var Jue="firestore_bundle_loaded_v2";function ehe(t){return`${Jue}_${t}`}var the="firestore_sequence_number";function ihe(t){return`${the}_${t}`}var Fs="SharedClientState",E0=class t{constructor(e,i,n,r){this.user=e,this.batchId=i,this.state=n,this.error=r}static fromWebStorageEntry(e,i,n){let r=JSON.parse(n),s=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object"),a;return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(a=new D(r.error.code,r.error.message))),s?new t(e,i,r.state,a):(Lt(Fs,`Failed to parse mutation state for ID '${i}': ${n}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},cp=class t{constructor(e,i,n){this.targetId=e,this.state=i,this.error=n}static fromWebStorageEntry(e,i){let n=JSON.parse(i),r=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object"),s;return r&&n.error&&(r=typeof n.error.message=="string"&&typeof n.error.code=="string",r&&(s=new D(n.error.code,n.error.message))),r?new t(e,n.state,s):(Lt(Fs,`Failed to parse target state for ID '${e}': ${i}`),null)}toWebStorageJSON(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},S0=class t{constructor(e,i){this.clientId=e,this.activeTargetIds=i}static fromWebStorageEntry(e,i){let n=JSON.parse(i),r=typeof n=="object"&&n.activeTargetIds instanceof Array,s=cR();for(let a=0;r&&a<n.activeTargetIds.length;++a)r=i5(n.activeTargetIds[a]),s=s.add(n.activeTargetIds[a]);return r?new t(e,s):(Lt(Fs,`Failed to parse client data for instance '${e}': ${i}`),null)}},lA=class t{constructor(e,i){this.clientId=e,this.onlineState=i}static fromWebStorageEntry(e){let i=JSON.parse(e);return typeof i=="object"&&["Unknown","Online","Offline"].indexOf(i.onlineState)!==-1&&typeof i.clientId=="string"?new t(i.clientId,i.onlineState):(Lt(Fs,`Failed to parse online state: ${e}`),null)}},kp=class{constructor(){this.activeTargetIds=cR()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},dp=class{constructor(e,i,n,r,s){this.window=e,this.queue=i,this.persistenceKey=n,this.localClientId=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new Dt(Re),this.started=!1,this.earlyEvents=[];let a=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.localClientStorageKey=mq(this.persistenceKey,this.localClientId),this.sequenceNumberKey=ihe(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new kp),this.clientStateKeyRe=new RegExp(`^${cH}_${a}_([^_]*)$`),this.mutationBatchKeyRe=new RegExp(`^${dH}_${a}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=new RegExp(`^${uH}_${a}_(\\d+)$`),this.onlineStateKey=Zue(this.persistenceKey),this.bundleLoadedKey=ehe(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(e){return!!(e&&e.localStorage)}start(){return y(this,null,function*(){let e=yield this.syncEngine.getActiveClients();for(let n of e){if(n===this.localClientId)continue;let r=this.getItem(mq(this.persistenceKey,n));if(r){let s=S0.fromWebStorageEntry(n,r);s&&(this.activeClients=this.activeClients.insert(s.clientId,s))}}this.persistClientState();let i=this.storage.getItem(this.onlineStateKey);if(i){let n=this.fromWebStorageOnlineState(i);n&&this.handleOnlineStateEvent(n)}for(let n of this.earlyEvents)this.handleWebStorageEvent(n);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(e){let i=!1;return this.activeClients.forEach((n,r)=>{r.activeTargetIds.has(e)&&(i=!0)}),i}addPendingMutation(e){this.persistMutationState(e,"pending")}updateMutationState(e,i,n){this.persistMutationState(e,i,n),this.removeMutationState(e)}addLocalQueryTarget(e){let i="not-current";if(this.isActiveQueryTarget(e)){let n=this.storage.getItem($1(this.persistenceKey,e));if(n){let r=cp.fromWebStorageEntry(e,n);r&&(i=r.state)}}return this.localClientState.addQueryTarget(e),this.persistClientState(),i}removeLocalQueryTarget(e){this.localClientState.removeQueryTarget(e),this.persistClientState()}isLocalQueryTarget(e){return this.localClientState.activeTargetIds.has(e)}clearQueryState(e){this.removeItem($1(this.persistenceKey,e))}updateQueryState(e,i,n){this.persistQueryTargetState(e,i,n)}handleUserChange(e,i,n){i.forEach(r=>{this.removeMutationState(r)}),this.currentUser=e,n.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.persistOnlineState(e)}notifyBundleLoaded(e){this.persistBundleLoadedState(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(e){let i=this.storage.getItem(e);return N(Fs,"READ",e,i),i}setItem(e,i){N(Fs,"SET",e,i),this.storage.setItem(e,i)}removeItem(e){N(Fs,"REMOVE",e),this.storage.removeItem(e)}handleWebStorageEvent(e){let i=e;if(i.storageArea===this.storage){if(N(Fs,"EVENT",i.key,i.newValue),i.key===this.localClientStorageKey){Lt("Received WebStorage notification for local change. Another client might have garbage-collected our state");return}this.queue.enqueueRetryable(()=>y(this,null,function*(){if(!this.started){this.earlyEvents.push(i);return}if(i.key!==null){if(this.clientStateKeyRe.test(i.key))if(i.newValue!=null){let n=this.fromWebStorageClientState(i.key,i.newValue);if(n)return this.handleClientStateEvent(n.clientId,n)}else{let n=this.fromWebStorageClientStateKey(i.key);return this.handleClientStateEvent(n,null)}else if(this.mutationBatchKeyRe.test(i.key)){if(i.newValue!==null){let n=this.fromWebStorageMutationMetadata(i.key,i.newValue);if(n)return this.handleMutationBatchEvent(n)}}else if(this.queryTargetKeyRe.test(i.key)){if(i.newValue!==null){let n=this.fromWebStorageQueryTargetMetadata(i.key,i.newValue);if(n)return this.handleQueryTargetEvent(n)}}else if(i.key===this.onlineStateKey){if(i.newValue!==null){let n=this.fromWebStorageOnlineState(i.newValue);if(n)return this.handleOnlineStateEvent(n)}}else if(i.key===this.sequenceNumberKey){let n=nhe(i.newValue);n!==qn.INVALID&&this.sequenceNumberHandler(n)}else if(i.key===this.bundleLoadedKey){let n=this.fromWebStoreBundleLoadedState(i.newValue);yield Promise.all(n.map(r=>this.syncEngine.synchronizeWithChangedDocuments(r)))}}}))}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(e,i,n){let r=new E0(this.currentUser,e,i,n),s=pq(this.persistenceKey,this.currentUser,e);this.setItem(s,r.toWebStorageJSON())}removeMutationState(e){let i=pq(this.persistenceKey,this.currentUser,e);this.removeItem(i)}persistOnlineState(e){let i={clientId:this.localClientId,onlineState:e};this.storage.setItem(this.onlineStateKey,JSON.stringify(i))}persistQueryTargetState(e,i,n){let r=$1(this.persistenceKey,e),s=new cp(e,i,n);this.setItem(r,s.toWebStorageJSON())}persistBundleLoadedState(e){let i=JSON.stringify(Array.from(e));this.setItem(this.bundleLoadedKey,i)}fromWebStorageClientStateKey(e){let i=this.clientStateKeyRe.exec(e);return i?i[1]:null}fromWebStorageClientState(e,i){let n=this.fromWebStorageClientStateKey(e);return S0.fromWebStorageEntry(n,i)}fromWebStorageMutationMetadata(e,i){let n=this.mutationBatchKeyRe.exec(e),r=Number(n[1]),s=n[2]!==void 0?n[2]:null;return E0.fromWebStorageEntry(new ui(s),r,i)}fromWebStorageQueryTargetMetadata(e,i){let n=this.queryTargetKeyRe.exec(e),r=Number(n[1]);return cp.fromWebStorageEntry(r,i)}fromWebStorageOnlineState(e){return lA.fromWebStorageEntry(e)}fromWebStoreBundleLoadedState(e){return JSON.parse(e)}handleMutationBatchEvent(e){return y(this,null,function*(){if(e.user.uid!==this.currentUser.uid){N(Fs,`Ignoring mutation for non-active user ${e.user.uid}`);return}return this.syncEngine.applyBatchState(e.batchId,e.state,e.error)})}handleQueryTargetEvent(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)}handleClientStateEvent(e,i){let n=i?this.activeClients.insert(e,i):this.activeClients.remove(e),r=this.extractActiveQueryTargets(this.activeClients),s=this.extractActiveQueryTargets(n),a=[],o=[];return s.forEach(l=>{r.has(l)||a.push(l)}),r.forEach(l=>{s.has(l)||o.push(l)}),this.syncEngine.applyActiveTargetsChange(a,o).then(()=>{this.activeClients=n})}handleOnlineStateEvent(e){this.activeClients.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}extractActiveQueryTargets(e){let i=cR();return e.forEach((n,r)=>{i=i.unionWith(r.activeTargetIds)}),i}};function nhe(t){let e=qn.INVALID;if(t!=null)try{let i=JSON.parse(t);oe(typeof i=="number"),e=i}catch(i){Lt(Fs,"Failed to read sequence number from WebStorage",i)}return e}var x0=class{constructor(){this.localState=new kp,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,i,n){}addLocalQueryTarget(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,i,n){this.queryState[e]=i}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new kp,Promise.resolve()}handleUserChange(e,i,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var cA=class{addCallback(e){}shutdown(){}};var dA=class{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}};var Wy=null;function rhe(){return 268435456+Math.round(2147483648*Math.random())}function Y1(){return Wy===null?Wy=rhe():Wy++,"0x"+Wy.toString(16)}function she(t){return new Promise((e,i)=>{t((n,r)=>{n?i(n):e(r)})})}var ahe="1.9.1",pn="GrpcConnection",ohe=`gl-node/${process.versions.node} fire/${Ku} grpc/${ahe}`;function Q1(t,e,i,n){oe(e===null||e.type==="OAuth");let r=new Zl.Metadata;return e&&e.headers.forEach((s,a)=>r.set(a,s)),i&&i.headers.forEach((s,a)=>r.set(a,s)),n&&r.set("X-Firebase-GMPID",n),r.set("X-Goog-Api-Client",ohe),r.set("Google-Cloud-Resource-Prefix",t),r.set("x-goog-request-params",t),r}var uA=class{constructor(e,i){this.databaseInfo=i,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${i.databaseId.projectId}/databases/${i.databaseId.database}`}get shouldResourcePathBeIncludedInRequest(){return!0}ensureActiveStub(){if(!this.cachedStub){N(pn,"Creating Firestore stub.");let e=this.databaseInfo.ssl?Zl.credentials.createSsl():Zl.credentials.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,i,n,r,s){let a=Y1(),o=this.ensureActiveStub(),l=Q1(this.databasePath,r,s,this.databaseInfo.appId),c=Object.assign({database:this.databasePath},n);return she(d=>(N(pn,`RPC '${e}' ${a} invoked with request:`,n),o[e](c,l,(u,h)=>{u?(N(pn,`RPC '${e}' ${a} failed with error:`,u),d(new D(Qy(u.code),u.message))):(N(pn,`RPC '${e}' ${a} completed with response:`,h),d(void 0,h))})))}invokeStreamingRPC(e,i,n,r,s,a){let o=Y1(),l=[],c=new Zt;N(pn,`RPC '${e}' ${o} invoked (streaming) with request:`,n);let d=this.ensureActiveStub(),u=Q1(this.databasePath,r,s,this.databaseInfo.appId),h=Object.assign(Object.assign({},n),{database:this.databasePath}),f=d[e](h,u),p=!1;return f.on("data",v=>{N(pn,`RPC ${e} ${o} received result:`,v),l.push(v),a!==void 0&&l.length===a&&(p=!0,c.resolve(l))}),f.on("end",()=>{N(pn,`RPC '${e}' ${o} completed.`),p||(p=!0,c.resolve(l))}),f.on("error",v=>{N(pn,`RPC '${e}' ${o} failed with error:`,v);let E=Qy(v.code);c.reject(new D(E,v.message))}),c.promise}openStream(e,i,n){let r=Y1(),s=this.ensureActiveStub(),a=Q1(this.databasePath,i,n,this.databaseInfo.appId),o=s[e](a),l=!1,c=u=>{l||(l=!0,d.callOnClose(u),o.end())},d=new dA({sendFn:u=>{if(l)N(pn,`RPC '${e}' stream ${r} not sending because gRPC stream is closed:`,u);else{N(pn,`RPC '${e}' stream ${r} sending:`,u);try{o.write(u)}catch(h){throw Lt("Failure sending:",u),Lt("Error:",h),h}}},closeFn:()=>{N(pn,`RPC '${e}' stream ${r} closed locally via close().`),c()}});return o.on("data",u=>{l||(N(pn,`RPC '${e}' stream ${r} received:`,u),d.callOnMessage(u))}),o.on("end",()=>{N(pn,`RPC '${e}' stream ${r} ended.`),c()}),o.on("error",u=>{if(!l){wr(pn,`RPC '${e}' stream ${r} error. Code:`,u.code,"Message:",u.message);let h=Qy(u.code);c(new D(h,u.message))}}),N(pn,`Opening RPC '${e}' stream ${r} to ${this.databaseInfo.host}`),setTimeout(()=>{d.callOnOpen()},0),d}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}},hH={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}},lhe={nested:hH},che=Object.freeze({__proto__:null,nested:hH,default:lhe});var dhe={longs:String,enums:String,defaults:!0,oneofs:!1};function uhe(){let t=Aq.fromJSON(che,dhe);return Zl.loadPackageDefinition(t)}function hhe(t){let e=uhe();return new uA(e,t)}function fhe(){return new cA}function fH(){return process.env.USE_MOCK_PERSISTENCE==="YES"?window:null}function mhe(){return null}function Hp(t){return new Mk(t,!1)}var phe="ExponentialBackoff",ghe=1e3,_he=1.5,bhe=60*1e3,Ap=class{constructor(e,i,n=ghe,r=_he,s=bhe){this.queue=e,this.timerId=i,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=s,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let i=Math.floor(this.currentBaseMs+this.jitterDelayMs()),n=Math.max(0,Date.now()-this.lastAttemptTime),r=Math.max(0,i-n);r>0&&N(phe,`Backing off for ${r} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${i} ms, last attempt: ${n} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,r,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){this.timerPromise!==null&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){this.timerPromise!==null&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}};var gq="PersistentStream",vhe=60*1e3,yhe=10*1e3,T0=class{constructor(e,i,n,r,s,a,o,l){this.queue=e,this.idleTimerId=n,this.healthTimerId=r,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.backoff=new Ap(e,i)}isStarted(){return this.state===1||this.state===5||this.isOpen()}isOpen(){return this.state===2||this.state===3}start(){if(this.state===4){this.performBackoff();return}this.auth()}stop(){return y(this,null,function*(){this.isStarted()&&(yield this.close(0))})}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&this.idleTimer===null&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,vhe,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}handleIdleCloseTimer(){return y(this,null,function*(){if(this.isOpen())return this.close(0)})}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}close(e,i){return y(this,null,function*(){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,e!==4?this.backoff.reset():i&&i.code===T.RESOURCE_EXHAUSTED?(Lt(i.toString()),Lt("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):i&&i.code===T.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.onClose(i)})}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),i=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.closeCount===i&&this.startStream(n,r)},n=>{e(()=>{let r=new D(T.UNKNOWN,"Fetching auth token failed: "+n.message);return this.handleStreamClose(r)})})}startStream(e,i){let n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,i),this.stream.onOpen(()=>{n(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,yhe,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(r=>{n(()=>this.handleStreamClose(r))}),this.stream.onMessage(r=>{n(()=>this.onMessage(r))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(()=>y(this,null,function*(){this.state=0,this.start()}))}handleStreamClose(e){return N(gq,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return i=>{this.queue.enqueueAndForget(()=>this.closeCount===e?i():(N(gq,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},hA=class extends T0{constructor(e,i,n,r,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,n,r,a),this.serializer=s}startRpc(e,i){return this.connection.openStream("Listen",e,i)}onMessage(e){this.backoff.reset();let i=Mce(this.serializer,e),n=Nce(e);return this.listener.onWatchChange(i,n)}watch(e){let i={};i.database=Pk(this.serializer),i.addTarget=Wce(this.serializer,e);let n=qce(this.serializer,e);n&&(i.labels=n),this.sendRequest(i)}unwatch(e){let i={};i.database=Pk(this.serializer),i.removeTarget=e,this.sendRequest(i)}},fA=class extends T0{constructor(e,i,n,r,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,n,r,a),this.serializer=s,this.handshakeComplete_=!1}get handshakeComplete(){return this.handshakeComplete_}start(){this.handshakeComplete_=!1,this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete_&&this.writeMutations([])}startRpc(e,i){return this.connection.openStream("Write",e,i)}onMessage(e){if(oe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();let i=Bce(e.writeResults,e.commitTime),n=Jt(e.commitTime);return this.listener.onMutationResult(n,i)}else return oe(!e.writeResults||e.writeResults.length===0),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()}writeHandshake(){let e={};e.database=Pk(this.serializer),this.sendRequest(e)}writeMutations(e){let i={streamToken:this.lastStreamToken,writes:e.map(n=>xp(this.serializer,n))};this.sendRequest(i)}};var mA=class{},pA=class extends mA{constructor(e,i,n,r){super(),this.authCredentials=e,this.appCheckCredentials=i,this.connection=n,this.serializer=r,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new D(T.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,i,n,r){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.invokeRPC(e,Nk(i,n),r,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===T.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(T.UNKNOWN,s.toString())})}invokeStreamingRPC(e,i,n,r,s){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.invokeStreamingRPC(e,Nk(i,n),r,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===T.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new D(T.UNKNOWN,a.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}};function whe(t,e,i,n){return new pA(t,e,i,n)}function Che(t,e){return y(this,null,function*(){let i=U(t),n={writes:e.map(r=>xp(i.serializer,r))};yield i.invokeRPC("Commit",i.serializer.databaseId,Qe.emptyPath(),n)})}function Ehe(t,e){return y(this,null,function*(){let i=U(t),n={documents:e.map(o=>Sp(i.serializer,o))},r=yield i.invokeStreamingRPC("BatchGetDocuments",i.serializer.databaseId,Qe.emptyPath(),n,e.length),s=new Map;r.forEach(o=>{let l=Rce(i.serializer,o);s.set(l.key.toString(),l)});let a=[];return e.forEach(o=>{let l=s.get(o.toString());oe(!!l),a.push(l)}),a})}function She(t,e,i){let n=U(t);return n.verifyInitialized(),new fA(e,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,i)}function xhe(t,e,i){let n=U(t);return n.verifyInitialized(),new hA(e,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,i)}var The="OnlineStateTracker",_q=1,bq=10*1e3,gA=class{constructor(e,i){this.asyncQueue=e,this.onlineStateHandler=i,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){this.watchStreamFailures===0&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",bq,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${bq/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){this.state==="Online"?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=_q&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${_q} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e==="Online"&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let i=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(Lt(i),this.shouldWarnClientIsOffline=!1):N(The,i)}clearOnlineStateTimer(){this.onlineStateTimer!==null&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}};var lc="RemoteStore",Ihe=10,_A=class{constructor(e,i,n,r,s){this.localStore=e,this.datastore=i,this.asyncQueue=n,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=s,this.connectivityMonitor.addCallback(a=>{n.enqueueAndForget(()=>y(this,null,function*(){Uo(this)&&(N(lc,"Restarting streams for network reachability change."),yield Hhe(this))}))}),this.onlineStateTracker=new gA(n,r)}};function Dhe(t,e,i,n,r){return new _A(t,e,i,n,r)}function khe(t){let e=U(t);return e.offlineCauses.delete(0),Wp(e)}function Wp(t){return y(this,null,function*(){if(Uo(t))for(let e of t.onNetworkStatusChange)yield e(!0)})}function Ahe(t){return y(this,null,function*(){let e=U(t);e.offlineCauses.add(0),yield Zu(e),e.onlineStateTracker.set("Offline")})}function Zu(t){return y(this,null,function*(){for(let e of t.onNetworkStatusChange)yield e(!1)})}function Rhe(t){return y(this,null,function*(){let e=U(t);N(lc,"RemoteStore shutting down."),e.offlineCauses.add(5),yield Zu(e),e.connectivityMonitor.shutdown(),e.onlineStateTracker.set("Unknown")})}function J0(t,e){let i=U(t);i.listenTargets.has(e.targetId)||(i.listenTargets.set(e.targetId,e),vR(i)?bR(i):th(i).isOpen()&&_R(i,e))}function Ju(t,e){let i=U(t),n=th(i);i.listenTargets.delete(e),n.isOpen()&&mH(i,e),i.listenTargets.size===0&&(n.isOpen()?n.markIdle():Uo(i)&&i.onlineStateTracker.set("Unknown"))}function _R(t,e){if(t.watchChangeAggregator.recordPendingTargetRequest(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){let i=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(i)}th(t).watch(e)}function mH(t,e){t.watchChangeAggregator.recordPendingTargetRequest(e),th(t).unwatch(e)}function bR(t){t.watchChangeAggregator=new Rk({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),getTargetDataForTarget:e=>t.listenTargets.get(e)||null,getDatabaseId:()=>t.datastore.serializer.databaseId}),th(t).start(),t.onlineStateTracker.handleWatchStreamStart()}function vR(t){return Uo(t)&&!th(t).isStarted()&&t.listenTargets.size>0}function Uo(t){return U(t).offlineCauses.size===0}function pH(t){t.watchChangeAggregator=void 0}function Mhe(t){return y(this,null,function*(){t.listenTargets.forEach((e,i)=>{_R(t,e)})})}function Ohe(t,e){return y(this,null,function*(){pH(t),vR(t)?(t.onlineStateTracker.handleWatchStreamFailure(e),bR(t)):t.onlineStateTracker.set("Unknown")})}function Nhe(t,e,i){return y(this,null,function*(){if(t.onlineStateTracker.set("Online"),e instanceof d0&&e.state===2&&e.cause){try{yield Fhe(t,e)}catch(n){N(lc,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield I0(t,n)}return}if(e instanceof ku?t.watchChangeAggregator.handleDocumentChange(e):e instanceof c0?t.watchChangeAggregator.handleExistenceFilter(e):t.watchChangeAggregator.handleTargetChange(e),!i.isEqual(pe.min()))try{let n=yield rH(t.localStore);i.compareTo(n)>=0&&(yield Phe(t,i))}catch(n){N(lc,"Failed to raise snapshot:",n),yield I0(t,n)}})}function I0(t,e,i){return y(this,null,function*(){if(zo(e))t.offlineCauses.add(1),yield Zu(t),t.onlineStateTracker.set("Offline"),i||(i=()=>rH(t.localStore)),t.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){N(lc,"Retrying IndexedDB access"),yield i(),t.offlineCauses.delete(1),yield Wp(t)}));else throw e})}function gH(t,e){return e().catch(i=>I0(t,i,e))}function Phe(t,e){let i=t.watchChangeAggregator.createRemoteEvent(e);return i.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){let s=t.listenTargets.get(r);s&&t.listenTargets.set(r,s.withResumeToken(n.resumeToken,e))}}),i.targetMismatches.forEach((n,r)=>{let s=t.listenTargets.get(n);if(!s)return;t.listenTargets.set(n,s.withResumeToken(Ri.EMPTY_BYTE_STRING,s.snapshotVersion)),mH(t,n);let a=new Bu(s.target,n,r,s.sequenceNumber);_R(t,a)}),t.remoteSyncer.applyRemoteEvent(i)}function Fhe(t,e){return y(this,null,function*(){let i=e.cause;for(let n of e.targetIds)t.listenTargets.has(n)&&(yield t.remoteSyncer.rejectListen(n,i),t.listenTargets.delete(n),t.watchChangeAggregator.removeTarget(n))})}function eh(t){return y(this,null,function*(){let e=U(t),i=qo(e),n=e.writePipeline.length>0?e.writePipeline[e.writePipeline.length-1].batchId:Do;for(;Lhe(e);)try{let r=yield Fue(e.localStore,n);if(r===null){e.writePipeline.length===0&&i.markIdle();break}else n=r.batchId,Bhe(e,r)}catch(r){yield I0(e,r)}_H(e)&&bH(e)})}function Lhe(t){return Uo(t)&&t.writePipeline.length<Ihe}function Bhe(t,e){t.writePipeline.push(e);let i=qo(t);i.isOpen()&&i.handshakeComplete&&i.writeMutations(e.mutations)}function _H(t){return Uo(t)&&!qo(t).isStarted()&&t.writePipeline.length>0}function bH(t){qo(t).start()}function Vhe(t){return y(this,null,function*(){qo(t).writeHandshake()})}function jhe(t){return y(this,null,function*(){let e=qo(t);for(let i of t.writePipeline)e.writeMutations(i.mutations)})}function zhe(t,e,i){return y(this,null,function*(){let n=t.writePipeline.shift(),r=Ik.from(n,e,i);yield gH(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),yield eh(t)})}function Uhe(t,e){return y(this,null,function*(){e&&qo(t).handshakeComplete&&(yield qhe(t,e)),_H(t)&&bH(t)})}function qhe(t,e){return y(this,null,function*(){if(mce(e.code)){let i=t.writePipeline.shift();qo(t).inhibitBackoff(),yield gH(t,()=>t.remoteSyncer.rejectFailedWrite(i.batchId,e)),yield eh(t)}})}function Hhe(t){return y(this,null,function*(){let e=U(t);e.offlineCauses.add(4),yield Zu(e),e.onlineStateTracker.set("Unknown"),e.offlineCauses.delete(4),yield Wp(e)})}function vq(t,e){return y(this,null,function*(){let i=U(t);i.asyncQueue.verifyOperationInProgress(),N(lc,"RemoteStore received new credentials");let n=Uo(i);i.offlineCauses.add(3),yield Zu(i),n&&i.onlineStateTracker.set("Unknown"),yield i.remoteSyncer.handleCredentialChange(e),i.offlineCauses.delete(3),yield Wp(i)})}function bA(t,e){return y(this,null,function*(){let i=U(t);e?(i.offlineCauses.delete(2),yield Wp(i)):e||(i.offlineCauses.add(2),yield Zu(i),i.onlineStateTracker.set("Unknown"))})}function th(t){return t.watchStream||(t.watchStream=xhe(t.datastore,t.asyncQueue,{onOpen:Mhe.bind(null,t),onClose:Ohe.bind(null,t),onWatchChange:Nhe.bind(null,t)}),t.onNetworkStatusChange.push(e=>y(this,null,function*(){e?(t.watchStream.inhibitBackoff(),vR(t)?bR(t):t.onlineStateTracker.set("Unknown")):(yield t.watchStream.stop(),pH(t))}))),t.watchStream}function qo(t){return t.writeStream||(t.writeStream=She(t.datastore,t.asyncQueue,{onOpen:Vhe.bind(null,t),onClose:Uhe.bind(null,t),onHandshakeComplete:jhe.bind(null,t),onMutationResult:zhe.bind(null,t)}),t.onNetworkStatusChange.push(e=>y(this,null,function*(){e?(t.writeStream.inhibitBackoff(),yield eh(t)):(yield t.writeStream.stop(),t.writePipeline.length>0&&(N(lc,`Stopping write stream with ${t.writePipeline.length} pending writes`),t.writePipeline=[]))}))),t.writeStream}var Whe="AsyncQueue",vA=class t{constructor(e,i,n,r,s){this.asyncQueue=e,this.timerId=i,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new Zt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,i,n,r,s){let a=Date.now()+n,o=new t(e,i,a,r,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(T.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ih(t,e){if(Lt(Whe,`${e}: ${t}`),zo(t))return new D(T.UNAVAILABLE,`${e}: ${t}`);throw t}var D0=class t{constructor(e){e?this.comparator=(i,n)=>e(i,n)||z.comparator(i.key,n.key):this.comparator=(i,n)=>z.comparator(i.key,n.key),this.keyedMap=np(),this.sortedSet=new Dt(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let i=this.keyedMap.get(e);return i?this.sortedSet.indexOf(i):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((i,n)=>(e(i),!1))}add(e){let i=this.delete(e.key);return i.copy(i.keyedMap.insert(e.key,e),i.sortedSet.insert(e,null))}delete(e){let i=this.get(e);return i?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(i)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let i=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;i.hasNext();){let r=i.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(i=>{e.push(i.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,i){let n=new t;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=i,n}};var k0=class{constructor(){this.changeMap=new Dt(z.comparator)}track(e){let i=e.doc.key,n=this.changeMap.get(i);if(!n){this.changeMap=this.changeMap.insert(i,e);return}e.type!==0&&n.type===3?this.changeMap=this.changeMap.insert(i,e):e.type===3&&n.type!==1?this.changeMap=this.changeMap.insert(i,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.changeMap=this.changeMap.insert(i,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.changeMap=this.changeMap.insert(i,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.changeMap=this.changeMap.remove(i):e.type===1&&n.type===2?this.changeMap=this.changeMap.insert(i,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.changeMap=this.changeMap.insert(i,{type:2,doc:e.doc}):Y()}getChanges(){let e=[];return this.changeMap.inorderTraversal((i,n)=>{e.push(n)}),e}},Uu=class t{constructor(e,i,n,r,s,a,o,l,c){this.query=e,this.docs=i,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,i,n,r,s){let a=[];return i.forEach(o=>{a.push({type:0,doc:o})}),new t(e,i,D0.emptySet(i),a,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!zp(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let i=this.docChanges,n=e.docChanges;if(i.length!==n.length)return!1;for(let r=0;r<i.length;r++)if(i[r].type!==n[r].type||!i[r].doc.isEqual(n[r].doc))return!1;return!0}};var yA=class{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(e=>e.listensToRemoteStore())}};function Ghe(){return new wA}var wA=class{constructor(){this.queries=new Us(e=>p5(e),zp),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}};function yR(t,e){return y(this,null,function*(){let i=U(t),n=3,r=e.query,s=i.queries.get(r);s?!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(n=2):(s=new yA,n=e.listensToRemoteStore()?0:1);try{switch(n){case 0:s.viewSnap=yield i.onListen(r,!0);break;case 1:s.viewSnap=yield i.onListen(r,!1);break;case 2:yield i.onFirstRemoteStoreListen(r);break;default:break}}catch(a){let o=ih(a,`Initialization of query '${Cu(e.query)}' failed`);e.onError(o);return}i.queries.set(r,s),s.listeners.push(e),e.applyOnlineStateChange(i.onlineState),s.viewSnap&&e.onViewSnapshot(s.viewSnap)&&CR(i)})}function wR(t,e){return y(this,null,function*(){let i=U(t),n=e.query,r=3,s=i.queries.get(n);if(s){let a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),s.listeners.length===0?r=e.listensToRemoteStore()?0:1:!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(r=2))}switch(r){case 0:return i.queries.delete(n),i.onUnlisten(n,!0);case 1:return i.queries.delete(n),i.onUnlisten(n,!1);case 2:return i.onLastRemoteStoreUnlisten(n);default:return}})}function Khe(t,e){let i=U(t),n=!1;for(let r of e){let s=r.query,a=i.queries.get(s);if(a){for(let o of a.listeners)o.onViewSnapshot(r)&&(n=!0);a.viewSnap=r}}n&&CR(i)}function $he(t,e,i){let n=U(t),r=n.queries.get(e);if(r)for(let s of r.listeners)s.onError(i);n.queries.delete(e)}function Yhe(t,e){let i=U(t);i.onlineState=e;let n=!1;i.queries.forEach((r,s)=>{for(let a of s.listeners)a.applyOnlineStateChange(e)&&(n=!0)}),n&&CR(i)}function Qhe(t,e){U(t).snapshotsInSyncListeners.add(e),e.next()}function Xhe(t,e){U(t).snapshotsInSyncListeners.delete(e)}function CR(t){t.snapshotsInSyncListeners.forEach(e=>{e.next()})}var vH=function(t){return t.Default="default",t.Cache="cache",t}(vH||{}),Rp=class{constructor(e,i,n){this.query=e,this.queryObserver=i,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=n||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let n=[];for(let r of e.docChanges)r.type!==3&&n.push(r);e=new Uu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let i=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),i=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),i=!0),this.snap=e,i}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let i=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),i=!0),i}shouldRaiseInitialEvent(e,i){if(!e.fromCache||!this.listensToRemoteStore())return!0;let n=i!=="Offline";return this.options.waitForSyncWhenOnline&&n?!1:!e.docs.isEmpty()||e.hasCachedResults||i==="Offline"}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let i=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return e.syncStateChanged||i?this.options.includeMetadataChanges===!0:!1}raiseInitialEvent(e){e=Uu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}listensToRemoteStore(){return this.options.source!==vH.Cache}};var CA=class t{constructor(e,i,n,r){this.targetId=e,this.fromCache=i,this.addedKeys=n,this.removedKeys=r}static fromSnapshot(e,i){let n=Oe(),r=Oe();for(let s of i.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key);break}return new t(e,i.fromCache,n,r)}};var A0=class{constructor(e){this.serializer=e}toDocumentKey(e){return Vs(this.serializer,e)}toMutableDocument(e){return e.metadata.exists?V5(this.serializer,e.document,!1):di.newNoDocument(this.toDocumentKey(e.metadata.name),this.toSnapshotVersion(e.metadata.readTime))}toSnapshotVersion(e){return Jt(e)}},EA=class{constructor(e,i,n){this.bundleMetadata=e,this.localStore=i,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=yH(e)}addSizedElement(e){this.progress.bytesLoaded+=e.byteLength;let i=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++i;let n=Qe.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++i);return i!==this.progress.documentsLoaded?(this.progress.documentsLoaded=i,Object.assign({},this.progress)):null}getQueryDocumentMapping(e){let i=new Map,n=new A0(this.serializer);for(let r of e)if(r.metadata.queries){let s=n.toDocumentKey(r.metadata.name);for(let a of r.metadata.queries){let o=(i.get(a)||Oe()).add(s);i.set(a,o)}}return i}complete(){return y(this,null,function*(){let e=yield Hue(this.localStore,new A0(this.serializer),this.documents,this.bundleMetadata.id),i=this.getQueryDocumentMapping(this.documents);for(let n of this.queries)yield $ue(this.localStore,n,i.get(n.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:e}})}};function yH(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function Zhe(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var R0=class{constructor(e){this.key=e}},M0=class{constructor(e){this.key=e}},O0=class{constructor(e,i){this.query=e,this._syncedDocuments=i,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=Oe(),this.mutatedKeys=Oe(),this.docComparator=_5(e),this.documentSet=new D0(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,i){let n=i?i.changeSet:new k0,r=i?i.documentSet:this.documentSet,s=i?i.mutatedKeys:this.mutatedKeys,a=r,o=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,u)=>{let h=r.get(d),f=Up(this.query,u)?u:null,p=h?this.mutatedKeys.has(h.key):!1,v=f?f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations:!1,E=!1;h&&f?h.data.isEqual(f.data)?p!==v&&(n.track({type:3,doc:f}),E=!0):this.shouldWaitForSyncedDocument(h,f)||(n.track({type:2,doc:f}),E=!0,(l&&this.docComparator(f,l)>0||c&&this.docComparator(f,c)<0)&&(o=!0)):!h&&f?(n.track({type:0,doc:f}),E=!0):h&&!f&&(n.track({type:1,doc:h}),E=!0,(l||c)&&(o=!0)),E&&(f?(a=a.add(f),v?s=s.add(d):s=s.delete(d)):(a=a.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{documentSet:a,changeSet:n,needsRefill:o,mutatedKeys:s}}shouldWaitForSyncedDocument(e,i){return e.hasLocalMutations&&i.hasCommittedMutations&&!i.hasLocalMutations}applyChanges(e,i,n,r){let s=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let a=e.changeSet.getChanges();a.sort((u,h)=>Jhe(u.type,h.type)||this.docComparator(u.doc,h.doc)),this.applyTargetChange(n),r=r??!1;let o=i&&!r?this.updateLimboDocuments():[],c=this.limboDocuments.size===0&&this.current&&!r?1:0,d=c!==this.syncState;return this.syncState=c,a.length===0&&!d?{limboChanges:o}:{snapshot:new Uu(this.query,e.documentSet,s,a,e.mutatedKeys,c===0,d,!1,n?n.resumeToken.approximateByteSize()>0:!1),limboChanges:o}}applyOnlineStateChange(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new k0,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!(this._syncedDocuments.has(e)||!this.documentSet.has(e)||this.documentSet.get(e).hasLocalMutations)}applyTargetChange(e){e&&(e.addedDocuments.forEach(i=>this._syncedDocuments=this._syncedDocuments.add(i)),e.modifiedDocuments.forEach(i=>{}),e.removedDocuments.forEach(i=>this._syncedDocuments=this._syncedDocuments.delete(i)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=Oe(),this.documentSet.forEach(n=>{this.shouldBeInLimbo(n.key)&&(this.limboDocuments=this.limboDocuments.add(n.key))});let i=[];return e.forEach(n=>{this.limboDocuments.has(n)||i.push(new M0(n))}),this.limboDocuments.forEach(n=>{e.has(n)||i.push(new R0(n))}),i}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=Oe();let i=this.computeDocChanges(e.documents);return this.applyChanges(i,!0)}computeInitialSnapshot(){return Uu.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===0,this.hasCachedResults)}};function Jhe(t,e){let i=n=>{switch(n){case 0:return 1;case 2:return 2;case 3:return 2;case 1:return 0;default:return Y()}};return i(t)-i(e)}var Ho="SyncEngine",SA=class{constructor(e,i,n){this.query=e,this.targetId=i,this.view=n}},xA=class{constructor(e){this.key=e,this.receivedDocument=!1}},TA=class{constructor(e,i,n,r,s,a){this.localStore=e,this.remoteStore=i,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.syncEngineListener={},this.queryViewsByQuery=new Us(o=>p5(o),zp),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new Dt(z.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new Ip,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=Vu.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return this._isPrimaryClient===!0}};function efe(t,e,i,n,r,s,a){let o=new TA(t,e,i,n,r,s);return a&&(o._isPrimaryClient=!0),o}function tfe(t,e,i=!0){return y(this,null,function*(){let n=ew(t),r,s=n.queryViewsByQuery.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.computeInitialSnapshot()):r=yield wH(n,e,i,!0),r})}function ife(t,e){return y(this,null,function*(){let i=ew(t);yield wH(i,e,!0,!1)})}function wH(t,e,i,n){return y(this,null,function*(){let r=yield ju(t.localStore,_n(e)),s=r.targetId,a=i?t.sharedClientState.addLocalQueryTarget(s):"not-current",o;return n&&(o=yield ER(t,e,s,a==="current",r.resumeToken)),t.isPrimaryClient&&i&&J0(t.remoteStore,r),o})}function ER(t,e,i,n,r){return y(this,null,function*(){t.applyDocChanges=(u,h,f)=>ffe(t,u,h,f);let s=yield Z0(t.localStore,e,!0),a=new O0(e,s.remoteKeys),o=a.computeDocChanges(s.documents),l=Ep.createSynthesizedTargetChangeForCurrentChange(i,n&&t.onlineState!=="Offline",r),c=a.applyChanges(o,t.isPrimaryClient,l);TR(t,i,c.limboChanges);let d=new SA(e,i,a);return t.queryViewsByQuery.set(e,d),t.queriesByTarget.has(i)?t.queriesByTarget.get(i).push(e):t.queriesByTarget.set(i,[e]),c.snapshot})}function nfe(t,e,i){return y(this,null,function*(){let n=U(t),r=n.queryViewsByQuery.get(e),s=n.queriesByTarget.get(r.targetId);if(s.length>1){n.queriesByTarget.set(r.targetId,s.filter(a=>!zp(a,e))),n.queryViewsByQuery.delete(e);return}n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield zu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),i&&Ju(n.remoteStore,r.targetId),qu(n,r.targetId)}).catch(jo))):(qu(n,r.targetId),yield zu(n.localStore,r.targetId,!0))})}function rfe(t,e){return y(this,null,function*(){let i=U(t),n=i.queryViewsByQuery.get(e),r=i.queriesByTarget.get(n.targetId);i.isPrimaryClient&&r.length===1&&(i.sharedClientState.removeLocalQueryTarget(n.targetId),Ju(i.remoteStore,n.targetId))})}function sfe(t,e,i){return y(this,null,function*(){let n=DR(t);try{let r=yield Due(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),ufe(n,r.batchId,i),yield ga(n,r.changes),yield eh(n.remoteStore)}catch(r){let s=ih(r,"Failed to persist write");i.reject(s)}})}function CH(t,e){return y(this,null,function*(){let i=U(t);try{let n=yield Oue(i.localStore,e);e.targetChanges.forEach((r,s)=>{let a=i.activeLimboResolutionsByTarget.get(s);a&&(oe(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?a.receivedDocument=!0:r.modifiedDocuments.size>0?oe(a.receivedDocument):r.removedDocuments.size>0&&(oe(a.receivedDocument),a.receivedDocument=!1))}),yield ga(i,n,e)}catch(n){yield jo(n)}})}function yq(t,e,i){let n=U(t);if(n.isPrimaryClient&&i===0||!n.isPrimaryClient&&i===1){let r=[];n.queryViewsByQuery.forEach((s,a)=>{let o=a.view.applyOnlineStateChange(e);o.snapshot&&r.push(o.snapshot)}),Yhe(n.eventManager,e),r.length&&n.syncEngineListener.onWatchChange(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function afe(t,e,i){return y(this,null,function*(){let n=U(t);n.sharedClientState.updateQueryState(e,"rejected",i);let r=n.activeLimboResolutionsByTarget.get(e),s=r&&r.key;if(s){let a=new Dt(z.comparator);a=a.insert(s,di.newNoDocument(s,pe.min()));let o=Oe().add(s),l=new Cp(pe.min(),new Map,new Dt(Re),a,o);yield CH(n,l),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.remove(s),n.activeLimboResolutionsByTarget.delete(e),IR(n)}else yield zu(n.localStore,e,!1).then(()=>qu(n,e,i)).catch(jo)})}function ofe(t,e){return y(this,null,function*(){let i=U(t),n=e.batch.batchId;try{let r=yield kue(i.localStore,e);xR(i,n,null),SR(i,n),i.sharedClientState.updateMutationState(n,"acknowledged"),yield ga(i,r)}catch(r){yield jo(r)}})}function lfe(t,e,i){return y(this,null,function*(){let n=U(t);try{let r=yield Rue(n.localStore,e);xR(n,e,i),SR(n,e),n.sharedClientState.updateMutationState(e,"rejected",i),yield ga(n,r)}catch(r){yield jo(r)}})}function cfe(t,e){return y(this,null,function*(){let i=U(t);Uo(i.remoteStore)||N(Ho,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let n=yield Mue(i.localStore);if(n===Do){e.resolve();return}let r=i.pendingWritesCallbacks.get(n)||[];r.push(e),i.pendingWritesCallbacks.set(n,r)}catch(n){let r=ih(n,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}})}function SR(t,e){(t.pendingWritesCallbacks.get(e)||[]).forEach(i=>{i.resolve()}),t.pendingWritesCallbacks.delete(e)}function dfe(t,e){t.pendingWritesCallbacks.forEach(i=>{i.forEach(n=>{n.reject(new D(T.CANCELLED,e))})}),t.pendingWritesCallbacks.clear()}function ufe(t,e,i){let n=t.mutationUserCallbacks[t.currentUser.toKey()];n||(n=new Dt(Re)),n=n.insert(e,i),t.mutationUserCallbacks[t.currentUser.toKey()]=n}function xR(t,e,i){let n=U(t),r=n.mutationUserCallbacks[n.currentUser.toKey()];if(r){let s=r.get(e);s&&(i?s.reject(i):s.resolve(),r=r.remove(e)),n.mutationUserCallbacks[n.currentUser.toKey()]=r}}function qu(t,e,i=null){t.sharedClientState.removeLocalQueryTarget(e);for(let n of t.queriesByTarget.get(e))t.queryViewsByQuery.delete(n),i&&t.syncEngineListener.onWatchError(n,i);t.queriesByTarget.delete(e),t.isPrimaryClient&&t.limboDocumentRefs.removeReferencesForId(e).forEach(r=>{t.limboDocumentRefs.containsKey(r)||EH(t,r)})}function EH(t,e){t.enqueuedLimboResolutions.delete(e.path.canonicalString());let i=t.activeLimboTargetsByKey.get(e);i!==null&&(Ju(t.remoteStore,i),t.activeLimboTargetsByKey=t.activeLimboTargetsByKey.remove(e),t.activeLimboResolutionsByTarget.delete(i),IR(t))}function TR(t,e,i){for(let n of i)n instanceof R0?(t.limboDocumentRefs.addReference(n.key,e),hfe(t,n)):n instanceof M0?(N(Ho,"Document no longer in limbo: "+n.key),t.limboDocumentRefs.removeReference(n.key,e),t.limboDocumentRefs.containsKey(n.key)||EH(t,n.key)):Y()}function hfe(t,e){let i=e.key,n=i.path.canonicalString();!t.activeLimboTargetsByKey.get(i)&&!t.enqueuedLimboResolutions.has(n)&&(N(Ho,"New document in limbo: "+i),t.enqueuedLimboResolutions.add(n),IR(t))}function IR(t){for(;t.enqueuedLimboResolutions.size>0&&t.activeLimboTargetsByKey.size<t.maxConcurrentLimboResolutions;){let e=t.enqueuedLimboResolutions.values().next().value;t.enqueuedLimboResolutions.delete(e);let i=new z(Qe.fromString(e)),n=t.limboTargetIdGenerator.next();t.activeLimboResolutionsByTarget.set(n,new xA(i)),t.activeLimboTargetsByKey=t.activeLimboTargetsByKey.insert(i,n),J0(t.remoteStore,new Bu(_n(Xu(i.path)),n,"TargetPurposeLimboResolution",qn.INVALID))}}function ga(t,e,i){return y(this,null,function*(){let n=U(t),r=[],s=[],a=[];n.queryViewsByQuery.isEmpty()||(n.queryViewsByQuery.forEach((o,l)=>{a.push(n.applyDocChanges(l,e,i).then(c=>{if((c||i)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(l.targetId,c?.fromCache?"not-current":"current"),c){r.push(c);let d=CA.fromSnapshot(l.targetId,c);s.push(d)}}))}),yield Promise.all(a),n.syncEngineListener.onWatchChange(r),yield Pue(n.localStore,s))})}function ffe(t,e,i,n){return y(this,null,function*(){let r=e.view.computeDocChanges(i);r.needsRefill&&(r=yield Z0(t.localStore,e.query,!1).then(({documents:l})=>e.view.computeDocChanges(l,r)));let s=n&&n.targetChanges.get(e.targetId),a=n&&n.targetMismatches.get(e.targetId)!=null,o=e.view.applyChanges(r,t.isPrimaryClient,s,a);return TR(t,e.targetId,o.limboChanges),o.snapshot})}function mfe(t,e){return y(this,null,function*(){let i=U(t);if(!i.currentUser.isEqual(e)){N(Ho,"User change. New user:",e.toKey());let r=yield nH(i.localStore,e);i.currentUser=e,dfe(i,"'waitForPendingWrites' promise is rejected due to a user change."),i.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ga(i,r.affectedDocuments)}})}function pfe(t,e){let i=U(t),n=i.activeLimboResolutionsByTarget.get(e);if(n&&n.receivedDocument)return Oe().add(n.key);{let r=Oe(),s=i.queriesByTarget.get(e);if(!s)return r;for(let a of s){let o=i.queryViewsByQuery.get(a);r=r.unionWith(o.view.syncedDocuments)}return r}}function gfe(t,e){return y(this,null,function*(){let i=U(t),n=yield Z0(i.localStore,e.query,!0),r=e.view.synchronizeWithPersistedState(n);return i.isPrimaryClient&&TR(i,e.targetId,r.limboChanges),r})}function _fe(t,e){return y(this,null,function*(){let i=U(t);return oH(i.localStore,e).then(n=>ga(i,n))})}function bfe(t,e,i,n){return y(this,null,function*(){let r=U(t),s=yield jue(r.localStore,e);if(s===null){N(Ho,"Cannot apply mutation batch with id: "+e);return}i==="pending"?yield eh(r.remoteStore):i==="acknowledged"||i==="rejected"?(xR(r,e,n||null),SR(r,e),zue(r.localStore,e)):Y(),yield ga(r,s)})}function vfe(t,e){return y(this,null,function*(){let i=U(t);if(ew(i),DR(i),e===!0&&i._isPrimaryClient!==!0){let n=i.sharedClientState.getAllActiveQueryTargets(),r=yield wq(i,n.toArray());i._isPrimaryClient=!0,yield bA(i.remoteStore,!0);for(let s of r)J0(i.remoteStore,s)}else if(e===!1&&i._isPrimaryClient!==!1){let n=[],r=Promise.resolve();i.queriesByTarget.forEach((s,a)=>{i.sharedClientState.isLocalQueryTarget(a)?n.push(a):r=r.then(()=>(qu(i,a),zu(i.localStore,a,!0))),Ju(i.remoteStore,a)}),yield r,yield wq(i,n),yfe(i),i._isPrimaryClient=!1,yield bA(i.remoteStore,!1)}})}function yfe(t){let e=U(t);e.activeLimboResolutionsByTarget.forEach((i,n)=>{Ju(e.remoteStore,n)}),e.limboDocumentRefs.removeAllReferences(),e.activeLimboResolutionsByTarget=new Map,e.activeLimboTargetsByKey=new Dt(z.comparator)}function wq(t,e,i){return y(this,null,function*(){let n=U(t),r=[],s=[];for(let a of e){let o,l=n.queriesByTarget.get(a);if(l&&l.length!==0){o=yield ju(n.localStore,_n(l[0]));for(let c of l){let d=n.queryViewsByQuery.get(c),u=yield gfe(n,d);u.snapshot&&s.push(u.snapshot)}}else{let c=yield aH(n.localStore,a);o=yield ju(n.localStore,c),yield ER(n,SH(c),a,!1,o.resumeToken)}r.push(o)}return n.syncEngineListener.onWatchChange(s),r})}function SH(t){return m5(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function wfe(t){let e=U(t);return Uue(e.localStore)}function Cfe(t,e,i,n){return y(this,null,function*(){let r=U(t);if(r._isPrimaryClient){N(Ho,"Ignoring unexpected query state notification.");return}let s=r.queriesByTarget.get(e);if(s&&s.length>0)switch(i){case"current":case"not-current":{let a=yield oH(r.localStore,g5(s[0])),o=Cp.createSynthesizedRemoteEventForCurrentChange(e,i==="current",Ri.EMPTY_BYTE_STRING);yield ga(r,a,o);break}case"rejected":{yield zu(r.localStore,e,!0),qu(r,e,n);break}default:Y()}})}function Efe(t,e,i){return y(this,null,function*(){let n=ew(t);if(n._isPrimaryClient){for(let r of e){if(n.queriesByTarget.has(r)&&n.sharedClientState.isActiveQueryTarget(r)){N(Ho,"Adding an already active target "+r);continue}let a=yield aH(n.localStore,r),o=yield ju(n.localStore,a);yield ER(n,SH(a),o.targetId,!1,o.resumeToken),J0(n.remoteStore,o)}for(let r of i)n.queriesByTarget.has(r)&&(yield zu(n.localStore,r,!1).then(()=>{Ju(n.remoteStore,r),qu(n,r)}).catch(jo))}})}function ew(t){let e=U(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=CH.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pfe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=afe.bind(null,e),e.syncEngineListener.onWatchChange=Khe.bind(null,e.eventManager),e.syncEngineListener.onWatchError=$he.bind(null,e.eventManager),e}function DR(t){let e=U(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ofe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lfe.bind(null,e),e}function Sfe(t,e,i){let n=U(t);xfe(n,e,i).then(r=>{n.sharedClientState.notifyBundleLoaded(r)})}function xfe(t,e,i){return y(this,null,function*(){try{let n=yield e.getMetadata();if(yield Wue(t.localStore,n))return yield e.close(),i._completeWith(Zhe(n)),Promise.resolve(new Set);i._updateProgress(yH(n));let s=new EA(n,t.localStore,e.serializer),a=yield e.nextElement();for(;a;){let l=yield s.addSizedElement(a);l&&i._updateProgress(l),a=yield e.nextElement()}let o=yield s.complete();return yield ga(t,o.changedDocs,void 0),yield Gue(t.localStore,n),i._completeWith(o.progress),Promise.resolve(o.changedCollectionGroups)}catch(n){return wr(Ho,`Loading bundle failed with ${n}`),i._failWith(n),Promise.resolve(new Set)}})}var Mp=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=Hp(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,i){return null}createIndexBackfillerScheduler(e,i){return null}createLocalStore(e){return iH(this.persistence,new C0,e.initialUser,this.serializer)}createPersistence(e){return new y0(w0.factory,this.serializer)}createSharedClientState(e){return new x0}terminate(){return y(this,null,function*(){var e,i;(e=this.gcScheduler)===null||e===void 0||e.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var N0=class t extends Mp{constructor(e,i,n){super(),this.onlineComponentProvider=e,this.cacheSizeBytes=i,this.forceOwnership=n,this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){yield mw(t.prototype,this,"initialize").call(this,e),yield this.onlineComponentProvider.initialize(this,e),yield DR(this.onlineComponentProvider.syncEngine),yield eh(this.onlineComponentProvider.remoteStore),yield this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return iH(this.persistence,new C0,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,i){let n=this.persistence.referenceDelegate.garbageCollector;return new Gk(n,e.asyncQueue,i)}createIndexBackfillerScheduler(e,i){let n=new lk(i,this.persistence);return new ok(e.asyncQueue,n)}createPersistence(e){let i=pR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?yr.withCacheSize(this.cacheSizeBytes):yr.DEFAULT;return new aA(this.synchronizeTabs,i,e.clientId,n,e.asyncQueue,fH(),mhe(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new x0}},IA=class t extends N0{constructor(e,i){super(e,i,!1),this.onlineComponentProvider=e,this.cacheSizeBytes=i,this.synchronizeTabs=!0}initialize(e){return y(this,null,function*(){yield mw(t.prototype,this,"initialize").call(this,e);let i=this.onlineComponentProvider.syncEngine;this.sharedClientState instanceof dp&&(this.sharedClientState.syncEngine={applyBatchState:bfe.bind(null,i),applyTargetState:Cfe.bind(null,i),applyActiveTargetsChange:Efe.bind(null,i),getActiveClients:wfe.bind(null,i),synchronizeWithChangedDocuments:_fe.bind(null,i)},yield this.sharedClientState.start()),yield this.persistence.setPrimaryStateListener(n=>y(this,null,function*(){yield vfe(this.onlineComponentProvider.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let i=fH();if(!dp.isAvailable(i))throw new D(T.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let n=pR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new dp(i,e.asyncQueue,n,e.clientId,e.initialUser)}},Op=class{initialize(e,i){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>yq(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=mfe.bind(null,this.syncEngine),yield bA(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return Ghe()}createDatastore(e){let i=Hp(e.databaseInfo.databaseId),n=hhe(e.databaseInfo);return whe(e.authCredentials,e.appCheckCredentials,n,i)}createRemoteStore(e){return Dhe(this.localStore,this.datastore,e.asyncQueue,i=>yq(this.syncEngine,i,0),fhe())}createSyncEngine(e,i){return efe(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,i)}terminate(){return y(this,null,function*(){var e;yield Rhe(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};var Tfe=10240;function Ife(t,e=Tfe){let i=0;return{read(){return y(this,null,function*(){if(i<t.byteLength){let s={value:t.slice(i,i+e),done:!1};return i+=e,s}return{done:!0}})},cancel(){return y(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}function kR(t,e,i){if(!i)throw new D(T.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function AR(t,e,i,n){if(e===!0&&n===!0)throw new D(T.INVALID_ARGUMENT,`${t} and ${i} cannot be used together.`)}function Cq(t){if(!z.isDocumentKey(t))throw new D(T.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Eq(t){if(z.isDocumentKey(t))throw new D(T.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Dfe(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Gp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=kfe(t);return e?`a custom ${e} object`:"an object"}}else return typeof t=="function"?"a function":Y()}function kfe(t){return t.constructor?t.constructor.name:null}function Xe(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new D(T.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let i=Gp(t);throw new D(T.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${i}`)}}return t}function xH(t,e){if(e<=0)throw new D(T.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}function Afe(t,e){if(!(t instanceof Uint8Array))throw new D(T.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${Gp(t)}`);return Ife(t,e)}var Hu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.observer.error?this.scheduleEvent(this.observer.error,e):Lt("Uncaught Error in snapshot listener:",e.toString())}mute(){this.muted=!0}scheduleEvent(e,i){this.muted||setTimeout(()=>{this.muted||e(i)},0)}};var DA=class{constructor(e,i){this.payload=e,this.byteLength=i}isBundleMetadata(){return"metadata"in this.payload}};var kA=class{constructor(e,i){this.reader=e,this.serializer=i,this.metadata=new Zt,this.buffer=new Uint8Array,this.textDecoder=pce(),this.nextElementImpl().then(n=>{n&&n.isBundleMetadata()?this.metadata.resolve(n.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n?.payload)}`))},n=>this.metadata.reject(n))}close(){return this.reader.cancel()}getMetadata(){return y(this,null,function*(){return this.metadata.promise})}nextElement(){return y(this,null,function*(){return yield this.getMetadata(),this.nextElementImpl()})}nextElementImpl(){return y(this,null,function*(){let e=yield this.readLength();if(e===null)return null;let i=this.textDecoder.decode(e),n=Number(i);isNaN(n)&&this.raiseError(`length string (${i}) is not valid number`);let r=yield this.readJsonString(n);return new DA(JSON.parse(r),e.length+n)})}indexOfOpenBracket(){return this.buffer.findIndex(e=>e===123)}readLength(){return y(this,null,function*(){for(;this.indexOfOpenBracket()<0&&!(yield this.pullMoreDataToBuffer()););if(this.buffer.length===0)return null;let e=this.indexOfOpenBracket();e<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let i=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),i})}readJsonString(e){return y(this,null,function*(){for(;this.buffer.length<e;)(yield this.pullMoreDataToBuffer())&&this.raiseError("Reached the end of bundle when more is expected.");let i=this.textDecoder.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),i})}raiseError(e){throw this.reader.cancel(),new Error(`Invalid bundle format: ${e}`)}pullMoreDataToBuffer(){return y(this,null,function*(){let e=yield this.reader.read();if(!e.done){let i=new Uint8Array(this.buffer.length+e.value.length);i.set(this.buffer),i.set(e.value,this.buffer.length),this.buffer=i}return e.done})}};function Rfe(t,e){return new kA(t,e)}var AA=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return y(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new D(T.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let i=yield Ehe(this.datastore,e);return i.forEach(n=>this.recordVersion(n)),i})}set(e,i){this.write(i.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,i){try{this.write(i.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new Lo(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return y(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(i=>{e.delete(i.key.toString())}),e.forEach((i,n)=>{let r=z.fromPath(n);this.mutations.push(new vp(r,this.precondition(r)))}),yield Che(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let i;if(e.isFoundDocument())i=e.version;else if(e.isNoDocument())i=pe.min();else throw Y();let n=this.readVersions.get(e.key.toString());if(n){if(!i.isEqual(n))throw new D(T.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),i)}precondition(e){let i=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&i?i.isEqual(pe.min())?Ht.exists(!1):Ht.updateTime(i):Ht.none()}preconditionForUpdate(e){let i=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&i){if(i.isEqual(pe.min()))throw new D(T.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ht.updateTime(i)}else return Ht.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var RA=class{constructor(e,i,n,r,s){this.asyncQueue=e,this.datastore=i,this.options=n,this.updateFunction=r,this.deferred=s,this.attemptsRemaining=n.maxAttempts,this.backoff=new Ap(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(()=>y(this,null,function*(){let e=new AA(this.datastore),i=this.tryRunUpdateFunction(e);i&&i.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(r=>{this.handleTransactionError(r)}))}).catch(n=>{this.handleTransactionError(n)})}))}tryRunUpdateFunction(e){try{let i=this.updateFunction(e);return Vp(i)||!i.catch||!i.then?(this.deferred.reject(Error("Transaction callback must return a Promise")),null):i}catch(i){return this.deferred.reject(i),null}}handleTransactionError(e){this.attemptsRemaining>0&&this.isRetryableTransactionError(e)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(e)}isRetryableTransactionError(e){if(e.name==="FirebaseError"){let i=e.code;return i==="aborted"||i==="failed-precondition"||i==="already-exists"||!M5(i)}return!1}};var Bo="FirestoreClient",Mfe=100,Ofe=11,Nfe=20,Pfe=22,MA=class{constructor(e,i,n,r){this.authCredentials=e,this.appCheckCredentials=i,this.asyncQueue=n,this.databaseInfo=r,this.user=ui.UNAUTHENTICATED,this.clientId=Jy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,s=>y(this,null,function*(){N(Bo,"Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(n,s=>(N(Bo,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:Mfe}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new D(T.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Zt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(i){let n=ih(i,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function Xy(t,e){return y(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),N(Bo,"Initializing OfflineComponentProvider");let i=t.configuration;yield e.initialize(i);let n=i.initialUser;t.setCredentialChangeListener(r=>y(this,null,function*(){n.isEqual(r)||(yield nH(e.localStore,r),n=r)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function OA(t,e){return y(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let i=yield RR(t);N(Bo,"Initializing OnlineComponentProvider"),yield e.initialize(i,t.configuration),t.setCredentialChangeListener(n=>vq(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,r)=>vq(e.remoteStore,r)),t._onlineComponents=e})}function TH(t){return t.name==="FirebaseError"?t.code===T.FAILED_PRECONDITION||t.code===T.UNIMPLEMENTED:typeof DOMException<"u"&&t instanceof DOMException?t.code===Pfe||t.code===Nfe||t.code===Ofe:!0}function RR(t){return y(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){N(Bo,"Using user provided OfflineComponentProvider");try{yield Xy(t,t._uninitializedComponentsProvider._offline)}catch(e){let i=e;if(!TH(i))throw i;wr("Error using user provided cache. Falling back to memory cache: "+i),yield Xy(t,new Mp)}}else N(Bo,"Using default OfflineComponentProvider"),yield Xy(t,new Mp);return t._offlineComponents})}function tw(t){return y(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(N(Bo,"Using user provided OnlineComponentProvider"),yield OA(t,t._uninitializedComponentsProvider._online)):(N(Bo,"Using default OnlineComponentProvider"),yield OA(t,new Op))),t._onlineComponents})}function IH(t){return RR(t).then(e=>e.persistence)}function MR(t){return RR(t).then(e=>e.localStore)}function DH(t){return tw(t).then(e=>e.remoteStore)}function OR(t){return tw(t).then(e=>e.syncEngine)}function Ffe(t){return tw(t).then(e=>e.datastore)}function Wu(t){return y(this,null,function*(){let e=yield tw(t),i=e.eventManager;return i.onListen=tfe.bind(null,e.syncEngine),i.onUnlisten=nfe.bind(null,e.syncEngine),i.onFirstRemoteStoreListen=ife.bind(null,e.syncEngine),i.onLastRemoteStoreUnlisten=rfe.bind(null,e.syncEngine),i})}function Lfe(t){return t.asyncQueue.enqueue(()=>y(this,null,function*(){let e=yield IH(t),i=yield DH(t);return e.setNetworkEnabled(!0),khe(i)}))}function Bfe(t){return t.asyncQueue.enqueue(()=>y(this,null,function*(){let e=yield IH(t),i=yield DH(t);return e.setNetworkEnabled(!1),Ahe(i)}))}function Vfe(t){let e=new Zt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let i=yield OR(t);return cfe(i,e)})),e.promise}function jfe(t,e,i,n){let r=new Hu(n),s=new Rp(e,r,i);return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let a=yield Wu(t);return yR(a,s)})),()=>{r.mute(),t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let a=yield Wu(t);return wR(a,s)}))}}function zfe(t,e){let i=new Zt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let n=yield MR(t);return Gfe(n,e,i)})),i.promise}function kH(t,e,i={}){let n=new Zt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let r=yield Wu(t);return Kfe(r,t.asyncQueue,e,i,n)})),n.promise}function Ufe(t,e){let i=new Zt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let n=yield MR(t);return $fe(n,e,i)})),i.promise}function AH(t,e,i={}){let n=new Zt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let r=yield Wu(t);return Yfe(r,t.asyncQueue,e,i,n)})),n.promise}function qfe(t,e){let i=new Zt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let n=yield OR(t);return sfe(n,e,i)})),i.promise}function Hfe(t,e){let i=new Hu(e);return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let n=yield Wu(t);return Qhe(n,i)})),()=>{i.mute(),t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let n=yield Wu(t);return Xhe(n,i)}))}}function Wfe(t,e,i){let n=new Zt;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let r=yield Ffe(t);new RA(t.asyncQueue,r,i,e,n).run()})),n.promise}function Gfe(t,e,i){return y(this,null,function*(){try{let n=yield Lue(t,e);n.isFoundDocument()?i.resolve(n):n.isNoDocument()?i.resolve(null):i.reject(new D(T.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(n){let r=ih(n,`Failed to get document '${e} from cache`);i.reject(r)}})}function Kfe(t,e,i,n,r){let s=new Hu({next:o=>{e.enqueueAndForget(()=>wR(t,a));let l=o.docs.has(i);!l&&o.fromCache?r.reject(new D(T.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&n&&n.source==="server"?r.reject(new D(T.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(o)},error:o=>r.reject(o)}),a=new Rp(Xu(i.path),s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return yR(t,a)}function $fe(t,e,i){return y(this,null,function*(){try{let n=yield Z0(t,e,!0),r=new O0(e,n.remoteKeys),s=r.computeDocChanges(n.documents),a=r.applyChanges(s,!1);i.resolve(a.snapshot)}catch(n){let r=ih(n,`Failed to execute query '${e} against cache`);i.reject(r)}})}function Yfe(t,e,i,n,r){let s=new Hu({next:o=>{e.enqueueAndForget(()=>wR(t,a)),o.fromCache&&n.source==="server"?r.reject(new D(T.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(o)},error:o=>r.reject(o)}),a=new Rp(i,s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return yR(t,a)}function Qfe(t,e,i,n){let r=Zfe(i,Hp(e));t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){Sfe(yield OR(t),r,n)}))}function Xfe(t,e){return t.asyncQueue.enqueue(()=>y(this,null,function*(){return Kue(yield MR(t),e)}))}function Zfe(t,e){let i;return typeof t=="string"?i=O5().encode(t):i=t,Rfe(Afe(i),e)}function Jfe(t,e){return t.timeoutSeconds===e.timeoutSeconds}function RH(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var eme="ComponentProvider",Sq=new Map;function tme(t){let e=Sq.get(t);e&&(N(eme,"Removing Datastore"),Sq.delete(t),e.terminate())}function ime(t,e,i,n){return new mk(t,e,i,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling,RH(n.experimentalLongPollingOptions),n.useFetchStreams)}var MH="firestore.googleapis.com",xq=!0,Tq=5,Iq=30,nme=!0,P0=class{constructor(e){var i,n;if(e.host===void 0){if(e.ssl!==void 0)throw new D(T.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=MH,this.ssl=xq}else this.host=e.host,this.ssl=(i=e.ssl)!==null&&i!==void 0?i:xq;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=J5;else{if(e.cacheSizeBytes!==qp&&e.cacheSizeBytes<lq)throw new D(T.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${lq}`);this.cacheSizeBytes=e.cacheSizeBytes}AR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=nme:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=RH((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),rme(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&Jfe(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};function rme(t){if(t.timeoutSeconds!==void 0){if(isNaN(t.timeoutSeconds))throw new D(T.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<Tq)throw new D(T.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is ${Tq})`);if(t.timeoutSeconds>Iq)throw new D(T.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is ${Iq})`)}}var cc=class{constructor(e,i,n,r){this._authCredentials=e,this._appCheckCredentials=i,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new P0({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new D(T.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new D(T.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new P0(e),e.credentials!==void 0&&(this._authCredentials=toe(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return tme(this),Promise.resolve()}};function OH(t,e,i,n={}){var r;t=Xe(t,cc);let s=t._getSettings(),a=`${e}:${i}`;if(s.host!==MH&&s.host!==a&&wr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=ui.MOCK_USER;else{o=hg(n.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);let c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new D(T.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ui(c)}t._authCredentials=new Z1(new Zy(o,l))}}var Bi=class t{constructor(e,i,n){this.converter=i,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},xt=class t{constructor(e,i,n){this.converter=i,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new js(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},js=class t extends Bi{constructor(e,i,n){super(e,i,Xu(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new xt(this.firestore,null,new z(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function NR(t,e,...i){if(t=We(t),kR("collection","path",e),t instanceof cc){let n=Qe.fromString(e,...i);return Eq(n),new js(t,null,n)}else{if(!(t instanceof xt)&&!(t instanceof js))throw new D(T.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=t._path.child(Qe.fromString(e,...i));return Eq(n),new js(t.firestore,null,n)}}function NH(t,e){if(t=Xe(t,cc),kR("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new D(T.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Bi(t,null,Lle(e))}function Kp(t,e,...i){if(t=We(t),arguments.length===1&&(e=Jy.newId()),kR("doc","path",e),t instanceof cc){let n=Qe.fromString(e,...i);return Cq(n),new xt(t,null,new z(n))}else{if(!(t instanceof xt)&&!(t instanceof js))throw new D(T.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=t._path.child(Qe.fromString(e,...i));return Cq(n),new xt(t.firestore,t instanceof js?t.converter:null,new z(n))}}function PR(t,e){return t=We(t),e=We(e),(t instanceof xt||t instanceof js)&&(e instanceof xt||e instanceof js)?t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter:!1}function FR(t,e){return t=We(t),e=We(e),t instanceof Bi&&e instanceof Bi?t.firestore===e.firestore&&zp(t._query,e._query)&&t.converter===e.converter:!1}var sme="AsyncQueue",NA=class{constructor(){this.tail=Promise.resolve(),this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new Ap(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()}}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let i=new Zt;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(i.resolve,i.reject),i.promise)).then(()=>i.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}retryNextOp(){return y(this,null,function*(){if(this.retryableOps.length!==0){try{yield this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(zo(e))N(sme,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}})}enqueueInternal(e){let i=this.tail.then(()=>(this.operationInProgress=!0,e().catch(n=>{this.failure=n,this.operationInProgress=!1;let r=ome(n);throw Lt("INTERNAL UNHANDLED ERROR: ",r),n}).then(n=>(this.operationInProgress=!1,n))));return this.tail=i,i}enqueueAfterDelay(e,i,n){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(i=0);let r=vA.createAndSchedule(this,e,i,n,s=>this.removeDelayedOperation(s));return this.delayedOperations.push(r),r}verifyNotFailed(){this.failure&&Y()}verifyOperationInProgress(){}drain(){return y(this,null,function*(){let e;do e=this.tail,yield e;while(e!==this.tail)})}containsDelayedOperation(e){for(let i of this.delayedOperations)if(i.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{this.delayedOperations.sort((i,n)=>i.targetTimeMs-n.targetTimeMs);for(let i of this.delayedOperations)if(i.skipDelay(),e!=="all"&&i.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let i=this.delayedOperations.indexOf(e);this.delayedOperations.splice(i,1)}};function ame(){return new NA}function ome(t){let e=t.message||"";return t.stack&&(t.stack.includes(t.message)?e=t.stack:e=t.message+`
`+t.stack),e}var PA=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Zt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,i,n){this._progressObserver={next:e,error:i,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,i){return this._taskCompletionResolver.promise.then(e,i)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var PH=qp,Pt=class extends cc{constructor(e,i,n,r){super(e,i,n,r),this.type="firestore",this._queue=ame(),this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||FH(this),this._firestoreClient.terminate()}};function yi(t){return t._firestoreClient||FH(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function FH(t){var e,i,n;let r=t._freezeSettings(),s=ime(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new MA(t._authCredentials,t._appCheckCredentials,t._queue,s),!((i=r.localCache)===null||i===void 0)&&i._offlineComponentProvider&&(!((n=r.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}function LH(t,e){t=Xe(t,Pt),GH(t);let i=yi(t);if(i._uninitializedComponentsProvider)throw new D(T.FAILED_PRECONDITION,"SDK cache is already specified.");wr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new Op,s=new N0(r,n.cacheSizeBytes,e?.forceOwnership);return VH(i,r,s)}function BH(t){t=Xe(t,Pt),GH(t);let e=yi(t);if(e._uninitializedComponentsProvider)throw new D(T.FAILED_PRECONDITION,"SDK cache is already specified.");wr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let i=t._freezeSettings(),n=new Op,r=new IA(n,i.cacheSizeBytes);return VH(e,n,r)}function VH(t,e,i){let n=new Zt;return t.asyncQueue.enqueue(()=>y(this,null,function*(){try{yield Xy(t,i),yield OA(t,e),n.resolve()}catch(r){let s=r;if(!TH(s))throw s;wr("Error enabling indexeddb cache. Falling back to memory cache: "+s),n.reject(s)}})).then(()=>n.promise)}function jH(t){if(t._initialized&&!t._terminated)throw new D(T.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Zt;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{yield Tue(pR(t._databaseId,t._persistenceKey)),e.resolve()}catch(i){e.reject(i)}})),e.promise}function zH(t){t=Xe(t,Pt);let e=yi(t);return Vfe(e)}function UH(t){t=Xe(t,Pt);let e=yi(t);return Lfe(e)}function qH(t){t=Xe(t,Pt);let e=yi(t);return Bfe(e)}function HH(t,e){t=Xe(t,Pt);let i=yi(t),n=new PA;return Qfe(i,t._databaseId,e,n),n}function WH(t,e){t=Xe(t,Pt);let i=yi(t);return Xfe(i,e).then(n=>n?new Bi(t,null,n.query):null)}function GH(t){if(t._initialized||t._terminated)throw new D(T.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}function lme(t,e=!0){Jae(_g),Xo(new Rn("firestore",(i,{instanceIdentifier:n,options:r})=>{let s=i.getProvider("app").getImmediate(),a=new Pt(new J1(i.getProvider("auth-internal")),new nk(i.getProvider("app-check-internal")),Qoe(s,n),s);return r=Object.assign({useFetchStreams:e},r),a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),sn(vU,yU,t),sn(vU,yU,"esm2017")}var qs=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(Ri.fromBase64String(e))}catch(i){throw new D(T.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+i)}}static fromUint8Array(e){return new t(Ri.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Kr=class{constructor(...e){for(let i=0;i<e.length;++i)if(e[i].length===0)throw new D(T.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ei(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var fa=class{constructor(e){this._methodName=e}};var dc=class{constructor(e,i){if(!isFinite(e)||e<-90||e>90)throw new D(T.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(i)||i<-180||i>180)throw new D(T.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+i);this._lat=e,this._long=i}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Re(this._lat,e._lat)||Re(this._long,e._long)}};var cme=/^__.*__$/,FA=class{constructor(e,i,n){this.data=e,this.fieldMask=i,this.fieldTransforms=n}toMutation(e,i){return this.fieldMask!==null?new Gr(e,this.data,this.fieldMask,i,this.fieldTransforms):new Fo(e,this.data,i,this.fieldTransforms)}},F0=class{constructor(e,i,n){this.data=e,this.fieldMask=i,this.fieldTransforms=n}toMutation(e,i){return new Gr(e,this.data,this.fieldMask,i,this.fieldTransforms)}};function KH(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}var L0=class t{constructor(e,i,n,r,s,a){this.settings=e,this.databaseId=i,this.serializer=n,this.ignoreUndefinedProperties=r,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var i;let n=(i=this.path)===null||i===void 0?void 0:i.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var i;let n=(i=this.path)===null||i===void 0?void 0:i.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return B0(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(i=>e.isPrefixOf(i))!==void 0||this.fieldTransforms.find(i=>e.isPrefixOf(i.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(KH(this.dataSource)&&cme.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},LA=class{constructor(e,i,n){this.databaseId=e,this.ignoreUndefinedProperties=i,this.serializer=n||Hp(e)}createContext(e,i,n,r=!1){return new L0({dataSource:e,methodName:i,targetDoc:n,path:ei.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function pc(t){let e=t._freezeSettings(),i=Hp(t._databaseId);return new LA(t._databaseId,!!e.ignoreUndefinedProperties,i)}function iw(t,e,i,n,r,s={}){let a=t.createContext(s.merge||s.mergeFields?2:0,e,i,r);VR("Data must be an object, but it was:",a,n);let o=QH(n,a),l,c;if(s.merge)l=new Hn(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){let d=[];for(let u of s.mergeFields){let h=UA(e,u,i);if(!a.contains(h))throw new D(T.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);ZH(d,h)||d.push(h)}l=new Hn(d),c=a.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=a.fieldTransforms;return new FA(new Zi(o),l,c)}var Np=class t extends fa{_toFieldTransform(e){if(e.dataSource===2)e.fieldMask.push(e.path);else throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(e){return e instanceof t}};function $H(t,e,i){return new L0({dataSource:3,targetDoc:e.settings.targetDoc,methodName:t._methodName,arrayElement:i},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var BA=class t extends fa{_toFieldTransform(e){return new sc(e.path,new No)}isEqual(e){return e instanceof t}},VA=class t extends fa{constructor(e,i){super(e),this._elements=i}_toFieldTransform(e){let i=$H(this,e,!0),n=this._elements.map(s=>gc(s,i)),r=new ua(n);return new sc(e.path,r)}isEqual(e){return e instanceof t&&Iw(this._elements,e._elements)}},jA=class t extends fa{constructor(e,i){super(e),this._elements=i}_toFieldTransform(e){let i=$H(this,e,!0),n=this._elements.map(s=>gc(s,i)),r=new ha(n);return new sc(e.path,r)}isEqual(e){return e instanceof t&&Iw(this._elements,e._elements)}},zA=class t extends fa{constructor(e,i){super(e),this._operand=i}_toFieldTransform(e){let i=new Po(e.serializer,E5(e.serializer,this._operand));return new sc(e.path,i)}isEqual(e){return e instanceof t&&this._operand===e._operand}};function LR(t,e,i,n){let r=t.createContext(1,e,i);VR("Data must be an object, but it was:",r,n);let s=[],a=Zi.empty();mc(n,(l,c)=>{let d=jR(e,l,i);c=We(c);let u=r.childContextForFieldPath(d);if(c instanceof Np)s.push(d);else{let h=gc(c,u);h!=null&&(s.push(d),a.set(d,h))}});let o=new Hn(s);return new F0(a,o,r.fieldTransforms)}function BR(t,e,i,n,r,s){let a=t.createContext(1,e,i),o=[UA(e,n,i)],l=[r];if(s.length%2!==0)throw new D(T.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)o.push(UA(e,s[h])),l.push(s[h+1]);let c=[],d=Zi.empty();for(let h=o.length-1;h>=0;--h)if(!ZH(c,o[h])){let f=o[h],p=l[h];p=We(p);let v=a.childContextForFieldPath(f);if(p instanceof Np)c.push(f);else{let E=gc(p,v);E!=null&&(c.push(f),d.set(f,E))}}let u=new Hn(c);return new F0(d,u,a.fieldTransforms)}function YH(t,e,i,n=!1){let r=t.createContext(n?4:3,e);return gc(i,r)}function gc(t,e){if(t=We(t),XH(t))return VR("Unsupported field value:",e,t),QH(t,e);if(t instanceof fa)return ume(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return dme(t,e)}else return hme(t,e)}function QH(t,e){let i={};return Qq(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mc(t,(n,r)=>{let s=gc(r,e.childContextForField(n));s!=null&&(i[n]=s)}),{mapValue:{fields:i}}}function dme(t,e){let i=[],n=0;for(let r of t){let s=gc(r,e.childContextForArray(n));s==null&&(s={nullValue:"NULL_VALUE"}),i.push(s),n++}return{arrayValue:{values:i}}}function ume(t,e){if(!KH(e.dataSource))throw e.createError(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.createError(`${t._methodName}() is not currently supported inside arrays`);let i=t._toFieldTransform(e);i&&e.fieldTransforms.push(i)}function hme(t,e){if(t=We(t),t===null)return{nullValue:"NULL_VALUE"};if(typeof t=="number")return E5(e.serializer,t);if(typeof t=="boolean")return{booleanValue:t};if(typeof t=="string")return{stringValue:t};if(t instanceof Date){let i=Bt.fromDate(t);return{timestampValue:Lu(e.serializer,i)}}else if(t instanceof Bt){let i=new Bt(t.seconds,Math.floor(t.nanoseconds/1e3)*1e3);return{timestampValue:Lu(e.serializer,i)}}else{if(t instanceof dc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof qs)return{bytesValue:N5(e.serializer,t._byteString)};if(t instanceof xt){let i=e.databaseId,n=t.firestore._databaseId;if(!n.isEqual(i))throw e.createError(`Document reference is for database ${n.projectId}/${n.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:dR(t.firestore._databaseId||e.databaseId,t._key.path)}}else throw e.createError(`Unsupported field value: ${Gp(t)}`)}}function XH(t){return typeof t=="object"&&t!==null&&!(t instanceof Array)&&!(t instanceof Date)&&!(t instanceof Bt)&&!(t instanceof dc)&&!(t instanceof qs)&&!(t instanceof xt)&&!(t instanceof fa)}function VR(t,e,i){if(!XH(i)||!Dfe(i)){let n=Gp(i);throw n==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+n)}}function UA(t,e,i){if(e=We(e),e instanceof Kr)return e._internalPath;if(typeof e=="string")return jR(t,e);throw B0("Field path arguments must be of type string or ",t,!1,void 0,i)}var fme=new RegExp("[~\\*/\\[\\]]");function jR(t,e,i){if(e.search(fme)>=0)throw B0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,i);try{return new Kr(...e.split("."))._internalPath}catch{throw B0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,i)}}function B0(t,e,i,n,r){let s=n&&!n.isEmpty(),a=r!==void 0,o=`Function ${e}() called with invalid data`;i&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${r}`),l+=")"),new D(T.INVALID_ARGUMENT,o+t+l)}function ZH(t,e){return t.some(i=>i.isEqual(e))}var uc=class{constructor(e,i,n,r,s){this._firestore=e,this._userDataWriter=i,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new xt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document)if(this._converter){let e=new qA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}else return this._userDataWriter.convertValue(this._document.data.value);else return}get(e){if(this._document){let i=this._document.data.field(nw("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i)}}},qA=class extends uc{data(){return super.data()}};function nw(t,e){return typeof e=="string"?jR(t,e):e instanceof Kr?e._internalPath:e._delegate._internalPath}function JH(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new D(T.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Pp=class{},hc=class extends Pp{};function _a(t,e,...i){let n=[];e instanceof Pp&&n.push(e),n=n.concat(i),wme(n);for(let r of n)t=r._apply(t);return t}var V0=class t extends hc{constructor(e,i,n){super(),this._field=e,this._op=i,this._value=n,this.type="where"}static _create(e,i,n){return new t(e,i,n)}_apply(e){let i=this._parse(e);return c6(e._query,i),new Bi(e.firestore,e.converter,lR(e._query,i))}_parse(e){let i=pc(e.firestore);return mme(e._query,"where",i,e.firestore._databaseId,this._field,this._op,this._value)}};function e6(t,e,i){let n=e,r=nw("where",t);return V0._create(r,n,i)}var HA=class t extends Pp{constructor(e,i){super(),this.type=e,this._queryConstraints=i}static _create(e,i){return new t(e,i)}_parse(e){let i=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return i.length===1?i[0]:dt.create(i,this._getOperator())}_apply(e){let i=this._parse(e);return i.getFilters().length===0?e:(vme(e._query,i),new Bi(e.firestore,e.converter,lR(e._query,i)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var WA=class t extends hc{constructor(e,i){super(),this._field=e,this._direction=i,this.type="orderBy"}static _create(e,i){return new t(e,i)}_apply(e){let i=pme(e._query,this._field,this._direction);return new Bi(e.firestore,e.converter,jle(e._query,i))}};function t6(t,e="asc"){let i=e,n=nw("orderBy",t);return WA._create(n,i)}var j0=class t extends hc{constructor(e,i,n){super(),this.type=e,this._limit=i,this._limitType=n}static _create(e,i,n){return new t(e,i,n)}_apply(e){return new Bi(e.firestore,e.converter,l0(e._query,this._limit,this._limitType))}};function i6(t){return xH("limit",t),j0._create("limit",t,"F")}function n6(t){return xH("limitToLast",t),j0._create("limitToLast",t,"L")}var z0=class t extends hc{constructor(e,i,n){super(),this.type=e,this._docOrFields=i,this._inclusive=n}static _create(e,i,n){return new t(e,i,n)}_apply(e){let i=l6(e,this.type,this._docOrFields,this._inclusive);return new Bi(e.firestore,e.converter,zle(e._query,i))}};function r6(...t){return z0._create("startAt",t,!0)}function s6(...t){return z0._create("startAfter",t,!1)}var U0=class t extends hc{constructor(e,i,n){super(),this.type=e,this._docOrFields=i,this._inclusive=n}static _create(e,i,n){return new t(e,i,n)}_apply(e){let i=l6(e,this.type,this._docOrFields,this._inclusive);return new Bi(e.firestore,e.converter,Ule(e._query,i))}};function a6(...t){return U0._create("endBefore",t,!1)}function o6(...t){return U0._create("endAt",t,!0)}function l6(t,e,i,n){if(i[0]=We(i[0]),i[0]instanceof uc)return gme(t._query,t.firestore._databaseId,e,i[0]._document,n);{let r=pc(t.firestore);return _me(t._query,t.firestore._databaseId,r,e,i,n)}}function mme(t,e,i,n,r,s,a){let o;if(r.isKeyField()){if(s==="array-contains"||s==="array-contains-any")throw new D(T.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if(s==="in"||s==="not-in"){kq(a,s);let c=[];for(let d of a)c.push(Dq(n,t,d));o={arrayValue:{values:c}}}else o=Dq(n,t,a)}else(s==="in"||s==="not-in"||s==="array-contains-any")&&kq(a,s),o=YH(i,e,a,s==="in"||s==="not-in");return $e.create(r,s,o)}function pme(t,e,i){if(t.startAt!==null)throw new D(T.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(t.endAt!==null)throw new D(T.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new nc(e,i)}function gme(t,e,i,n,r){if(!n)throw new D(T.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${i}().`);let s=[];for(let a of Nu(t))if(a.field.isKeyField())s.push(ic(e,n.key));else{let o=n.data.field(a.field);if($0(o))throw new D(T.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(o!==null)s.push(o);else{let l=a.field.canonicalString();throw new D(T.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${l}' (used as the orderBy) does not exist.`)}}return new zs(s,r)}function _me(t,e,i,n,r,s){let a=t.explicitOrderBy;if(r.length>a.length)throw new D(T.INVALID_ARGUMENT,`Too many arguments provided to ${n}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let o=[];for(let l=0;l<r.length;l++){let c=r[l];if(a[l].field.isKeyField()){if(typeof c!="string")throw new D(T.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${n}(), but got a ${typeof c}`);if(!oR(t)&&c.indexOf("/")!==-1)throw new D(T.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${n}() must be a plain document ID, but '${c}' contains a slash.`);let u=t.path.child(Qe.fromString(c));if(!z.isDocumentKey(u))throw new D(T.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${n}() must result in a valid document path, but '${u}' is not because it contains an odd number of segments.`);let h=new z(u);o.push(ic(e,h))}else{let u=YH(i,n,c);o.push(u)}}return new zs(o,s)}function Dq(t,e,i){if(i=We(i),typeof i=="string"){if(i==="")throw new D(T.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!oR(e)&&i.indexOf("/")!==-1)throw new D(T.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${i}' contains a '/' character.`);let n=e.path.child(Qe.fromString(i));if(!z.isDocumentKey(n))throw new D(T.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ic(t,new z(n))}else{if(i instanceof xt)return ic(t,i._key);throw new D(T.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Gp(i)}.`)}}function kq(t,e){if(!Array.isArray(t)||t.length===0)throw new D(T.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bme(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function c6(t,e){let i=yme(t.filters,bme(e.op));if(i!==null)throw i===e.op?new D(T.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(T.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${i.toString()}' filters.`)}function vme(t,e){let i=t,n=e.getFlattenedFilters();for(let r of n)c6(i,r),i=lR(i,r)}function yme(t,e){for(let i of t)for(let n of i.getFlattenedFilters())if(e.indexOf(n.op)>=0)return n.op;return null}function wme(t){let e=t.filter(n=>n instanceof HA).length,i=t.filter(n=>n instanceof V0).length;if(e>1||e>0&&i>0)throw new D(T.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}var Gu=class{convertValue(e,i="none"){switch(tc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Wt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,i);case 5:return e.stringValue;case 6:return this.convertBytes(Ro(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,i);case 10:return this.convertObject(e.mapValue,i);default:throw Y()}}convertObject(e,i){return this.convertObjectMap(e.fields,i)}convertObjectMap(e,i="none"){let n={};return mc(e,(r,s)=>{n[r]=this.convertValue(s,i)}),n}convertGeoPoint(e){return new dc(Wt(e.latitude),Wt(e.longitude))}convertArray(e,i){return(e.values||[]).map(n=>this.convertValue(n,i))}convertServerTimestamp(e,i){switch(i){case"previous":let n=rR(e);return n==null?null:this.convertValue(n,i);case"estimate":return this.convertTimestamp(mp(e));default:return null}}convertTimestamp(e){let i=Ao(e);return new Bt(i.seconds,i.nanos)}convertDocumentKey(e,i){let n=Qe.fromString(e);oe(W5(n));let r=new Mo(n.get(1),n.get(3)),s=new z(n.popFirst(5));return r.isEqual(i)||Lt(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${i.projectId}/${i.database}) instead.`),s}};function rw(t,e,i){let n;return t?i&&(i.merge||i.mergeFields)?n=t.toFirestore(e,i):n=t.toFirestore(e):n=e,n}var GA=class extends Gu{constructor(e){super(),this.firestore=e}convertBytes(e){return new qs(e)}convertReference(e){let i=this.convertDocumentKey(e,this.firestore._databaseId);return new xt(this.firestore,null,i)}};function KA(t){return Cme(t,["next","error","complete"])}function Cme(t,e){if(typeof t!="object"||t===null)return!1;let i=t;for(let n of e)if(n in i&&typeof i[n]=="function")return!0;return!1}var ma=class{constructor(e,i){this.hasPendingWrites=e,this.fromCache=i}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Er=class extends uc{constructor(e,i,n,r,s,a){super(e,i,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document)if(this._converter){let i=new Vo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(i,e)}else return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);else return}get(e,i={}){if(this._document){let n=this._document.data.field(nw("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,i.serverTimestamps)}}},Vo=class extends Er{data(e={}){return super.data(e)}},$r=class{constructor(e,i,n,r){this._firestore=e,this._userDataWriter=i,this._snapshot=r,this.metadata=new ma(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){let e=[];return this.forEach(i=>e.push(i)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,i){this._snapshot.docs.forEach(n=>{e.call(i,new Vo(this._firestore,this._userDataWriter,n.key,n,new ma(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let i=!!e.includeMetadataChanges;if(i&&this._snapshot.excludesMetadataChanges)throw new D(T.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return(!this._cachedChanges||this._cachedChangesIncludeMetadataChanges!==i)&&(this._cachedChanges=Eme(this,i),this._cachedChangesIncludeMetadataChanges=i),this._cachedChanges}};function Eme(t,e){if(t._snapshot.oldDocs.isEmpty()){let i=0;return t._snapshot.docChanges.map(n=>{let r=new Vo(t._firestore,t._userDataWriter,n.doc.key,n.doc,new ma(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:i++}})}else{let i=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(n=>e||n.type!==3).map(n=>{let r=new Vo(t._firestore,t._userDataWriter,n.doc.key,n.doc,new ma(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter),s=-1,a=-1;return n.type!==0&&(s=i.indexOf(n.doc.key),i=i.delete(n.doc.key)),n.type!==1&&(i=i.add(n.doc),a=i.indexOf(n.doc.key)),{type:Sme(n.type),doc:r,oldIndex:s,newIndex:a}})}}function Sme(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function zR(t,e){return t instanceof Er&&e instanceof Er?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof $r&&e instanceof $r?t._firestore===e._firestore&&FR(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot):!1}function d6(t){t=Xe(t,xt);let e=Xe(t.firestore,Pt),i=yi(e);return kH(i,t._key).then(n=>WR(e,t,n))}var pa=class extends Gu{constructor(e){super(),this.firestore=e}convertBytes(e){return new qs(e)}convertReference(e){let i=this.convertDocumentKey(e,this.firestore._databaseId);return new xt(this.firestore,null,i)}};function u6(t){t=Xe(t,xt);let e=Xe(t.firestore,Pt),i=yi(e),n=new pa(e);return zfe(i,t._key).then(r=>new Er(e,n,t._key,r,new ma(r!==null&&r.hasLocalMutations,!0),t.converter))}function h6(t){t=Xe(t,xt);let e=Xe(t.firestore,Pt),i=yi(e);return kH(i,t._key,{source:"server"}).then(n=>WR(e,t,n))}function f6(t){t=Xe(t,Bi);let e=Xe(t.firestore,Pt),i=yi(e),n=new pa(e);return JH(t._query),AH(i,t._query).then(r=>new $r(e,n,t,r))}function m6(t){t=Xe(t,Bi);let e=Xe(t.firestore,Pt),i=yi(e),n=new pa(e);return Ufe(i,t._query).then(r=>new $r(e,n,t,r))}function p6(t){t=Xe(t,Bi);let e=Xe(t.firestore,Pt),i=yi(e),n=new pa(e);return AH(i,t._query,{source:"server"}).then(r=>new $r(e,n,t,r))}function UR(t,e,i){t=Xe(t,xt);let n=Xe(t.firestore,Pt),r=rw(t.converter,e,i),s=pc(n),o=iw(s,"setDoc",t._key,r,t.converter!==null,i).toMutation(t._key,Ht.none());return nh(n,[o])}function qR(t,e,i,...n){t=Xe(t,xt);let r=Xe(t.firestore,Pt),s=pc(r);e=We(e);let a;typeof e=="string"||e instanceof Kr?a=BR(s,"updateDoc",t._key,e,i,n):a=LR(s,"updateDoc",t._key,e);let o=a.toMutation(t._key,Ht.exists(!0));return nh(r,[o])}function g6(t){let e=Xe(t.firestore,Pt),i=[new Lo(t._key,Ht.none())];return nh(e,i)}function _6(t,e){let i=Xe(t.firestore,Pt),n=Kp(t),r=rw(t.converter,e),s=pc(t.firestore),o=iw(s,"addDoc",n._key,r,t.converter!==null,{}).toMutation(n._key,Ht.exists(!1));return nh(i,[o]).then(()=>n)}function HR(t,...e){var i,n,r;t=We(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]=="object"&&!KA(e[a])&&(s=e[a],a++);let o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(KA(e[a])){let h=e[a];e[a]=(i=h.next)===null||i===void 0?void 0:i.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let l,c,d;if(t instanceof xt)c=Xe(t.firestore,Pt),d=Xu(t._key.path),l={next:h=>{e[a]&&e[a](WR(c,t,h))},error:e[a+1],complete:e[a+2]};else{let h=Xe(t,Bi);c=Xe(h.firestore,Pt),d=h._query;let f=new pa(c);l={next:p=>{e[a]&&e[a](new $r(c,f,h,p))},error:e[a+1],complete:e[a+2]},JH(t._query)}let u=yi(c);return jfe(u,d,o,l)}function b6(t,e){t=Xe(t,Pt);let i=yi(t),n=KA(e)?e:{next:e};return Hfe(i,n)}function nh(t,e){let i=yi(t);return qfe(i,e)}function WR(t,e,i){let n=i.docs.get(e._key),r=new pa(t);return new Er(t,r,e._key,n,new ma(i.hasPendingWrites,i.fromCache),e.converter)}var xme={maxAttempts:5};function Tme(t){if(t.maxAttempts<1)throw new D(T.INVALID_ARGUMENT,"Max attempts must be at least 1")}var q0=class{constructor(e,i){this._firestore=e,this._commitHandler=i,this._mutations=[],this._committed=!1,this._dataReader=pc(e)}set(e,i,n){this._verifyNotCommitted();let r=Io(e,this._firestore),s=rw(r.converter,i,n),a=iw(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,n);return this._mutations.push(a.toMutation(r._key,Ht.none())),this}update(e,i,n,...r){this._verifyNotCommitted();let s=Io(e,this._firestore);i=We(i);let a;return typeof i=="string"||i instanceof Kr?a=BR(this._dataReader,"WriteBatch.update",s._key,i,n,r):a=LR(this._dataReader,"WriteBatch.update",s._key,i),this._mutations.push(a.toMutation(s._key,Ht.exists(!0))),this}delete(e){this._verifyNotCommitted();let i=Io(e,this._firestore);return this._mutations=this._mutations.concat(new Lo(i._key,Ht.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new D(T.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Io(t,e){if(t=We(t),t.firestore!==e)throw new D(T.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var $A=class{constructor(e,i){this._firestore=e,this._transaction=i,this._dataReader=pc(e)}get(e){let i=Io(e,this._firestore),n=new GA(this._firestore);return this._transaction.lookup([i._key]).then(r=>{if(!r||r.length!==1)return Y();let s=r[0];if(s.isFoundDocument())return new uc(this._firestore,n,s.key,s,i.converter);if(s.isNoDocument())return new uc(this._firestore,n,i._key,null,i.converter);throw Y()})}set(e,i,n){let r=Io(e,this._firestore),s=rw(r.converter,i,n),a=iw(this._dataReader,"Transaction.set",r._key,s,r.converter!==null,n);return this._transaction.set(r._key,a),this}update(e,i,n,...r){let s=Io(e,this._firestore);i=We(i);let a;return typeof i=="string"||i instanceof Kr?a=BR(this._dataReader,"Transaction.update",s._key,i,n,r):a=LR(this._dataReader,"Transaction.update",s._key,i),this._transaction.update(s._key,a),this}delete(e){let i=Io(e,this._firestore);return this._transaction.delete(i._key),this}};var YA=class extends $A{constructor(e,i){super(e,i),this._firestore=e}get(e){let i=Io(e,this._firestore),n=new pa(this._firestore);return super.get(e).then(r=>new Er(this._firestore,n,i._key,r._document,new ma(!1,!1),i.converter))}};function v6(t,e,i){t=Xe(t,Pt);let n=Object.assign(Object.assign({},xme),i);Tme(n);let r=yi(t);return Wfe(r,s=>e(new YA(t,s)),n)}function y6(){return new Np("deleteField")}function w6(){return new BA("serverTimestamp")}function C6(...t){return new VA("arrayUnion",t)}function E6(...t){return new jA("arrayRemove",t)}function S6(t){return new zA("increment",t)}lme("node");var Ime="@firebase/firestore-compat",Dme="0.3.28";function XR(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new D("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function x6(){if(typeof Uint8Array>"u")throw new D("unimplemented","Uint8Arrays are not available in this environment.")}function T6(){if(!Xq())throw new D("unimplemented","Blobs are unavailable in Firestore in this environment.")}var sw=class t{constructor(e){this._delegate=e}static fromBase64String(e){return T6(),new t(qs.fromBase64String(e))}static fromUint8Array(e){return x6(),new t(qs.fromUint8Array(e))}toBase64(){return T6(),this._delegate.toBase64()}toUint8Array(){return x6(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function GR(t){return kme(t,["next","error","complete"])}function kme(t,e){if(typeof t!="object"||t===null)return!1;let i=t;for(let n of e)if(n in i&&typeof i[n]=="function")return!0;return!1}var KR=class{enableIndexedDbPersistence(e,i){return LH(e._delegate,{forceOwnership:i})}enableMultiTabIndexedDbPersistence(e){return BH(e._delegate)}clearIndexedDbPersistence(e){return jH(e._delegate)}},aw=class{constructor(e,i,n){this._delegate=i,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof Mo||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let i=this._delegate._getSettings();!e.merge&&i.host!==e.host&&wr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},i),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,i,n={}){OH(this._delegate,e,i,n)}enableNetwork(){return UH(this._delegate)}disableNetwork(){return qH(this._delegate)}enablePersistence(e){let i=!1,n=!1;return e&&(i=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,AR("synchronizeTabs",i,"experimentalForceOwningTab",n)),i?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return zH(this._delegate)}onSnapshotsInSync(e){return b6(this._delegate,e)}get app(){if(!this._appCompat)throw new D("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ah(this,NR(this._delegate,e))}catch(i){throw bn(i,"collection()","Firestore.collection()")}}doc(e){try{return new Hs(this,Kp(this._delegate,e))}catch(i){throw bn(i,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new yc(this,NH(this._delegate,e))}catch(i){throw bn(i,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return v6(this._delegate,i=>e(new ow(this,i)))}batch(){return yi(this._delegate),new lw(new q0(this._delegate,e=>nh(this._delegate,e)))}loadBundle(e){return HH(this._delegate,e)}namedQuery(e){return WH(this._delegate,e).then(i=>i?new yc(this,i):null)}},rh=class extends Gu{constructor(e){super(),this.firestore=e}convertBytes(e){return new sw(new qs(e))}convertReference(e){let i=this.convertDocumentKey(e,this.firestore._databaseId);return Hs.forKey(i,this.firestore,null)}};function Ame(t){Rq(t)}var ow=class{constructor(e,i){this._firestore=e,this._delegate=i,this._userDataWriter=new rh(e)}get(e){let i=_c(e);return this._delegate.get(i).then(n=>new bc(this._firestore,new Er(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,i.converter)))}set(e,i,n){let r=_c(e);return n?(XR("Transaction.set",n),this._delegate.set(r,i,n)):this._delegate.set(r,i),this}update(e,i,n,...r){let s=_c(e);return arguments.length===2?this._delegate.update(s,i):this._delegate.update(s,i,n,...r),this}delete(e){let i=_c(e);return this._delegate.delete(i),this}},lw=class{constructor(e){this._delegate=e}set(e,i,n){let r=_c(e);return n?(XR("WriteBatch.set",n),this._delegate.set(r,i,n)):this._delegate.set(r,i),this}update(e,i,n,...r){let s=_c(e);return arguments.length===2?this._delegate.update(s,i):this._delegate.update(s,i,n,...r),this}delete(e){let i=_c(e);return this._delegate.delete(i),this}commit(){return this._delegate.commit()}},sh=class t{constructor(e,i,n){this._firestore=e,this._userDataWriter=i,this._delegate=n}fromFirestore(e,i){let n=new Vo(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new vc(this._firestore,n),i??{})}toFirestore(e,i){return i?this._delegate.toFirestore(e,i):this._delegate.toFirestore(e)}static getInstance(e,i){let n=t.INSTANCES,r=n.get(e);r||(r=new WeakMap,n.set(e,r));let s=r.get(i);return s||(s=new t(e,new rh(e),i),r.set(i,s)),s}};sh.INSTANCES=new WeakMap;var Hs=class t{constructor(e,i){this.firestore=e,this._delegate=i,this._userDataWriter=new rh(e)}static forPath(e,i,n){if(e.length%2!==0)throw new D("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(i,new xt(i._delegate,n,new z(e)))}static forKey(e,i,n){return new t(i,new xt(i._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new ah(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ah(this.firestore,NR(this._delegate,e))}catch(i){throw bn(i,"collection()","DocumentReference.collection()")}}isEqual(e){return e=We(e),e instanceof xt?PR(this._delegate,e):!1}set(e,i){i=XR("DocumentReference.set",i);try{return i?UR(this._delegate,e,i):UR(this._delegate,e)}catch(n){throw bn(n,"setDoc()","DocumentReference.set()")}}update(e,i,...n){try{return arguments.length===1?qR(this._delegate,e):qR(this._delegate,e,i,...n)}catch(r){throw bn(r,"updateDoc()","DocumentReference.update()")}}delete(){return g6(this._delegate)}onSnapshot(...e){let i=I6(e),n=D6(e,r=>new bc(this.firestore,new Er(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return HR(this._delegate,i,n)}get(e){let i;return e?.source==="cache"?i=u6(this._delegate):e?.source==="server"?i=h6(this._delegate):i=d6(this._delegate),i.then(n=>new bc(this.firestore,new Er(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(sh.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function bn(t,e,i){return t.message=t.message.replace(e,i),t}function I6(t){for(let e of t)if(typeof e=="object"&&!GR(e))return e;return{}}function D6(t,e){var i,n;let r;return GR(t[0])?r=t[0]:GR(t[1])?r=t[1]:typeof t[0]=="function"?r={next:t[0],error:t[1],complete:t[2]}:r={next:t[1],error:t[2],complete:t[3]},{next:s=>{r.next&&r.next(e(s))},error:(i=r.error)===null||i===void 0?void 0:i.bind(r),complete:(n=r.complete)===null||n===void 0?void 0:n.bind(r)}}var bc=class{constructor(e,i){this._firestore=e,this._delegate=i}get ref(){return new Hs(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,i){return this._delegate.get(e,i)}isEqual(e){return zR(this._delegate,e._delegate)}},vc=class extends bc{data(e){let i=this._delegate.data(e);return this._delegate._converter||Mq(i!==void 0,"Document in a QueryDocumentSnapshot should exist"),i}},yc=class t{constructor(e,i){this.firestore=e,this._delegate=i,this._userDataWriter=new rh(e)}where(e,i,n){try{return new t(this.firestore,_a(this._delegate,e6(e,i,n)))}catch(r){throw bn(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,i){try{return new t(this.firestore,_a(this._delegate,t6(e,i)))}catch(n){throw bn(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,_a(this._delegate,i6(e)))}catch(i){throw bn(i,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,_a(this._delegate,n6(e)))}catch(i){throw bn(i,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,_a(this._delegate,r6(...e)))}catch(i){throw bn(i,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,_a(this._delegate,s6(...e)))}catch(i){throw bn(i,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,_a(this._delegate,a6(...e)))}catch(i){throw bn(i,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,_a(this._delegate,o6(...e)))}catch(i){throw bn(i,"endAt()","Query.endAt()")}}isEqual(e){return FR(this._delegate,e._delegate)}get(e){let i;return e?.source==="cache"?i=m6(this._delegate):e?.source==="server"?i=p6(this._delegate):i=f6(this._delegate),i.then(n=>new $p(this.firestore,new $r(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){let i=I6(e),n=D6(e,r=>new $p(this.firestore,new $r(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return HR(this._delegate,i,n)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(sh.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},$R=class{constructor(e,i){this._firestore=e,this._delegate=i}get type(){return this._delegate.type}get doc(){return new vc(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},$p=class{constructor(e,i){this._firestore=e,this._delegate=i}get query(){return new yc(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new vc(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(i=>new $R(this._firestore,i))}forEach(e,i){this._delegate.forEach(n=>{e.call(i,new vc(this._firestore,n))})}isEqual(e){return zR(this._delegate,e._delegate)}},ah=class t extends yc{constructor(e,i){super(e,i),this.firestore=e,this._delegate=i}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Hs(this.firestore,e):null}doc(e){try{return e===void 0?new Hs(this.firestore,Kp(this._delegate)):new Hs(this.firestore,Kp(this._delegate,e))}catch(i){throw bn(i,"doc()","CollectionReference.doc()")}}add(e){return _6(this._delegate,e).then(i=>new Hs(this.firestore,i))}isEqual(e){return PR(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(sh.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function _c(t){return Xe(t,xt)}var YR=class t{constructor(...e){this._delegate=new Kr(...e)}static documentId(){return new t(ei.keyField().canonicalString())}isEqual(e){return e=We(e),e instanceof Kr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var QR=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=w6();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=y6();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let i=C6(...e);return i._methodName="FieldValue.arrayUnion",new t(i)}static arrayRemove(...e){let i=E6(...e);return i._methodName="FieldValue.arrayRemove",new t(i)}static increment(e){let i=S6(e);return i._methodName="FieldValue.increment",new t(i)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var Rme={Firestore:aw,GeoPoint:dc,Timestamp:Bt,Blob:sw,Transaction:ow,WriteBatch:lw,DocumentReference:Hs,DocumentSnapshot:bc,Query:yc,QueryDocumentSnapshot:vc,QuerySnapshot:$p,CollectionReference:ah,FieldPath:YR,FieldValue:QR,setLogLevel:Ame,CACHE_SIZE_UNLIMITED:PH};function Mme(t,e){t.INTERNAL.registerComponent(new Rn("firestore-compat",i=>{let n=i.getProvider("app-compat").getImmediate(),r=i.getProvider("firestore").getImmediate();return e(n,r)},"PUBLIC").setServiceProps(Object.assign({},Rme)))}function Ome(t){Mme(t,(e,i)=>new aw(e,i,new KR)),t.registerVersion(Ime,Dme,"node")}Ome(vi);function Nme(t,e=Cc){return new ni(i=>{let n;return e!=null?e.schedule(()=>{n=t.onSnapshot({includeMetadataChanges:!0},i)}):n=t.onSnapshot({includeMetadataChanges:!0},i),()=>{n?.()}})}function k6(t,e){return Nme(t,e)}function Pme(t,e){return k6(t,e).pipe(Kt(void 0),ch(),Ie(i=>{let[n,r]=i;return r.exists?n?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}function eM(t,e){return k6(t,e).pipe(Ie(i=>({payload:i,type:"query"})))}var cw=class{ref;afs;constructor(e,i){this.ref=e,this.afs=i}set(e,i){return this.ref.set(e,i)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,i){let n=this.ref.collection(e),{ref:r,query:s}=N6(n,i);return new uw(r,s,this.afs)}snapshotChanges(){return Pme(this.ref,this.afs.schedulers.outsideAngular).pipe(Yt)}valueChanges(e={}){return this.snapshotChanges().pipe(Ie(({payload:i})=>e.idField?tn(Me({},i.data()),{[e.idField]:i.id}):i.data()))}get(e){return Yr(this.ref.get(e)).pipe(Yt)}};function dw(t,e){return eM(t,e).pipe(Kt(void 0),ch(),Ie(i=>{let[n,r]=i,s=r.payload.docChanges(),a=s.map(o=>({type:o.type,payload:o}));return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((o,l)=>{let c=s.find(u=>u.doc.ref.isEqual(o.ref)),d=n?.payload.docs.find(u=>u.ref.isEqual(o.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(o.metadata)||!c&&d&&JSON.stringify(d.metadata)===JSON.stringify(o.metadata)||a.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:o}})}),a}))}function A6(t,e,i){return dw(t,i).pipe(Go((n,r)=>Fme(n,r.map(s=>s.payload),e),[]),Sr(),Ie(n=>n.map(r=>({type:r.type,payload:r}))))}function Fme(t,e,i){return e.forEach(n=>{i.indexOf(n.type)>-1&&(t=Lme(t,n))}),t}function ZR(t,e,i,...n){let r=t.slice();return r.splice(e,i,...n),r}function Lme(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return ZR(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let i=t.slice();return i.splice(e.oldIndex,1),i.splice(e.newIndex,0,e),i}else return ZR(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return ZR(t,e.oldIndex,1);break}return t}function R6(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var uw=class{ref;query;afs;constructor(e,i,n){this.ref=e,this.query=i,this.afs=n}stateChanges(e){let i=dw(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(i=i.pipe(Ie(n=>n.filter(r=>e.indexOf(r.type)>-1)))),i.pipe(Kt(void 0),ch(),zt(([n,r])=>r.length>0||!n),Ie(([,n])=>n),Yt)}auditTrail(e){return this.stateChanges(e).pipe(Go((i,n)=>[...i,...n],[]))}snapshotChanges(e){let i=R6(e);return A6(this.query,i,this.afs.schedulers.outsideAngular).pipe(Yt)}valueChanges(e={}){return eM(this.query,this.afs.schedulers.outsideAngular).pipe(Ie(i=>i.payload.docs.map(n=>e.idField?tn(Me({},n.data()),{[e.idField]:n.id}):n.data())),Yt)}get(e){return Yr(this.query.get(e)).pipe(Yt)}add(e){return this.ref.add(e)}doc(e){return new cw(this.ref.doc(e),this.afs)}},JR=class{query;afs;constructor(e,i){this.query=e,this.afs=i}stateChanges(e){return!e||e.length===0?dw(this.query,this.afs.schedulers.outsideAngular).pipe(Yt):dw(this.query,this.afs.schedulers.outsideAngular).pipe(Ie(i=>i.filter(n=>e.indexOf(n.type)>-1)),zt(i=>i.length>0),Yt)}auditTrail(e){return this.stateChanges(e).pipe(Go((i,n)=>[...i,...n],[]))}snapshotChanges(e){let i=R6(e);return A6(this.query,i,this.afs.schedulers.outsideAngular).pipe(Yt)}valueChanges(e={}){return eM(this.query,this.afs.schedulers.outsideAngular).pipe(Ie(n=>n.payload.docs.map(r=>e.idField?Me({[e.idField]:r.id},r.data()):r.data())),Yt)}get(e){return Yr(this.query.get(e)).pipe(Yt)}},M6=new K("angularfire2.enableFirestorePersistence"),O6=new K("angularfire2.firestore.persistenceSettings"),Bme=new K("angularfire2.firestore.settings"),Vme=new K("angularfire2.firestore.use-emulator");function N6(t,e=i=>i){return{query:e(t),ref:t}}var jme=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(i,n,r,s,a,o,l,c,d,u,h,f,p,v,E,k,I){this.schedulers=l;let P=cl(i,o,n),L=d;u&&sf(P,o,h,p,v,E,f,k),[this.firestore,this.persistenceEnabled$]=Jc(`${P.name}.firestore`,"AngularFirestore",P.name,()=>{let te=o.runOutsideAngular(()=>P.firestore());if(s&&te.settings(s),L&&te.useEmulator(...L),r&&!dg(a)){let Ee=()=>{try{return Yr(te.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(ze){return typeof console<"u"&&console.warn(ze),et(!1)}};return[te,o.runOutsideAngular(Ee)]}else return[te,et(!1)]},[s,L,r])}collection(i,n){let r;typeof i=="string"?r=this.firestore.collection(i):r=i;let{ref:s,query:a}=N6(r,n),o=this.schedulers.ngZone.run(()=>s);return new uw(o,a,this)}collectionGroup(i,n){let r=n||(a=>a),s=this.firestore.collectionGroup(i);return new JR(r(s),this)}doc(i){let n;typeof i=="string"?n=this.firestore.doc(i):n=i;let r=this.schedulers.ngZone.run(()=>n);return new cw(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(n){return new(n||t)(C(Oa),C(Na,8),C(M6,8),C(Bme,8),C(nn),C(re),C(ll),C(O6,8),C(Vme,8),C(dl,8),C(Zh,8),C(Jh,8),C(ef,8),C(tf,8),C(nf,8),C(rf,8),C(Ys,8))};static \u0275prov=ee({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),P6=(()=>{class t{constructor(){vi.registerVersion("angularfire",rr.full,"fst-compat")}static enablePersistence(i){return{ngModule:t,providers:[{provide:M6,useValue:!0},{provide:O6,useValue:i}]}}static \u0275fac=function(n){return new(n||t)};static \u0275mod=X({type:t});static \u0275inj=Q({providers:[jme]})}return t})();var Qp="Service workers are disabled or not supported by this browser";function zme(t){return pw(()=>Zp(new Error(t)))}var oh=class{constructor(e){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=zme(Qp);else{let n=Qr(e,"controllerchange").pipe(Ie(()=>e.controller)),r=pw(()=>et(e.controller)),s=Jp(r,n);this.worker=s.pipe(zt(d=>!!d)),this.registration=this.worker.pipe(pi(()=>e.getRegistration()));let c=Qr(e,"message").pipe(Ie(d=>d.data)).pipe(zt(d=>d&&d.type)).pipe(dM());c.connect(),this.events=c}}postMessage(e,i){return this.worker.pipe(mi(1),Xr(n=>{n.postMessage(Me({action:e},i))})).toPromise().then(()=>{})}postMessageWithOperation(e,i,n){let r=this.waitForOperationCompleted(n),s=this.postMessage(e,i);return Promise.all([s,r]).then(([,a])=>a)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let i;return typeof e=="string"?i=n=>n.type===e:i=n=>e.includes(n.type),this.events.pipe(zt(i))}nextEventOfType(e){return this.eventsOfType(e).pipe(mi(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(zt(i=>i.nonce===e),mi(1),Ie(i=>{if(i.result!==void 0)return i.result;throw new Error(i.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},Ume=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(n){if(this.sw=n,this.pushManager=null,this.subscriptionChanges=new be,!n.isEnabled){this.messages=Sc,this.notificationClicks=Sc,this.subscription=Sc;return}this.messages=this.sw.eventsOfType("PUSH").pipe(Ie(s=>s.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(Ie(s=>s.data)),this.pushManager=this.sw.registration.pipe(Ie(s=>s.pushManager));let r=this.pushManager.pipe(pi(s=>s.getSubscription()));this.subscription=fi(r,this.subscriptionChanges)}requestSubscription(n){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(Qp));let r={userVisibleOnly:!0},s=this.decodeBase64(n.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),a=new Uint8Array(new ArrayBuffer(s.length));for(let o=0;o<s.length;o++)a[o]=s.charCodeAt(o);return r.applicationServerKey=a,this.pushManager.pipe(pi(o=>o.subscribe(r)),mi(1)).toPromise().then(o=>(this.subscriptionChanges.next(o),o))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(Qp));let n=r=>{if(r===null)throw new Error("Not subscribed to push notifications.");return r.unsubscribe().then(s=>{if(!s)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(mi(1),pi(n)).toPromise()}decodeBase64(n){return atob(n)}};e.\u0275fac=function(r){return new(r||e)(C(oh))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let t=e;return t})(),qme=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(n){if(this.sw=n,!n.isEnabled){this.versionUpdates=Sc,this.unrecoverable=Sc;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Qp));let n=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:n},n)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Qp));let n=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:n},n)}};e.\u0275fac=function(r){return new(r||e)(C(oh))},e.\u0275prov=ee({token:e,factory:e.\u0275fac});let t=e;return t})();var F6=new K("");function Hme(t,e,i,n){return()=>{if(!(gh(n)&&"serviceWorker"in navigator&&i.enabled!==!1))return;navigator.serviceWorker.addEventListener("controllerchange",()=>{navigator.serviceWorker.controller!==null&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})});let r;if(typeof i.registrationStrategy=="function")r=i.registrationStrategy();else{let[a,...o]=(i.registrationStrategy||"registerWhenStable:30000").split(":");switch(a){case"registerImmediately":r=et(null);break;case"registerWithDelay":r=L6(+o[0]||0);break;case"registerWhenStable":r=o[0]?fi(B6(t),L6(+o[0])):B6(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${i.registrationStrategy}`)}}t.get(re).runOutsideAngular(()=>r.pipe(mi(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:i.scope}).catch(a=>console.error("Service worker registration failed with:",a))))}}function L6(t){return et(null).pipe(oM(t))}function B6(t){return t.get(cg).isStable.pipe(zt(i=>i))}function Wme(t,e){return new oh(gh(e)&&t.enabled!==!1?navigator.serviceWorker:void 0)}var Yp=class{};function tM(t,e={}){return ig([Ume,qme,{provide:F6,useValue:t},{provide:Yp,useValue:e},{provide:oh,useFactory:Wme,deps:[Yp,nn]},{provide:yM,useFactory:Hme,deps:[vn,F6,Yp,nn],multi:!0}])}var V6={providers:[MM(CP),DM(),aE(),aE(),fM([a_.initializeApp(EP.firebaseConfig),o_,DB,P6]),tM("ngsw-worker.js",{enabled:!Oc(),registrationStrategy:"registerWhenStable:30000"}),tM("ngsw-worker.js",{enabled:!Oc(),registrationStrategy:"registerWhenStable:30000"})]};var Gme={providers:[kM()]},j6=CM(V6,Gme);var Kme=()=>TM(ZN,j6),UIe=Kme;export{us as a,UIe as b};
